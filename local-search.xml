<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>vue学习</title>
    <link href="/2024/02/20/vue%E5%AD%A6%E4%B9%A0/"/>
    <url>/2024/02/20/vue%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1 id="为什么要使用ref-函数来声明响应式状态"><a href="#为什么要使用ref-函数来声明响应式状态" class="headerlink" title="为什么要使用ref()函数来声明响应式状态"></a>为什么要使用<code>ref()</code>函数来声明响应式状态</h1><blockquote><p><strong><a href="https://cn.vuejs.org/guide/essentials/reactivity-fundamentals.html#why-refs">为什么要使用ref ?</a></strong></p><p>当你在模板中使用了一个 ref，然后改变了这个 ref 的值时，Vue 会自动检测到这个变化，并且相应地更新 DOM。这是通过一个基于依赖追踪的响应式系统实现的。当一个组件首次渲染时，Vue 会<strong>追踪</strong>在渲染过程中使用的每一个 ref。然后，当一个 ref 被修改时，它会<strong>触发</strong>追踪它的组件的一次重新渲染。</p><p>在标准的 JavaScript 中，检测普通变量的访问或修改是行不通的。然而，我们可以通过 getter 和 setter 方法来拦截对象属性的 get 和 set 操作。</p><p>该 <code>.value</code> 属性给予了 Vue 一个机会来检测 ref 何时被访问或修改。在其内部，Vue 在它的 getter 中执行追踪，在它的 setter 中执行触发。从概念上讲，你可以将 ref 看作是一个像这样的对象：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 伪代码，不是真正的实现</span><br><span class="hljs-keyword">const</span> myRef = &#123;<br><span class="hljs-attr">_value</span>: <span class="hljs-number">0</span>,<br><span class="hljs-keyword">get</span> <span class="hljs-title function_">value</span>() &#123;<br><span class="hljs-title function_">track</span>()<br><span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_value</span><br>&#125;,<br><span class="hljs-keyword">set</span> <span class="hljs-title function_">value</span>(<span class="hljs-params">newValue</span>) &#123;<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">_value</span> = newValue<br><span class="hljs-title function_">trigger</span>()<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>另一个 ref 的好处是，与普通变量不同，你可以将 ref 传递给函数，同时保留对最新值和响应式连接的访问。当将复杂的逻辑重构为可重用的代码时，这将非常有用。</p></blockquote><h1 id="computed和watch、watchEffect"><a href="#computed和watch、watchEffect" class="headerlink" title="computed和watch、watchEffect"></a>computed和watch、watchEffect</h1><table><thead><tr><th>对比依据</th><th>computed</th><th>watch</th><th>watchEffect</th></tr></thead><tbody><tr><td>是否自动收集依赖（1）</td><td>自动</td><td>需要指定依赖对象</td><td>自动</td></tr><tr><td>有无返回值</td><td>有</td><td>无</td><td>有</td></tr><tr><td>是否可以赋值</td><td>可以</td><td>不能</td><td>不能</td></tr><tr><td>使用场景</td><td>简单情况</td><td>复杂情况</td><td>简单情况</td></tr><tr><td>是否立即执行</td><td>是</td><td>看参数（2）</td><td>是</td></tr><tr><td>本质</td><td>class</td><td>function</td><td>function</td></tr></tbody></table><p>（1）依赖：指的是响应性依赖，也就是侦听 ref、reactive 这类具有响应性的对象。</p><p>（2）watch：默认情况下，被侦听对象变化时才会执行，但是可以通过 options 参数设置为可以立即执行</p><blockquote><p>computed的缓存原理：就是ComputedRefImpl上有私有成员<code>_value</code>，执行get方法时，会吧返回值存入<code>_value</code>，template直接从<code>_value</code>属性获取数据，在需要更新缓存的时候才会调用<code>getter</code>方法</p></blockquote><h1 id="vue的模版编译"><a href="#vue的模版编译" class="headerlink" title="vue的模版编译"></a>vue的模版编译</h1><p>模板字符串 -&gt; 解析器 -&gt; AST -&gt; 优化器 -&gt; AST -&gt; 代码生成器 -&gt; 渲染函数</p><h1 id="vue的响应式原理"><a href="#vue的响应式原理" class="headerlink" title="vue的响应式原理"></a>vue的响应式原理</h1>]]></content>
    
    
    <categories>
      
      <category>技术</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>js学习</title>
    <link href="/2024/02/20/js%E5%AD%A6%E4%B9%A0/"/>
    <url>/2024/02/20/js%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1 id="js执行过程"><a href="#js执行过程" class="headerlink" title="js执行过程"></a>js执行过程</h1><p>JavaScript代码的执行过程可以分为三个阶段：解析（Parsing）、编译（Compilation）和执行（Execution）</p><ol><li>词法分析：将代码的字符串分析得到词法单元token</li><li>语法分析：将词法单元流解析成AST（抽象语法树），该过程包括词法作用域的生成、变量提升等阶段</li><li>代码生成：AST转换成字节码，这部分有V8中的lgnition解释器来生成的</li><li>代码执行：逐条解释执行字节码，注意了，当 V8 发现有大量重复字节码时（热点代码 HotSpot ），会将其编译成机器码（由引擎中 TurboFan 编译器进行编译），下次再碰到类似字节码不需要解释，直接执行，这种与解释器配合的过程也称为 <em><strong>JIT （即时编译）</strong></em>。</li><li>垃圾回收</li></ol><h1 id="作用域与作用域链、原型与原型链"><a href="#作用域与作用域链、原型与原型链" class="headerlink" title="作用域与作用域链、原型与原型链"></a>作用域与作用域链、原型与原型链</h1><p>在es5之前，js只有<strong>全局作用域</strong>及<strong>函数作用域</strong>。es6引入了块级作用域。但是这个块级别作用域需要注意的是不是<code>&#123;&#125;</code>的作用域，而是<code>let</code>，<code>const</code>关键字的<strong>块级作用域</strong></p><p>作用域链：[[scope]]中所存储的执行期上下文对象的<code>集合</code>，这个集合呈<code>链式连接</code>，我们把这种链式连接叫做<code>作用域链</code></p><p>copy from <a href="https://juejin.cn/post/7287524648808366091">掘金文章地址</a></p><p>很明了，就不自己写了:smile:</p><h4 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h4><p>先来看一下上古时期的工作中我们是如何定义函数的，直接使用 <code>function</code> 关键字来声明</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">fun</span>(<span class="hljs-params"></span>) &#123;&#125;<br></code></pre></td></tr></table></figure><p>但是有的时候我们会发现函数也会用下面的这种格式来定义</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Fun</span>(<span class="hljs-params"></span>) &#123;&#125;<br></code></pre></td></tr></table></figure><p>除了第二个 <strong>函数名的首字母大写之外</strong>，本质上两者毫无区别 </p><h4 id="函数名首字母大写的意义"><a href="#函数名首字母大写的意义" class="headerlink" title="函数名首字母大写的意义"></a>函数名首字母大写的意义</h4><p>当我们需要将一个函数作为 <strong>构造函数</strong> 使用时，通常会将函数名首字母大写，为了看起来规范一些，仅此而已 </p><h4 id="实例化"><a href="#实例化" class="headerlink" title="实例化"></a>实例化</h4><p>对 <strong>构造函数</strong> 使用 <code>new</code> 关键字可以创建出不同的 <strong>实例（实例的本质就是一个对象）</strong>，就好比说：你没有女朋友，但是你可以准备一个构造函数 new 很多女朋友出来，就是这个意思！</p><h4 id="开造"><a href="#开造" class="headerlink" title="开造"></a>开造</h4><ul><li>构造函数（女朋友构造器）：</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">GirlFriend</span>(<span class="hljs-params"></span>) &#123;&#125;<br></code></pre></td></tr></table></figure><ul><li>创建第一个 gf1 （实例对象）</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> gf1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">GirlFriend</span>()<br><br>gf1.<span class="hljs-property">name</span> = <span class="hljs-string">&#x27;小美&#x27;</span><br>gf1.<span class="hljs-property">age</span> = <span class="hljs-number">18</span><br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(gf1)  <span class="hljs-comment">// &#123;name: &#x27;小美&#x27;, age: 18&#125;</span><br></code></pre></td></tr></table></figure><ul><li>创建第二个 gf2 （实例对象）</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> gf2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">GirlFriend</span>()<br><br>gf2.<span class="hljs-property">name</span> = <span class="hljs-string">&#x27;小丽&#x27;</span><br>gf2.<span class="hljs-property">age</span> = <span class="hljs-number">19</span><br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(gf2) <span class="hljs-comment">// &#123;name: &#x27;小丽&#x27;, age: 19&#125;</span><br></code></pre></td></tr></table></figure><h4 id="关联"><a href="#关联" class="headerlink" title="关联"></a>关联</h4><ul><li><code>GirlFriend</code> 是一个 <strong>构造函数</strong></li><li><code>gf1</code> 和 <code>gf2</code> 是通过 <code>new GirlFriend</code> 创建出来的两个 <strong>实例对象</strong></li></ul><p>那如何将 <strong>实例对象</strong> 和 <strong>构造函数</strong> 联系在一起呢？</p><ul><li>在 <strong>实例对象</strong> 上会默认存在一个属性叫做 <code>__proto__</code>，这里记作 <strong>隐式原型</strong></li><li>在 <strong>构造函数</strong> 上会默认存在一个属性叫做 <code>prototype</code>，这里记作 **显示原型 **</li></ul><p>通常我们所说的 <strong>原型对象</strong> 也就是指这里的 <code>prototype</code>，<strong>原型对象</strong> 上的 <code>constructor</code>属性可以直接访问该 <strong>构造函数</strong>（这里建议手动打印观察一下）<br>默认情况下，<strong>实例对象</strong> 的 <code>__proto__</code> 指向 <strong>构造函数</strong> 的 <code>prototype</code>，如果你想访问某个实例的原型对象，就可以通过如下关系来进行访问</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">GirlFriend</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span>) <span class="hljs-comment">// ƒ GirlFriend() &#123;&#125;</span><br>gf1.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">GirlFriend</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> <span class="hljs-comment">// true</span><br>gf2.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">GirlFriend</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> <span class="hljs-comment">// true</span><br></code></pre></td></tr></table></figure><h4 id="访问"><a href="#访问" class="headerlink" title="访问"></a>访问</h4><p>当我需要访问 <strong>实例对象</strong> 上存在的属性，比如 <code>name</code> 时：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(gf1.<span class="hljs-property">name</span>) <span class="hljs-comment">// &#x27;小美&#x27;</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(gf2.<span class="hljs-property">name</span>) <span class="hljs-comment">// &#x27;小丽&#x27;</span><br></code></pre></td></tr></table></figure><p>当我需要访问 <strong>实例对象</strong> 上不存在的属性，比如 <code>feature</code> 时：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(gf1.<span class="hljs-property">feature</span>) <span class="hljs-comment">// undefined</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(gf2.<span class="hljs-property">feature</span>) <span class="hljs-comment">// undefined</span><br></code></pre></td></tr></table></figure><p>因为没有这个属性，自然而然就会打印 <code>undefined</code><br>但如果说我想添加一个共同的属性给所有被 <strong>实例化的对象</strong> 时，我该如何去处理呢？</p><ul><li>上面已经说明，被同一个 <strong>构造函数</strong> 创建出来的 <strong>实例对象</strong> ，默认情况下他们的 <strong>隐式原型</strong> 都会指向该构造函数的 <strong>显示原型</strong> ，也就是 <code>GirlFriend.prototype</code>，因此我只需要在往这个原型上去添加就好</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">GirlFriend</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">feature</span> = <span class="hljs-string">&#x27;beautiful&#x27;</span><br></code></pre></td></tr></table></figure><p>此时再次访问实例上的 <code>feature</code>属性，最终即可得到正常的打印</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(gf1.<span class="hljs-property">feature</span>) <span class="hljs-comment">// beautiful</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(gf2.<span class="hljs-property">feature</span>) <span class="hljs-comment">// beautiful</span><br></code></pre></td></tr></table></figure><p>如果说我想单独给 <code>gf1</code> 添加不一样的 <code>feature</code> 再访问呢</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript">gf1.<span class="hljs-property">feature</span> = <span class="hljs-string">&#x27;pretty&#x27;</span><br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(gf1.<span class="hljs-property">feature</span>) <span class="hljs-comment">// pretty</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(gf2.<span class="hljs-property">feature</span>) <span class="hljs-comment">// beautiful</span><br></code></pre></td></tr></table></figure><p>但是，为什么我给 <strong>显示原型</strong> 添加的属性可以直接通过实例对象进行访问呢？ </p><h4 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h4><ol><li>每一个被 <strong>构造函数</strong> 创建的 <strong>实例对象</strong> 都是一个全新的 <strong>对象</strong> ，我们可以为该对象添加本身特有的属性</li><li>当我们尝试访问 <strong>实例对象</strong> 上的某个属性时，如果存在则会直接返回该属性的值；如果不存在，就会沿着 <strong>实例对象</strong> 的 <code>__proto__</code> 继续向上访问，如果查找到则会返回该属性的值，如果没有找到，则会返回 <code>undefined</code></li></ol><p>![Snipaste_2024-01-30_18-45-43](data:image&#x2F;svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1178 921"></svg>)</p><h4 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h4><p>为了更加清晰的了解原型，这里我们再提及 js 中几个比较关键的点 </p><h6 id="普通对象-object"><a href="#普通对象-object" class="headerlink" title="普通对象 - object"></a>普通对象 - object</h6><ul><li>只要是一个普通对象<code>object</code>，就可以用 <code>new Object()</code> 来实例化（<strong>Object() 是一个内置的构造函数</strong>），也就是说，所有的对象字面量都是 <code>Object()</code> 的实例</li><li><code>Object</code> 作为构造函数，<code>Object.prototype</code> 指向一个具体的 <strong>原型对象</strong> ，该 <strong>原型对象</strong> 作为对象的实例，它的 <code>__proto__</code> 值为 <code>null</code>，因而 <code>Object.prototype.__proto__ = null</code> 时也就走到了 <strong>原型的尽头</strong></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> obj = &#123;&#125;<br><span class="hljs-keyword">const</span> obj1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>()<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj.<span class="hljs-property">__proto__</span> === obj1.<span class="hljs-property">__proto__</span>)  <span class="hljs-comment">// true</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj1.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>) <span class="hljs-comment">// true</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">____proto__</span>) <span class="hljs-comment">// null</span><br></code></pre></td></tr></table></figure><p>![](data:image&#x2F;svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1328 740"></svg>)</p><p>回到上面那个例子，当我要访问 <strong>实例对象</strong> <code>gf1</code> 上的属性时：</p><ul><li><p>如果该属性存在，就会直接返回对应的值</p></li><li><p>如果该属性不存在，就会沿着 </p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">gf1.<span class="hljs-emphasis">__proto__</span><br></code></pre></td></tr></table></figure><p> 进行查找，本质上查找的就是 </p><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs elm"><span class="hljs-type">GirlFriend</span>.proto<span class="hljs-keyword">type</span><br></code></pre></td></tr></table></figure><p> 这个对象</p><ul><li>如果该属性存在，就会直接返回对应的值</li><li>如果该属性不存在，那么 <code>GirlFriend.prototype</code>作为 <code>Object</code>的实例对象，其本身也是存在<code>__proto__</code>属性的，所以会沿着 <code>GirlFriend.prototype.__proto__</code>来进行查找，本质上查找的就是<code>Object.prototype</code><ul><li>如果该属性存在，就会直接返回对应的值</li><li>如果不存在，就会查找接着查找 <code>Object.prototype.__proto__</code> ，此时 <code>Object.prototype.__proto__</code> 值为 <code>null</code> ，最终没有找到该属性，打印 <code>undefined</code></li></ul></li></ul></li></ul><p>这个顺序很好理解</p><ol><li><code>gf1.xx</code></li><li><code>gf1.__proto__.xx</code></li><li><code>gf1.__proto__.__proto__.xx</code></li><li><code>gf1.__proto__.__proto__.__proto__.xx</code></li></ol><p>当最终 <code>__proto__</code> 为 <code>null</code> 都没有找到时就会打印 <code>undefined</code><br>因此，沿着 <code>__proto__</code> 访问对象属性构成的这一条链也就是平时所说的 <strong>原型链</strong> </p><h6 id="特殊对象-function"><a href="#特殊对象-function" class="headerlink" title="特殊对象 - function"></a>特殊对象 - function</h6><ul><li><code>function</code> 也算是一类特殊的对象，因此可以直接通过属性的形式来进行变量的访问</li><li>已经内置了 <strong>Function() 构造函数</strong> ，因而 <strong>所有函数</strong> 都算作是 <code>Function</code> 的 <strong>实例对象</strong><ul><li>当 <code>Function</code> 作为 <strong>构造函数</strong> 时，可以访问其 <code>prototype</code> 属性</li><li>当 <code>Function</code> 作为 <strong>实例对象</strong> 时，可以访问其 <code>__proto__</code> 属性</li></ul></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 在 Function 这里就是：我实例化了我寄几</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Function</span>.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>) <span class="hljs-comment">// true</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> === <span class="hljs-title class_">Function</span>) <span class="hljs-comment">// true</span><br></code></pre></td></tr></table></figure><ul><li>内置的 <code>Object()</code> 也是一个函数，因此 <code>Object</code> 也是我 <code>Function</code> 的 <strong>实例对象</strong></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>) <span class="hljs-comment">// true</span><br></code></pre></td></tr></table></figure><p>![](data:image&#x2F;svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1263 923"></svg>)</p><h4 id="经典图示"><a href="#经典图示" class="headerlink" title="经典图示"></a>经典图示</h4><p><img src="/Users/mac/Desktop/test/TestCase/%E7%AC%94%E8%AE%B0/%E8%AF%AD%E8%A8%80/javascript/image/Snipaste_2024-01-30_18-51-00.png"></p><h1 id="执行上下文与闭包"><a href="#执行上下文与闭包" class="headerlink" title="执行上下文与闭包"></a>执行上下文与闭包</h1><p>在JavaScript中，执行上下文（execution context）是一个关键概念，与闭包（closure）密切相关。理解执行上下文如何与闭包交互可以帮助我们深入理解闭包的工作原理和行为。</p><p>执行上下文是JavaScript代码执行时的环境。它包含了变量、函数声明、作用域链等信息，用于管理和跟踪代码的执行过程。当一个函数被调用时，就会创建一个新的执行上下文。每个执行上下文都有自己的词法环境（Lexical Environment），用于存储变量和函数的声明。</p><p>在理解闭包之前，让我们先了解一下执行上下文的创建和销毁过程。当函数被调用时，会创建一个新的执行上下文，并将其推入执行上下文栈（execution context stack）中。当函数执行完毕后，其执行上下文会从栈中弹出并销毁。</p><p>现在，让我们通过一个例子来更具体地了解执行上下文和闭包之间的关系：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">outerFunction</span>(<span class="hljs-params">outerVariable</span>) &#123;<br>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">innerFunction</span>(<span class="hljs-params">innerVariable</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;outerVariable:&#x27;</span>, outerVariable);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;innerVariable:&#x27;</span>, innerVariable);<br>  &#125;<br>  <span class="hljs-keyword">return</span> innerFunction;<br>&#125;<br><br><span class="hljs-keyword">var</span> newFunction = <span class="hljs-title function_">outerFunction</span>(<span class="hljs-string">&#x27;outside&#x27;</span>);<br><span class="hljs-title function_">newFunction</span>(<span class="hljs-string">&#x27;inside&#x27;</span>); <span class="hljs-comment">// 输出: outerVariable: outside innerVariable: inside</span><br></code></pre></td></tr></table></figure><p>在这个例子中，当调用<code>outerFunction</code>时，会创建一个新的执行上下文，其中包含了<code>outerVariable</code>参数和<code>innerFunction</code>函数声明。然后，<code>outerFunction</code>返回了<code>innerFunction</code>，并将其赋值给变量<code>newFunction</code>。</p><p>现在让我们来看看闭包是如何形成的。当<code>innerFunction</code>被返回时，它会携带其词法环境（包含<code>outerVariable</code>）一起返回。这意味着<code>innerFunction</code>保持对<code>outerVariable</code>的引用，即使<code>outerFunction</code>执行完毕并且其执行上下文已经销毁。</p><p>这就是闭包的力量所在。它允许内部函数（<code>innerFunction</code>）访问其词法环境中的变量（<code>outerVariable</code>），即使这些变量在其创建时的执行上下文已经不存在。</p><p>在这个例子中，<code>newFunction</code>就是一个闭包。它引用了外部函数<code>outerFunction</code>的词法环境，其中包含了<code>outerVariable</code>变量。因此，当我们调用<code>newFunction</code>时，它可以访问并打印出<code>outerVariable</code>和<code>innerVariable</code>的值。</p><p>执行上下文和闭包的关系是密不可分的。闭包是由执行上下文中的变量引用形成的，而这些变量保留在闭包的作用域中。这使得闭包能够在函数执行完成后继续访问这些变量，实现了JavaScript中非常重要的特性。</p><p>理解执行上下文和闭包的交互对于编写复杂的JavaScript代码非常重要。它有助于我们更好地理解作用域、变量的生命周期以及如何正确使用闭包来解决问题。同时，它也帮助我们避免一些潜在的问题，如内存泄漏和不必要的资源消耗。</p><h2 id="闭包的作用"><a href="#闭包的作用" class="headerlink" title="闭包的作用"></a>闭包的作用</h2><h3 id="1-数据封装和私有性"><a href="#1-数据封装和私有性" class="headerlink" title="1. 数据封装和私有性"></a>1. 数据封装和私有性</h3><p>闭包可以用于创建私有变量，将变量隐藏在函数作用域内部，从而实现数据的封装和私有性。通过闭包，我们可以控制变量的访问权限，只暴露需要暴露的接口。这种封装机制可以防止外部代码直接访问和修改内部数据，增加代码的安全性。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createCounter</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">return</span> &#123;<br>    <span class="hljs-attr">increment</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>      count++;<br>    &#125;,<br>    <span class="hljs-attr">decrement</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>      count--;<br>    &#125;,<br>    <span class="hljs-attr">getCount</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>      <span class="hljs-keyword">return</span> count;<br>    &#125;<br>  &#125;;<br>&#125;<br><br><span class="hljs-keyword">const</span> counter = <span class="hljs-title function_">createCounter</span>();<br>counter.<span class="hljs-title function_">increment</span>();<br>counter.<span class="hljs-title function_">increment</span>();<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(counter.<span class="hljs-title function_">getCount</span>()); <span class="hljs-comment">// 输出: 2</span><br></code></pre></td></tr></table></figure><p>在这个例子中，<code>createCounter</code>函数返回一个对象，该对象包含了三个闭包函数，分别用于增加计数、减少计数和获取计数值。通过闭包，我们可以将<code>count</code>变量隐藏在函数内部，并通过闭包函数来操作和访问这个变量。</p><h3 id="2-模块化编程"><a href="#2-模块化编程" class="headerlink" title="2. 模块化编程"></a>2. 模块化编程</h3><p>闭包可以用于实现模块化编程，将相关的变量和函数组织在一个闭包内部，形成一个模块。这样可以避免全局命名冲突，提供命名空间，并且允许模块内部的函数相互调用和共享数据。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> myModule = (<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">var</span> privateVariable = <span class="hljs-string">&#x27;私有变量&#x27;</span>;<br><br>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">privateFunction</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;私有函数&#x27;</span>);<br>  &#125;<br><br>  <span class="hljs-keyword">return</span> &#123;<br>    <span class="hljs-attr">publicMethod</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(privateVariable);<br>    &#125;,<br>    <span class="hljs-attr">publicFunction</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>      <span class="hljs-title function_">privateFunction</span>();<br>    &#125;<br>  &#125;;<br>&#125;)();<br><br>myModule.<span class="hljs-title function_">publicMethod</span>(); <span class="hljs-comment">// 输出: 私有变量</span><br>myModule.<span class="hljs-title function_">publicFunction</span>(); <span class="hljs-comment">// 输出: 私有函数</span><br></code></pre></td></tr></table></figure><p>在这个例子中，我们使用了立即调用函数表达式（IIFE）来创建一个闭包，形成一个独立的模块。模块内部的变量和函数对外部是不可见的，只有通过公共接口才能访问。</p><h3 id="3-回调函数和事件处理"><a href="#3-回调函数和事件处理" class="headerlink" title="3. 回调函数和事件处理"></a>3. 回调函数和事件处理</h3><p>闭包常常用于处理回调函数和事件处理，特别是在异步编程中。由于闭包的特性，它可以捕获外部函数的上下文，并在内部函数被调用时保留这个上下文，从而实现对异步操作的响应。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchData</span>(<span class="hljs-params">url, callback</span>) &#123;<br>  <span class="hljs-title function_">fetch</span>(url).<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">response</span>) &#123;<br>    <span class="hljs-keyword">return</span> response.<span class="hljs-title function_">json</span>();<br>  &#125;).<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) &#123;<br>    <span class="hljs-title function_">callback</span>(data);<br>  &#125;);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">processData</span>(<span class="hljs-params">data</span>) &#123;<br>  <span class="hljs-variable language_">console</span><br><br>.<span class="hljs-title function_">log</span>(data);<br>&#125;<br><br><span class="hljs-title function_">fetchData</span>(<span class="hljs-string">&#x27;https://api.example.com/data&#x27;</span>, processData);<br></code></pre></td></tr></table></figure><p>在这个例子中，<code>fetchData</code>函数通过闭包捕获了<code>processData</code>函数作为回调函数。当异步操作完成时，它会调用回调函数并传递数据给它。闭包保持了回调函数的上下文，使得回调函数可以访问外部的<code>processData</code>函数。</p><h3 id="4-缓存和记忆化"><a href="#4-缓存和记忆化" class="headerlink" title="4. 缓存和记忆化"></a>4. 缓存和记忆化</h3><p>闭包还可以用于实现缓存和记忆化功能。通过闭包，我们可以在函数内部维护一个缓存，避免重复计算相同的结果，提高函数执行的性能。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">memoizedFunction</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">var</span> cache = &#123;&#125;;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params">arg</span>) &#123;<br>    <span class="hljs-keyword">if</span> (cache[arg]) &#123;<br>      <span class="hljs-keyword">return</span> cache[arg];<br>    &#125;<br>    <span class="hljs-comment">// 计算结果</span><br>    <span class="hljs-keyword">var</span> result = <span class="hljs-comment">// ...</span><br>    cache[arg] = result;<br>    <span class="hljs-keyword">return</span> result;<br>  &#125;;<br>&#125;<br><br><span class="hljs-keyword">var</span> memoized = <span class="hljs-title function_">memoizedFunction</span>();<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">memoized</span>(<span class="hljs-string">&#x27;value&#x27;</span>)); <span class="hljs-comment">// 第一次计算并缓存结果</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">memoized</span>(<span class="hljs-string">&#x27;value&#x27;</span>)); <span class="hljs-comment">// 直接从缓存中读取结果</span><br></code></pre></td></tr></table></figure><p>在这个例子中，<code>memoizedFunction</code>返回一个闭包函数，用于记忆化计算结果。闭包内部维护了一个缓存对象<code>cache</code>，当输入相同的参数时，直接从缓存中读取结果，避免重复计算。</p><p>闭包在JavaScript中有许多其他的应用场景，如实现延迟执行、函数柯里化、实现迭代器等。了解闭包的应用场景可以帮助我们写出更加优雅、高效的代码，并利用闭包的强大能力解决问题。</p><h2 id="闭包的优缺点"><a href="#闭包的优缺点" class="headerlink" title="闭包的优缺点"></a>闭包的优缺点</h2><p>当谈到闭包的缺点时，主要涉及内存消耗、内存泄漏和性能影响。下面是一些代码示例，帮助我们理解这些缺点。</p><h3 id="1-内存消耗"><a href="#1-内存消耗" class="headerlink" title="1. 内存消耗"></a><strong>1. 内存消耗</strong></h3><p>闭包会导致内存占用增加，因为它们会保留对外部变量的引用，即使外部函数执行完毕。这可能会导致内存占用过高。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createHugeArray</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">var</span> arr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(<span class="hljs-number">1000000</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-string">&#x27;Huge Data&#x27;</span>);<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr.<span class="hljs-property">length</span>);<br>  &#125;;<br>&#125;<br><br><span class="hljs-keyword">var</span> bigDataFunc = <span class="hljs-title function_">createHugeArray</span>();<br><span class="hljs-title function_">bigDataFunc</span>(); <span class="hljs-comment">// 输出: 1000000</span><br></code></pre></td></tr></table></figure><p>在这个例子中，<code>createHugeArray</code>函数返回一个闭包函数，它引用了一个巨大的数组<code>arr</code>。即使<code>createHugeArray</code>执行完毕，<code>arr</code>仍然被闭包引用，无法被垃圾回收机制回收，从而导致内存占用增加。</p><h3 id="2-内存泄漏"><a href="#2-内存泄漏" class="headerlink" title="2. 内存泄漏"></a><strong>2. 内存泄漏</strong></h3><p>由于闭包会持有对外部变量的引用，如果不正确地处理闭包的使用，可能会导致内存泄漏。如果一个闭包长时间存在，但不再需要，它会一直持有对外部变量的引用，使这些变量无法被垃圾回收。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">leakMemory</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">var</span> data = <span class="hljs-string">&#x27;Sensitive Data&#x27;</span>;<br>  <span class="hljs-keyword">var</span> timer = <span class="hljs-built_in">setInterval</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data);<br>  &#125;, <span class="hljs-number">1000</span>);<br>&#125;<br><br><span class="hljs-title function_">leakMemory</span>();<br></code></pre></td></tr></table></figure><p>在这个例子中，<code>leakMemory</code>函数创建了一个闭包，它引用了一个定时器内部的函数。即使<code>leakMemory</code>执行完毕，定时器仍然在持续执行，因此闭包会一直存在并引用<code>data</code>变量，导致<code>data</code>无法被垃圾回收。</p><h3 id="3-性能影响"><a href="#3-性能影响" class="headerlink" title="3. 性能影响"></a><strong>3. 性能影响</strong></h3><p>闭包可能对性能产生一定的影响，特别是在涉及大量变量或复杂词法环境的情况下。闭包的创建和执行可能消耗更多的时间和资源。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">calculate</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">var</span> result = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000000</span>; i++) &#123;<br>    result += i;<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result);<br>  &#125;;<br>&#125;<br><br><span class="hljs-keyword">var</span> expensiveFunc = <span class="hljs-title function_">calculate</span>();<br><span class="hljs-title function_">expensiveFunc</span>(); <span class="hljs-comment">// 输出: 499999500000</span><br></code></pre></td></tr></table></figure><p>在这个例子中，<code>calculate</code>函数返回一个闭包函数，它引用了一个在循环中计算的结果。由于闭包保留了这个结果，闭包的执行可能会耗费更多的时间和资源。</p><p>为了减少闭包的缺点，我们可以采取以下措施：</p><ul><li>优化内存使用：在闭包中避免持有大量数据或不必要的引用。确保只</li></ul><p>保留必要的变量和引用。</p><ul><li>及时清理闭包：在不需要使用闭包时，手动解除对闭包的引用，以便垃圾回收机制可以回收闭包相关的资源。</li><li>避免滥用闭包：只在必要的情况下使用闭包，避免在不必要的场景中使用闭包。</li><li>优化性能：在闭包的创建和使用过程中，尽量避免不必要的计算或资源消耗，以提高性能。</li></ul><p>通过合理使用和处理闭包，我们可以最大限度地减少其缺点，同时享受闭包在JavaScript中带来的强大功能。</p><h1 id="变量提升"><a href="#变量提升" class="headerlink" title="变量提升"></a>变量提升</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a)  <span class="hljs-comment">//输出的是undifined，而不是ReferenceError</span><br><span class="hljs-keyword">var</span> a = <span class="hljs-number">10</span>  <br><br><span class="hljs-title function_">foo</span>() <span class="hljs-comment">//这个函数是undifined，报错</span><br><span class="hljs-keyword">var</span> foo = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;foo1&quot;</span>)<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>var定义的变量会变量提升，所以声明会被拿到函数或全局作用域的顶部，并且输出undifined。所以执行foo()的时候，foo是undifined，所以会报错。由于js按照顺序从上往下，所以当执行foo &#x3D; function(){}的时候，才对foo进行赋值为一个函数。</li><li>这种定义函数的方式，我们称为函数表达式。函数表达式是将函数作为一个值赋给一个变量或属性</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;foo1&quot;</span>)<br>&#125;<br><span class="hljs-title function_">foo</span>()<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;foo2&quot;</span>)<br>&#125;<br><span class="hljs-title function_">foo</span>()<br></code></pre></td></tr></table></figure><ul><li>函数声明会在任何代码执行之前先被读取并添加到执行上下文，也就是函数声明提升，因此第二个foo会覆盖掉第一个foo，所以输出的是两个foo</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> foo = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;foo1&quot;</span>)<br>&#125;<br><span class="hljs-title function_">foo</span>()<br><br><span class="hljs-keyword">var</span> foo = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;foo2&quot;</span>)<br>&#125;<br><span class="hljs-title function_">foo</span>()<br><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;foo3&quot;</span>)<br>&#125;<br><span class="hljs-title function_">foo</span>()<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;foo4&quot;</span>)<br>&#125;<br><span class="hljs-title function_">foo</span>()<br></code></pre></td></tr></table></figure><ul><li>函数的变量提升优先级比var高，因此后两个foo提升上去后，被 <code>var foo</code>给覆盖了，隐藏最后执行函数<code>foo()</code>的时候，都是执行第二个<code>var foo</code>，所以输出的是foo1和3个foo2</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> a = <span class="hljs-number">0</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;1 a:&quot;</span>+a)<br><span class="hljs-keyword">if</span> (<span class="hljs-literal">true</span>) &#123;<br>  a = <span class="hljs-number">1</span><br>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">a</span>(<span class="hljs-params"></span>) &#123;&#125;<br>  a = <span class="hljs-number">5</span><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;2 a:&quot;</span>+a)<br>&#125;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;3 a:&quot;</span>+a)<br></code></pre></td></tr></table></figure><ul><li>js执行是按顺序从上到下的，因此先输出0</li><li>在if里面，也就是块级作用域，存在函数a，而在ES6之后，块级作用域中的函数声明会提升到全局，虽然提升到全局，但只有执行到这个函数的时候才会去重写块中生成对应的全局变量，否则就是重写之前声明的全局变量</li><li>没有变量提升后，按顺序执行<code>a = 1</code>，if作用域不存在a，因此会向外寻找，因此赋值给全局中的变量a，此时变量a的值为1</li><li>开始执行函数a，形成函数作用域，此时的a是一个函数</li><li>执行<code>a = 5</code>，此时的a是一个局部变量，不是外面的全局变量，因此输出的是5</li><li>此时全局变量当中的a是1，因此输出1</li></ul><blockquote><p>函数提升优先级高于变量提升，且不会被同名变量声明时覆盖，但是会被同名变量赋值后覆盖<br>变量提升是假提升，函数的提升是真提升，赋值后的同名变量优先级要高于同名函数</p></blockquote><p>JavaScript中具名的函数的声明形式有两种：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//函数声明式：</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span> () &#123;&#125;<br><span class="hljs-comment">//变量形式声明： </span><br><span class="hljs-keyword">var</span> fn = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;&#125;<br></code></pre></td></tr></table></figure><p>当使用变量形式声明函数时，和普通的变量一样会存在提升的现象，而函数声明式会提升到作用域最前边，并且将声明内容一起提升到最上边。如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">fn</span>()<br><span class="hljs-keyword">var</span> fn = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">1</span>)  <br>&#125;<br><span class="hljs-comment">// 输出结果：Uncaught TypeError: fn is not a function</span><br><br><span class="hljs-title function_">foo</span>()<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span> () &#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">2</span>)<br>&#125;<br><span class="hljs-comment">// 输出结果：2</span><br></code></pre></td></tr></table></figure><p>可以看到，使用变量形式声明fn并在其前面执行时，会报错fn不是一个函数，因为此时fn只是一个变量，还没有赋值为一个函数，所以是不能执行fn方法的。</p><h2 id="变量提升导致的问题"><a href="#变量提升导致的问题" class="headerlink" title="变量提升导致的问题"></a>变量提升导致的问题</h2><h3 id="变量被覆盖"><a href="#变量被覆盖" class="headerlink" title="变量被覆盖"></a>变量被覆盖</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> name = <span class="hljs-string">&quot;JavaScript&quot;</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">showName</span>(<span class="hljs-params"></span>)&#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(name);<br>  <span class="hljs-keyword">if</span>(<span class="hljs-number">0</span>)&#123;<br>   <span class="hljs-keyword">var</span> name = <span class="hljs-string">&quot;CSS&quot;</span><br>  &#125;<br>&#125;<br><span class="hljs-title function_">showName</span>()<br></code></pre></td></tr></table></figure><p>执行这段代码需要使用变量 name，代码中有两个 name 变量：一个在全局执行上下文中，其值是JavaScript；另外一个在 showName 函数的执行上下文中，由于if(0)永远不成立，所以 name 值是 undifined。那该使用哪个呢？<strong>应该先使用函数执行上下文中的变量</strong>。因为在函数执行过程中，JavaScript 会优先从当前的执行上下文中查找变量，由于变量提升的存在，当前的执行上下文中就包含了if(0)中的变量 name，其值是 undefined，所以获取到的 name 的值就是 undefined。</p><h3 id="变量没有被销毁"><a href="#变量没有被销毁" class="headerlink" title="变量没有被销毁"></a>变量没有被销毁</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>)&#123;<br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) &#123;<br>  &#125;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(i); <br>&#125;<br><span class="hljs-title function_">foo</span>()<br></code></pre></td></tr></table></figure><p>使用其他的大部分语言实现类似代码时，在 for 循环结束之后，i 就已经被销毁了，但是在 JavaScript 代码中，i 的值并未被销毁，所以最后打印出来的是 5。这也是由变量提升而导致的，在创建执行上下文阶段，变量 i 就已经被提升了，所以当 for 循环结束之后，变量 i 并没有被销毁。</p><h1 id="词法环境"><a href="#词法环境" class="headerlink" title="词法环境"></a>词法环境</h1><p>词法环境是一个包含标识符变量映射的结构。（这里的标识符表示变量&#x2F;函数的名称，变量是对实际对象【包括函数类型对象】或原始值的引用）。在词法环境中，有两个组成部分：（1）环境记录（environment record） （2）对外部环境的引用</p><ul><li>环境记录是存储变量和函数声明的实际位置。</li><li>对外部环境的引用意味着它可以访问其外部词法环境。(实现作用域链的重要部分)</li></ul><p>词法环境有两种类型：</p><ul><li><strong>全局环境</strong>（在全局执行上下文中）是一个没有外部环境的词法环境。全局环境的外部环境引用为 null。它拥有一个全局对象（window 对象）及其关联的方法和属性（例如数组方法）以及任何用户自定义的全局变量，this 的值指向这个全局对象。</li><li><strong>函数环境</strong>，用户在函数中定义的变量被存储在环境记录中。对外部环境的引用可以是全局环境，也可以是包含内部函数的外部函数环境。</li></ul><p>变量环境 Variable Environment</p><p>它也是一个词法环境，其 <code>EnvironmentRecord</code> 包含了由 <code>VariableStatements</code> 在此执行上下文创建的绑</p><p>变量环境组件（VariableEnvironment） 是用来登记var function变量声明，词法环境组件（LexicalEnvironment）是用来登记let const class等变量声明。</p><p>在ES6之前都没有块级作用域，ES6之后我们可以用let const来声明块级作用域，有这两个词法环境是为了实现块级作用域的同时不影响var变量声明和函数声明，具体如下：</p><ol><li><p>首先在一个正在运行的执行上下文内，词法环境由LexicalEnvironment和VariableEnvironment构成，用来登记所有的变量声明。</p></li><li><p>当执行到块级代码时候，会先LexicalEnvironment记录下来，记录为oldEnv。</p></li><li><p>创建一个新的LexicalEnvironment（outer指向oldEnv），记录为newEnv，并将newEnv设置为正在执行上下文的LexicalEnvironment。</p></li><li><p>块级代码内的let const会登记在newEnv里面，但是var声明和函数声明还是登记在原来的VariableEnvironment里。</p></li><li><p>块级代码执行结束后，将oldEnv还原为正在执行上下文的LexicalEnvironment。</p></li></ol><h1 id="浅拷贝、深拷贝"><a href="#浅拷贝、深拷贝" class="headerlink" title="浅拷贝、深拷贝"></a>浅拷贝、深拷贝</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> obj = &#123;<br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;test&#x27;</span>,<br>  <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>,<br>  <span class="hljs-attr">height</span>: <span class="hljs-number">188</span>,<br>  <span class="hljs-attr">money</span>: &#123;<br>    <span class="hljs-attr">jijing</span>: <span class="hljs-number">5000</span><br>  &#125;<br>&#125;<br><span class="hljs-comment">// 引用赋值，修改obj2的值，obj的值也会改，本质上obj和ibj2都指向同一个堆数据</span><br><span class="hljs-keyword">const</span> obj2 = obj<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;obj&#x27;</span>, obj2)<br>obj2.<span class="hljs-property">name</span> = <span class="hljs-string">&#x27;dawei&#x27;</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;obj&#x27;</span>, obj2)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;obj&#x27;</span>, obj)<br><br><span class="hljs-comment">// 浅拷贝，值拷贝第一层，其他的依旧是引用赋值</span><br><span class="hljs-keyword">const</span> obj3 = &#123;<br>  ...obj<br>&#125;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;obj&#x27;</span>, obj3)<br>obj3.<span class="hljs-property">name</span> = <span class="hljs-string">&#x27;dawei&#x27;</span><br>obj3.<span class="hljs-property">money</span>.<span class="hljs-property">jijing</span> = <span class="hljs-number">10000</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;obj&#x27;</span>, obj3)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;obj&#x27;</span>, obj)<br><br><span class="hljs-comment">// 深拷贝，完全独立的一个</span><br><span class="hljs-keyword">const</span> obj4 = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(obj))<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;obj&#x27;</span>, obj4)<br>obj4.<span class="hljs-property">name</span> = <span class="hljs-string">&#x27;dawei&#x27;</span><br>obj4.<span class="hljs-property">money</span>.<span class="hljs-property">jijing</span> = <span class="hljs-number">10000</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;obj&#x27;</span>, obj4)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;obj&#x27;</span>, obj)<br></code></pre></td></tr></table></figure><p>在使用深拷贝和浅拷贝时，需要注意以下几个问题：</p><ul><li><strong>循环引用</strong>：深拷贝和浅拷贝都需要注意循环引用的问题。循环引用是指对象之间相互引用，导致无限循环。在处理循环引用时，深拷贝需要使用额外的数据结构（如 <code>Map</code> 或 <code>WeakMap</code>）进行记录和判断，而浅拷贝则无法解决循环引用的问题。</li><li><strong>特殊类型的处理</strong>：在实现深拷贝和浅拷贝时，需要注意特殊类型的处理。特殊类型包括函数、正则表达式等。对于特殊类型，深拷贝可以选择直接引用原始对象，而浅拷贝只会复制引用。</li><li><strong>性能开销</strong>：深拷贝是一项相对耗费性能的操作，特别是在处理大型对象或嵌套层次很深的对象时。在实际应用中，需要根据场景权衡性能和需求。</li></ul><h1 id="set、map、reduce"><a href="#set、map、reduce" class="headerlink" title="set、map、reduce"></a>set、map、reduce</h1><h3 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h3><h4 id="去重"><a href="#去重" class="headerlink" title="去重"></a>去重</h4><p>使用 Set 可以轻松地进行数组去重操作，因为 Set 只能存储唯一的值。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> arr = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];<br><span class="hljs-keyword">const</span> uniqueArr = [...<span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>(arr)];<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(uniqueArr); <span class="hljs-comment">// [1, 2, 3, 4, 5]</span><br></code></pre></td></tr></table></figure><h4 id="数组转换"><a href="#数组转换" class="headerlink" title="数组转换"></a>数组转换</h4><p>可以使用 Set 将数组转换为不包含重复元素的 Set 对象，再使用 Array.from() 将其转换回数组。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> arr = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];<br><span class="hljs-keyword">const</span> set = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>(arr);<br><span class="hljs-keyword">const</span> uniqueArr = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(set);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(uniqueArr); <span class="hljs-comment">// [1, 2, 3, 4, 5]</span><br></code></pre></td></tr></table></figure><h4 id="优化数据查找"><a href="#优化数据查找" class="headerlink" title="优化数据查找"></a>优化数据查找</h4><p>使用 Set 存储数据时，查找操作的时间复杂度为 O(1)，比数组的 O(n) 要快得多，因此可以使用 Set 来优化数据查找的效率。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> dataSet = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]);<br><br><span class="hljs-keyword">if</span> (dataSet.<span class="hljs-title function_">has</span>(<span class="hljs-number">3</span>)) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;数据已经存在&#x27;</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;数据不存在&#x27;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="并集、交集、差集"><a href="#并集、交集、差集" class="headerlink" title="并集、交集、差集"></a>并集、交集、差集</h4><p>Set数据结构可以用于计算两个集合的并集、交集和差集。以下是一些使用Set进行集合运算的示例代码：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> setA = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]);<br><span class="hljs-keyword">const</span> setB = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]);<br><br><span class="hljs-comment">// 并集</span><br><span class="hljs-keyword">const</span> union = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([...setA, ...setB]);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(union); <span class="hljs-comment">// Set &#123;1, 2, 3, 4&#125;</span><br><br><span class="hljs-comment">// 交集</span><br><span class="hljs-keyword">const</span> intersection = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([...setA].<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> setB.<span class="hljs-title function_">has</span>(x)));<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(intersection); <span class="hljs-comment">// Set &#123;2, 3&#125;</span><br><br><span class="hljs-comment">// 差集</span><br><span class="hljs-keyword">const</span> difference = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([...setA].<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> !setB.<span class="hljs-title function_">has</span>(x)));<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(difference); <span class="hljs-comment">// Set &#123;1&#125;</span><br></code></pre></td></tr></table></figure><h4 id="模糊搜索"><a href="#模糊搜索" class="headerlink" title="模糊搜索"></a>模糊搜索</h4><p>Set 还可以通过正则表达式实现模糊搜索。可以将匹配结果保存到 Set 中，然后使用 Array.from() 方法将 Set 转换成数组。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> data = [<span class="hljs-string">&#x27;apple&#x27;</span>, <span class="hljs-string">&#x27;banana&#x27;</span>, <span class="hljs-string">&#x27;pear&#x27;</span>, <span class="hljs-string">&#x27;orange&#x27;</span>];<br><br><span class="hljs-comment">// 搜索以 &quot;a&quot; 开头的水果</span><br><span class="hljs-keyword">const</span> result = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>(data.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> <span class="hljs-regexp">/^a/i</span>.<span class="hljs-title function_">test</span>(item))));<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result); <span class="hljs-comment">// [&quot;apple&quot;]</span><br></code></pre></td></tr></table></figure><h4 id="使用-Set-替代数组实现队列和栈"><a href="#使用-Set-替代数组实现队列和栈" class="headerlink" title="使用 Set 替代数组实现队列和栈"></a>使用 Set 替代数组实现队列和栈</h4><p>可以使用 Set 来模拟队列和栈的数据结构。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 使用 Set 实现队列</span><br><span class="hljs-keyword">const</span> queue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>();<br>queue.<span class="hljs-title function_">add</span>(<span class="hljs-number">1</span>);<br>queue.<span class="hljs-title function_">add</span>(<span class="hljs-number">2</span>);<br>queue.<span class="hljs-title function_">add</span>(<span class="hljs-number">3</span>);<br>queue.<span class="hljs-title function_">delete</span>(queue.<span class="hljs-title function_">values</span>().<span class="hljs-title function_">next</span>().<span class="hljs-property">value</span>); <span class="hljs-comment">// 删除第一个元素</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(queue); <span class="hljs-comment">// Set(2) &#123; 2, 3 &#125;</span><br><br><span class="hljs-comment">// 使用 Set 实现栈</span><br><span class="hljs-keyword">const</span> stack = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>();<br>stack.<span class="hljs-title function_">add</span>(<span class="hljs-number">1</span>);<br>stack.<span class="hljs-title function_">add</span>(<span class="hljs-number">2</span>);<br>stack.<span class="hljs-title function_">add</span>(<span class="hljs-number">3</span>);<br>stack.<span class="hljs-title function_">delete</span>([...stack][stack.<span class="hljs-property">size</span> - <span class="hljs-number">1</span>]); <span class="hljs-comment">// 删除最后一个元素</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(stack); <span class="hljs-comment">// Set(2) &#123; 1, 2 &#125;</span><br></code></pre></td></tr></table></figure><h3 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h3><h4 id="将-Map-转换为对象"><a href="#将-Map-转换为对象" class="headerlink" title="将 Map 转换为对象"></a>将 Map 转换为对象</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>().<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;key1&#x27;</span>, <span class="hljs-string">&#x27;value1&#x27;</span>).<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;key2&#x27;</span>, <span class="hljs-string">&#x27;value2&#x27;</span>);<br><span class="hljs-keyword">const</span> obj = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">fromEntries</span>(map);<br></code></pre></td></tr></table></figure><h4 id="将-Map-转换为数组"><a href="#将-Map-转换为数组" class="headerlink" title="将 Map 转换为数组"></a>将 Map 转换为数组</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>().<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;key1&#x27;</span>, <span class="hljs-string">&#x27;value1&#x27;</span>).<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;key2&#x27;</span>, <span class="hljs-string">&#x27;value2&#x27;</span>);<br><span class="hljs-keyword">const</span> array = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(map);<br></code></pre></td></tr></table></figure><h4 id="记录数据的顺序"><a href="#记录数据的顺序" class="headerlink" title="记录数据的顺序"></a>记录数据的顺序</h4><p>如果你需要记录添加元素的顺序，那么可以使用<code>Map</code>来解决这个问题。当你需要按照添加顺序迭代元素时，可以使用<code>Map</code>来保持元素的顺序。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();<br>map.<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-number">1</span>);<br>map.<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-number">2</span>);<br>map.<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-number">3</span>);<br>map.<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;d&#x27;</span>, <span class="hljs-number">4</span>);<br><br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [key, value] <span class="hljs-keyword">of</span> map) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(key, value);<br>&#125;<br><span class="hljs-comment">// Output: a 1, b 2, c 3, d 4</span><br></code></pre></td></tr></table></figure><h4 id="统计数组中元素出现次数"><a href="#统计数组中元素出现次数" class="headerlink" title="统计数组中元素出现次数"></a>统计数组中元素出现次数</h4><p>可以使用 Map 统计数组中每个元素出现的次数。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> arr = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];<br><br><span class="hljs-keyword">const</span> countMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();<br>arr.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> &#123;<br>  countMap.<span class="hljs-title function_">set</span>(item, (countMap.<span class="hljs-title function_">get</span>(item) || <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>);<br>&#125;);<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(countMap.<span class="hljs-title function_">get</span>(<span class="hljs-number">1</span>)); <span class="hljs-comment">// 2</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(countMap.<span class="hljs-title function_">get</span>(<span class="hljs-number">2</span>)); <span class="hljs-comment">// 2</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(countMap.<span class="hljs-title function_">get</span>(<span class="hljs-number">3</span>)); <span class="hljs-comment">// 1</span><br></code></pre></td></tr></table></figure><h4 id="统计字符出现次数"><a href="#统计字符出现次数" class="headerlink" title="统计字符出现次数"></a>统计字符出现次数</h4><p>使用Map数据结构可以方便地统计字符串中每个字符出现的次数。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> str = <span class="hljs-string">&#x27;hello world&#x27;</span>;<br><span class="hljs-keyword">const</span> charCountMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> char <span class="hljs-keyword">of</span> str) &#123;<br>  charCountMap.<span class="hljs-title function_">set</span>(char, (charCountMap.<span class="hljs-title function_">get</span>(char) || <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>);<br>&#125;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(charCountMap); <span class="hljs-comment">// Map &#123; &#x27;h&#x27; =&gt; 1, &#x27;e&#x27; =&gt; 1, &#x27;l&#x27; =&gt; 3, &#x27;o&#x27; =&gt; 2, &#x27; &#x27; =&gt; 1, &#x27;w&#x27; =&gt; 1, &#x27;r&#x27; =&gt; 1, &#x27;d&#x27; =&gt; 1 &#125;</span><br></code></pre></td></tr></table></figure><h4 id="缓存计算结果"><a href="#缓存计算结果" class="headerlink" title="缓存计算结果"></a>缓存计算结果</h4><p>在处理复杂的计算时，可能需要对中间结果进行缓存以提高性能。可以使用Map数据结构缓存计算结果，以避免重复计算。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> cache = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">fibonacci</span>(<span class="hljs-params">n</span>) &#123;<br>  <span class="hljs-keyword">if</span> (n === <span class="hljs-number">0</span> || n === <span class="hljs-number">1</span>) &#123;<br>    <span class="hljs-keyword">return</span> n;<br>  &#125;<br>  <span class="hljs-keyword">if</span> (cache.<span class="hljs-title function_">has</span>(n)) &#123;<br>    <span class="hljs-keyword">return</span> cache.<span class="hljs-title function_">get</span>(n);<br>  &#125;<br>  <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">fibonacci</span>(n - <span class="hljs-number">1</span>) + <span class="hljs-title function_">fibonacci</span>(n - <span class="hljs-number">2</span>);<br>  cache.<span class="hljs-title function_">set</span>(n, result);<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">fibonacci</span>(<span class="hljs-number">10</span>)); <span class="hljs-comment">// 55</span><br></code></pre></td></tr></table></figure><h4 id="使用-Map-进行数据的分组"><a href="#使用-Map-进行数据的分组" class="headerlink" title="使用 Map 进行数据的分组"></a>使用 Map 进行数据的分组</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> students = [<br>  &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Tom&quot;</span>, <span class="hljs-attr">grade</span>: <span class="hljs-string">&quot;A&quot;</span> &#125;,<br>  &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Jerry&quot;</span>, <span class="hljs-attr">grade</span>: <span class="hljs-string">&quot;B&quot;</span> &#125;,<br>  &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Kate&quot;</span>, <span class="hljs-attr">grade</span>: <span class="hljs-string">&quot;A&quot;</span> &#125;,<br>  &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Mike&quot;</span>, <span class="hljs-attr">grade</span>: <span class="hljs-string">&quot;C&quot;</span> &#125;,<br>];<br><br><span class="hljs-keyword">const</span> gradeMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();<br>students.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">student</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> grade = student.<span class="hljs-property">grade</span>;<br>  <span class="hljs-keyword">if</span> (!gradeMap.<span class="hljs-title function_">has</span>(grade)) &#123;<br>    gradeMap.<span class="hljs-title function_">set</span>(grade, [student]);<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    gradeMap.<span class="hljs-title function_">get</span>(grade).<span class="hljs-title function_">push</span>(student);<br>  &#125;<br>&#125;);<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(gradeMap.<span class="hljs-title function_">get</span>(<span class="hljs-string">&quot;A&quot;</span>)); <span class="hljs-comment">// [&#123; name: &quot;Tom&quot;, grade: &quot;A&quot; &#125;, &#123; name: &quot;Kate&quot;, grade: &quot;A&quot; &#125;]</span><br></code></pre></td></tr></table></figure><h4 id="使用-Map-过滤符合条件的对象"><a href="#使用-Map-过滤符合条件的对象" class="headerlink" title="使用 Map 过滤符合条件的对象"></a>使用 Map 过滤符合条件的对象</h4><p>在实际开发中，我们常常需要在一个对象数组中查找符合某些条件的对象。此时，我们可以结合使用 Map 和 filter 方法来实现。比如：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> users = [<br>  &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Alice&#x27;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">22</span> &#125;,<br>  &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Bob&#x27;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">18</span> &#125;,<br>  &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Charlie&#x27;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">25</span> &#125;<br>];<br><span class="hljs-keyword">const</span> userMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>(users.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">user</span> =&gt;</span> [user.<span class="hljs-property">name</span>, user]));<br><span class="hljs-keyword">const</span> result = users.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">user</span> =&gt;</span> userMap.<span class="hljs-title function_">has</span>(user.<span class="hljs-property">name</span>) &amp;&amp; user.<span class="hljs-property">age</span> &gt; <span class="hljs-number">20</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result); <span class="hljs-comment">// [&#123; name: &#x27;Alice&#x27;, age: 22 &#125;, &#123; name: &#x27;Charlie&#x27;, age: 25 &#125;]</span><br></code></pre></td></tr></table></figure><p>首先，我们将对象数组转换为 Map，以便快速查找。然后，我们使用 filter 方法来过滤符合条件的对象。</p><h3 id="reduce"><a href="#reduce" class="headerlink" title="reduce"></a>reduce</h3><p>reduce 函数可以根据需要进行累加、过滤、分组、映射等操作，是一个非常强大的数组方法。在数据处理时使用的非常频繁，很多复杂的逻辑如果用reduce去处理，都非常的简洁，在实际的开发工作过程中，积累了一些常见又超级好用的 reduce 技巧的代码片段，筛选了如下 10 个，以供大家参考</p><h4 id="reduce-介绍"><a href="#reduce-介绍" class="headerlink" title="reduce 介绍"></a>reduce 介绍</h4><p><code>reduce</code> 是数组的方法，可以对数组中的每个元素依次执行一个回调函数，从左到右依次累积计算出一个最终的值。其语法为：</p><blockquote><p>arr.reduce(callback(accumulator, currentValue[, index[, array]])[, initialValue])</p></blockquote><p>其中，<code>callback</code> 是每个元素执行的回调函数，其包含 4 个参数：</p><ul><li><code>accumulator</code>：累积器，即上一次回调函数执行的返回值。</li><li><code>currentValue</code>：当前元素的值。</li><li><code>index</code>：当前元素的下标。</li><li><code>array</code>：原始数组。</li></ul><p><code>initialValue</code> 是可选的，表示累积器的初始值。</p><p><code>reduce</code> 函数的执行过程如下：</p><ol><li>如果没有提供 <code>initialValue</code>，则将数组的第一个元素作为累积器的初始值，否则将 <code>initialValue</code> 作为累积器的初始值。</li><li>从数组的第二个元素开始，依次对数组中的每个元素执行回调函数。</li><li>回调函数的返回值作为下一次回调函数执行时的累积器的值。</li><li>对数组中的每个元素执行完回调函数后，<code>reduce</code> 函数返回最后一次回调函数的返回值，即最终的累积值。</li></ol><h4 id="计算数组中每个元素出现的次数"><a href="#计算数组中每个元素出现的次数" class="headerlink" title="计算数组中每个元素出现的次数"></a>计算数组中每个元素出现的次数</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> fruits = [<span class="hljs-string">&#x27;apple&#x27;</span>, <span class="hljs-string">&#x27;banana&#x27;</span>, <span class="hljs-string">&#x27;apple&#x27;</span>, <span class="hljs-string">&#x27;orange&#x27;</span>, <span class="hljs-string">&#x27;banana&#x27;</span>, <span class="hljs-string">&#x27;apple&#x27;</span>];<br><span class="hljs-keyword">const</span> count = fruits.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">accumulator, currentValue</span>) =&gt;</span> &#123;<br>  accumulator[currentValue] = (accumulator[currentValue] || <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>;<br>  <span class="hljs-keyword">return</span> accumulator;<br>&#125;, &#123;&#125;);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(count); <span class="hljs-comment">// Output: &#123; apple: 3, banana: 2, orange: 1 &#125;</span><br></code></pre></td></tr></table></figure><h4 id="拍平嵌套数组"><a href="#拍平嵌套数组" class="headerlink" title="拍平嵌套数组"></a>拍平嵌套数组</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> nestedArray = [[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>], [<span class="hljs-number">5</span>, <span class="hljs-number">6</span>]];<br><span class="hljs-keyword">const</span> flattenedArray = nestedArray.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">accumulator, currentValue</span>) =&gt;</span> accumulator.<span class="hljs-title function_">concat</span>(currentValue), []);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(flattenedArray); <span class="hljs-comment">// Output: [1, 2, 3, 4, 5, 6]</span><br></code></pre></td></tr></table></figure><h4 id="按条件分组"><a href="#按条件分组" class="headerlink" title="按条件分组"></a>按条件分组</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> people = [<br>  &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Alice&#x27;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">25</span> &#125;,<br>  &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Bob&#x27;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> &#125;,<br>  &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Charlie&#x27;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">35</span> &#125;,<br>  &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;David&#x27;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">25</span> &#125;,<br>  &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Emily&#x27;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> &#125;<br>];<br><span class="hljs-keyword">const</span> groupedPeople = people.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">accumulator, currentValue</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> key = currentValue.<span class="hljs-property">age</span>;<br>  <span class="hljs-keyword">if</span> (!accumulator[key]) &#123;<br>    accumulator[key] = [];<br>  &#125;<br>  accumulator[key].<span class="hljs-title function_">push</span>(currentValue);<br>  <span class="hljs-keyword">return</span> accumulator;<br>&#125;, &#123;&#125;);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(groupedPeople);<br><span class="hljs-comment">// Output: &#123;</span><br><span class="hljs-comment">//   25: [&#123; name: &#x27;Alice&#x27;, age: 25 &#125;, &#123; name: &#x27;David&#x27;, age: 25 &#125;],</span><br><span class="hljs-comment">//   30: [&#123; name: &#x27;Bob&#x27;, age: 30 &#125;, &#123; name: &#x27;Emily&#x27;, age: 30 &#125;],</span><br><span class="hljs-comment">//   35: [&#123; name: &#x27;Charlie&#x27;, age: 35 &#125;]</span><br><span class="hljs-comment">// &#125;</span><br></code></pre></td></tr></table></figure><h4 id="将多个数组合并为一个对象"><a href="#将多个数组合并为一个对象" class="headerlink" title="将多个数组合并为一个对象"></a>将多个数组合并为一个对象</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> keys = [<span class="hljs-string">&#x27;name&#x27;</span>, <span class="hljs-string">&#x27;age&#x27;</span>, <span class="hljs-string">&#x27;gender&#x27;</span>];<br><span class="hljs-keyword">const</span> values = [<span class="hljs-string">&#x27;Alice&#x27;</span>, <span class="hljs-number">25</span>, <span class="hljs-string">&#x27;female&#x27;</span>];<br><span class="hljs-keyword">const</span> person = keys.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">accumulator, currentValue, index</span>) =&gt;</span> &#123;<br>    accumulator[currentValue] = values[index];<br>    <span class="hljs-keyword">return</span> accumulator;<br>  &#125;, &#123;&#125;);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person); <span class="hljs-comment">// Output: &#123; name: &#x27;Alice&#x27;, age: 25, gender: &#x27;female&#x27; &#125;</span><br></code></pre></td></tr></table></figure><h4 id="将字符串转换为对象"><a href="#将字符串转换为对象" class="headerlink" title="将字符串转换为对象"></a>将字符串转换为对象</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> str = <span class="hljs-string">&#x27;key1=value1&amp;key2=value2&amp;key3=value3&#x27;</span>;<br><span class="hljs-keyword">const</span> obj = str.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;&amp;&#x27;</span>).<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">accumulator, currentValue</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> [key, value] = currentValue.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;=&#x27;</span>);<br>  accumulator[key] = value;<br>  <span class="hljs-keyword">return</span> accumulator;<br>&#125;, &#123;&#125;);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj); <br><span class="hljs-comment">// Output: &#123; key1: &#x27;value1&#x27;, key2: &#x27;value2&#x27;, key3: &#x27;value3&#x27; &#125;</span><br></code></pre></td></tr></table></figure><h4 id="将对象转换为查询字符串"><a href="#将对象转换为查询字符串" class="headerlink" title="将对象转换为查询字符串"></a>将对象转换为查询字符串</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> params = &#123; <span class="hljs-attr">foo</span>: <span class="hljs-string">&quot;bar&quot;</span>, <span class="hljs-attr">baz</span>: <span class="hljs-number">42</span> &#125;;<br><span class="hljs-keyword">const</span> queryString = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(params).<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">acc, [key, value]</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">$&#123;acc&#125;</span><span class="hljs-subst">$&#123;key&#125;</span>=<span class="hljs-subst">$&#123;value&#125;</span>&amp;`</span>;<br>&#125;, <span class="hljs-string">&quot;?&quot;</span>).<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, -<span class="hljs-number">1</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(queryString); <span class="hljs-comment">// &quot;?foo=bar&amp;baz=42&quot;</span><br></code></pre></td></tr></table></figure><h4 id="打印斐波那契数列"><a href="#打印斐波那契数列" class="headerlink" title="打印斐波那契数列"></a>打印斐波那契数列</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">fibonacci</span> = n =&gt; &#123;<br>  <span class="hljs-keyword">return</span> [...<span class="hljs-title class_">Array</span>(n)].<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">accumulator, currentValue, index</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">if</span> (index &lt; <span class="hljs-number">2</span>) &#123;<br>      accumulator.<span class="hljs-title function_">push</span>(index);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      accumulator.<span class="hljs-title function_">push</span>(accumulator[index - <span class="hljs-number">1</span>] + accumulator[index - <span class="hljs-number">2</span>]);<br>    &#125;<br>    <span class="hljs-keyword">return</span> accumulator;<br>  &#125;, []);<br>&#125;;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">fibonacci</span>(<span class="hljs-number">10</span>)); <span class="hljs-comment">// Output: [0, 1, 1, 2, 3, 5, 8, 13, 21, 34]</span><br></code></pre></td></tr></table></figure><h4 id="检查字符串是否是回文字符串"><a href="#检查字符串是否是回文字符串" class="headerlink" title="检查字符串是否是回文字符串"></a>检查字符串是否是回文字符串</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> str = <span class="hljs-string">&#x27;racecar&#x27;</span>;<br><span class="hljs-keyword">const</span> isPalindrome = str.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;&#x27;</span>).<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">accumulator, currentValue, index, array</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">return</span> accumulator &amp;&amp; currentValue === array[array.<span class="hljs-property">length</span> - index - <span class="hljs-number">1</span>];<br>&#125;, <span class="hljs-literal">true</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(isPalindrome); <span class="hljs-comment">// Output: true</span><br></code></pre></td></tr></table></figure><h4 id="检查括号是否匹配"><a href="#检查括号是否匹配" class="headerlink" title="检查括号是否匹配"></a>检查括号是否匹配</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> str = <span class="hljs-string">&quot;(()()())&quot;</span>;<br><span class="hljs-keyword">const</span> balanced = str.<span class="hljs-title function_">split</span>(<span class="hljs-string">&quot;&quot;</span>).<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">acc, cur</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">if</span> (cur === <span class="hljs-string">&quot;(&quot;</span>) &#123;<br>    acc++;<br>  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (cur === <span class="hljs-string">&quot;)&quot;</span>) &#123;<br>    acc--;<br>  &#125;<br>  <span class="hljs-keyword">return</span> acc;<br>&#125;, <span class="hljs-number">0</span>) === <span class="hljs-number">0</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(balanced); <span class="hljs-comment">// true</span><br></code></pre></td></tr></table></figure><h4 id="递归获取对象属性"><a href="#递归获取对象属性" class="headerlink" title="递归获取对象属性"></a>递归获取对象属性</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> user = &#123;<br>  <span class="hljs-attr">info</span>: &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Jason&quot;</span>,<br>    <span class="hljs-attr">address</span>: &#123; <span class="hljs-attr">home</span>: <span class="hljs-string">&quot;Shaanxi&quot;</span>, <span class="hljs-attr">company</span>: <span class="hljs-string">&quot;Xian&quot;</span> &#125;,<br>  &#125;,<br>&#125;;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">get</span>(<span class="hljs-params">config, path, defaultVal</span>) &#123;<br>  <span class="hljs-keyword">return</span> path.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;.&#x27;</span>).<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">config, name</span>) =&gt;</span> config[name], config) || defaultVal;<br>&#125;<br><span class="hljs-title function_">get</span>(user, <span class="hljs-string">&quot;info.name&quot;</span>); <span class="hljs-comment">// Jason</span><br><span class="hljs-title function_">get</span>(user, <span class="hljs-string">&quot;info.address.home&quot;</span>); <span class="hljs-comment">// Shaanxi</span><br><span class="hljs-title function_">get</span>(user, <span class="hljs-string">&quot;info.address.company&quot;</span>); <span class="hljs-comment">// Xian</span><br><span class="hljs-title function_">get</span>(user, <span class="hljs-string">&quot;info.address.abc&quot;</span>, <span class="hljs-string">&quot;default&quot;</span>); <span class="hljs-comment">// default</span><br></code></pre></td></tr></table></figure><h4 id="手写-reduce"><a href="#手写-reduce" class="headerlink" title="手写 reduce"></a>手写 reduce</h4><p>可以通过手写一个简单的 <code>reduce</code> 函数来更好地理解它的实现原理：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">myReduce</span>(<span class="hljs-params">arr, callback, initialValue</span>) &#123;<br>  <span class="hljs-keyword">let</span> accumulator = initialValue === <span class="hljs-literal">undefined</span> ? arr[<span class="hljs-number">0</span>] : initialValue;<br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = initialValue === <span class="hljs-literal">undefined</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>; i &lt; arr.<span class="hljs-property">length</span>; i++) &#123;<br>    accumulator = <span class="hljs-title function_">callback</span>(accumulator, arr[i], i, arr);<br>  &#125;<br>  <span class="hljs-keyword">return</span> accumulator;<br>&#125;<br></code></pre></td></tr></table></figure><p>上面的代码中，<code>myReduce</code> 函数接受 3 个参数：要执行 <code>reduce</code> 操作的数组 <code>arr</code>、回调函数 <code>callback</code> 和累积器的初始值 <code>initialValue</code>。如果没有提供初始值，则将数组的第一个元素作为累积器的初始值。</p><p>接下来，在循环中，如果有 initialValue，则从第一个元素开始遍历 callback，此时 callabck 的第二个参数是从数组的第一项开始的；如果没有 initialValue，则从第二个元素开始遍历 callback，此时 callback 的第二个参数是从数组的第二项开始的从数组的第二个元素开始，依次对数组中的每个元素执行回调函数，并将返回值作为下一次回调函数执行时的累积器的值。</p><p>最后，<code>myReduce</code> 函数返回最后一次回调函数的返回值，即最终的累积值。</p><p>这个简易的 <code>reduce</code> 函数并没有考虑很多边界情况和复杂的应用场景，但是可以帮助我们更好地理解 <code>reduce</code> 函数的实现原理。</p><h1 id="事件循环"><a href="#事件循环" class="headerlink" title="事件循环"></a>事件循环</h1><blockquote><p>叫法不同：</p><p>w3c    event loop</p><p>谷歌浏览器    message loop</p><p>promise本身是一个同步的代码，只有它后面调用的then()方法里的回调才是微任务</p><p>await右边的表达式还是会</p><p>script标签本身是一个宏任务，当页面出现多个script标签的时候，浏览器会把script标签作为宏任务来解析</p></blockquote><ul><li><strong>单线程是异步产生的原因</strong></li><li><strong>事件循环是异步的实现方式</strong></li></ul><h2 id="浏览器的进程模型"><a href="#浏览器的进程模型" class="headerlink" title="浏览器的进程模型"></a>浏览器的进程模型</h2><h3 id="何为进程"><a href="#何为进程" class="headerlink" title="何为进程"></a>何为进程</h3><ul><li>程序运行需要有他自己专属的内存空间，可以把这块内存空间简单的理解为进程</li><li>每个应用至少有一个进程，进程之间相互独立，即使要通信，也需要双方同意</li><li>不会相互影响，如一个进程崩溃，不会导致其他进程崩溃</li></ul><h3 id="何为线程"><a href="#何为线程" class="headerlink" title="何为线程"></a>何为线程</h3><p>有了进程，就可以运行程序的代码了</p><p>一个进程至少有一个线程，所以在进程开启后会自动创建一个线程来运行代码，该线程称之为主线程</p><p>如果程序需要同时执行多块代码，主线程就会启动更多的线程来执行代码，所以一个进程可以包含多个线程</p><h3 id="浏览器有哪些进程和线程"><a href="#浏览器有哪些进程和线程" class="headerlink" title="浏览器有哪些进程和线程"></a>浏览器有哪些进程和线程</h3><p><strong>浏览器是一个多进程多线程的应用程序</strong></p><ul><li>为了避免相互影响，为了减少连环崩溃的几率，当浏览器启动后，它会自动启动多个进程</li></ul><p><img src="https://ap3pibqbmd.feishu.cn/space/api/box/stream/download/asynccode/?code=YjcwMjliMzE2YzlmYTU2OWNkNWFhZmZkYzRiNzM0NmRfMW52SDBuQlNQcXl6UENFUXdBYTlLMVlOQ0praFFtRzBfVG9rZW46Ym94Y25keG9FWm1seVBDRVp4UG9abFpNdThSXzE3MDcyMDE2NzU6MTcwNzIwNTI3NV9WNA" alt="img"></p><blockquote><p>可以在浏览器的任务管理器中查看当前的所有进程</p></blockquote><p>其中，最主要的进程有：</p><ul><li><p>浏览器进程</p><ul><li>主要负责界面显示、用户交互、子进程管理等，浏览器进程内部会启动多个线程处理不同的任务</li></ul></li><li><p>网络进程</p><ul><li>负责加载网络资源，网络进程内部会启动多个线程来处理不同的网络任务</li></ul></li><li><p>渲染进程（重点）</p><ul><li><p>渲染进程启动后，会开启一个<strong>渲染主线程</strong>，主线程复制执行HTML、CSS、JS代码</p></li><li><p>默认情况下，浏览器会为每个标签页开启一个新的渲染进程，以保证不同的标签页之间不相互影响</p></li><li><blockquote><p>这样每一个标签页就开启一个渲染进程，这就会导致当我们打开多个标签页时，谷歌浏览器就会非常占内存</p><p>改变：一个站点一个渲染进程，也就是说打开淘宝分配一个渲染进程，但我们又打开一个新的标签页，是淘宝的商品详情，那么它们共同使用一个渲染进程</p></blockquote></li></ul></li></ul><h2 id="渲染主线程是如何工作的"><a href="#渲染主线程是如何工作的" class="headerlink" title="渲染主线程是如何工作的"></a>渲染主线程是如何工作的</h2><p>渲染主线程是浏览器中最繁忙的线程，需要它处理的任务包括但不限于：</p><ul><li>解析HTML</li><li>解析CSS</li><li>计算样式</li><li>布局</li><li>处理图层</li><li>每秒把页面画60次</li><li>执行全局JS代码</li><li>执行事件处理函数</li><li>执行计时器的回调函数</li><li>………….</li></ul><p>要处理这么多的任务，主线程遇到了一个难题，如果调度任务？</p><ul><li>正在执行一个JS函数，执行到一半的时候用户点击了按钮，该立即执行点击事件的处理函数</li></ul><p><strong>渲染主线程处理调度任务：排队</strong></p><ul><li>dnag</li></ul><p><img src="https://ap3pibqbmd.feishu.cn/space/api/box/stream/download/asynccode/?code=NGU4OGU1M2E4ZGNhNGRhZWQxNTcyNjI0YzU0YzllOTBfNkhaY1dKNGliSjhGS0QybkVVeXVjQUlBR2xhaVF1NWlfVG9rZW46Ym94Y25OQ1BwRGFvc08ybXNqVkg1U1hXOHZmXzE3MDcyMDE2NzU6MTcwNzIwNTI3NV9WNA" alt="img"></p><ol><li>在最开始的时候，渲染主线程会进入一个无限循环（for（; ;））</li><li>每一次循环会检查消息队列中是否有任务存在，如果有，就取出第一个任务执行，执行完一个后进入下一次循环，如果没有，则进入休眠状态</li><li>其他所有线程（包括其他进行的线程）可以随时向消息队列添加任务，新任务会加到消息队列的末尾，在添加新任务时，如果主线程时休眠状态，则会将其唤醒以继续循环拿取任务</li></ol><p><strong>整个过程，被称之为事件循环（消息循环）</strong></p><h2 id="若干解释"><a href="#若干解释" class="headerlink" title="若干解释"></a>若干解释</h2><h3 id="何为异步"><a href="#何为异步" class="headerlink" title="何为异步"></a>何为异步</h3><p>在代码执行过程中，回到一些无法立即处理的任务，比如：</p><ul><li>计时完后需要执行的任务 —- <code>setTimeout</code>、<code>setInterval</code></li><li>网络通信后需要执行的任务 —- <code>XHR</code>、<code>Fetch</code></li><li>用户操作后需要执行的任务 —- <code>addEventListener</code></li></ul><p>如果让渲染主线程等待这些任务的时机到达，就会导致主线程长期处于【阻塞】的状态，从而导致浏览器【卡死】</p><p><img src="https://ap3pibqbmd.feishu.cn/space/api/box/stream/download/asynccode/?code=ZWNhZjQ4Zjc5MmZmZDk2Yjg3MmUxMmY0MDI1MTZjNjlfTFZ1Tm8zY3k0TWpJaEZlWVY3U3d6ZFV6UWg1dWN4Sm9fVG9rZW46Ym94Y25mTklHTHp6NTZlZ1VJTGFLbUFaUVZiXzE3MDcyMDE2NzU6MTcwNzIwNTI3NV9WNA" alt="img"></p><p><strong>渲染主线程承担着极其重要的工作，无论如何都不能阻塞</strong></p><p>因此，浏览器选择<strong>异步</strong>来解决这个问题</p><p><img src="https://ap3pibqbmd.feishu.cn/space/api/box/stream/download/asynccode/?code=NTQ4YmFkM2YyNzM0NDk5YTA1YjVmZDAyY2NhODljNDhfNlE3SnYzYWtCd1pEYVBmc3BZeExjbENNcXNUTnpXMmxfVG9rZW46Ym94Y25PODdaM2VmenBpWlRnd3BIM3RkUkdjXzE3MDcyMDE2NzU6MTcwNzIwNTI3NV9WNA" alt="img"></p><p> 使用异步的方式，渲染主线程永不阻塞</p><blockquote><p>面试题：如何理解JS的异步？</p><p>答：</p><p>JS是一门单线程的语言，这是因为它运行在浏览器的渲染主线程中，而渲染主线程只有一个</p><p>而选择主线程承担诸多的工作，渲染页面、执行HTML、CSS、JS都在其中运行</p><p>如果使用同步的方式，就极有可能导致主线程产生阻塞，从而导致消息队列中的很多其他任务无法得到执行</p><p>这样一来，一方面会导致繁忙的主线程浪费时间，另一方面导致页面无法及时更新，页面卡死</p><p>所以浏览器采用异步的方式来避免这个问题。具体做法是当某些任务发送时，比如计数器、网络、事件监听等，主线程会将任务交给其他线程去处理，自身立即结束任务的执行，从而执行后续代码。当其他线程完成时，将事先传递的回调函数包装成任务，加入到消息队列的末尾排队，等待主线程调度执行</p><p>在这种异步模式下，浏览器用不阻塞，从而最大限度的保证了单线程的流畅运行</p></blockquote><h3 id="JS为何会阻碍渲染"><a href="#JS为何会阻碍渲染" class="headerlink" title="JS为何会阻碍渲染"></a>JS为何会阻碍渲染</h3><p>JS代码执行和渲染都在一个线程上</p><p>如执行一个函数，先点击按钮改变文本，后死循环三秒，当我们看到的是等待三秒后，文本才改变。是因为当我们点击按钮改变文本时，会触发渲染任务，但渲染主线程为单线程，JS代码还未执行完，因此执行完JS代码后，也就是点击改变文本，死循环三秒之后，渲染主线程才开始执行渲染任务，这时页面上才会显示改变后的文本</p><h3 id="任务有优先级吗"><a href="#任务有优先级吗" class="headerlink" title="任务有优先级吗"></a>任务有优先级吗</h3><p>任务没有优先级，在消息队列中先进先出</p><p><strong>但消息队列有优先级</strong></p><p>W3C的最新解释：</p><ul><li>每个任务都一个任务类型，同一个类型的任务必须在一个队列，不同类型的任务可以分属于不同的队列。每一次事件循环中，浏览器可以根据实际情况从不同的队列中取出任务执行</li><li>浏览器必须准备好一个微队列，微队列中的任务有限所有其他任务执行</li></ul><blockquote><p>随着浏览器的复杂度急剧提升，W3C不再使用宏队列的说法</p></blockquote><p>在目前的chrome的实现中，至少包含了下面的队列：</p><ul><li>延时队列：用于存放计时器到达后的回调任务，优先级【中】</li><li>交互队列：用于存放用户操作后产生的事件处理任务，优先级【高】</li><li>微队列：用户存放需要最快的任务，优先级【最高】</li></ul><blockquote><p>面试题：阐述一下JS的事件循环</p><p>答：</p><p>事件循环又叫做消息循环，时浏览器渲染主线程的工作方式</p><p>在Chrome的源码中，它开启一个不会结束的for循环，每次循环从消息队列中取出第一个任务执行，而其他线程只需要在合适的时候加入队列末尾即可</p><p>过去把消息队列简单分为宏队列和微队列，这种说法目前已经无法满足复杂的浏览器环境，取而代之的是一种灵活多变的处理方式</p><p>根据W3C官方的解释，每个任务又不同的类型，同类型的任务必须在同一个队列，不同的任务可以属于不同的队列。不同任务队列有不同的优先级，在一次事件循环中，由浏览器自行决定取哪一个队列的任务。但浏览器必须有一个微队列，微队列的任务一定具有最高的优先级，必须优先调度执行</p></blockquote><blockquote><p>面试题：JS中的计时器能做到精确计时吗?为什么？</p><p>答：</p><p>不行，因为：</p><ul><li>计算机硬件没有原子钟，无法做到精确计时</li><li>操作系统的计时函数本身就有少量偏差，由于JS的计时器最终调用的是操作系统的函数，也就携带了这些偏差</li><li>按照W3C的标准，浏览器实现计时器时，如果嵌套层级超过5层，则会带有4毫秒的最少时间，这样在计时时间少于4毫秒时又带来偏差</li><li>受事件循环的影响，计时器的回调函数只能在主线程空闲时运行，因此又带来偏差</li></ul></blockquote><h1 id="类型转换"><a href="#类型转换" class="headerlink" title="类型转换"></a>类型转换</h1><h2 id="隐式类型转换"><a href="#隐式类型转换" class="headerlink" title="隐式类型转换"></a>隐式类型转换</h2><p>在JavaScript中，隐式类型转换是指在特定的上下文中，JavaScript自动将一个数据类型转换为另一个数据类型，而无需显式地编写转换代码。</p><h3 id="1-数字转字符串："><a href="#1-数字转字符串：" class="headerlink" title="1. 数字转字符串："></a>1. 数字转字符串：</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> num = <span class="hljs-number">10</span>;<br><span class="hljs-keyword">let</span> str = num + <span class="hljs-string">&#x27;&#x27;</span>; <span class="hljs-comment">// 将数字转换为字符串</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str); <span class="hljs-comment">// 输出: &quot;10&quot;</span><br></code></pre></td></tr></table></figure><p>在这个例子中，通过将数字与一个空字符串相加，JavaScript会将数字隐式转换为字符串。</p><h3 id="2-字符串转数字："><a href="#2-字符串转数字：" class="headerlink" title="2. 字符串转数字："></a>2. 字符串转数字：</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> str = <span class="hljs-string">&#x27;20&#x27;</span>;<br><span class="hljs-keyword">let</span> num = +str; <span class="hljs-comment">// 将字符串转换为数字</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num); <span class="hljs-comment">// 输出: 20</span><br></code></pre></td></tr></table></figure><p>在这个例子中，通过使用一元加号操作符（+）对字符串进行操作，JavaScript会将字符串隐式转换为数字。</p><h3 id="3-布尔值转数字："><a href="#3-布尔值转数字：" class="headerlink" title="3. 布尔值转数字："></a>3. 布尔值转数字：</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> bool = <span class="hljs-literal">true</span>;<br><span class="hljs-keyword">let</span> num = +bool; <span class="hljs-comment">// 将布尔值转换为数字</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num); <span class="hljs-comment">// 输出: 1</span><br></code></pre></td></tr></table></figure><p>在这个例子中，通过使用一元加号操作符（+）对布尔值进行操作，JavaScript会将布尔值隐式转换为数字，<code>true</code>转换为1，<code>false</code>转换为0。</p><h3 id="4-字符串转布尔值："><a href="#4-字符串转布尔值：" class="headerlink" title="4. 字符串转布尔值："></a>4. 字符串转布尔值：</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> str = <span class="hljs-string">&#x27;true&#x27;</span>;<br><span class="hljs-keyword">let</span> bool = !!str; <span class="hljs-comment">// 将字符串转换为布尔值</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(bool); <span class="hljs-comment">// 输出: true</span><br></code></pre></td></tr></table></figure><p>在这个例子中，通过使用两个逻辑非操作符（!!）对字符串进行操作，JavaScript会将字符串隐式转换为布尔值，非空字符串转换为<code>true</code>，空字符串转换为<code>false</code>。</p><p>需要注意的是，隐式类型转换在某些情况下可能会导致意外的结果。因此，在进行类型转换时，特别是涉及不同的数据类型之间的运算时，要注意确保结果符合预期。</p><p>理解隐式类型转换的规则和机制可以帮助我们更好地理解JavaScript代码中的行为，并在需要时正确地处理数据类型转换。</p><h3 id="5-对象的隐式转换"><a href="#5-对象的隐式转换" class="headerlink" title="5. 对象的隐式转换"></a>5. 对象的隐式转换</h3><p>在JavaScript中，对象在进行隐式类型转换时会根据一定的规则进行处理。对象的隐式类型转换通常涉及将对象转换为字符串或将对象转换为数字。</p><ol><li>对象转换为字符串：</li></ol><p>当一个对象需要被隐式转换为字符串时，JavaScript会尝试调用对象的<code>toString()</code>方法。<code>toString()</code>方法是一个内置方法，它返回表示对象的字符串形式。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> obj = &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;John&quot;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">25</span> &#125;;<br><span class="hljs-keyword">let</span> str = obj.<span class="hljs-title function_">toString</span>();<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str); <span class="hljs-comment">// 输出: &quot;[object Object]&quot;</span><br></code></pre></td></tr></table></figure><p>在上述例子中，对象<code>obj</code>会被隐式转换为字符串形式，调用了<code>toString()</code>方法并返回了<code>&quot;[object Object]&quot;</code>。</p><p>需要注意的是，<code>toString()</code>方法的默认实现返回<code>&quot;[object Object]&quot;</code>，这对于大多数对象来说并不是非常有用。因此，可以通过重写对象的<code>toString()</code>方法来自定义对象转换为字符串的行为。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> person = &#123;<br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;John&quot;</span>,<br>  <span class="hljs-attr">age</span>: <span class="hljs-number">25</span>,<br>  <span class="hljs-title function_">toString</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> + <span class="hljs-string">&quot; - &quot;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span>;<br>  &#125;<br>&#125;;<br><span class="hljs-keyword">let</span> str = person.<span class="hljs-title function_">toString</span>();<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str); <span class="hljs-comment">// 输出: &quot;John - 25&quot;</span><br></code></pre></td></tr></table></figure><p>在这个例子中，我们重写了<code>person</code>对象的<code>toString()</code>方法，使其返回自定义的字符串形式。</p><ol><li>对象转换为数字：</li></ol><p>在JavaScript中，当一个对象需要被隐式转换为数字时，会首先尝试调用对象的valueOf()方法，如果该方法返回的不是原始值（例如数字），则会接着尝试调用对象的toString()方法，将返回值转换为数字</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> obj = &#123; <span class="hljs-attr">value</span>: <span class="hljs-number">42</span> &#125;;<br><span class="hljs-keyword">let</span> num = obj.<span class="hljs-title function_">valueOf</span>();<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num); <span class="hljs-comment">// 输出: &#123; value: 42 &#125;</span><br></code></pre></td></tr></table></figure><p>需要注意的是，与日期对象的<code>valueOf()</code>方法不同，大多数对象的默认<code>valueOf()</code>方法的行为通常并不有用。因此，可以通过重写对象的<code>valueOf()</code>方法来自定义对象转换为数字的行为。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> counter = &#123;<br>  <span class="hljs-attr">value</span>: <span class="hljs-number">0</span>,<br>  <span class="hljs-title function_">valueOf</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>++;<br>  &#125;<br>&#125;;<br><span class="hljs-keyword">let</span> num = counter.<span class="hljs-title function_">valueOf</span>();<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num); <span class="hljs-comment">// 输出: 0</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(counter.<span class="hljs-property">value</span>); <span class="hljs-comment">// 输出: 1</span><br></code></pre></td></tr></table></figure><p>在这个例子中，我们重写了<code>counter</code>对象的<code>valueOf()</code>方法，使其每次调用时返回一个递增的值。</p><p>需要注意的是，对象的隐式类型转换的行为和结果可能会因对象的类型、实现方式以及具体的上下文而有所不同。在编写代码时，建议根据实际需求和预期结果来处理对象的隐式类型转换，并确保理解和掌握对象的<code>toString()</code>和<code>valueOf()</code>方法的使用。</p><h2 id="显式类型转换"><a href="#显式类型转换" class="headerlink" title="显式类型转换"></a>显式类型转换</h2><p>在JavaScript中，我们可以使用一些内置函数和操作符来进行显式类型转换，以将一个值转换为特定的数据类型。下面是一些常用的类型转换函数和操作符以及它们的用法和注意事项：</p><ol><li>String() 函数：用于将一个值转换为字符串类型。</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> num = <span class="hljs-number">10</span>;<br><span class="hljs-keyword">let</span> str = <span class="hljs-title class_">String</span>(num); <span class="hljs-comment">// 将数字转换为字符串</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str); <span class="hljs-comment">// 输出: &quot;10&quot;</span><br></code></pre></td></tr></table></figure><p>需要注意的是，使用String()函数进行转换时，对于 <code>null</code> 和 undefined 值会分别得到 “null” 和 “undefined” 字符串。</p><ol><li>Number() 函数：用于将一个值转换为数字类型。</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;20&quot;</span>;<br><span class="hljs-keyword">let</span> num = <span class="hljs-title class_">Number</span>(str); <span class="hljs-comment">// 将字符串转换为数字</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num); <span class="hljs-comment">// 输出: 20</span><br></code></pre></td></tr></table></figure><p>需要注意的是，使用Number()函数进行转换时，如果传入的字符串无法解析为有效的数字，将返回 NaN（Not a Number）。</p><ol><li>Boolean() 函数：用于将一个值转换为布尔类型。</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> num = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">let</span> bool = <span class="hljs-title class_">Boolean</span>(num); <span class="hljs-comment">// 将数字转换为布尔值</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(bool); <span class="hljs-comment">// 输出: false</span><br></code></pre></td></tr></table></figure><p>需要注意的是，使用Boolean()函数进行转换时，对于 0、-0、null、undefined、NaN 和空字符串会返回 false，其他值都会返回 true。</p><ol><li>parseInt() 和 parseFloat() 函数：用于将字符串转换为整数和浮点数类型。</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;123&quot;</span>;<br><span class="hljs-keyword">let</span> num = <span class="hljs-built_in">parseInt</span>(str); <span class="hljs-comment">// 将字符串转换为整数</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num); <span class="hljs-comment">// 输出: 123</span><br><br><span class="hljs-keyword">let</span> floatStr = <span class="hljs-string">&quot;3.14&quot;</span>;<br><span class="hljs-keyword">let</span> floatNum = <span class="hljs-built_in">parseFloat</span>(floatStr); <span class="hljs-comment">// 将字符串转换为浮点数</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(floatNum); <span class="hljs-comment">// 输出: 3.14</span><br></code></pre></td></tr></table></figure><p>需要注意的是，使用 parseInt() 和 parseFloat() 函数进行转换时，它们会尝试解析字符串的开头部分，直到遇到非数字字符为止。</p><p>除了上述函数，还有一些常用的操作符也可以进行显式类型转换：</p><ul><li>加号操作符（+）：用于将值转换为数字类型。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;20&quot;</span>;<br><span class="hljs-keyword">let</span> num = +str; <span class="hljs-comment">// 将字符串转换为数字</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num); <span class="hljs-comment">// 输出: 20</span><br></code></pre></td></tr></table></figure><ul><li>双重取反操作符（!!）：用于将值转换为布尔类型。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> num = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">let</span> bool = !!num; <span class="hljs-comment">// 将数字转换为布尔值</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(bool); <span class="hljs-comment">// 输出: false</span><br></code></pre></td></tr></table></figure><p>在进行显式类型转换时，需要注意以下几点：</p><ul><li>了解转换函数和操作符的行为和规则，以避免出现意外的结果。</li><li>特别注意在将字符串转换为数字时，确保字符串能够正确解析为有效的数字，以避免得到 NaN。</li><li>注意处理 null 和 undefined 值时的类型转换结果。</li><li>在类型转换场景中，根据具体需求选择合适的函数或操作符。</li></ul><p>通过显式类型转换，我们可以将值从一个数据类型转换为另一个数据类型，以满足具体的需求和逻辑。</p><h2 id="类型转换规则"><a href="#类型转换规则" class="headerlink" title="类型转换规则"></a>类型转换规则</h2><p>了解类型转换的规则和注意事项是非常重要的，可以帮助我们避免出现意外的结果和错误的行为。下面是一些类型转换的规则和需要注意的情况：</p><h3 id="1-类型转换的优先级：在JavaScript中，类型转换有一定的优先级。从高到低的优先级顺序是："><a href="#1-类型转换的优先级：在JavaScript中，类型转换有一定的优先级。从高到低的优先级顺序是：" class="headerlink" title="1. 类型转换的优先级：在JavaScript中，类型转换有一定的优先级。从高到低的优先级顺序是："></a>1. 类型转换的优先级：在JavaScript中，类型转换有一定的优先级。从高到低的优先级顺序是：</h3><ul><li>布尔值 -&gt; 数字 -&gt; 字符串</li></ul><p>这意味着在进行混合类型的操作时，JavaScript会首先尝试将值转换为布尔值，然后是数字，最后是字符串。</p><h3 id="2-字符串拼接优先：在涉及字符串和其他数据类型的操作中，字符串拼接的优先级最高。这意味着如果一个操作符是字符串拼接操作符（-），那么其他操作数将被隐式转换为字符串。"><a href="#2-字符串拼接优先：在涉及字符串和其他数据类型的操作中，字符串拼接的优先级最高。这意味着如果一个操作符是字符串拼接操作符（-），那么其他操作数将被隐式转换为字符串。" class="headerlink" title="2. 字符串拼接优先：在涉及字符串和其他数据类型的操作中，字符串拼接的优先级最高。这意味着如果一个操作符是字符串拼接操作符（+），那么其他操作数将被隐式转换为字符串。"></a>2. 字符串拼接优先：在涉及字符串和其他数据类型的操作中，字符串拼接的优先级最高。这意味着如果一个操作符是字符串拼接操作符（+），那么其他操作数将被隐式转换为字符串。</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> num = <span class="hljs-number">10</span>;<br><span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;The number is: &quot;</span> + num;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str); <span class="hljs-comment">// 输出: &quot;The number is: 10&quot;</span><br></code></pre></td></tr></table></figure><p>在这个例子中，数字<code>num</code>会被隐式转换为字符串，然后与其他字符串进行拼接。</p><h3 id="3-NaN（Not-a-Number）：当涉及无法进行有效数值计算的情况时，JavaScript会返回NaN。NaN是一个特殊的数字值，表示不是一个有效的数字。"><a href="#3-NaN（Not-a-Number）：当涉及无法进行有效数值计算的情况时，JavaScript会返回NaN。NaN是一个特殊的数字值，表示不是一个有效的数字。" class="headerlink" title="3. NaN（Not a Number）：当涉及无法进行有效数值计算的情况时，JavaScript会返回NaN。NaN是一个特殊的数字值，表示不是一个有效的数字。"></a>3. NaN（Not a Number）：当涉及无法进行有效数值计算的情况时，JavaScript会返回NaN。NaN是一个特殊的数字值，表示不是一个有效的数字。</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> result = <span class="hljs-number">10</span> / <span class="hljs-string">&quot;hello&quot;</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result); <span class="hljs-comment">// 输出: NaN</span><br></code></pre></td></tr></table></figure><p>在这个例子中，字符串”hello”无法被解析为有效的数字，所以计算结果为NaN。</p><h3 id="4-null和undefined的类型转换：null和undefined在进行类型转换时有一些特殊规则："><a href="#4-null和undefined的类型转换：null和undefined在进行类型转换时有一些特殊规则：" class="headerlink" title="4. null和undefined的类型转换：null和undefined在进行类型转换时有一些特殊规则："></a>4. null和undefined的类型转换：null和undefined在进行类型转换时有一些特殊规则：</h3><ul><li>null在进行数字转换时会被转换为0，而在进行字符串转换时会被转换为”null”。</li><li>undefined在进行数字转换时会被转换为NaN，而在进行字符串转换时会被转换为”undefined”。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> num = <span class="hljs-title class_">Number</span>(<span class="hljs-literal">null</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num); <span class="hljs-comment">// 输出: 0</span><br><br><span class="hljs-keyword">let</span> str = <span class="hljs-title class_">String</span>(<span class="hljs-literal">undefined</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str); <span class="hljs-comment">// 输出: &quot;undefined&quot;</span><br></code></pre></td></tr></table></figure><p>在这个例子中，null在数字转换时被转换为0，undefined在字符串转换时被转换为”undefined”。</p><h3 id="5-注意一元加号操作符（-）的行为：一元加号操作符可以用于将值转换为数字类型，但需要注意一些情况。当应用于字符串时，一元加号操作符会尝试将字符串解析为数字。"><a href="#5-注意一元加号操作符（-）的行为：一元加号操作符可以用于将值转换为数字类型，但需要注意一些情况。当应用于字符串时，一元加号操作符会尝试将字符串解析为数字。" class="headerlink" title="5. 注意一元加号操作符（+）的行为：一元加号操作符可以用于将值转换为数字类型，但需要注意一些情况。当应用于字符串时，一元加号操作符会尝试将字符串解析为数字。"></a>5. 注意一元加号操作符（+）的行为：一元加号操作符可以用于将值转换为数字类型，但需要注意一些情况。当应用于字符串时，一元加号操作符会尝试将字符串解析为数字。</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;123&quot;</span>;<br><span class="hljs-keyword">let</span> num = +str;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num); <span class="hljs-comment">// 输出: 123</span><br><br><span class="hljs-keyword">let</span> invalidStr = <span class="hljs-string">&quot;hello&quot;</span>;<br><span class="hljs-keyword">let</span> invalidNum = +invalidStr;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(invalidNum); <span class="hljs-comment">// 输出: NaN</span><br></code></pre></td></tr></table></figure><p>在这个例子中，有效的数字字符串可以成功转换为数字，而无法解析为数字的字符串会转换为NaN。</p><p>了解这些规则和注意事项可以帮助我们更好地理解类型转换的行为，并在编写代码时避免潜在的错误和意外结果。同时，在进行类型转换时，要根据具体的需求选择合适的方法和操作符，并进行适当的错误处理和边界检查。</p><h2 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h2><ol><li><p>避免意外的类型转换：隐式类型转换可能导致意外的结果和错误的行为。为了避免这种情况，可以遵循以下实践：</p><ul><li>显式地使用适当的类型转换函数或操作符，明确指定期望的转换结果。</li><li>在涉及类型转换的操作中，添加适当的错误处理机制，以防止无效的转换。</li></ul></li><li><p>类型安全的比较：在条件语句中，确保进行类型安全的比较，避免因类型转换而导致的问题。使用恰当的比较操作符（如<code>===</code>和<code>!==</code>）可以同时比较值和类型，确保比较的准确性。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> num = <span class="hljs-string">&quot;10&quot;</span>;<br><span class="hljs-keyword">if</span> (num === <span class="hljs-number">10</span>) &#123;<br>  <span class="hljs-comment">// 正确的比较方式，值和类型都匹配</span><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;The number is 10.&quot;</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;The number is not 10.&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>在这个例子中，使用<code>===</code>进行比较可以避免字符串与数字的隐式转换，确保比较的准确性。</p></li><li><p>使用适当的类型转换技巧：在某些情况下，可以使用类型转换来解决问题或优化代码逻辑。以下是一些常见的类型转换技巧：</p><ul><li>将字符串转换为数字或反之：使用<code>Number()</code>函数或一元加号操作符（+）进行转换。</li><li>将字符串转换为数组：使用<code>split()</code>函数将字符串拆分为数组。</li><li>将对象转换为字符串：使用<code>JSON.stringify()</code>函数将对象转换为字符串表示。</li><li>将数字转换为字符串并添加特定格式：使用字符串模板或字符串拼接操作符（+）。</li></ul></li><li><p>考虑性能和可读性：尽管类型转换是一种强大的工具，但过度使用或滥用可能会影响代码的性能和可读性。在进行类型转换时，要权衡利弊，并确保代码易于理解和维护。</p></li></ol><p>总之，掌握类型转换的最佳实践可以帮助我们编写更健壮和高效的代码。遵循类型安全的比较、避免意外的类型转换、选择适当的类型转换技巧，并在性能和可读性之间找到平衡，都是编写优质JavaScript代码的重要因素。</p><h1 id="垃圾回收"><a href="#垃圾回收" class="headerlink" title="垃圾回收"></a>垃圾回收</h1><h2 id="JavaScript内存生命周期"><a href="#JavaScript内存生命周期" class="headerlink" title="JavaScript内存生命周期"></a>JavaScript内存生命周期</h2><p>在讨论垃圾回收之前，我们首先需要了解一下JavaScript的内存生命周期，这个过程通常分为三个阶段：</p><ol><li><strong>分配内存</strong>：当声明变量、添加属性、或者调用函数等操作时，JavaScript引擎会分配内存来存储值。例如，当你写<code>let a = 1</code>时，JavaScript引擎会为变量<code>a</code>分配一块内存来存储值<code>1</code>。</li><li><strong>使用内存</strong>：在分配了内存之后，我们可以通过读写操作来使用这块内存。例如，我们可以读取变量<code>a</code>的值，或者改变它的值。</li><li><strong>释放内存</strong>：当内存不再被需要时（例如，变量已经离开了它的作用域），这块内存需要被释放，以便为新的内存分配做出空间。这个过程就是垃圾回收。</li></ol><h2 id="垃圾回收-1"><a href="#垃圾回收-1" class="headerlink" title="垃圾回收"></a>垃圾回收</h2><p>垃圾回收是自动完成的。垃圾收集器会周期性地（或在特定触发条件下）运行，找出不再使用的变量，然后释放其占用的内存。但是，如何确定哪些内存“不再需要”呢？这其实是一个复杂的问题，因为某些内存可能仍然被间接引用，或者可能在将来需要。因此，垃圾收集器必须使用一种算法来确定哪些内存可以安全地释放。接下来我们将详细介绍两种常见的垃圾回收算法：标记-清除算法和引用计数算法。</p><h3 id="标记-清除算法"><a href="#标记-清除算法" class="headerlink" title="标记-清除算法"></a>标记-清除算法</h3><p>这是JavaScript中最常用的垃圾回收算法。它的工作原理大致可以分为两个阶段：标记和清除。</p><p>在标记阶段，垃圾回收器从一组“根”（root）对象开始，遍历所有从这些根对象可达的对象。可达的对象包括直接引用的对象，以及通过其他可达对象间接引用的对象。所有可达的对象都被标记为“活动的”或“非垃圾的”。</p><p>然后，在清除阶段，垃圾回收器会遍历所有的堆内存，清除未被标记的对象。这些未被标记的对象就是我们所说的“垃圾”，它们无法从根对象访问到，因此我们可以安全地假设它们不会再被应用程序使用。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">test</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> x = <span class="hljs-number">123</span>;<br>    <span class="hljs-keyword">var</span> y = &#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span> &#125;;<br>    <span class="hljs-comment">// 当函数执行结束时，x 和 y 就离开了环境</span><br>&#125;<br><span class="hljs-title function_">test</span>();<br><span class="hljs-comment">// 现在 x 和 y 都是非环境变量，它们占用的内存就可以被垃圾回收器回收</span><br></code></pre></td></tr></table></figure><h3 id="引用计数算法"><a href="#引用计数算法" class="headerlink" title="引用计数算法"></a>引用计数算法</h3><p>引用计数是另一种垃圾回收策略。这种策略的基本思想是跟踪每个对象被引用的次数。当声明一个变量并将一个引用类型值赋给该变量时，这个引用类型值的引用次数就是1。如果同一个引用值被赋给另一个变量，引用次数增加1。相反，如果对该值的引用被删除，引用次数减少1。当这个引用次数变成0时，就表示没有任何地方再引用这个值了，因此该值可以被视为“垃圾”并被收集。</p><p>然而，引用计数算法有一个著名的问题，那就是循环引用。如果两个对象相互引用，即使它们没有被其他任何对象引用，它们的引用次数也不会是0，因此它们不会被回收，这会导致内存泄漏。为了解决这个问题，现代JavaScript引擎通常会结合使用标记-清除和引用计数两种算法。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">cycleReference</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> obj1 = &#123;&#125;;<br>    <span class="hljs-keyword">var</span> obj2 = &#123;&#125;;<br>    obj1.<span class="hljs-property">prop</span> = obj2;<br>    obj2.<span class="hljs-property">prop</span> = obj1;<br>&#125;<br><span class="hljs-title function_">cycleReference</span>();<br><span class="hljs-comment">// 在函数执行结束后，obj1 和 obj2 仍然相互引用，但已经离开了环境，无法被引用计数器捕获</span><br></code></pre></td></tr></table></figure><h2 id="JavaScript引擎的垃圾回收优化策略"><a href="#JavaScript引擎的垃圾回收优化策略" class="headerlink" title="JavaScript引擎的垃圾回收优化策略"></a>JavaScript引擎的垃圾回收优化策略</h2><p>现代JavaScript引擎不仅实现了上述的基础垃圾回收算法，而且引入了一些优化策略，以提高垃圾回收的效率并减小对性能的影响。</p><h3 id="分代收集"><a href="#分代收集" class="headerlink" title="分代收集"></a>分代收集</h3><p>大部分的JavaScript对象在创建后很快就会死亡，而那些能活下来的对象，通常能活很久。这给了JavaScript引擎一个优化垃圾收集的思路。它把内存堆分为两个</p><p>区域：新生代和老生代。新生代存放的是生存时间短的对象，老生代存放的是生存时间长的对象。</p><p>对新生代的垃圾回收采用Scavenge算法，它将新生代的空间一分为二，一个为使用空间（From），一个为空闲空间（To）。新对象总是被分配到From空间，当From空间快被使用完时，就会触发垃圾回收过程。回收过程中，存活的对象将会被复制到To空间，同时From和To空间的角色会对调，也就是原来的To空间变成新的From空间。这个过程称为新生代的晋升策略。</p><p>而老生代的对象数量一般较多且存活时间较长，如果还使用上面的Scavenge算法就会占用较多的CPU，因此老生代采用了标记-清除和标记-整理算法。</p><h3 id="延迟清除和增量标记"><a href="#延迟清除和增量标记" class="headerlink" title="延迟清除和增量标记"></a>延迟清除和增量标记</h3><p>为了减小垃圾回收过程对应用程序性能的影响，JavaScript引擎采用了“延迟清除”（Lazy Sweeping）和“增量标记”（Incremental Marking）两种策略。</p><p>“延迟清除”是指，在标记-清除算法中，垃圾回收器并不是在标记完对象之后立即清除，而是将清除操作延迟到应用程序空闲时进行。</p><p>“增量标记”则是将一次完整的标记过程分解为几个部分，每个部分只标记一部分对象。这样，垃圾回收器可以在运行一小段时间后，暂停一会儿，让出CPU给应用程序，然后再运行一小段时间，如此反复，直到标记所有对象。这种方式可以让垃圾回收和应用程序交替运行，减小了垃圾回收对应用程序性能的影响。</p><h3 id="JavaScript代码优化和垃圾回收"><a href="#JavaScript代码优化和垃圾回收" class="headerlink" title="JavaScript代码优化和垃圾回收"></a>JavaScript代码优化和垃圾回收</h3><p>了解了垃圾回收的基本概念和机制后，我们可以通过优化JavaScript代码来减少垃圾回收的压力，提高程序的性能。</p><h4 id="局部变量和立即释放内存"><a href="#局部变量和立即释放内存" class="headerlink" title="局部变量和立即释放内存"></a>局部变量和立即释放内存</h4><p>使用局部变量而不是全局变量可以更快地释放内存。这是因为局部变量的生命周期通常比全局变量短，一旦离开了它的环境（例如：函数执行结束），局部变量就可以被标记为垃圾回收。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">test</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> local = <span class="hljs-string">&quot;I&#x27;m a local variable&quot;</span>;<br>    <span class="hljs-comment">// 当函数执行结束后，local 就离开了环境，可以被垃圾回收</span><br>&#125;<br><span class="hljs-title function_">test</span>();<br></code></pre></td></tr></table></figure><h4 id="解除对象引用"><a href="#解除对象引用" class="headerlink" title="解除对象引用"></a>解除对象引用</h4><p>当你不再需要一个对象时，应该解除对它的引用。这样，垃圾回收器在下一次运行时就可以回收这个对象。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> obj = &#123; <span class="hljs-attr">prop</span>: <span class="hljs-string">&quot;I&#x27;m an object&quot;</span> &#125;;<br>obj = <span class="hljs-literal">null</span>; <span class="hljs-comment">// 现在，obj 可以被垃圾回收</span><br></code></pre></td></tr></table></figure><h4 id="避免长生命周期的引用"><a href="#避免长生命周期的引用" class="headerlink" title="避免长生命周期的引用"></a>避免长生命周期的引用</h4><p>长生命周期的引用（例如：全局变量或DOM引用）会阻止垃圾回收器回收它们所引用的对象。因此，应该尽量避免使用长生命周期的引用，或者在不再需要它们时及时解除引用。</p><p>在理解了JavaScript的垃圾回收机制和如何优化代码以减轻垃圾回收压力之后，我们可以写出更高效、更可靠的代码，从而提高用户体验，降低系统负载。</p><h1 id="WeakMap与Map、WeakSet与Set"><a href="#WeakMap与Map、WeakSet与Set" class="headerlink" title="WeakMap与Map、WeakSet与Set"></a>WeakMap与Map、WeakSet与Set</h1><p><code>WeakMap</code>是一种键值对的集合，类似于<code>Map</code>。不过，<code>WeakMap</code>与<code>Map</code>有几个重要的区别：</p><ul><li>在<code>WeakMap</code>中，只有对象可以作为键。换句话说，我们不能使用基本类型（如数字，字符串，布尔值等）作为<code>WeakMap</code>的键。</li><li><code>WeakMap</code>的键是弱引用的。这意味着，如果一个对象只被<code>WeakMap</code>引用，那么这个对象可以被垃圾回收（GC）。当这个对象被垃圾回收后，它对应的键值对也会从<code>WeakMap</code>中自动移除。</li><li><code>WeakMap</code>不可遍历，也就是说，我们不能使用像<code>for...of</code>这样的循环来遍历<code>WeakMap</code>。</li></ul><p>由于这些特性，<code>WeakMap</code>在处理内存泄漏问题和管理对象私有数据等场景中有着显著的优势。</p><p><code>WeakSet</code>也是一种集合，类似于<code>Set</code>。<code>WeakSet</code>与<code>Set</code>的主要区别包括：</p><ul><li>在<code>WeakSet</code>中，只有对象可以作为值。也就是说，我们不能将基本类型（如数字，字符串，布尔值等）添加到<code>WeakSet</code>中。</li><li><code>WeakSet</code>中的对象是弱引用的。如果一个对象只被<code>WeakSet</code>引用，那么这个对象可以被垃圾回收。当这个对象被垃圾回收后，它会自动从<code>WeakSet</code>中移除。</li><li><code>WeakSet</code>不可遍历，也就是说，我们不能使用像<code>for...of</code>这样的循环来遍历<code>WeakSet</code>。</li></ul><h2 id="WeakMap的创建和使用"><a href="#WeakMap的创建和使用" class="headerlink" title="WeakMap的创建和使用"></a>WeakMap的创建和使用</h2><p>我们可以使用<code>new WeakMap()</code>来创建一个新的<code>WeakMap</code>。在创建了<code>WeakMap</code>之后，我们可以使用<code>set</code>方法来添加新的键值对，</p><p>使用<code>get</code>方法来获取某个键对应的值，使用<code>delete</code>方法来移除某个键及其对应的值，使用<code>has</code>方法来检查<code>WeakMap</code>中是否存在某个键。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> weakMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WeakMap</span>();<br><br><span class="hljs-keyword">let</span> obj1 = &#123;&#125;;<br><span class="hljs-keyword">let</span> obj2 = &#123;&#125;;<br><br><span class="hljs-comment">// 添加键值对</span><br>weakMap.<span class="hljs-title function_">set</span>(obj1, <span class="hljs-string">&#x27;Hello&#x27;</span>);<br>weakMap.<span class="hljs-title function_">set</span>(obj2, <span class="hljs-string">&#x27;World&#x27;</span>);<br><br><span class="hljs-comment">// 获取值</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(weakMap.<span class="hljs-title function_">get</span>(obj1)); <span class="hljs-comment">// 输出: &#x27;Hello&#x27;</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(weakMap.<span class="hljs-title function_">get</span>(obj2)); <span class="hljs-comment">// 输出: &#x27;World&#x27;</span><br><br><span class="hljs-comment">// 检查键是否存在</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(weakMap.<span class="hljs-title function_">has</span>(obj1)); <span class="hljs-comment">// 输出: true</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(weakMap.<span class="hljs-title function_">has</span>(obj2)); <span class="hljs-comment">// 输出: true</span><br><br><span class="hljs-comment">// 删除键值对</span><br>weakMap.<span class="hljs-title function_">delete</span>(obj1);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(weakMap.<span class="hljs-title function_">has</span>(obj1)); <span class="hljs-comment">// 输出: false</span><br></code></pre></td></tr></table></figure><h2 id="WeakMap和内存管理"><a href="#WeakMap和内存管理" class="headerlink" title="WeakMap和内存管理"></a>WeakMap和内存管理</h2><p><code>WeakMap</code>最重要的特性就是其键对对象的弱引用。这意味着，如果一个对象只被<code>WeakMap</code>引用，那么这个对象可以被垃圾回收。这样就可以防止因为长时间持有对象引用导致的内存泄漏。</p><p>例如，如果我们在<code>Map</code>中保存了一些对象的引用，即使这些对象在其他地方都已经不再使用，但是由于它们仍被<code>Map</code>引用，所以它们不能被垃圾回收，这就可能导致内存泄漏。然而，如果我们使用<code>WeakMap</code>来保存这些对象的引用，那么当这些对象在其他地方都不再使用时，它们就会被垃圾回收，从而防止了内存泄漏。</p><h2 id="WeakMap和对象私有数据"><a href="#WeakMap和对象私有数据" class="headerlink" title="WeakMap和对象私有数据"></a>WeakMap和对象私有数据</h2><p><code>WeakMap</code>还常常被用来保存对象的私有数据。这是因为<code>WeakMap</code>的键不可遍历，所以我们可以利用这个特性来存储一些只有特定代码能够访问的数据。</p><p>例如，我们可以创建一个<code>WeakMap</code>，然后使用这个<code>WeakMap</code>来保存每个对象的私有数据，像这样：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> privateData = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WeakMap</span>();<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">MyClass</span>(<span class="hljs-params"></span>) &#123;<br>  privateData.<span class="hljs-title function_">set</span>(<span class="hljs-variable language_">this</span>, &#123;<br>    <span class="hljs-attr">secret</span>: <span class="hljs-string">&#x27;my secret data&#x27;</span>,<br>  &#125;);<br>&#125;<br><br><span class="hljs-title class_">MyClass</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">getSecret</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">return</span> privateData.<span class="hljs-title function_">get</span>(<span class="hljs-variable language_">this</span>).<span class="hljs-property">secret</span>;<br>&#125;;<br><br><span class="hljs-keyword">let</span> obj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyClass</span>();<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj.<span class="hljs-title function_">getSecret</span>()); <span class="hljs-comment">// 输出: &#x27;my secret data&#x27;</span><br></code></pre></td></tr></table></figure><p>在这个例子中，我们创建了一个<code>MyClass</code>的类，每一个<code>MyClass</code>的实例都有一个私有数据<code>secret</code>。我们使用<code>WeakMap</code>来保存这个私有数据。这样，我们就可以在<code>MyClass</code>的方法中访问这个私有数据，但是其他的代码无法访问它。</p><h2 id="WeakSet的创建和使用"><a href="#WeakSet的创建和使用" class="headerlink" title="WeakSet的创建和使用"></a>WeakSet的创建和使用</h2><p>我们可以使用<code>new WeakSet()</code>来创建一个新的<code>WeakSet</code>。在创建了<code>WeakSet</code>之后，我们可以使用<code>add</code>方法来添加新的对象，使用<code>delete</code>方法来移除某个对象，使用<code>has</code>方法来检查<code>WeakSet</code>中是否存在某个对象。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> weakSet = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WeakSet</span>();<br><br><span class="hljs-keyword">let</span> obj1 = &#123;&#125;;<br><span class="hljs-keyword">let</span> obj2 = &#123;&#125;;<br><br><span class="hljs-comment">// 添加对象</span><br>weakSet.<span class="hljs-title function_">add</span>(obj1);<br>weakSet.<span class="hljs-title function_">add</span>(obj2);<br><br><span class="hljs-comment">// 检查对象是否存在</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(weakSet.<span class="hljs-title function_">has</span>(obj1)); <span class="hljs-comment">// 输出: true</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(weakSet.<span class="hljs-title function_">has</span>(obj2)); <span class="hljs-comment">// 输出: true</span><br><br><span class="hljs-comment">// 删除对象</span><br>weakSet.<span class="hljs-title function_">delete</span>(obj1);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(weakSet.<span class="hljs-title function_">has</span>(obj1)); <span class="hljs-comment">// 输出: false</span><br></code></pre></td></tr></table></figure><h2 id="WeakSet和对象唯一性"><a href="#WeakSet和对象唯一性" class="headerlink" title="WeakSet和对象唯一性"></a>WeakSet和对象唯一性</h2><p><code>WeakSet</code>可以用来检查一个对象是否已经存在。由于<code>WeakSet</code>中的每个对象都是唯一的，所以我们可以利用这个特性来确保我们不会添加重复的对象。</p><p>例如，我们可以创建一个<code>WeakSet</code>，然后使用这个<code>WeakSet</code>来保存所有我们已经处理过的对象，像这样：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> processedObjects = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WeakSet</span>();<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">processObject</span>(<span class="hljs-params">obj</span>) &#123;<br>  <span class="hljs-keyword">if</span> (!processedObjects.<span class="hljs-title function_">has</span>(obj)) &#123;<br>    <span class="hljs-comment">// 处理对象</span><br>    <span class="hljs-comment">// ...</span><br><br>    <span class="hljs-comment">// 将对象添加到WeakSet中，表示我们已经处理过这个对象</span><br>    processedObjects.<span class="hljs-title function_">add</span>(obj);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>在这个例子中，我们在每次处理一个对象之前，都会检查这个对象是否已经被处理过。如果这个对象已经被处理过，我们就不会再处理它。这样，我们就可以确保我们不会重复处理同一个对象。</p><h2 id="WeakSet和内存管理"><a href="#WeakSet和内存管理" class="headerlink" title="WeakSet和内存管理"></a>WeakSet和内存管理</h2><p>与<code>WeakMap</code>一样，<code>WeakSet</code>中的对象也是弱引用的，所以<code>WeakSet</code>也有优秀的内存管理特性。如果一个对象只被<code>WeakSet</code>引用，那么这个对象可以被垃圾回收。这样就可以防止因为长时间持有对象引用导致的内存泄漏。</p><p>例如，如果我们在<code>Set</code>中保存了一些对象的引用，即使这些对象在其他地方都已经不再使用，但是由于它们仍被<code>Set</code>引用，所以它们不能被垃圾回收，这就可能导致内存泄漏。然而，如果我们使用<code>WeakSet</code>来保存这些对象的引用，那么当这些对象在其他地方都不再使用时，它们就会被垃圾回收，从而防止了内存泄漏</p><h1 id="面向对象编程oop与class"><a href="#面向对象编程oop与class" class="headerlink" title="面向对象编程oop与class"></a>面向对象编程oop与class</h1><h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p>随着JavaScript的发展，ECMAScript 6（ES6）引入了许多新的语言特性和语法糖，其中包括了面向对象编程的Class（类）机制。Class提供了一种更简洁、更直观的方式来定义对象和操作对象的行为。本文将介绍ES6中Class的概念、语法和特性，并通过示例代码来说明其实际应用。</p><h2 id="1-什么是面向对象编程？"><a href="#1-什么是面向对象编程？" class="headerlink" title="1. 什么是面向对象编程？"></a>1. 什么是面向对象编程？</h2><p>面向对象编程（Object-Oriented Programming，简称OOP）是一种编程范式，它将程序中的对象作为基本单元，通过封装、继承和多态等机制来组织和管理代码。面向对象编程将现实世界中的实体抽象为代码中的对象，对象拥有自己的状态（属性）和行为（方法），并与其他对象进行交互。</p><p>面向对象编程有以下几个核心概念：</p><ul><li><strong>封装（Encapsulation）</strong>：将数据和操作数据的方法封装在一个对象中，使其成为一个独立的实体，外部无法直接访问对象的内部实现细节。</li><li><strong>继承（Inheritance）</strong>：通过定义一个基类（父类），其他类可以继承该基类的属性和方法，并可以在此基础上进行扩展或覆盖。</li><li><strong>多态（Polymorphism）</strong>：不同对象可以对相同的方法做出不同的响应，即同一个方法可以根据调用对象的不同而具有不同的行为。</li></ul><p>面向对象编程的优势包括代码的可重用性、可维护性、扩展性和灵活性等。</p><h2 id="2-Class的基本概念"><a href="#2-Class的基本概念" class="headerlink" title="2. Class的基本概念"></a>2. Class的基本概念</h2><p>在ES6之前，JavaScript中的对象和面向对象编程的概念相对比较模糊。ES6引入了Class机制，使得JavaScript可以更加直观地定义和使用类。Class是一种特殊的函数，通过Class关键字定义。Class中可以定义构造函数、属性和方法等。</p><p>一个简单的Class示例如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Rectangle</span> &#123;<br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">width, height</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">width</span> = width;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">height</span> = height;<br>  &#125;<br><br>  <span class="hljs-title function_">area</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">width</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">height</span>;<br>  &#125;<br><br>  <span class="hljs-title function_">perimeter</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">2</span> * (<span class="hljs-variable language_">this</span>.<span class="hljs-property">width</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">height</span>);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>在上述示例中，我们定义了一个名为<code>Rectangle</code>的类，</p><p>它具有<code>width</code>和<code>height</code>两个属性，以及<code>area()</code>和<code>perimeter()</code>两个方法。通过Class定义的类可以通过实例化来创建具体的对象，并调用其属性和方法。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> rect = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Rectangle</span>(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(rect.<span class="hljs-title function_">area</span>());       <span class="hljs-comment">// 输出：15</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(rect.<span class="hljs-title function_">perimeter</span>());  <span class="hljs-comment">// 输出：16</span><br></code></pre></td></tr></table></figure><h2 id="3-Class的语法"><a href="#3-Class的语法" class="headerlink" title="3. Class的语法"></a>3. Class的语法</h2><p>ES6中Class的语法相对简洁明了。一个Class可以包含构造函数、属性和方法等。下面介绍一些常用的语法规则：</p><h3 id="3-1-构造函数"><a href="#3-1-构造函数" class="headerlink" title="3.1 构造函数"></a>3.1 构造函数</h3><p>在Class中使用<code>constructor</code>关键字定义构造函数。构造函数用于创建对象时进行初始化操作，通过<code>new</code>关键字实例化类时会自动调用构造函数。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Rectangle</span> &#123;<br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">width, height</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">width</span> = width;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">height</span> = height;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>构造函数中的<code>this</code>关键字表示当前实例化的对象。</p><h3 id="3-2-属性"><a href="#3-2-属性" class="headerlink" title="3.2 属性"></a>3.2 属性</h3><p>在Class中可以定义各种属性。属性可以直接定义在Class的内部，也可以在构造函数中通过<code>this</code>关键字进行定义。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Rectangle</span> &#123;<br>  width = <span class="hljs-number">0</span>;    <span class="hljs-comment">// 直接定义属性</span><br>  height = <span class="hljs-number">0</span>;<br><br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">width, height</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">width</span> = width;    <span class="hljs-comment">// 在构造函数中定义属性</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">height</span> = height;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3-3-方法"><a href="#3-3-方法" class="headerlink" title="3.3 方法"></a>3.3 方法</h3><p>在Class中定义的函数称为方法。可以直接在Class的内部定义方法，也可以使用ES6的简写形式。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Rectangle</span> &#123;<br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">width, height</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">width</span> = width;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">height</span> = height;<br>  &#125;<br><br>  <span class="hljs-title function_">area</span>(<span class="hljs-params"></span>) &#123;            <span class="hljs-comment">// 定义方法</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">width</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">height</span>;<br>  &#125;<br><br>  <span class="hljs-title function_">perimeter</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">2</span> * (<span class="hljs-variable language_">this</span>.<span class="hljs-property">width</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">height</span>);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3-4-方法的访问修饰符"><a href="#3-4-方法的访问修饰符" class="headerlink" title="3.4 方法的访问修饰符"></a>3.4 方法的访问修饰符</h3><p>在Class中，可以使用访问修饰符来限制方法的访问权限。ES6中的Class默认所有方法都是公共的，可以被外部调用。但我们可以使用<code>static</code>、<code>get</code>、<code>set</code>、<code>private</code>和<code>protected</code>等修饰符来控制方法的访问。</p><ul><li><code>static</code>：定义静态方法，只能通过类本身调用，不能通过类的实例调用。</li><li><code>get</code>和<code>set</code>：定义属性的读取和设置方法，使用类似访问属性的语法进行调用。</li><li><code>private</code>：定义私有方法，只能在类的内部被访问，外部无法访问。</li><li><code>protected</code>：定义受保护方法，只能在类的内部和子类中被访问，外部无法访问。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Rectangle</span> &#123;<br>  <span class="hljs-keyword">static</span> description = <span class="hljs-string">&#x27;This is a rectangle&#x27;</span>;  <span class="hljs-comment">// 静态属性</span><br><br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">width, height</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">width</span> = width;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">height</span> = height;<br>  &#125;<br><br>  <span class="hljs-keyword">static</span> <span class="hljs-title function_">createSquare</span>(<span class="hljs-params">side</span>) &#123;     <span class="hljs-comment">// 静态方法</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Rectangle</span>(side, side);<br>  &#125;<br><br><br><br>  <span class="hljs-keyword">get</span> <span class="hljs-title function_">area</span>() &#123;           <span class="hljs-comment">// Getter方法</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">width</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">height</span>;<br>  &#125;<br><br>  <span class="hljs-keyword">set</span> <span class="hljs-title function_">area</span>(<span class="hljs-params">value</span>) &#123;     <span class="hljs-comment">// Setter方法</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">width</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>(value);<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">height</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>(value);<br>  &#125;<br><br>  #<span class="hljs-title function_">privateMethod</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-comment">// 私有方法</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;This is a private method&#x27;</span>);<br>  &#125;<br><br>  <span class="hljs-title function_">protectedMethod</span>(<span class="hljs-params"></span>) &#123;   <span class="hljs-comment">// 受保护方法</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;This is a protected method&#x27;</span>);<br>  &#125;<br><br>  <span class="hljs-title function_">publicMethod</span>(<span class="hljs-params"></span>) &#123;      <span class="hljs-comment">// 公共方法</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;This is a public method&#x27;</span>);<br>    <span class="hljs-variable language_">this</span>.#<span class="hljs-title function_">privateMethod</span>();<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">protectedMethod</span>();<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>在上述示例中，我们定义了一个<code>Square</code>类，它继承自<code>Rectangle</code>类。通过<code>super</code>关键字调用父类的构造函数，确保父类的属性被正确初始化。子类可以新增或覆盖父类的方法。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> square = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Square</span>(<span class="hljs-number">5</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(square.<span class="hljs-title function_">area</span>());       <span class="hljs-comment">// 输出：25</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(square.<span class="hljs-title function_">perimeter</span>());  <span class="hljs-comment">// 输出：20</span><br></code></pre></td></tr></table></figure><h2 id="4-类的静态方法和属性"><a href="#4-类的静态方法和属性" class="headerlink" title="4. 类的静态方法和属性"></a>4. 类的静态方法和属性</h2><p>静态方法和属性属于类本身，而不是类的实例。静态方法和属性可以通过类名直接访问，无需实例化类。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MathUtil</span> &#123;<br>  <span class="hljs-keyword">static</span> <span class="hljs-variable constant_">PI</span> = <span class="hljs-number">3.14159</span>;    <span class="hljs-comment">// 静态属性</span><br><br>  <span class="hljs-keyword">static</span> <span class="hljs-title function_">square</span>(<span class="hljs-params">number</span>) &#123;    <span class="hljs-comment">// 静态方法</span><br>    <span class="hljs-keyword">return</span> number * number;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>在上述示例中，我们定义了一个<code>MathUtil</code>类，它具有一个静态属性<code>PI</code>和一个静态方法<code>square()</code>。可以通过类名直接访问静态属性和方法。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">MathUtil</span>.<span class="hljs-property">PI</span>);        <span class="hljs-comment">// 输出：3.14159</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">MathUtil</span>.<span class="hljs-title function_">square</span>(<span class="hljs-number">5</span>)); <span class="hljs-comment">// 输出：25</span><br></code></pre></td></tr></table></figure><h2 id="5-Getter和Setter方法"><a href="#5-Getter和Setter方法" class="headerlink" title="5. Getter和Setter方法"></a>5. Getter和Setter方法</h2><p>Getter和Setter方法用于对类的属性进行读取和设置操作，可以通过类似访问属性的语法进行调用。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Circle</span> &#123;<br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">radius</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">radius</span> = radius;<br>  &#125;<br><br>  <span class="hljs-keyword">get</span> <span class="hljs-title function_">diameter</span>() &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">2</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">radius</span>;<br>  &#125;<br><br>  <span class="hljs-keyword">set</span> <span class="hljs-title function_">diameter</span>(<span class="hljs-params">value</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">radius</span> = value / <span class="hljs-number">2</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>在上述示例中，我们定义了一个<code>Circle</code>类，它具有一个属性<code>radius</code>。通过定义<code>get diameter()</code>方法和<code>set diameter()</code>方法，我们可以通过类似访问属性的方式来读取和设置直径（<code>diameter</code>）属性，而不需要直接访问<code>radius</code>属性。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> circle = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Circle</span>(<span class="hljs-number">5</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(circle.<span class="hljs-property">diameter</span>);     <span class="hljs-comment">//</span><br><br> 输出：<span class="hljs-number">10</span><br>circle.<span class="hljs-property">diameter</span> = <span class="hljs-number">12</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(circle.<span class="hljs-property">radius</span>);       <span class="hljs-comment">// 输出：6</span><br></code></pre></td></tr></table></figure><h2 id="6-类的私有属性和方法"><a href="#6-类的私有属性和方法" class="headerlink" title="6. 类的私有属性和方法"></a>6. 类的私有属性和方法</h2><p>在ES6中，可以使用<code>#</code>作为前缀来定义私有属性和方法。私有属性和方法只能在类的内部被访问，外部无法访问。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> &#123;<br>  #name;   <span class="hljs-comment">// 私有属性</span><br><br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.#name = name;<br>  &#125;<br><br>  #<span class="hljs-title function_">privateMethod</span>(<span class="hljs-params"></span>) &#123;   <span class="hljs-comment">// 私有方法</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;This is a private method&#x27;</span>);<br>  &#125;<br><br>  <span class="hljs-title function_">publicMethod</span>(<span class="hljs-params"></span>) &#123;      <span class="hljs-comment">// 公共方法</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Hello, my name is <span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.#name&#125;</span>`</span>);<br>    <span class="hljs-variable language_">this</span>.#<span class="hljs-title function_">privateMethod</span>();<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>在上述示例中，我们定义了一个<code>Person</code>类，它具有一个私有属性<code>#name</code>和一个私有方法<code>#privateMethod()</code>。私有属性和方法只能在类的内部访问。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> person = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&#x27;John&#x27;</span>);<br>person.<span class="hljs-title function_">publicMethod</span>();   <span class="hljs-comment">// 输出：Hello, my name is John</span><br>person.#name;            <span class="hljs-comment">// 报错：SyntaxError: Private field &#x27;#name&#x27; must be declared in an enclosing class</span><br>person.#<span class="hljs-title function_">privateMethod</span>(); <span class="hljs-comment">// 报错：SyntaxError: Private field &#x27;#privateMethod&#x27; must be declared in an enclosing class</span><br></code></pre></td></tr></table></figure><h2 id="7-类的实例和构造函数"><a href="#7-类的实例和构造函数" class="headerlink" title="7. 类的实例和构造函数"></a>7. 类的实例和构造函数</h2><p>在ES6中，类的实例通过<code>new</code>关键字进行创建，并自动调用类的构造函数进行初始化。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> rect = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Rectangle</span>(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(rect.<span class="hljs-title function_">area</span>());       <span class="hljs-comment">// 输出：15</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(rect.<span class="hljs-title function_">perimeter</span>());  <span class="hljs-comment">// 输出：16</span><br></code></pre></td></tr></table></figure><p>可以使用<code>instanceof</code>运算符来判断一个对象是否是某个类的实例。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(rect <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Rectangle</span>);  <span class="hljs-comment">// 输出：true</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(rect <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Object</span>);     <span class="hljs-comment">// 输出：true</span><br></code></pre></td></tr></table></figure><h2 id="8-类的继承"><a href="#8-类的继承" class="headerlink" title="8. 类的继承"></a>8. 类的继承</h2><p>继承是面向对象编程中的重要概念之一，它允许我们创建一个基类（父类），其他类可以继承该基类并扩展或覆盖其中的属性和方法。ES6中使用<code>extends</code>关键字实现类的继承。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Square</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Rectangle</span> &#123;<br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">side</span>) &#123;<br>    <span class="hljs-variable language_">super</span>(side, side);    <span class="hljs-comment">// 调用父类的构造函数</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="9-类的封装"><a href="#9-类的封装" class="headerlink" title="9. 类的封装"></a>9. 类的封装</h2><p>封装通过将数据和操作数据的方法封装在一个对象中，实现了数据的保护和访问的控制。类的属性和方法可以使用不同的访问修饰符来控制其可见性。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Rectangle</span> &#123;<br>  #width;  <span class="hljs-comment">// 私有属性</span><br>  #height;<br><br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">width, height</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.#width = width;<br>    <span class="hljs-variable language_">this</span>.#height = height;<br>  &#125;<br><br>  <span class="hljs-title function_">getArea</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-comment">// 公共方法</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.#width * <span class="hljs-variable language_">this</span>.#height;<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> rect = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Rectangle</span>(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(rect.#width);  <span class="hljs-comment">// 报错：SyntaxError: Private field &#x27;#width&#x27; must be declared in an enclosing class</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(rect.<span class="hljs-title function_">getArea</span>());  <span class="hljs-comment">// 输出：15</span><br></code></pre></td></tr></table></figure><p>在上述示例中，Rectangle类具有私有属性#width和#height，只能在类的内部被访问。通过定义公共方法getArea()来访问私有属性，从而实现了封装。</p><h2 id="10-类的多态"><a href="#10-类的多态" class="headerlink" title="10. 类的多态"></a>10. 类的多态</h2><p>多态允许不同的对象对相同的消息作出不同的响应。通过继承和方法的覆盖，不同的子类可以对父类的方法进行不同的实现，从而实现多态性。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span> &#123;<br>  <span class="hljs-title function_">makeSound</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Animal makes sound&#x27;</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Animal</span> &#123;<br>  <span class="hljs-title function_">makeSound</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Dog barks&#x27;</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Cat</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Animal</span> &#123;<br>  <span class="hljs-title function_">makeSound</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Cat meows&#x27;</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> animal = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Animal</span>();<br><span class="hljs-keyword">const</span> dog = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>();<br><span class="hljs-keyword">const</span> cat = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>();<br><br>animal.<span class="hljs-title function_">makeSound</span>();  <span class="hljs-comment">// 输出：Animal makes sound</span><br>dog.<span class="hljs-title function_">makeSound</span>();     <span class="hljs-comment">// 输出：Dog barks</span><br>cat.<span class="hljs-title function_">makeSound</span>();     <span class="hljs-comment">// 输出：Cat meows</span><br></code></pre></td></tr></table></figure><p>在上述示例中，Animal类是基类，Dog和Cat类是子类。它们都具有makeSound()方法，但不同的子类对该方法进行了不同的实现，实现了多态性。</p><p>通过封装、继承和多态，面向对象编程提供了一种更加灵活和可扩展的编程方式，使得代码的组织和管理更加直观和高效。</p><h1 id="Iterator-迭代器"><a href="#Iterator-迭代器" class="headerlink" title="Iterator 迭代器"></a>Iterator 迭代器</h1><h2 id="引言-1"><a href="#引言-1" class="headerlink" title="引言"></a>引言</h2><p>在 JavaScript 中，迭代器（Iterator）是一种用于遍历集合的接口。迭代器提供了一种统一的方式来访问集合中的元素，无论集合的类型和内部结构如何。通过使用迭代器，我们可以轻松地遍历数组、对象、Map、Set 等各种数据结构，并进行相应的操作。本文将详细介绍迭代器的概念、属性、应用场景，并提供相关的代码示例。</p><h2 id="1-迭代器的概念"><a href="#1-迭代器的概念" class="headerlink" title="1. 迭代器的概念"></a>1. 迭代器的概念</h2><p>迭代器是一种遍历集合的接口，它提供了统一的方式来访问集合中的元素。迭代器对象是一个具有特定结构的对象，其中包含一个 <code>next</code> 方法，用于返回集合中的下一个元素。</p><p>迭代器的工作原理如下：</p><ol><li>创建一个迭代器对象，通常通过调用集合对象的 <code>Symbol.iterator</code> 方法来获取迭代器对象。</li><li>调用迭代器对象的<code>next</code>方法，每次调用都会返回一个包含<code>value</code>和<code>done</code>两个属性的对象。<ul><li><code>value</code> 表示集合中的一个元素。</li><li><code>done</code> 表示迭代是否已完成，如果为 <code>true</code>，则表示迭代结束；如果为 <code>false</code>，则表示还有更多元素可供遍历。</li></ul></li><li>重复调用 <code>next</code> 方法，直到迭代结束。</li></ol><p>JavaScript 中的数组、对象、Map、Set 等数据结构都实现了迭代器接口，因此我们可以使用迭代器来遍历它们的元素。</p><h2 id="2-迭代器的属性"><a href="#2-迭代器的属性" class="headerlink" title="2. 迭代器的属性"></a>2. 迭代器的属性</h2><p>迭代器对象具有以下两个重要的属性：</p><ul><li><p><code>next()</code>方法：该方法返回一个包含<code>value</code>和<code>done</code>两个属性的对象。</p><ul><li><code>value</code>：表示集合中的一个元素。</li><li><code>done</code>：表示迭代是否已完成，如果为 <code>true</code>，则表示迭代结束；如果为 <code>false</code>，则表示还有更多元素可供遍历。</li></ul></li><li><p><code>Symbol.iterator</code> 方法：该方法返回迭代器对象自身，用于支持迭代器的迭代。</p></li></ul><h2 id="3-迭代器的应用场景"><a href="#3-迭代器的应用场景" class="headerlink" title="3. 迭代器的应用场景"></a>3. 迭代器的应用场景</h2><p>迭代器在 JavaScript 中有许多应用场景，下面是一些常见的应用场景：</p><h3 id="3-1-数组遍历"><a href="#3-1-数组遍历" class="headerlink" title="3.1 数组遍历"></a>3.1 数组遍历</h3><p>使用迭代器可以轻松遍历数组的所有元素。通过调用数组对象的 <code>Symbol.iterator</code> 方法，可以获取一个迭代器对象，然后使用迭代器的 <code>next</code> 方法逐个访问数组的元素。</p><p><strong>示例代码：</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> arr = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];<br><span class="hljs-keyword">const</span> iterator = arr[<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">iterator</span>]();<br><br><span class="hljs-keyword">let</span> result = iterator.<span class="hljs-title function_">next</span>();<br><span class="hljs-keyword">while</span><br><br> (!result.<span class="hljs-property">done</span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result.<span class="hljs-property">value</span>);<br>  result = iterator.<span class="hljs-title function_">next</span>();<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3-2-对象遍历"><a href="#3-2-对象遍历" class="headerlink" title="3.2 对象遍历"></a>3.2 对象遍历</h3><p>使用迭代器可以遍历对象的所有属性。通过调用对象的 <code>Symbol.iterator</code> 方法，可以获取一个迭代器对象，然后使用迭代器的 <code>next</code> 方法逐个访问对象的属性。</p><p><strong>示例代码：</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> obj = &#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">c</span>: <span class="hljs-number">3</span> &#125;;<br><span class="hljs-keyword">const</span> iterator = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(obj)[<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">iterator</span>]();<br><br><span class="hljs-keyword">let</span> result = iterator.<span class="hljs-title function_">next</span>();<br><span class="hljs-keyword">while</span> (!result.<span class="hljs-property">done</span>) &#123;<br>  <span class="hljs-keyword">const</span> key = result.<span class="hljs-property">value</span>;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(key, obj[key]);<br>  result = iterator.<span class="hljs-title function_">next</span>();<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3-3-Map-遍历"><a href="#3-3-Map-遍历" class="headerlink" title="3.3 Map 遍历"></a>3.3 Map 遍历</h3><p>使用迭代器可以遍历 Map 对象的所有键值对。通过调用 Map 对象的 <code>entries()</code> 方法，可以获取一个迭代器对象，然后使用迭代器的 <code>next</code> 方法逐个访问 Map 的键值对。</p><p><strong>示例代码：</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>([[<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-number">1</span>], [<span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-number">2</span>], [<span class="hljs-string">&quot;c&quot;</span>, <span class="hljs-number">3</span>]]);<br><span class="hljs-keyword">const</span> iterator = map.<span class="hljs-title function_">entries</span>();<br><br><span class="hljs-keyword">let</span> result = iterator.<span class="hljs-title function_">next</span>();<br><span class="hljs-keyword">while</span> (!result.<span class="hljs-property">done</span>) &#123;<br>  <span class="hljs-keyword">const</span> [key, value] = result.<span class="hljs-property">value</span>;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(key, value);<br>  result = iterator.<span class="hljs-title function_">next</span>();<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3-4-Set-遍历"><a href="#3-4-Set-遍历" class="headerlink" title="3.4 Set 遍历"></a>3.4 Set 遍历</h3><p>使用迭代器可以遍历 Set 对象的所有元素。通过调用 Set 对象的 <code>values()</code> 方法，可以获取一个迭代器对象，然后使用迭代器的 <code>next</code> 方法逐个访问 Set 的元素。</p><p><strong>示例代码：</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> set = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]);<br><span class="hljs-keyword">const</span> iterator = set.<span class="hljs-title function_">values</span>();<br><br><span class="hljs-keyword">let</span> result = iterator.<span class="hljs-title function_">next</span>();<br><span class="hljs-keyword">while</span> (!result.<span class="hljs-property">done</span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result.<span class="hljs-property">value</span>);<br>  result = iterator.<span class="hljs-title function_">next</span>();<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="4-自定义迭代器"><a href="#4-自定义迭代器" class="headerlink" title="4. 自定义迭代器"></a>4. 自定义迭代器</h2><p>除了使用内置数据结构提供的迭代器之外，我们还可以自定义迭代器来遍历自定义数据结构。要实现一个自定义迭代器，我们需要定义一个具有 <code>next</code> 方法的对象，并且该对象的 <code>next</code> 方法需要返回一个包含 <code>value</code> 和 <code>done</code> 属性的对象。</p><p><strong>示例代码：</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> myIterable = &#123;<br>  <span class="hljs-attr">data</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>],<br>  [<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">iterator</span>]() &#123;<br>    <span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span>;<br><br>    <span class="hljs-keyword">return</span> &#123;<br>      <span class="hljs-attr">next</span>: <span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-keyword">if</span> (index &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>.<span class="hljs-property">length</span>) &#123;<br>          <span class="hljs-keyword">return</span> &#123; <span class="hljs-attr">value</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>[index++], <span class="hljs-attr">done</span>: <span class="hljs-literal">false</span> &#125;;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>          <span class="hljs-keyword">return</span> &#123; <span class="hljs-attr">value</span>: <span class="hljs-literal">undefined</span>, <span class="hljs-attr">done</span>: <span class="hljs-literal">true</span> &#125;;<br>        &#125;<br>      &#125;,<br>    &#125;;<br>  &#125;,<br>&#125;;<br><br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> item <span class="hljs-keyword">of</span> myIterable) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(item);<br>&#125;<br></code></pre></td></tr></table></figure><p>在上面的示例中，我们定义了一个自定义数据结构 <code>myIterable</code>，它包含一个数组 <code>data</code> 和一个自定义的迭代器对象。迭代器对象的 <code>next</code> 方法会依次返回数组中的元素，并在遍历结束时返回 <code>&#123; value: undefined, done: true &#125;</code>。</p><h1 id="proxy"><a href="#proxy" class="headerlink" title="proxy"></a>proxy</h1><h2 id="Proxy是什么？"><a href="#Proxy是什么？" class="headerlink" title="Proxy是什么？"></a>Proxy是什么？</h2><p>在JavaScript中，Proxy是一个特殊的“包装器”对象，它可以用于修改或扩展某些基本操作的行为，比如属性读取、函数调用等。这种修改或扩展的行为是通过所谓的”traps”实现的，这些”traps”定义了如何拦截和改变基本操作。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> target = &#123;<br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;target&quot;</span><br>&#125;;<br><br><span class="hljs-keyword">let</span> proxy = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Proxy</span>(target, &#123;<br>  <span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">target, property</span>) &#123;<br>    <span class="hljs-keyword">return</span> property <span class="hljs-keyword">in</span> target ? target[property] : <span class="hljs-string">&quot;Default&quot;</span>;<br>  &#125;<br>&#125;);<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(proxy.<span class="hljs-property">name</span>); <span class="hljs-comment">// 输出 &quot;target&quot;</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(proxy.<span class="hljs-property">unknown</span>); <span class="hljs-comment">// 输出 &quot;Default&quot;</span><br></code></pre></td></tr></table></figure><p>在上面的例子中，当我们尝试从proxy读取不存在的属性时，我们得到了”default”，而不是通常的”undefined”。这是因为我们的”get” trap拦截了读取操作，并返回了默认值。</p><h2 id="Proxy的用途"><a href="#Proxy的用途" class="headerlink" title="Proxy的用途"></a>Proxy的用途</h2><p>Proxy有许多用途，下面是一些常见的例子：</p><h3 id="数据校验"><a href="#数据校验" class="headerlink" title="数据校验"></a>数据校验</h3><p>Proxy可以用于校验设置对象属性的值：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> validator = &#123;<br>  <span class="hljs-attr">set</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">target, property, value</span>) &#123;<br>    <span class="hljs-keyword">if</span> (property === <span class="hljs-string">&quot;age&quot;</span>) &#123;<br>      <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">Number</span>.<span class="hljs-title function_">isInteger</span>(value)) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">&quot;The age is not an integer&quot;</span>);<br>      &#125;<br>      <span class="hljs-keyword">if</span> (value &lt; <span class="hljs-number">0</span> || value &gt; <span class="hljs-number">200</span>) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RangeError</span>(<span class="hljs-string">&quot;The age is invalid&quot;</span>);<br>      &#125;<br>    &#125;<br><br>    target[property] = value;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>  &#125;<br>&#125;;<br><br><span class="hljs-keyword">let</span> person = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Proxy</span>(&#123;&#125;, validator);<br><br>person.<span class="hljs-property">age</span> = <span class="hljs-number">100</span>; <span class="hljs-comment">// 正常</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person.<span class="hljs-property">age</span>); <span class="hljs-comment">// 输出 100</span><br>person.<span class="hljs-property">age</span> = <span class="hljs-string">&quot;young&quot;</span>; <span class="hljs-comment">// 抛出 TypeError: The age is not an integer</span><br>person.<span class="hljs-property">age</span> = <span class="hljs-number">300</span>; <span class="hljs-comment">// 抛出 RangeError: The age is invalid</span><br></code></pre></td></tr></table></figure><h3 id="数据绑定和观察"><a href="#数据绑定和观察" class="headerlink" title="数据绑定和观察"></a>数据绑定和观察</h3><p>Proxy可以用于实现数据绑定和观察（数据变化的监听）：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> handler = &#123;<br>  <span class="hljs-attr">set</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">target, property, value</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">$&#123;property&#125;</span> is set to <span class="hljs-subst">$&#123;value&#125;</span>`</span>);<br>    target[property] = value;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>  &#125;<br>&#125;;<br><br><span class="hljs-keyword">let</span> proxy = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Proxy</span>(&#123;&#125;, handler);<br><br>proxy.<span class="hljs-property">name</span> = <span class="hljs-string">&quot;proxy&quot;</span>; <span class="hljs-comment">// 输出 &quot;name is set to proxy&quot;</span><br></code></pre></td></tr></table></figure><h3 id="函数参数的默认值"><a href="#函数参数的默认值" class="headerlink" title="函数参数的默认值"></a>函数参数的默认值</h3><p>Proxy可以用于给函数参数设置默认值：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">defaultValues</span>(<span class="hljs-params">target, defaults</span>) &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Proxy</span>(target, &#123;<br>    <span class="hljs-attr">apply</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">target, thisArg, args</span>) &#123;<br>      args = args.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">arg, index</span>) =&gt;</span> arg === <span class="hljs-literal">undefined</span> ? defaults[index] : arg);<br>     <br><br> <span class="hljs-keyword">return</span> target.<span class="hljs-title function_">apply</span>(thisArg, args);<br>    &#125;<br>  &#125;);<br>&#125;<br><br><span class="hljs-keyword">let</span> add = <span class="hljs-title function_">defaultValues</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">x, y</span>) &#123;<br>  <span class="hljs-keyword">return</span> x + y;<br>&#125;, [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>]);<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">add</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)); <span class="hljs-comment">// 输出 2</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">add</span>(<span class="hljs-literal">undefined</span>, <span class="hljs-number">1</span>)); <span class="hljs-comment">// 输出 1</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">add</span>(<span class="hljs-number">1</span>)); <span class="hljs-comment">// 输出 1</span><br></code></pre></td></tr></table></figure><p>以上仅仅是Proxy能做的事情的一部分。在实际开发中，你可以根据需要灵活使用Proxy。</p><h2 id="Proxy-vs-Reflect"><a href="#Proxy-vs-Reflect" class="headerlink" title="Proxy vs Reflect"></a>Proxy vs Reflect</h2><p>在ES6中引入了另一个新的全局对象<code>Reflect</code>，它提供了一组用于执行JavaScript基本操作的方法，例如<code>Reflect.get()</code>，<code>Reflect.set()</code>等。这些方法与Proxy的traps一一对应。这使得Proxy的traps可以使用对应的Reflect方法来执行被拦截的操作：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> proxy = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Proxy</span>(target, &#123;<br>  <span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">target, property</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">get</span>(target, property);<br>  &#125;<br>&#125;);<br></code></pre></td></tr></table></figure><p>Reflect的方法有许多优点。首先，它们总是返回一个期望的值，使得代码更易于理解和调试。其次，它们提供了一种正确处理JavaScript基本操作的方法。例如，使用<code>Reflect.set()</code>可以正确处理设置只读属性的情况。</p><h1 id="修饰器（Decorator）"><a href="#修饰器（Decorator）" class="headerlink" title="修饰器（Decorator）"></a>修饰器（Decorator）</h1><h2 id="引言-2"><a href="#引言-2" class="headerlink" title="引言"></a>引言</h2><p>在JavaScript中，修饰器（Decorator）是一种特殊的语法，用于修改类、方法或属性的行为。修饰器提供了一种简洁而灵活的方式来扩展和定制代码功能。本文将详细介绍JavaScript修饰器的概念、语法和应用场景，并提供相关的代码示例。</p><h2 id="1-修饰器简介"><a href="#1-修饰器简介" class="headerlink" title="1. 修饰器简介"></a>1. 修饰器简介</h2><p>修饰器是一种用于修改类、方法或属性的语法，它可以在不修改原始代码的情况下增强其功能。修饰器可以实现横切关注点（cross-cutting concerns）的功能，例如日志记录、性能分析、缓存等。通过将这些功能与原始代码分离，我们可以更好地组织和维护代码，并实现更高的可重用性和可扩展性。</p><h2 id="2-修饰器语法"><a href="#2-修饰器语法" class="headerlink" title="2. 修饰器语法"></a>2. 修饰器语法</h2><p>修饰器使用<code>@</code>符号作为前缀，紧跟着修饰器函数或类。修饰器可以接收不同的参数，根据修饰的目标不同，参数也会有所区别。修饰器可以单独使用，也可以通过组合多个修饰器来实现更复杂的功能。</p><p>下面是一个基本的修饰器语法示例：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript">@decorator<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span> &#123;<br>  @propertyDecorator<br>  myProperty = <span class="hljs-number">123</span>;<br><br>  @methodDecorator<br>  <span class="hljs-title function_">myMethod</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">// 代码逻辑</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="3-类修饰器"><a href="#3-类修饰器" class="headerlink" title="3. 类修饰器"></a>3. 类修饰器</h2><h3 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h3><p>类修饰器用于修改类的行为和属性。它可以在类定义之前应用，以修改类的构造函数或原型。</p><p>常见的应用场景包括：</p><ul><li><strong>日志记录</strong>：在类的方法执行前后记录日志信息。</li><li><strong>验证和授权</strong>：对类的方法进行验证和授权操作。</li><li><strong>性能分析</strong>：测量类的方法执行时间，进行性能分析。</li><li><strong>依赖注入</strong>：为类的构造函数注入依赖项。</li></ul><h3 id="示例代码"><a href="#示例代码" class="headerlink" title="示例代码"></a>示例代码</h3><p>下面是一个使用类修饰器实现日志记录</p><p>的示例：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">log</span>(<span class="hljs-params">target</span>) &#123;<br>  <span class="hljs-keyword">const</span> originalConstructor = target;<br><br>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">newConstructor</span>(<span class="hljs-params">...args</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Creating instance of <span class="hljs-subst">$&#123;originalConstructor.name&#125;</span>`</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">originalConstructor</span>(...args);<br>  &#125;<br><br>  <span class="hljs-keyword">return</span> newConstructor;<br>&#125;<br><br>@log<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span> &#123;<br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> myObj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyClass</span>(<span class="hljs-string">&quot;John&quot;</span>);<br></code></pre></td></tr></table></figure><p>在上面的示例中，我们定义了一个名为<code>log</code>的修饰器函数。该修饰器函数接收一个参数<code>target</code>，表示要修饰的类构造函数。在修饰器函数内部，我们将原始的构造函数保存到<code>originalConstructor</code>中，并创建一个新的构造函数<code>newConstructor</code>，该构造函数在创建实例前打印日志信息。最后，我们将新的构造函数返回作为修饰后的类构造函数。</p><h2 id="4-方法修饰器"><a href="#4-方法修饰器" class="headerlink" title="4. 方法修饰器"></a>4. 方法修饰器</h2><h3 id="应用场景-1"><a href="#应用场景-1" class="headerlink" title="应用场景"></a>应用场景</h3><p>方法修饰器用于修改类的方法行为。它可以在方法定义之前应用，以修改方法的特性和行为。</p><p>常见的应用场景包括：</p><ul><li><strong>日志记录</strong>：在方法执行前后记录日志信息。</li><li><strong>验证和授权</strong>：对方法进行验证和授权操作。</li><li><strong>性能分析</strong>：测量方法执行时间，进行性能分析。</li><li><strong>缓存</strong>：为方法添加缓存功能，提高性能。</li></ul><h3 id="示例代码-1"><a href="#示例代码-1" class="headerlink" title="示例代码"></a>示例代码</h3><p>下面是一个使用方法修饰器实现日志记录的示例：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">log</span>(<span class="hljs-params">target, name, descriptor</span>) &#123;<br>  <span class="hljs-keyword">const</span> originalMethod = descriptor.<span class="hljs-property">value</span>;<br><br>  descriptor.<span class="hljs-property">value</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">...args</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Executing method <span class="hljs-subst">$&#123;name&#125;</span>`</span>);<br>    <span class="hljs-keyword">const</span> result = originalMethod.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Method <span class="hljs-subst">$&#123;name&#125;</span> executed`</span>);<br>    <span class="hljs-keyword">return</span> result;<br>  &#125;;<br><br>  <span class="hljs-keyword">return</span> descriptor;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span> &#123;<br>  @log<br>  <span class="hljs-title function_">myMethod</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">// 代码逻辑</span><br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> myObj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyClass</span>();<br>myObj.<span class="hljs-title function_">myMethod</span>();<br></code></pre></td></tr></table></figure><p>在上面的示例中，我们定义了一个名为<code>log</code>的修饰器函数。该修饰器函数接收三个参数，分别是<code>target</code>（类的原型或构造函数）、<code>name</code>（方法名）和<code>descriptor</code>（方法的属性描述符）。在修饰器函数内部，我们获取原始方法并将其保存到<code>originalMethod</code>中。然后，我们修改<code>descriptor.value</code>，将其替换为一个新的函数，该函数在执行原始方法前后打印日志信息。最后，我们返回修改后的属性描述符。</p><h2 id="5-属性修饰器"><a href="#5-属性修饰器" class="headerlink" title="5. 属性修饰器"></a>5. 属性修饰器</h2><h3 id="应用场景-2"><a href="#应用场景-2" class="headerlink" title="应用场景"></a>应用场景</h3><p>属性修饰器用于修改类的属性行为。它可以在属性定义之前应用，以修改属性的特性和行为。</p><p>常见的应用场景包括：</p><ul><li><strong>日志记录</strong>：在属性读取或写入时记录日志信息。</li><li><strong>验证和授权</strong>：对属性进行验证和授权操作。</li><li><strong>计算属性</strong>：根据其他属性的值计算属性的值。</li><li><strong>缓存</strong>：为属性添加</li></ul><p>缓存功能，提高性能。</p><h3 id="示例代码-2"><a href="#示例代码-2" class="headerlink" title="示例代码"></a>示例代码</h3><p>下面是一个使用属性修饰器实现日志记录的示例：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">log</span>(<span class="hljs-params">target, name</span>) &#123;<br>  <span class="hljs-keyword">let</span> value;<br><br>  <span class="hljs-keyword">const</span> getter = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Getting value of property <span class="hljs-subst">$&#123;name&#125;</span>`</span>);<br>    <span class="hljs-keyword">return</span> value;<br>  &#125;;<br><br>  <span class="hljs-keyword">const</span> setter = <span class="hljs-keyword">function</span>(<span class="hljs-params">newValue</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Setting value of property <span class="hljs-subst">$&#123;name&#125;</span>`</span>);<br>    value = newValue;<br>  &#125;;<br><br>  <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(target, name, &#123;<br>    <span class="hljs-attr">get</span>: getter,<br>    <span class="hljs-attr">set</span>: setter,<br>    <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span><br>  &#125;);<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span> &#123;<br>  @log<br>  myProperty;<br>&#125;<br><br><span class="hljs-keyword">const</span> myObj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyClass</span>();<br>myObj.<span class="hljs-property">myProperty</span> = <span class="hljs-number">123</span>;<br><span class="hljs-keyword">const</span> value = myObj.<span class="hljs-property">myProperty</span>;<br></code></pre></td></tr></table></figure><p>在上面的示例中，我们定义了一个名为<code>log</code>的修饰器函数。该修饰器函数接收两个参数，分别是<code>target</code>（类的原型或构造函数）和<code>name</code>（属性名）。在修饰器函数内部，我们定义了一个名为<code>getter</code>的函数，用于获取属性值，并在获取属性值时打印日志信息。我们还定义了一个名为<code>setter</code>的函数，用于设置属性值，并在设置属性值时打印日志信息。最后，我们使用<code>Object.defineProperty</code>方法将修饰后的属性定义到类的原型上。</p><h2 id="6-参数修饰器"><a href="#6-参数修饰器" class="headerlink" title="6. 参数修饰器"></a>6. 参数修饰器</h2><h3 id="应用场景-3"><a href="#应用场景-3" class="headerlink" title="应用场景"></a>应用场景</h3><p>参数修饰器用于修改方法的参数行为。它可以在方法参数声明之前应用，以修改参数的特性和行为。</p><p>常见的应用场景包括：</p><ul><li><strong>验证和授权</strong>：对方法的参数进行验证和授权操作。</li><li><strong>日志记录</strong>：在方法执行前后记录参数信息。</li><li><strong>参数转换</strong>：对方法的参数进行类型转换或格式化操作。</li></ul><h3 id="示例代码-3"><a href="#示例代码-3" class="headerlink" title="示例代码"></a>示例代码</h3><p>下面是一个使用参数修饰器实现参数验证的示例：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">validate</span>(<span class="hljs-params">target, name, index, validator</span>) &#123;<br>  <span class="hljs-keyword">const</span> originalMethod = target[name];<br><br>  target[name] = <span class="hljs-keyword">function</span>(<span class="hljs-params">...args</span>) &#123;<br>    <span class="hljs-keyword">const</span> value = args[index];<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">validator</span>(value)) &#123;<br>      <span class="hljs-keyword">return</span> originalMethod.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`Invalid value for parameter <span class="hljs-subst">$&#123;index&#125;</span> of method <span class="hljs-subst">$&#123;name&#125;</span>`</span>);<br>    &#125;<br>  &#125;;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span> &#123;<br>  <span class="hljs-title function_">myMethod</span>(<span class="hljs-params">@validate isNumber</span>) &#123;<br>    <span class="hljs-comment">// 代码逻辑</span><br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">isNumber</span>(<span class="hljs-params">value</span>) &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> value === <span class="hljs-string">&quot;number&quot;</span>;<br>&#125;<br><br><span class="hljs-keyword">const</span> myObj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyClass</span>();<br>myObj.<span class="hljs-title function_">myMethod</span>(<span class="hljs-number">123</span>);<br></code></pre></td></tr></table></figure><p>在上面的示例中，我们定义了一个名为<code>validate</code>的修饰器函数。该修饰器函数接收四个参数，分别是<code>target</code>（类的原型或构造函数）、<code>name</code>（方法名）、<code>index</code>（参数索引）和<code>validator</code>（验证函数）。在修饰器函数内部，我们获取原始方法并将其保存到<code>originalMethod</code>中。然后，我们修改<code>target[name]</code>，将其替换为一个新的函数，该函数在执行原始方法之前对指定参数进行验证。如果参数通过验证，就继续执行原始方法；否则，抛出一个错误</p><p>。最后，我们使用<code>@validate</code>修饰器应用参数验证。</p><h2 id="7-修饰器组合和执行顺序"><a href="#7-修饰器组合和执行顺序" class="headerlink" title="7. 修饰器组合和执行顺序"></a>7. 修饰器组合和执行顺序</h2><p>可以通过组合多个修饰器来实现更复杂的功能。修饰器的执行顺序从上到下，从右到左。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">log</span>(<span class="hljs-params">target, name, descriptor</span>) &#123;<br>  <span class="hljs-comment">// 日志记录逻辑</span><br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">validate</span>(<span class="hljs-params">target, name, index, validator</span>) &#123;<br>  <span class="hljs-comment">// 参数验证逻辑</span><br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span> &#123;<br>  @log<br>  @<span class="hljs-title function_">validate</span>(isNumber)<br>  <span class="hljs-title function_">myMethod</span>(<span class="hljs-params">@validate(isString) param1, @validate(isBoolean) param2</span>) &#123;<br>    <span class="hljs-comment">// 代码逻辑</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>在上面的示例中，我们通过使用<code>@log</code>修饰器和<code>@validate</code>修饰器组合，为类的方法和参数添加日志记录和验证功能。修饰器的执行顺序是从上到下，从右到左。</p><h2 id="8-常用修饰器库和工具"><a href="#8-常用修饰器库和工具" class="headerlink" title="8. 常用修饰器库和工具"></a>8. 常用修饰器库和工具</h2><p>除了原生的修饰器语法，还有许多优秀的修饰器库和工具可供使用。一些常见的库和工具包括：</p><ul><li><strong>core-decorators</strong>：提供了一组常用的修饰器，如<code>@readonly</code>、<code>@debounce</code>、<code>@throttle</code>等。<a href="https://github.com/jayphelps/core-decorators">GitHub 地址open in new window</a></li><li><strong>lodash-decorators</strong>：基于Lodash库的修饰器集合，提供了许多实用的修饰器。<a href="https://github.com/steelsojka/lodash-decorators">GitHub 地址open in new window</a></li><li><strong>mobx</strong>：流行的状态管理库MobX使用修饰器来实现响应式数据和自动触发更新。<a href="https://mobx.js.org/README.html">官方文档open in new window</a></li><li><strong>nestjs</strong>：基于Node.js的框架NestJS使用修饰器来实现依赖注入、路由定义等功能。<a href="https://docs.nestjs.com/">官方文档open in new window</a></li></ul><h2 id="9-结论"><a href="#9-结论" class="headerlink" title="9. 结论"></a>9. 结论</h2><p>JavaScript修饰器是一种强大的语法，它能够简化代码、增强功能，并提高代码的可维护性和可扩展性。通过使用修饰器，我们可以轻松地实现日志记录、验证和授权、性能分析等常见的功能，同时保持代码的整洁和可读性。修饰器在许多库和框架中得到了广泛的应用，为开发者提供了更好的开发体验和工具支持。</p><h1 id="MutationObserver"><a href="#MutationObserver" class="headerlink" title="MutationObserver"></a>MutationObserver</h1><h2 id="引言-3"><a href="#引言-3" class="headerlink" title="引言"></a>引言</h2><p>在Web开发中，操作和监测DOM元素的变化是一项常见的任务。MutationObserver是JavaScript提供的一个强大的API，用于异步监测DOM树的变化，并在发生变化时执行相应的操作。本文将详细介绍MutationObserver的属性、应用场景以及使用示例，帮助读者充分理解和应用这一强大的工具。</p><h2 id="MutationObserver简介"><a href="#MutationObserver简介" class="headerlink" title="MutationObserver简介"></a>MutationObserver简介</h2><p>MutationObserver是一个JavaScript的API，用于监测DOM树的变化。它提供了一种异步的方式来监听DOM元素的增加、删除、属性变化等操作，以及文本节点的修改。通过MutationObserver，开发者可以实时地捕捉到DOM的变化，并做出相应的响应。</p><p>MutationObserver是在2012年引入的，目前被广泛支持的浏览器（包括Chrome、Firefox、Safari、Edge等）都提供了对MutationObserver的支持。</p><h2 id="MutationObserver的属性"><a href="#MutationObserver的属性" class="headerlink" title="MutationObserver的属性"></a>MutationObserver的属性</h2><p>MutationObserver提供了一些属性，用于配置和控制观察器的行为。下面是一些常用的属性：</p><ul><li><strong>attributes</strong>：是否监测元素的属性变化。</li><li><strong>attributeOldValue</strong>：是否在属性变化时记录旧值。</li><li><strong>attributeFilter</strong>：指定要监测的属性列表。</li><li><strong>childList</strong>：是否监测子元素的添加或移除。</li><li><strong>subtree</strong>：是否监测后代元素的变化。</li><li><strong>characterData</strong>：是否监测文本节点的内容变化。</li><li><strong>characterDataOldValue</strong>：是否在文本节点内容变化时记录旧值。</li></ul><p>通过这些属性，可以灵活地配置MutationObserver的观察行为，以满足不同的需求。</p><h2 id="MutationObserver的应用场景"><a href="#MutationObserver的应用场景" class="headerlink" title="MutationObserver的应用场景"></a>MutationObserver的应用场景</h2><p>MutationObserver在许多场景下都能发挥重要作用。下面是一些常见的应用场景：</p><h3 id="动态内容加载"><a href="#动态内容加载" class="headerlink" title="动态内容加载"></a>动态内容加载</h3><p>当页面中的内容是通过异步加载或动态生成时，可以使用MutationObserver来监测内容的变化，并在变化发生后进行相应的处理，如更新页面布局、添加事件监听器等。例如，在无限滚动加载的场景中，当新的内容被加载到页面时，可以使用MutationObserver来自动监听内容的变化，并在变化发生后动态添加相应的元素或事件。</p><h3 id="表单验证"><a href="#表单验证" class="headerlink" title="表单验证"></a>表单验证</h3><p>当需要实时验证用户输入时，可以使用MutationObserver来监测表单元素的变化，以及对应的属性变化，如值的变化、禁用状态的变化等。这样可以及时地对用户的输入进行验证和反馈。例如，在一个表单中，当用户输入时，可以使用MutationObserver来监测输入框的值变化，并在值变化后进行实时的表单验证。</p><h3 id="响应式布局"><a href="#响应式布局" class="headerlink" title="响应式布局"></a>响应式布局</h3><p>当页面布局需要根据DOM变化自适应调整时，可以使用MutationObserver来监测相关元素的变化，并根据变化动态地调整页面布局。例如，在响应式网页设计中，当窗口大小发生变化或元素被添加或移除时，可以使用MutationObserver来监听相关元素的变化，并根据变化重新计算和调整页面布局，以适应不同的设备和屏幕尺寸。</p><h3 id="自定义组件开发"><a href="#自定义组件开发" class="headerlink" title="自定义组件开发"></a>自定义组件开发</h3><p>在自定义组件的开发中，MutationObserver可以用于监听组件内部的DOM变化，以及对应的属性变化。这样可以在组件内部做出相应的处理，如更新组件的状态、重新渲染组件等。例如，当一个自定义组件中的某个子元素被添加或移除时，可以使用MutationObserver来监听这些变化，并在变化发生后更新组件的状态或重新渲染组件。</p><h2 id="使用MutationObserver的示例"><a href="#使用MutationObserver的示例" class="headerlink" title="使用MutationObserver的示例"></a>使用MutationObserver的示例</h2><p>下面通过几个示例来演示如何使用MutationObserver进行DOM变化的监测。</p><h3 id="监测元素属性变化"><a href="#监测元素属性变化" class="headerlink" title="监测元素属性变化"></a>监测元素属性变化</h3><p>下面的示例代码演示了如何使用MutationObserver监测元素的属性变化，并在变化发生后进行相应的处理：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 目标元素</span><br><span class="hljs-keyword">const</span> targetElement = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#target&#x27;</span>);<br><br><span class="hljs-comment">// 创建一个MutationObserver实例</span><br><span class="hljs-keyword">const</span> observer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutationObserver</span>(<span class="hljs-function">(<span class="hljs-params">mutations</span>) =&gt;</span> &#123;<br>  mutations.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">mutation</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">if</span> (mutation.<span class="hljs-property">type</span> === <span class="hljs-string">&#x27;attributes&#x27;</span>) &#123;<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`属性 <span class="hljs-subst">$&#123;mutation.attributeName&#125;</span> 发生变化`</span>);<br>      <span class="hljs-comment">// 执行相应的处理逻辑</span><br>    &#125;<br>  &#125;);<br>&#125;);<br><br><span class="hljs-comment">// 配置观察器</span><br><span class="hljs-keyword">const</span> config = &#123;<br>  <span class="hljs-attr">attributes</span>: <span class="hljs-literal">true</span>,<br>&#125;;<br><br><span class="hljs-comment">// 启动观察器</span><br>observer.<span class="hljs-title function_">observe</span>(targetElement, config);<br></code></pre></td></tr></table></figure><p>在上述代码中，我们首先选择了一个目标元素，然后创建了一个MutationObserver实例。接下来，我们配置了观察器，指定我们要监测的变化类型为属性变化。最后，我们通过调用<code>observe</code>方法，将观察器绑定到目标元素上。</p><p>当目标元素的属性发生变化时，MutationObserver的回调函数将被调用，并传递一个<code>mutations</code>参数，该参数包含了所有发生的变化。在回调函数中，我们可以根据变化的类型（<code>mutation.type</code>）来判断具体的变化类型，并执行相应的处理逻辑。</p><h3 id="监测子元素的添加或移除"><a href="#监测子元素的添加或移除" class="headerlink" title="监测子元素的添加或移除"></a>监测子元素的添加或移除</h3><p>下面的示例代码演示了如何使用MutationObserver监测子元素的添加或移除，并在变化发生后进行相应的处理：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 目标元素</span><br><span class="hljs-keyword">const</span> targetElement = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#target&#x27;</span>);<br><br><span class="hljs-comment">// 创建一个MutationObserver实例</span><br><span class="hljs-keyword">const</span> observer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutationObserver</span>(<span class="hljs-function">(<span class="hljs-params">mutations</span>) =&gt;</span> &#123;<br>  mutations.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">mutation</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">if</span> (mutation.<span class="hljs-property">type</span> === <span class="hljs-string">&#x27;childList&#x27;</span>) &#123;<br>     <br><br> mutation.<span class="hljs-property">addedNodes</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">addedNode</span>) =&gt;</span> &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`添加了子元素：<span class="hljs-subst">$&#123;addedNode.nodeName&#125;</span>`</span>);<br>        <span class="hljs-comment">// 执行相应的处理逻辑</span><br>      &#125;);<br><br>      mutation.<span class="hljs-property">removedNodes</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">removedNode</span>) =&gt;</span> &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`移除了子元素：<span class="hljs-subst">$&#123;removedNode.nodeName&#125;</span>`</span>);<br>        <span class="hljs-comment">// 执行相应的处理逻辑</span><br>      &#125;);<br>    &#125;<br>  &#125;);<br>&#125;);<br><br><span class="hljs-comment">// 配置观察器</span><br><span class="hljs-keyword">const</span> config = &#123;<br>  <span class="hljs-attr">childList</span>: <span class="hljs-literal">true</span>,<br>&#125;;<br><br><span class="hljs-comment">// 启动观察器</span><br>observer.<span class="hljs-title function_">observe</span>(targetElement, config);<br></code></pre></td></tr></table></figure><p>在上述代码中，我们创建了一个MutationObserver实例，并将观察器配置为监测子元素的添加或移除。当目标元素的子元素发生添加或移除操作时，MutationObserver的回调函数将被调用，并传递一个<code>mutations</code>参数，该参数包含了所有发生的变化。在回调函数中，我们可以根据变化的类型（<code>mutation.type</code>）为<code>childList</code>来判断子元素的添加或移除操作，并执行相应的处理逻辑。</p><h3 id="监测文本节点的内容变化"><a href="#监测文本节点的内容变化" class="headerlink" title="监测文本节点的内容变化"></a>监测文本节点的内容变化</h3><p>下面的示例代码演示了如何使用MutationObserver监测文本节点的内容变化，并在变化发生后进行相应的处理：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 目标元素</span><br><span class="hljs-keyword">const</span> targetElement = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#target&#x27;</span>);<br><br><span class="hljs-comment">// 创建一个MutationObserver实例</span><br><span class="hljs-keyword">const</span> observer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutationObserver</span>(<span class="hljs-function">(<span class="hljs-params">mutations</span>) =&gt;</span> &#123;<br>  mutations.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">mutation</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">if</span> (mutation.<span class="hljs-property">type</span> === <span class="hljs-string">&#x27;characterData&#x27;</span>) &#123;<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`文本节点内容发生变化：<span class="hljs-subst">$&#123;mutation.target.nodeValue&#125;</span>`</span>);<br>      <span class="hljs-comment">// 执行相应的处理逻辑</span><br>    &#125;<br>  &#125;);<br>&#125;);<br><br><span class="hljs-comment">// 配置观察器</span><br><span class="hljs-keyword">const</span> config = &#123;<br>  <span class="hljs-attr">characterData</span>: <span class="hljs-literal">true</span>,<br>&#125;;<br><br><span class="hljs-comment">// 启动观察器</span><br>observer.<span class="hljs-title function_">observe</span>(targetElement, config);<br></code></pre></td></tr></table></figure><p>在上述代码中，我们创建了一个MutationObserver实例，并将观察器配置为监测文本节点的内容变化。当目标元素的文本节点的内容发生变化时，MutationObserver的回调函数将被调用，并传递一个<code>mutations</code>参数，该参数包含了所有发生的变化。在回调函数中，我们可以根据变化的类型（<code>mutation.type</code>）为<code>characterData</code>来判断文本节点的内容变化，并执行相应的处理逻辑。</p><h2 id="MutationObserver的浏览器兼容性"><a href="#MutationObserver的浏览器兼容性" class="headerlink" title="MutationObserver的浏览器兼容性"></a>MutationObserver的浏览器兼容性</h2><p>MutationObserver已经在大多数现代浏览器中得到支持，包括Chrome、Firefox、Safari、Edge等。然而，考虑到一些老旧的浏览器版本，建议在使用MutationObserver之前，检查浏览器的兼容性。</p><p>可以通过以下链接查看MutationObserver的浏览器兼容性信息：</p><ul><li><a href="https://caniuse.com/?search=MutationObserver">Can I use MutationObserver?open in new window</a></li></ul><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>MutationObserver是一个强大的工具，用于监测DOM树的变化。通过MutationObserver，我们可以异步地监听DOM元素的增加、删除、属性变化等操作，并在发生变化时执行相应的操作。它在动态内容加载、表单验证、响应式布局、自定义组件开发等场景下发挥重要作用。本文介绍了MutationObserver的属性、应用场景以及使用示例，</p><h1 id="requestAnimationFrame"><a href="#requestAnimationFrame" class="headerlink" title="requestAnimationFrame"></a>requestAnimationFrame</h1><h2 id="引言-4"><a href="#引言-4" class="headerlink" title="引言"></a>引言</h2><p>在Web开发中，实现平滑且高性能的动画和渲染是一个关键的需求。而requestAnimationFrame是浏览器提供的一个用于优化动画和渲染的API。它可以协调浏览器的刷新率，帮助开发者实现流畅的动画效果，并提供更高效的渲染方式。本文将详细介绍requestAnimationFrame的属性、应用场景以及使用示例，帮助读者深入理解和应用这一强大的工具。</p><h2 id="requestAnimationFrame简介"><a href="#requestAnimationFrame简介" class="headerlink" title="requestAnimationFrame简介"></a>requestAnimationFrame简介</h2><p>requestAnimationFrame是浏览器提供的一个用于优化动画和渲染的API。它基于浏览器的刷新率，调度回调函数的执行，以确保动画和渲染的流畅性和高性能。</p><p>使用requestAnimationFrame，开发者可以在每个浏览器刷新帧之前请求执行一个函数。浏览器会在适当的时机调用这个函数，以保证动画和渲染的协调性。通过与浏览器的合作，requestAnimationFrame可以避免不必要的渲染操作，并确保动画的效果更加平滑。</p><p>requestAnimationFrame在现代浏览器中得到广泛支持，并成为实现高性能动画和渲染的首选方式。</p><h2 id="requestAnimationFrame的属性"><a href="#requestAnimationFrame的属性" class="headerlink" title="requestAnimationFrame的属性"></a>requestAnimationFrame的属性</h2><p>requestAnimationFrame提供了一些属性，用于控制和管理动画和渲染的执行。下面是一些常用的属性：</p><ul><li><strong>callback</strong>：一个函数，表示要在下一次浏览器刷新帧之前执行的回调函数。</li><li><strong>id</strong>：一个整数，表示回调函数的唯一标识符。可以用于取消回调函数的执行。</li></ul><p>通过这些属性，开发者可以精确地控制和管理动画和渲染的执行过程。</p><h2 id="requestAnimationFrame的应用场景"><a href="#requestAnimationFrame的应用场景" class="headerlink" title="requestAnimationFrame的应用场景"></a>requestAnimationFrame的应用场景</h2><p>requestAnimationFrame在许多场景下都能发挥重要作用。下面是一些常见的应用场景：</p><h3 id="动画效果"><a href="#动画效果" class="headerlink" title="动画效果"></a>动画效果</h3><p>当需要实现平滑的动画效果时，requestAnimationFrame是一个理想的选择。通过使用requestAnimationFrame，可以在每个浏览器刷新帧之前更新动画的状态，并在合适的时机进行渲染。这样可以确保动画的流畅性，并减少不必要的渲染操作。例如，实现平滑的过渡效果、动态的图表展示等都可以使用requestAnimationFrame来实现。</p><h3 id="游戏开发"><a href="#游戏开发" class="headerlink" title="游戏开发"></a>游戏开发</h3><p>在游戏开发中，高性能和流畅的渲染是至关重要的。requestAnimationFrame提供了一种高效的渲染方式，可以与游戏引</p><p>擎配合使用，实现流畅的游戏画面和良好的用户体验。通过在每个浏览器刷新帧之前更新游戏的状态并进行渲染，可以实现高性能的游戏效果。例如，实时的射击游戏、跑酷游戏等都可以使用requestAnimationFrame来实现。</p><h3 id="数据可视化"><a href="#数据可视化" class="headerlink" title="数据可视化"></a>数据可视化</h3><p>在数据可视化的场景中，展示大量的数据并实时更新是一项挑战。使用requestAnimationFrame，可以在每个浏览器刷新帧之前更新数据的可视化状态，并进行相应的渲染。这样可以实现高效的数据可视化，并保持良好的性能和交互性。例如，绘制实时图表、展示动态地图等都可以使用requestAnimationFrame来实现。</p><h3 id="UI动效"><a href="#UI动效" class="headerlink" title="UI动效"></a>UI动效</h3><p>在网页开发中，为用户提供吸引人的UI动效是一种常见的需求。使用requestAnimationFrame，可以实现各种各样的UI动效，如平滑的滚动效果、渐变动画、拖拽效果等。通过在每个浏览器刷新帧之前更新UI状态并进行渲染，可以实现流畅和高性能的UI动效。</p><h2 id="使用requestAnimationFrame的示例"><a href="#使用requestAnimationFrame的示例" class="headerlink" title="使用requestAnimationFrame的示例"></a>使用requestAnimationFrame的示例</h2><p>下面通过几个示例来演示如何使用requestAnimationFrame来实现动画和渲染效果。</p><h3 id="实现平滑的滚动效果"><a href="#实现平滑的滚动效果" class="headerlink" title="实现平滑的滚动效果"></a>实现平滑的滚动效果</h3><p>下面的示例代码演示了如何使用requestAnimationFrame实现平滑的滚动效果：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">smoothScrollTo</span>(<span class="hljs-params">targetY, duration</span>) &#123;<br>  <span class="hljs-keyword">const</span> startY = <span class="hljs-variable language_">window</span>.<span class="hljs-property">pageYOffset</span>;<br>  <span class="hljs-keyword">const</span> distance = targetY - startY;<br>  <span class="hljs-keyword">const</span> startTime = performance.<span class="hljs-title function_">now</span>();<br><br>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">step</span>(<span class="hljs-params">currentTime</span>) &#123;<br>    <span class="hljs-keyword">const</span> elapsedTime = currentTime - startTime;<br>    <span class="hljs-keyword">const</span> progress = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(elapsedTime / duration, <span class="hljs-number">1</span>);<br>    <span class="hljs-keyword">const</span> ease = <span class="hljs-title function_">easingFunction</span>(progress);<br>    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">scrollTo</span>(<span class="hljs-number">0</span>, startY + distance * ease);<br><br>    <span class="hljs-keyword">if</span> (elapsedTime &lt; duration) &#123;<br>      <span class="hljs-title function_">requestAnimationFrame</span>(step);<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-title function_">requestAnimationFrame</span>(step);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">easingFunction</span>(<span class="hljs-params">t</span>) &#123;<br>  <span class="hljs-keyword">return</span> t * t * t;<br>&#125;<br><br><span class="hljs-comment">// 使用示例</span><br><span class="hljs-keyword">const</span> button = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#scrollButton&#x27;</span>);<br>button.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-title function_">smoothScrollTo</span>(<span class="hljs-number">1000</span>, <span class="hljs-number">1000</span>);<br>&#125;);<br></code></pre></td></tr></table></figure><p>在上述代码中，我们定义了一个<code>smoothScrollTo</code>函数，用于实现平滑的滚动效果。该函数接收目标位置<code>targetY</code>和滚动的持续时间<code>duration</code>作为参数。在函数内部，我们获取当前的滚动位置<code>startY</code>和目标位置与起始位置之间的距离<code>distance</code>。然后，我们使用<code>performance.now()</code>获取当前的时间戳<code>startTime</code>，并定义一个<code>step</code>函数用于更新滚动位置。在<code>step</code>函数中，我们根据时间的流逝计算出进度<code>progress</code>，并使用缓动函数<code>easingFunction</code>来调整进度。最后，我们使用</p><p><code>requestAnimationFrame</code>调度<code>step</code>函数的执行，并在滚动动画完成之前不断更新滚动位置。</p><h3 id="实现粒子动画效果"><a href="#实现粒子动画效果" class="headerlink" title="实现粒子动画效果"></a>实现粒子动画效果</h3><p>下面的示例代码演示了如何使用requestAnimationFrame实现粒子动画效果：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#canvas&#x27;</span>);<br><span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&#x27;2d&#x27;</span>);<br><br><span class="hljs-keyword">const</span> particles = [];<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Particle</span>(<span class="hljs-params">x, y, speedX, speedY, radius, color</span>) &#123;<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span> = x;<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span> = y;<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">speedX</span> = speedX;<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">speedY</span> = speedY;<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">radius</span> = radius;<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color;<br>&#125;<br><br><span class="hljs-title class_">Particle</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">update</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span> += <span class="hljs-variable language_">this</span>.<span class="hljs-property">speedX</span>;<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span> += <span class="hljs-variable language_">this</span>.<span class="hljs-property">speedY</span>;<br><br>  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">radius</span> &lt; <span class="hljs-number">0</span> || <span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span> - <span class="hljs-variable language_">this</span>.<span class="hljs-property">radius</span> &gt; canvas.<span class="hljs-property">width</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">speedX</span> = -<span class="hljs-variable language_">this</span>.<span class="hljs-property">speedX</span>;<br>  &#125;<br><br>  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">radius</span> &lt; <span class="hljs-number">0</span> || <span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span> - <span class="hljs-variable language_">this</span>.<span class="hljs-property">radius</span> &gt; canvas.<span class="hljs-property">height</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">speedY</span> = -<span class="hljs-variable language_">this</span>.<span class="hljs-property">speedY</span>;<br>  &#125;<br>&#125;;<br><br><span class="hljs-title class_">Particle</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">draw</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>  ctx.<span class="hljs-title function_">beginPath</span>();<br>  ctx.<span class="hljs-title function_">arc</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">radius</span>, <span class="hljs-number">0</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> * <span class="hljs-number">2</span>, <span class="hljs-literal">false</span>);<br>  ctx.<span class="hljs-property">fillStyle</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span>;<br>  ctx.<span class="hljs-title function_">fill</span>();<br>  ctx.<span class="hljs-title function_">closePath</span>();<br>&#125;;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">createParticles</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) &#123;<br>    <span class="hljs-keyword">const</span> x = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * canvas.<span class="hljs-property">width</span>;<br>    <span class="hljs-keyword">const</span> y = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * canvas.<span class="hljs-property">height</span>;<br>    <span class="hljs-keyword">const</span> speedX = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">4</span> - <span class="hljs-number">2</span>;<br>    <span class="hljs-keyword">const</span> speedY = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">4</span> - <span class="hljs-number">2</span>;<br>    <span class="hljs-keyword">const</span> radius = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">5</span> + <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">const</span> color = <span class="hljs-title function_">getRandomColor</span>();<br><br>    particles.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Particle</span>(x, y, speedX, speedY, radius, color));<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">updateParticles</span>(<span class="hljs-params"></span>) &#123;<br>  particles.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">particle</span>) =&gt;</span> &#123;<br>    particle.<span class="hljs-title function_">update</span>();<br>  &#125;);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">drawParticles</span>(<span class="hljs-params"></span>) &#123;<br>  ctx.<span class="hljs-title function_">clearRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, canvas.<span class="hljs-property">width</span>, canvas.<span class="hljs-property">height</span>);<br><br>  particles.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">particle</span>) =&gt;</span> &#123;<br>    particle.<span class="hljs-title function_">draw</span>();<br>  &#125;);<br><br>  <span class="hljs-title function_">requestAnimationFrame</span>(drawParticles);<br>&#125;<br><br><span class="hljs-comment">// 使用示例</span><br><span class="hljs-title function_">createParticles</span>();<br><span class="hljs-title function_">drawParticles</span>();<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">getRandomColor</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">const</span> letters = <span class="hljs-string">&#x27;0123456789ABCDEF&#x27;</span>;<br>  <span class="hljs-keyword">let</span> color = <span class="hljs-string">&#x27;#&#x27;</span>;<br><br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">6</span>; i++) &#123;<br>    color += letters[<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">16</span>)];<br>  &#125;<br><br>  <span class="hljs-keyword">return</span> color;<br>&#125;<br></code></pre></td></tr></table></figure><p>在上述代码中，我们定义了一个<code>Particle</code>构造函数，用于创建粒子对象。粒子对象包含位置坐标<code>x</code>和<code>y</code>、速度<code>speedX</code>和<code>speedY</code>、半径<code>radius</code>和颜色<code>color</code>等属性。我们还为<code>Particle</code>对象添加了<code>update</code>方法和<code>draw</code>方法，用于更新粒子的位置和绘制粒子的图形。</p><p>我们还定义了<code>createParticles</code>函数，用于创建一定数量的粒子，并随机生成它们的初始位置、速度、半径和颜色。在<code>drawParticles</code>函数中，我们使用<code>requestAnimationFrame</code>调度<code>drawParticles</code>函数的执行，并在每一帧清空画布、更新粒子的位置和绘制粒子的图形。</p><p>通过上述示例，我们可以看到使用requestAnimationFrame可以轻松实现平滑的动画效果和高性能的渲染。</p><h2 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h2><p>requestAnimationFrame是浏览器提供的用于优化动画和渲染的API，它通过与浏览器的合作，协调刷新率并在合适的时机执行回调函数，从而实现流畅的动画效果和高性能的渲染。</p><p>本文详细介绍了requestAnimationFrame的属性、应用场景以及使用示例。通过使用requestAnimationFrame，开发者可以实现平滑的滚动效果、高性能的游戏渲染、复杂的数据可视化和吸引人的UI动效等。同时，本文提供了几个示例代码，帮助读者更好地理解和应用requestAnimationFrame。</p><p>请记住，使用requestAnimationFrame时应注意避免过度使用和滥用，以免对浏览器性能造成负面影响。合理利用requestAnimationFrame，结合适当的优化和控制，能够提供更好的用户体验和更高效的渲染方式。</p><h1 id="Performance"><a href="#Performance" class="headerlink" title="Performance"></a>Performance</h1><h2 id="引言-5"><a href="#引言-5" class="headerlink" title="引言"></a>引言</h2><p>在现代 Web 开发中，性能优化是一个关键的方面。用户期望快速加载的网页，而慢速的加载和响应时间可能导致用户流失和不良的用户体验。为了满足用户的需求，我们需要准确地测量和分析网页的性能，并采取相应的优化措施。</p><p>Performance API 是浏览器提供的一组接口，可以让开发者测量和监控网页的性能表现。它提供了丰富的属性和方法，可以帮助我们了解网页加载的时间、资源的使用情况、代码执行的性能等关键指标。本文将详细介绍 Performance API 的属性和 API，探讨其应用场景，并提供相关的代码示例和引用资料链接。</p><h2 id="1-Performance-API-简介"><a href="#1-Performance-API-简介" class="headerlink" title="1. Performance API 简介"></a>1. Performance API 简介</h2><p>Performance API 是 Web API 的一部分，旨在提供与浏览器性能相关的信息和指标。它通过提供一组属性和方法，使开发者能够测量和分析网页的性能，以便进行性能优化。</p><p>Performance API 的核心对象是 <code>performance</code>，它代表了网页的性能信息。通过 <code>performance</code> 对象，我们可以访问各种性能指标、测量和记录时间戳、计算代码执行时间等。</p><ul><li><code>navigation</code>：提供了与导航相关的性能指标，如页面加载时间、重定向次数、响应时间等。</li><li><code>timing</code>：提供了与页面加载和资源加载相关的性能指标，如 DNS 查询时间、TCP 连接时间、DOM 解析时间等。</li><li><code>memory</code>：提供了与内存使用情况相关的性能指标，如内存限制、已使用内存、垃圾回收次数等。</li><li><code>navigationTiming</code>：提供了更详细的页面加载时间指标，如重定向时间、解析 DOM 树时间、首次渲染时间等。</li></ul><p>Performance API 还提供了一些方法，用于测量和记录时间戳、添加标记、计算代码执行时间等。</p><h2 id="2-Performance-API-属性和-API"><a href="#2-Performance-API-属性和-API" class="headerlink" title="2. Performance API 属性和 API"></a>2. Performance API 属性和 API</h2><h3 id="2-1-navigation"><a href="#2-1-navigation" class="headerlink" title="2.1 navigation"></a>2.1 navigation</h3><p><code>performance.navigation</code> 属性提供了与导航相关的性能指标，可以帮助我们了解页面的加载时间、重定向次数、响应时间等。</p><ul><li><code>performance.navigation.type</code>：表示导航类型，如新页面加载、页面刷新、页面后退等。</li><li><code>performance.navigation.redirectCount</code>：表示页面重定向的次数。</li></ul><p>这些 navigation 属性可以用于分析页面的导航行为和性能表现。</p><p><strong>示例代码：</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`导航类型: <span class="hljs-subst">$&#123;performance.navigation.type&#125;</span>`</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`重定向次数: <span class="hljs-subst">$&#123;performance.navigation.redirectCount&#125;</span>`</span>);<br></code></pre></td></tr></table></figure><h3 id="2-2-timing"><a href="#2-2-timing" class="headerlink" title="2.2 timing"></a>2.2 timing</h3><p><code>performance.timing</code> 属性提供了与页面加载和资源加载相关的性能指标，可以帮助我们了解页面加载的各个阶段所花费的时间。</p><ul><li><code>performance.timing.navigationStart</code>：表示页面开始导航的时间。</li><li><code>performance.timing.fetchStart</code>：表示开始获取页面资源的时间。</li><li><code>performance.timing.domContentLoadedEventStart</code>：表示 DOMContentLoaded 事件开始的时间。</li><li><code>performance.timing.loadEventStart</code>：表示 load 事件开始的时间。</li></ul><p>这些 timing 属性可以用于分析页面的加载性能，找出加载过程中的瓶颈。</p><p><strong>示例代码：</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`导航开始时间: <span class="hljs-subst">$&#123;performance.timing.navigationStart&#125;</span>`</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`资源获取开始时间: <span class="hljs-subst">$&#123;performance.timing.fetchStart&#125;</span>`</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`DOMContentLoaded 事件开始时间: <span class="hljs-subst">$&#123;performance.timing.domContentLoadedEventStart&#125;</span>`</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`load 事件开始时间: <span class="hljs-subst">$&#123;performance.timing.loadEventStart&#125;</span>`</span>);<br></code></pre></td></tr></table></figure><h3 id="2-3-memory"><a href="#2-3-memory" class="headerlink" title="2.3 memory"></a>2.3 memory</h3><p><code>performance.memory</code> 属性提供了与内存使用情况相关的性能指标，可以帮助我们了解页面的内存限制、已使用内存、垃圾回收次数等信息。</p><ul><li><code>performance.memory.jsHeapSizeLimit</code>：表示 JavaScript 堆的大小限制。</li><li><code>performance.memory.usedJSHeapSize</code>：表示已使用的 JavaScript 堆大小。</li><li><code>performance.memory.totalJSHeapSize</code>：表示 JavaScript 堆的总大小。</li></ul><p>这些 memory 属性可以用于监控页面的内存使用情况，及时发现内存泄漏或过度使用内存的问题。</p><p><strong>示例代码：</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`JavaScript 堆大小限制: <span class="hljs-subst">$&#123;performance.memory.jsHeapSizeLimit&#125;</span>`</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`已使用的 JavaScript 堆大小: <span class="hljs-subst">$&#123;performance.memory.usedJSHeapSize&#125;</span>`</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`JavaScript 堆的总大小: <span class="hljs-subst">$&#123;performance.memory.totalJSHeapSize&#125;</span>`</span>);<br></code></pre></td></tr></table></figure><h3 id="2-4-navigationTiming"><a href="#2-4-navigationTiming" class="headerlink" title="2.4 navigationTiming"></a>2.4 navigationTiming</h3><p><code>performance.getEntriesByType(&#39;navigation&#39;)</code> 方法返回与页面加载时间相关的详细信息，提供了更详细的页面加载时间指标，如重定向时间、解析 DOM 树时间、首次渲染时间等。</p><ul><li><code>navigationTiming.redirectTime</code>：表示重定向时间。</li><li><code>navigationTiming.domInteractiveTime</code>：表示 DOM 解析完成的时间。</li><li><code>navigationTiming.domContentLoadedTime</code>：表示 DOMContentLoaded 事件触发的时间。</li><li><code>navigationTiming.loadEventTime</code>：表示 load 事件触发的时间。</li></ul><p>这些 navigationTiming 属性可以用于更细粒度地分析页面加载的各个阶段所花费的时间。</p><p><strong>示例代码：</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> entries = performance.<span class="hljs-title function_">getEntriesByType</span>(<span class="hljs-string">&#x27;navigation&#x27;</span>);<br><span class="hljs-keyword">const</span> navigationTiming = entries[<span class="hljs-number">0</span>];<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`重定向时间: <span class="hljs-subst">$&#123;navigationTiming.redirectTime&#125;</span>`</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`DOM 解析完成时间: <span class="hljs-subst">$&#123;navigationTiming.domInteractiveTime&#125;</span>`</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`DOMContentLoaded 事件触发时间: <span class="hljs-subst">$&#123;navigationTiming.domContentLoadedTime&#125;</span>`</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`load 事件触发时间: <span class="hljs-subst">$&#123;navigationTiming.loadEventTime&#125;</span>`</span>);<br></code></pre></td></tr></table></figure><h3 id="2-5-其他方法"><a href="#2-5-其他方法" class="headerlink" title="2.5 其他方法"></a>2.5 其他方法</h3><p>Performance API</p><p>还提供了一些其他方法，用于测量和记录时间戳、添加标记、计算代码执行时间等。</p><ul><li><code>performance.now()</code>：返回当前时间戳，可用于测量代码执行时间。</li><li><code>performance.mark()</code>：添加一个时间戳标记，用于记录关键时刻。</li><li><code>performance.measure()</code>：计算两个时间戳标记之间的时间间隔。</li><li><code>performance.getEntriesByName()</code>：获取指定名称的时间戳标记信息。</li></ul><p>这些方法可以帮助我们精确测量代码的执行时间和关键事件的发生时间。</p><p><strong>示例代码：</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> startTime = performance.<span class="hljs-title function_">now</span>();<br><br><span class="hljs-comment">// 执行一些耗时的操作</span><br><br><span class="hljs-keyword">const</span> endTime = performance.<span class="hljs-title function_">now</span>();<br><span class="hljs-keyword">const</span> executionTime = endTime - startTime;<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`代码执行时间: <span class="hljs-subst">$&#123;executionTime&#125;</span> 毫秒`</span>);<br><br>performance.<span class="hljs-title function_">mark</span>(<span class="hljs-string">&#x27;start&#x27;</span>);<br><span class="hljs-comment">// 执行一些操作</span><br>performance.<span class="hljs-title function_">mark</span>(<span class="hljs-string">&#x27;end&#x27;</span>);<br><br>performance.<span class="hljs-title function_">measure</span>(<span class="hljs-string">&#x27;操作耗时&#x27;</span>, <span class="hljs-string">&#x27;start&#x27;</span>, <span class="hljs-string">&#x27;end&#x27;</span>);<br><span class="hljs-keyword">const</span> measurements = performance.<span class="hljs-title function_">getEntriesByName</span>(<span class="hljs-string">&#x27;操作耗时&#x27;</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`操作耗时: <span class="hljs-subst">$&#123;measurements[<span class="hljs-number">0</span>].duration&#125;</span> 毫秒`</span>);<br></code></pre></td></tr></table></figure><h2 id="3-Performance-API-应用场景"><a href="#3-Performance-API-应用场景" class="headerlink" title="3. Performance API 应用场景"></a>3. Performance API 应用场景</h2><p>Performance API 在 Web 开发中有许多应用场景，下面是一些常见的应用场景：</p><h3 id="3-1-性能优化"><a href="#3-1-性能优化" class="headerlink" title="3.1 性能优化"></a>3.1 性能优化</h3><p>通过使用 Performance API，我们可以测量和分析网页的性能指标，如加载时间、资源使用情况、代码执行时间等。这些指标可以帮助我们了解网页的性能瓶颈，并采取相应的优化措施。例如，通过分析页面加载时间的各个阶段所花费的时间，我们可以找出加载过程中的瓶颈，并进行相应的性能优化。</p><p><strong>示例代码：</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> startTime = performance.<span class="hljs-property">timing</span>.<span class="hljs-property">navigationStart</span>;<br><span class="hljs-keyword">const</span> loadTime = performance.<span class="hljs-property">timing</span>.<span class="hljs-property">loadEventStart</span> - startTime;<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`页面加载时间: <span class="hljs-subst">$&#123;loadTime&#125;</span> 毫秒`</span>);<br></code></pre></td></tr></table></figure><h3 id="3-2-监控页面资源"><a href="#3-2-监控页面资源" class="headerlink" title="3.2 监控页面资源"></a>3.2 监控页面资源</h3><p>Performance API 可以帮助我们监控页面的资源使用情况，包括网络请求、DOM 元素和脚本执行等。通过分析资源加载时间、资源大小等指标，我们可以找出资源使用不当或过度使用资源的问题，从而进行优化。</p><p><strong>示例代码：</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> resourceEntries = performance.<span class="hljs-title function_">getEntriesByType</span>(<span class="hljs-string">&#x27;resource&#x27;</span>);<br>resourceEntries.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">entry</span>) =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`资源 URL: <span class="hljs-subst">$&#123;entry.name&#125;</span>`</span>);<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`资源加载时间: <span class="hljs-subst">$&#123;entry.duration&#125;</span> 毫秒`</span>);<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`资源大小: <span class="hljs-subst">$&#123;entry.transferSize&#125;</span> 字节`</span>);<br>&#125;);<br></code></pre></td></tr></table></figure><h3 id="3-3-监控内存使用情况"><a href="#3-3-监控内存使用情况" class="headerlink" title="3.3 监控内存使用情况"></a>3.3 监控内存使用情况</h3><p>使用 Performance API 的 memory 属性，我们可以监控页面的内存使用情况。通过了解页面的内存限制、已使用内存、垃圾回收次数等信息，我们可以及时发现内存泄漏或过度使用内存的问题，并进行优化。</p><p><strong>示例代码：</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`JavaScript 堆大小限制:</span><br><span class="hljs-string"></span><br><span class="hljs-string"> <span class="hljs-subst">$&#123;performance.memory.jsHeapSizeLimit&#125;</span>`</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`已使用的 JavaScript 堆大小: <span class="hljs-subst">$&#123;performance.memory.usedJSHeapSize&#125;</span>`</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`JavaScript 堆的总大小: <span class="hljs-subst">$&#123;performance.memory.totalJSHeapSize&#125;</span>`</span>);<br></code></pre></td></tr></table></figure><h3 id="3-4-分析代码执行时间"><a href="#3-4-分析代码执行时间" class="headerlink" title="3.4 分析代码执行时间"></a>3.4 分析代码执行时间</h3><p>通过使用 Performance API 的 now() 方法，我们可以测量代码的执行时间。这对于优化关键代码块的性能非常有帮助，可以找出代码执行中的瓶颈，从而进行优化。</p><p><strong>示例代码：</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> startTime = performance.<span class="hljs-title function_">now</span>();<br><br><span class="hljs-comment">// 执行一些耗时的操作</span><br><br><span class="hljs-keyword">const</span> endTime = performance.<span class="hljs-title function_">now</span>();<br><span class="hljs-keyword">const</span> executionTime = endTime - startTime;<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`代码执行时间: <span class="hljs-subst">$&#123;executionTime&#125;</span> 毫秒`</span>);<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>技术</category>
      
    </categories>
    
    
    <tags>
      
      <tag>js</tag>
      
      <tag>前端</tag>
      
      <tag>js执行过程</tag>
      
      <tag>作用域与作用域链、原型与原型链</tag>
      
      <tag>执行上下文与闭包</tag>
      
      <tag>闭包的作用</tag>
      
      <tag>闭包的优缺点</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>前端学习</title>
    <link href="/2024/02/20/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/"/>
    <url>/2024/02/20/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1 id="undifined、ReferenceError"><a href="#undifined、ReferenceError" class="headerlink" title="undifined、ReferenceError"></a>undifined、ReferenceError</h1><h1 id="前端路由实现方式"><a href="#前端路由实现方式" class="headerlink" title="前端路由实现方式"></a>前端路由实现方式</h1><h3 id="history"><a href="#history" class="headerlink" title="history"></a>history</h3><p>我们都知道一个URL是由很多部分组成，包括协议、域名、路径、query、hash等，比如上面的例子，我们点击不同模块的时候可能看到是这样的URL</p><ul><li>首页：yourdomain.xxx.com&#x2F;index.html&#x2F;#&#x2F;</li><li>商城：yourdomain.xxx.com&#x2F;index.html&#x2F;#&#x2F;shop</li><li>购物车：yourdomain.xxx.com&#x2F;index.html&#x2F;#&#x2F;shopping-cart</li><li>我的：yourdomain.xxx.com&#x2F;index.html&#x2F;#&#x2F;mine</li></ul><p>#号后面的，就是一个URL中关于hash的组成部分，可以看到，不同路由对应的hash是不一样的，但是它们都是在访问同一个静态资源index.html。我们要做的，就是如何能够监听到URL中关于hash部分发生的变化，从而做出对应的改变。</p><p>其实浏览器已经暴露给我们一个现成的方法<code>hashchange</code>，在hash改变的时候，触发该事件。有了监听事件，且改变hash页面并不刷新，这样我们就可以在监听事件的回调函数中，执行我们展示和隐藏不同UI显示的功能，从而实现前端路由。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span></span><br><span class="hljs-tag">      <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover&quot;</span></span><br><span class="hljs-tag">      <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span></span><br><span class="hljs-tag">    /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>实现简单的hash路由<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><br><span class="language-css">      * &#123;</span><br><span class="language-css">        <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;</span><br><span class="language-css">        <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;</span><br><span class="language-css">        <span class="hljs-attribute">box-sizing</span>: border-box;</span><br><span class="language-css">      &#125;</span><br><span class="language-css">      <span class="hljs-selector-tag">html</span>,</span><br><span class="language-css">      <span class="hljs-selector-tag">body</span> &#123;</span><br><span class="language-css">        <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;</span><br><span class="language-css">      &#125;</span><br><span class="language-css">      <span class="hljs-selector-id">#content</span> &#123;</span><br><span class="language-css">        <span class="hljs-attribute">height</span>: <span class="hljs-built_in">calc</span>(<span class="hljs-number">100vh</span> - <span class="hljs-number">50px</span>);</span><br><span class="language-css">        <span class="hljs-attribute">display</span>: flex;</span><br><span class="language-css">        <span class="hljs-attribute">align-items</span>: center;</span><br><span class="language-css">        <span class="hljs-attribute">justify-content</span>: center;</span><br><span class="language-css">        <span class="hljs-attribute">font-size</span>: <span class="hljs-number">3em</span>;</span><br><span class="language-css">      &#125;</span><br><span class="language-css">      <span class="hljs-selector-id">#nav</span> &#123;</span><br><span class="language-css">        <span class="hljs-attribute">height</span>: <span class="hljs-number">50px</span>;</span><br><span class="language-css">        <span class="hljs-attribute">position</span>: fixed;</span><br><span class="language-css">        <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;</span><br><span class="language-css">        <span class="hljs-attribute">bottom</span>: <span class="hljs-number">0</span>;</span><br><span class="language-css">        <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;</span><br><span class="language-css">        <span class="hljs-attribute">display</span>: flex;</span><br><span class="language-css">      &#125;</span><br><span class="language-css">      <span class="hljs-selector-id">#nav</span> <span class="hljs-selector-tag">a</span> &#123;</span><br><span class="language-css">        <span class="hljs-attribute">width</span>: <span class="hljs-number">25%</span>;</span><br><span class="language-css">        <span class="hljs-attribute">display</span>: flex;</span><br><span class="language-css">        <span class="hljs-attribute">justify-content</span>: center;</span><br><span class="language-css">        <span class="hljs-attribute">align-items</span>: center;</span><br><span class="language-css">        <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid black;</span><br><span class="language-css">      &#125;</span><br><span class="language-css">      <span class="hljs-selector-id">#nav</span> <span class="hljs-selector-tag">a</span><span class="hljs-selector-pseudo">:not</span>(<span class="hljs-selector-pseudo">:last-of-type</span>) &#123;</span><br><span class="language-css">        <span class="hljs-attribute">border-right</span>: none;</span><br><span class="language-css">      &#125;</span><br><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">main</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;content&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">nav</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;nav&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;#/&quot;</span>&gt;</span>首页<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;#/shop&quot;</span>&gt;</span>商城<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;#/shopping-cart&quot;</span>&gt;</span>购物车<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;#/mine&quot;</span>&gt;</span>我的<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">nav</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-keyword">class</span> <span class="hljs-title class_">VueRouter</span> &#123;</span><br><span class="language-javascript">      <span class="hljs-title function_">constructor</span>(<span class="hljs-params">routes = []</span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-variable language_">this</span>.<span class="hljs-property">routes</span> = routes; <span class="hljs-comment">// 路由映射</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentHash</span> = <span class="hljs-string">&quot;&quot;</span>; <span class="hljs-comment">// 当前的hash</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">this</span>.<span class="hljs-property">refresh</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">refresh</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>);</span><br><span class="language-javascript">        <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;load&quot;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">refresh</span>, <span class="hljs-literal">false</span>);</span><br><span class="language-javascript">        <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;hashchange&quot;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">refresh</span>, <span class="hljs-literal">false</span>);</span><br><span class="language-javascript">      &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">      <span class="hljs-title function_">getUrlPath</span>(<span class="hljs-params">url</span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-comment">// 获取hash</span></span><br><span class="language-javascript">        <span class="hljs-keyword">return</span> url.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&quot;#&quot;</span>) &gt;= <span class="hljs-number">0</span> ? url.<span class="hljs-title function_">slice</span>(url.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&quot;#&quot;</span>) + <span class="hljs-number">1</span>) : <span class="hljs-string">&quot;/&quot;</span>;</span><br><span class="language-javascript">      &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">      <span class="hljs-title function_">refresh</span>(<span class="hljs-params">event</span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(event);</span><br><span class="language-javascript">        <span class="hljs-comment">// URL hash发生改变的时候，拿到当前的hash</span></span><br><span class="language-javascript">        <span class="hljs-keyword">let</span> newHash = <span class="hljs-string">&quot;&quot;</span>,</span><br><span class="language-javascript">          oldHash = <span class="hljs-literal">null</span>;</span><br><span class="language-javascript">        <span class="hljs-keyword">if</span> (event.<span class="hljs-property">newURL</span>) &#123;</span><br><span class="language-javascript">          oldHash = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUrlPath</span>(event.<span class="hljs-property">oldURL</span> || <span class="hljs-string">&quot;&quot;</span>);</span><br><span class="language-javascript">          newHash = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUrlPath</span>(event.<span class="hljs-property">newURL</span> || <span class="hljs-string">&quot;&quot;</span>);</span><br><span class="language-javascript">        &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">          newHash = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUrlPath</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">hash</span>);</span><br><span class="language-javascript">          <span class="hljs-variable language_">window</span>.<span class="hljs-property">history</span>.<span class="hljs-property">hash</span> = <span class="hljs-string">&quot;#/&quot;</span>;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentHash</span> = newHash;</span><br><span class="language-javascript">        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">matchComponent</span>();</span><br><span class="language-javascript">      &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">      <span class="hljs-title function_">matchComponent</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-keyword">let</span> curRoute = <span class="hljs-variable language_">this</span>.<span class="hljs-property">routes</span>.<span class="hljs-title function_">find</span>(</span><br><span class="language-javascript">          <span class="hljs-function">(<span class="hljs-params">route</span>) =&gt;</span> route.<span class="hljs-property">path</span> === <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentHash</span></span><br><span class="language-javascript">        );</span><br><span class="language-javascript">        <span class="hljs-keyword">if</span> (!curRoute) &#123;</span><br><span class="language-javascript">          <span class="hljs-comment">// 当前URL中的hash不存在的时候，默认取第一个，当然真实场景下，可能会有各种情况，取决于业务逻辑</span></span><br><span class="language-javascript">          curRoute = <span class="hljs-variable language_">this</span>.<span class="hljs-property">routes</span>.<span class="hljs-title function_">find</span>(<span class="hljs-function">(<span class="hljs-params">route</span>) =&gt;</span> route.<span class="hljs-property">path</span> === <span class="hljs-string">&quot;/&quot;</span>);</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-keyword">const</span> &#123; component &#125; = curRoute;</span><br><span class="language-javascript">        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;#content&quot;</span>).<span class="hljs-property">innerHTML</span> = component;</span><br><span class="language-javascript">      &#125;</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-keyword">const</span> router = <span class="hljs-keyword">new</span> <span class="hljs-title class_">VueRouter</span>([</span><br><span class="language-javascript">      &#123;</span><br><span class="language-javascript">        <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;/&quot;</span>,</span><br><span class="language-javascript">        <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;home&quot;</span>,</span><br><span class="language-javascript">        <span class="hljs-attr">component</span>: <span class="hljs-string">&quot;&lt;div&gt;首页内容&lt;/div&gt;&quot;</span></span><br><span class="language-javascript">      &#125;,</span><br><span class="language-javascript">      &#123;</span><br><span class="language-javascript">        <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;/shop&quot;</span>,</span><br><span class="language-javascript">        <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;shop&quot;</span>,</span><br><span class="language-javascript">        <span class="hljs-attr">component</span>: <span class="hljs-string">&quot;&lt;div&gt;商城内容&lt;/div&gt;&quot;</span></span><br><span class="language-javascript">      &#125;,</span><br><span class="language-javascript">      &#123;</span><br><span class="language-javascript">        <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;/shopping-cart&quot;</span>,</span><br><span class="language-javascript">        <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;shopping-cart&quot;</span>,</span><br><span class="language-javascript">        <span class="hljs-attr">component</span>: <span class="hljs-string">&quot;&lt;div&gt;购物车内容&lt;/div&gt;&quot;</span></span><br><span class="language-javascript">      &#125;,</span><br><span class="language-javascript">      &#123;</span><br><span class="language-javascript">        <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;/mine&quot;</span>,</span><br><span class="language-javascript">        <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;mine&quot;</span>,</span><br><span class="language-javascript">        <span class="hljs-attr">component</span>: <span class="hljs-string">&quot;&lt;div&gt;我的内容&lt;/div&gt;&quot;</span></span><br><span class="language-javascript">      &#125;</span><br><span class="language-javascript">    ]);</span><br><span class="language-javascript">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>从上面的一些描述和实践，我们可以得出以下结论：</p><ul><li>hash模式所有的工作都是在前端完成的，不需要后端服务的配合</li><li>hash模式的实现方式就是通过监听URL中hash部分的变化，从而做出对应的渲染逻辑</li><li>hash模式下，URL中会带有#，看起来不太美观</li></ul><h3 id="history-1"><a href="#history-1" class="headerlink" title="history"></a>history</h3><p>history路由模式的实现，是要归功于HTML5提供的一个history全局对象，可以将它理解为其中包含了关于我们访问网页（历史会话）的一些信息。同时它还暴露了一些有用的方法，比如：</p><ul><li>window.history.go 可以跳转到浏览器会话历史中的指定的某一个记录页</li><li>window.history.forward 指向浏览器会话历史中的下一页，跟浏览器的前进按钮相同</li><li>window.history.back 返回浏览器会话历史中的上一页，跟浏览器的回退按钮功能相同</li><li>window.history.pushState 可以将给定的数据压入到浏览器会话历史栈中</li><li>window.history.replaceState 将当前的会话页面的url替换成指定的数据</li></ul><p>而history路由的实现，主要就是依靠于pushState与replaceState实现的，这里我们先总结下它们的一些特点</p><ul><li>都会改变当前页面显示的url，但都不会刷新页面</li><li>pushState是压入浏览器的会话历史栈中，会使得history.length加1，而replaceState是替换当前的这条会话历史，因此不会增加history.length</li></ul><p>既然已经能够通过pushState或replaceState实现改变URL而不刷新页面，那么是不是如果我们能够监听到改变URL这个动作，就可以实现前端渲染逻辑的处理呢？这个时候，我们还要了解一个事件处理程序popstate，先看下它的官方定义</p><blockquote><p>每当激活同一文档中不同的历史记录条目时，<code>popstate</code> 事件就会在对应的 <code>window</code> 对象上触发。如果当前处于激活状态的历史记录条目是由 <code>history.pushState()</code> 方法创建的或者是由 <code>history.replaceState()</code> 方法修改的，则 <code>popstate</code> 事件的 <code>state</code> 属性包含了这个历史记录条目的 <code>state</code> 对象的一个拷贝。</p><p>调用 <code>history.pushState()</code> 或者 <code>history.replaceState()</code> 不会触发 <code>popstate</code> 事件。<code>popstate</code> 事件只会在浏览器某些行为下触发，比如点击后退按钮（或者在 JavaScript 中调用 <code>history.back()</code> 方法）。即，在同一文档的两个历史记录条目之间导航会触发该事件。</p></blockquote><p>总结下就是以下几点</p><ul><li>history.pushState和history.replaceState方法是不会触发popstate事件的</li><li>但是浏览器的某些行为会导致popstate，比如go、back、forward</li><li>popstate事件对象中的state属性，可以理解是我们在通过history.pushState或history.replaceState方法时，传入的指定的数据</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> _wr = <span class="hljs-keyword">function</span>(<span class="hljs-params">type</span>) &#123;<br>   <span class="hljs-keyword">let</span> orig = history[type]<br>   <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>      <span class="hljs-keyword">let</span> rv = orig.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, <span class="hljs-variable language_">arguments</span>)<br>      <span class="hljs-keyword">let</span> e = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Event</span>(type)<br>      e.<span class="hljs-property">arguments</span> = <span class="hljs-variable language_">arguments</span><br>      <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">dispatchEvent</span>(e)<br>      <span class="hljs-keyword">return</span> rv<br>   &#125;<br>&#125;<br><br> history.<span class="hljs-property">pushState</span> = <span class="hljs-title function_">_wr</span>(<span class="hljs-string">&#x27;pushState&#x27;</span>)<br> history.<span class="hljs-property">replaceState</span> = <span class="hljs-title function_">_wr</span>(<span class="hljs-string">&#x27;replaceState&#x27;</span>)<br></code></pre></td></tr></table></figure><p>hash模式是不需要后端服务配合的。但是history模式下，如果你再跳转路由后再次刷新会得到404的错误，这个错误说白了就是浏览器会把整个地址当成一个可访问的静态资源路径进行访问，然后服务端并没有这个文件～看下面例子更好理解</p><p><strong>没刷新时，只是通过pushState改变URL，不刷新页面</strong></p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs tex">http://192.168.30.161:5500/ === http://192.168.30.161:5500/index.html // 默认访问路径下的index.html文件，没毛病<br>http://192.168.30.161:5500/home === http://192.168.30.161:5500/index.html // 仍然访问路径下的index.html文件，没毛病<br>...<br>http://192.168.30.161:5500/mine === http://192.168.30.161:5500/index.html // 所有的路由都是访问路径下的index.html，没毛病<br></code></pre></td></tr></table></figure><p><strong>一旦在某个路由下刷新页面的时候，想当于去该路径下寻找可访问的静态资源index.html，无果，报错</strong></p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs tex">http://192.168.30.161:5500/mine === http://192.168.30.161:5500/mine/index.html文件，出问题了，服务器上并没有这个资源，404😭<br></code></pre></td></tr></table></figure><p><strong>所以一般情况下，我们都需要配置下nginx，告诉服务器，当我们访问的路径资源不存在的时候，默认指向静态资源index.html</strong></p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">location</span> / &#123;<br>  <span class="hljs-attribute">try_files</span> <span class="hljs-variable">$uri</span> <span class="hljs-variable">$uri</span>/ /index.html;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>一般路由实现主要有history和hash两种方式</p><p>hash的实现全部在前端，不需要后端服务器配合，兼容性好，主要是通过监听hashchange事件，处理前端业务逻辑</p><p>history的实现，需要服务器做以下简单的配置，通过监听pushState及replaceState事件，处理前端业务逻辑</p><h3 id="abstract"><a href="#abstract" class="headerlink" title="abstract"></a>abstract</h3><p>abstract 是vue路由中的第三种模式，本身是用来在不支持浏览器API的环境中，充当fallback，而不论是hash还是history模式都会对浏览器上的url产生作用，他一般要实现的功能就是在已存在的路由页面中内嵌其他的路由页面，而保持在浏览器当中依旧显示当前页面的路由path，这就是abstract这种与浏览器分离的路由模式。</p><h1 id="前端性能优化"><a href="#前端性能优化" class="headerlink" title="前端性能优化"></a>前端性能优化</h1><h3 id="路由懒加载"><a href="#路由懒加载" class="headerlink" title="路由懒加载"></a>路由懒加载</h3><p>SPA 项目，一个路由对应一个页面，如果不做处理，项目打包后，会把所有页面打包成一个文件，<strong>当用户打开首页时，会一次性加载所有的资源</strong>，造成首页加载很慢，降低用户体验</p><p><strong>原理</strong></p><p>ES6的动态地加载模块——<code>import()</code></p><p>调用 import() 之处，被作为分离的模块起点，意思是，被请求的模块和它引用的所有子模块，会分离到一个单独的 chunk 中</p><p>webpackChunkName 作用是 webpack 在打包的时候，对异步引入的库代码（lodash）进行代码分割时，设置代码块的名字。webpack 会将任何一个异步模块与相同的块名称组合到相同的异步块中</p><h3 id="组件懒加载"><a href="#组件懒加载" class="headerlink" title="组件懒加载"></a>组件懒加载</h3><p>和路由懒加载一致，也是使用import</p><h3 id="骨架屏"><a href="#骨架屏" class="headerlink" title="骨架屏"></a>骨架屏</h3><p>使用骨架屏，可以缩短白屏时间，提升用户体验。国内大多数的主流网站都使用了骨架屏，特别是手机端的项目</p><p>SPA 单页应用，无论 vue 还是 react，最初的 html 都是空白的，需要通过加载 JS 将内容挂载到根节点上，这套机制的副作用：会造成长时间的白屏</p><p>常见的骨架屏插件就是基于这种原理，在项目打包时将骨架屏的内容直接放到 html 文件的根节点中</p><h3 id="长列表虚拟滚动"><a href="#长列表虚拟滚动" class="headerlink" title="长列表虚拟滚动"></a>长列表虚拟滚动</h3><p>首页中不乏有需要渲染长列表的场景，当渲染条数过多时，所需要的渲染时间会很长，滚动时还会造成页面卡顿，整体体验非常不好</p><p><strong>虚拟滚动——指的是只渲染可视区域的列表项，非可见区域的</strong>不渲染，在滚动时动态更新可视区域，该方案在优化大量数据渲染时效果是很明显的</p><p>虚拟滚动图例：</p><p><img src="/Users/mac/Desktop/test/TestCase/%E7%AC%94%E8%AE%B0/image/test.png" alt="test"></p><p>虚拟滚动基本原理：</p><p>计算出 totalHeight 列表总高度，并在触发时滚动事件时根据 scrollTop 值不断更新 startIndex 以及 endIndex ，以此从列表数据 listData 中截取对应元素</p><p><strong>插件使用</strong>： vue-virtual-scroller、vue-virtual-scroll-list、react-tiny-virtual-list、react-virtualized</p><h3 id="Web-Worker-优化长任务"><a href="#Web-Worker-优化长任务" class="headerlink" title="Web Worker 优化长任务"></a>Web Worker 优化长任务</h3><p>由于浏览器 GUI 渲染线程与 JS 引擎线程是互斥的关系，当页面中有很多长任务时，会造成页面 UI 阻塞，出现界面卡顿、掉帧等情况</p><p>并不是执行时间超过 50ms 的任务，就可以使用 Web Worker，还要先考虑<code>通信时长</code>的问题</p><p>假如一个运算执行时长为 100ms，但是通信时长为 300ms， 用了 Web Worker可能会更慢</p><p>比如新建一个 web worker, 浏览器会加载对应的 worker.js 资源，下图中的 Time 是这个资源的通信时长（也叫加载时长）</p><p><strong>当任务的运算时长 - 通信时长 &gt; 50ms，推荐使用Web Worker</strong></p><h3 id="requestAnimationFrame-制作动画"><a href="#requestAnimationFrame-制作动画" class="headerlink" title="requestAnimationFrame 制作动画"></a>requestAnimationFrame 制作动画</h3><p><code>requestAnimationFrame</code> 是浏览器专门为动画提供的 API，它的刷新频率与显示器的频率保持一致，使用该 api 可以解决用 setTimeout&#x2F;setInterval 制作动画卡顿的情况</p><p>setTimeout&#x2F;setInterval、requestAnimationFrame 三者的区别：</p><p>1）引擎层面</p><p>setTimeout&#x2F;setInterval 属于 <code>JS引擎</code>，requestAnimationFrame 属于 <code>GUI引擎</code></p><p><code>JS引擎与GUI引擎</code>是互斥的，也就是说 GUI 引擎在渲染时会阻塞 JS 引擎的计算</p><p>2）时间是否准确</p><p>requestAnimationFrame 刷新频率是固定且准确的，但 setTimeout&#x2F;setInterval 是宏任务，根据事件轮询机制，其他任务会阻塞或延迟js任务的执行，会出现定时器不准的情况</p><p>3）性能层面</p><p>当页面被隐藏或最小化时，setTimeout&#x2F;setInterval 定时器仍会在后台执行动画任务，而使用 requestAnimationFrame 当页面处于未激活的状态下，屏幕刷新任务会被系统暂停</p><h3 id="JS的6种加载方式"><a href="#JS的6种加载方式" class="headerlink" title="JS的6种加载方式"></a>JS的6种加载方式</h3><p><strong>正常模式</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;index.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><p>这种情况下 JS 会阻塞 dom 渲染，浏览器必须等待 index.js 加载和执行完成后才能去做其它事情</p><p><strong>async模式</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">async</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;index.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><p>async 模式下，它的加载是异步的，JS 不会阻塞 DOM 的渲染，async 加载是无顺序的，当它加载结束，JS 会立即执行</p><p>使用场景：若该 JS 资源与 DOM 元素没有依赖关系，也不会产生其他资源所需要的数据时，可以使用async 模式，比如埋点统计</p><p><strong>defer模式</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">defer</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;index.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><p>defer 模式下，JS 的加载也是异步的，defer 资源会在 <code>DOMContentLoaded</code> 执行之前，并且 defer 是有顺序的加载</p><p>如果有多个设置了 defer 的 script 标签存在，则会按照引入的前后顺序执行，即便是后面的 script 资源先返回</p><p>所以 defer 可以用来控制 JS 文件的执行顺序，比如 element-ui.js 和 vue.js，因为 element-ui.js 依赖于 vue，所以必须先引入 vue.js，再引入 element-ui.js</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">defer</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;vue.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">defer</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;element-ui.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><p>defer 使用场景：一般情况下都可以使用 defer，特别是需要控制资源加载顺序时</p><p><strong>module模式</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;module&quot;</span>&gt;</span><span class="language-javascript"><span class="hljs-keyword">import</span> &#123; a &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./a.js&#x27;</span></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><p>在主流的现代浏览器中，script 标签的属性可以加上 <code>type=&quot;module&quot;</code>，浏览器会对其内部的 import 引用发起 HTTP 请求，获取模块内容。这时 script 的行为会像是 defer 一样，在后台下载，并且等待 DOM 解析</p><p>Vite 就是利用浏览器支持原生的 <code>es module</code> 模块，开发时跳过打包的过程，提升编译效率</p><p><strong>preload</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;preload&quot;</span> <span class="hljs-attr">as</span>=<span class="hljs-string">&quot;script&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;index.js&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure><p>link 标签的 preload 属性：用于提前加载一些需要的依赖，这些资源会优先加载</p><p>preload 特点：</p><p>1）preload 加载的资源是在浏览器渲染机制之前进行处理的，并且不会阻塞 onload 事件；</p><p>2）preload 加载的 JS 脚本其加载和执行的过程是分离的，即 preload 会预加载相应的脚本代码，待到需要时自行调用；</p><p><strong>prefetch</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;prefetch&quot;</span> <span class="hljs-attr">as</span>=<span class="hljs-string">&quot;script&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;index.js&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure><p>prefetch 是利用浏览器的空闲时间，加载页面将来可能用到的资源的一种机制；通常可以用于加载其他页面（非首页）所需要的资源，以便加快后续页面的打开速度</p><p>prefetch 特点：</p><p>1）pretch 加载的资源可以获取非当前页面所需要的资源，并且将其放入缓存至少5分钟（无论资源是否可以缓存）</p><p>2）当页面跳转时，未完成的 prefetch 请求不会被中断</p><p><strong>加载方式总结</strong></p><p>async、defer 是 script 标签的专属属性，对于网页中的其他资源，可以通过 link 的 preload、prefetch 属性来预加载</p><p>如今现代框架已经将 preload、prefetch 添加到打包流程中了，通过灵活的配置，去使用这些预加载功能，同时我们也可以审时度势地向 script 标签添加 async、defer 属性去处理资源，这样可以显著提升性能</p><h3 id="图片的优化"><a href="#图片的优化" class="headerlink" title="图片的优化"></a>图片的优化</h3><p><strong>图片的动态裁剪</strong></p><p><strong>图片的懒加载</strong></p><p>图片懒加载实现原理：</p><p>由于浏览器会自动对页面中的 img 标签的 src 属性发送请求并下载图片，可以通过 html5 自定义属性 data-xxx 先暂存 src 的值，然后在图片出现在屏幕可视区域的时候，再将 data-xxx 的值重新赋值到 img 的 src 属性即可</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">data-src</span>=<span class="hljs-string">&quot;./images/1.jpg&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">data-src</span>=<span class="hljs-string">&quot;./images/2.jpg&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure><p><strong>使用字体图标</strong></p><p>字体图标是页面使用小图标的不二选择，最常用的就是 <a href="https://link.juejin.cn/?target=https://www.iconfont.cn/home/index">iconfont</a></p><p>字体图标的优点：</p><p>1）轻量级：一个图标字体要比一系列的图像要小。一旦字体加载了，图标就会马上渲染出来，减少了 http 请求</p><p>2）灵活性：可以随意的改变颜色、产生阴影、透明效果、旋转等</p><p>3）兼容性：几乎支持所有的浏览器，请放心使用</p><p><strong>图片转 base64 格式</strong></p><p>将小图片转换为 base64 编码字符串，并写入 HTML 或者 CSS 中，减少 http 请求</p><p>转 base64 格式的优缺点：</p><p>1）它处理的往往是非常小的图片，因为 Base64 编码后，图片大小会膨胀为原文件的 4&#x2F;3，如果对大图也使用 Base64 编码，后者的体积会明显增加，即便减少了 http 请求，也无法弥补这庞大的体积带来的性能开销，得不偿失</p><p>2）在传输非常小的图片的时候，Base64 带来的文件体积膨胀、以及浏览器解析 Base64 的时间开销，与它节省掉的 http 请求开销相比，可以忽略不计，这时候才能真正体现出它在性能方面的优势</p><h1 id="前端模块化"><a href="#前端模块化" class="headerlink" title="前端模块化"></a>前端模块化</h1><h3 id="1-全局函数式编程"><a href="#1-全局函数式编程" class="headerlink" title="1.全局函数式编程"></a>1.全局函数式编程</h3><p>在早期的Web开发中，通常使用全局范围内声明函数和变量的方式来组织代码。例如：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> module1Data = <span class="hljs-string">&#x27;module1 data&#x27;</span>;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">module1Func</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(module1Data);<br>&#125;<br></code></pre></td></tr></table></figure><p>这种方式存在的问题主要有命名冲突、函数间依赖关系不明显、维护困难等。</p><h3 id="2-命名空间模式"><a href="#2-命名空间模式" class="headerlink" title="2.命名空间模式"></a>2.命名空间模式</h3><p>随着对代码组织方式的需求增加，开发者开始通过定义全局对象，将所有函数和变量封装在这个对象中，也就是命名空间模式。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> myApp = &#123;<br>    <span class="hljs-attr">module1Data</span>: <span class="hljs-string">&#x27;module1 data&#x27;</span>,<br>    <span class="hljs-attr">module1Func</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">module1Data</span>);<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><p>这种方式解决了全局命名冲突的问题，但是模块间的依赖关系依旧不明显，同时所有依赖都需要在命名空间对象中手动管理。</p><h3 id="3-CommonJS"><a href="#3-CommonJS" class="headerlink" title="3.CommonJS"></a>3.CommonJS</h3><p>CommonJS模块规范是Node.js采用的规范，使用<code>require</code>函数加载模块，通过<code>module.exports</code>导出模块。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// a.js</span><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-string">&#x27;Hello world&#x27;</span>;<br><br><span class="hljs-comment">// b.js</span><br><span class="hljs-keyword">var</span> a = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./a&#x27;</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a); <span class="hljs-comment">// 输出 &#x27;Hello world&#x27;</span><br></code></pre></td></tr></table></figure><p>CommonJS使用同步加载方式，适用于服务器端，但由于网络请求的异步特性，不适合在浏览器环境使用。</p><h4 id="require函数"><a href="#require函数" class="headerlink" title="require函数"></a><code>require</code>函数</h4><p><code>require</code>函数的主要任务是根据模块的文件路径读取模块文件，然后执行模块代码，最后返回模块的<code>exports</code>对象。</p><p><code>require</code>函数的实现代码大致如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">require</span>(<span class="hljs-params">modulePath</span>)&#123;<br>    <span class="hljs-comment">// 读取模块代码</span><br>    <span class="hljs-keyword">const</span> code = fs.<span class="hljs-title function_">readFileSync</span>(modulePath);<br>    <br>    <span class="hljs-comment">// 包装模块代码</span><br>    <span class="hljs-keyword">const</span> wrapper = <span class="hljs-title class_">Function</span>(<span class="hljs-string">&#x27;exports&#x27;</span>, <span class="hljs-string">&#x27;require&#x27;</span>, <span class="hljs-string">&#x27;module&#x27;</span>, <span class="hljs-string">&#x27;__filename&#x27;</span>, <span class="hljs-string">&#x27;__dirname&#x27;</span>, <span class="hljs-string">`<span class="hljs-subst">$&#123;code&#125;</span>\n return module.exports;`</span>);<br>    <br>    <span class="hljs-keyword">const</span> <span class="hljs-built_in">exports</span> = &#123;&#125;;<br>    <span class="hljs-keyword">const</span> <span class="hljs-variable language_">module</span> = &#123; <span class="hljs-built_in">exports</span> &#125;;<br>    <br>    <span class="hljs-comment">// 执行模块代码</span><br>    <span class="hljs-title function_">wrapper</span>(<span class="hljs-built_in">exports</span>, <span class="hljs-built_in">require</span>, <span class="hljs-variable language_">module</span>);<br>    <br>    <span class="hljs-comment">// 返回模块的exports对象</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>其中，<code>wrapper</code>函数的参数<code>exports</code>和<code>module</code>就是模块的<code>exports</code>和<code>module</code>对象，这样我们就可以在模块中通过<code>exports</code>和<code>module.exports</code>来导出模块。</p><p><code>require</code>函数在执行模块代码时，会先将模块代码包装到一个函数中，然后调用这个函数。这样做的好处是可以将模块代码隔离到一个函数作用域中，防止模块内的变量污染全局作用域。</p><h4 id="module-exports"><a href="#module-exports" class="headerlink" title="module.exports"></a><code>module.exports</code></h4><p>每个CommonJS模块都有一个<code>module</code>对象，这个对象有一个<code>exports</code>属性用于导出模块。当其他模块通过<code>require</code>函数加载这个模块时，就可以获取到<code>module.exports</code>对象。</p><p><code>module.exports</code>的初始值是一个空对象<code>&#123;&#125;</code>，我们可以添加属性到这个对象上，也可以直接将<code>module.exports</code>赋值为一个函数或其他类型的值。</p><p>例如，以下代码展示了如何使用<code>module.exports</code>导出一个函数：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// a.js</span><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Hello world&#x27;</span>);<br>&#125;;<br><br><span class="hljs-comment">// b.js</span><br><span class="hljs-keyword">const</span> a = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./a&#x27;</span>);<br><span class="hljs-title function_">a</span>(); <span class="hljs-comment">// 输出 &#x27;Hello world&#x27;</span><br></code></pre></td></tr></table></figure><p>以上就是CommonJS模块的实现原理。虽然CommonJS主要用于服务器端，但其模块化思想和实现方式对于前端模块化的发展有着深远影响。</p><h3 id="4-AMD（Asynchronous-Module-Definition）"><a href="#4-AMD（Asynchronous-Module-Definition）" class="headerlink" title="4.AMD（Asynchronous Module Definition）"></a>4.AMD（Asynchronous Module Definition）</h3><p>AMD规范是由RequireJS提出的，特点是异步加载模块，适合用在浏览器环境。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// AMD</span><br><span class="hljs-title function_">define</span>([<span class="hljs-string">&#x27;dependency&#x27;</span>], <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;module content&#x27;</span>;<br>&#125;);<br></code></pre></td></tr></table></figure><p>AMD规范的语法较为复杂，但能在浏览器环境中异步加载模块。</p><h3 id="5-UMD（Universal-Module-Definition）"><a href="#5-UMD（Universal-Module-Definition）" class="headerlink" title="5.UMD（Universal Module Definition）"></a>5.UMD（Universal Module Definition）</h3><p>UMD规范试图提供一种解决方案，让同一段代码在CommonJS和AMD环境中都能运行。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs javascript">(<span class="hljs-keyword">function</span> (<span class="hljs-params">root, factory</span>) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> define === <span class="hljs-string">&#x27;function&#x27;</span> &amp;&amp; define.<span class="hljs-property">amd</span>) &#123;<br>        <span class="hljs-comment">// AMD</span><br>       <br><br> <span class="hljs-title function_">define</span>([<span class="hljs-string">&#x27;jquery&#x27;</span>], factory);<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">exports</span> === <span class="hljs-string">&#x27;object&#x27;</span>) &#123;<br>        <span class="hljs-comment">// Node, CommonJS</span><br>        <span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-title function_">factory</span>(<span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;jquery&#x27;</span>));<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">// 浏览器全局变量</span><br>        root.<span class="hljs-property">returnExports</span> = <span class="hljs-title function_">factory</span>(root.<span class="hljs-property">jQuery</span>);<br>    &#125;<br>&#125;(<span class="hljs-variable language_">this</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">$</span>) &#123;<br>    <span class="hljs-comment">// 模块代码</span><br>&#125;));<br></code></pre></td></tr></table></figure><p>UMD通过判断环境中是否存在<code>define</code>和<code>exports</code>对象，来判断是哪种模块环境，从而使用对应的模块化方案。</p><h3 id="6-ES6模块化"><a href="#6-ES6模块化" class="headerlink" title="6.ES6模块化"></a>6.ES6模块化</h3><p>ES6模块化是ECMAScript 6（ES2015）中新引入的模块系统，使用<code>import</code>关键字加载模块，通过<code>export</code>关键字导出模块。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// a.js</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> a = <span class="hljs-string">&#x27;Hello world&#x27;</span>;<br><br><span class="hljs-comment">// b.js</span><br><span class="hljs-keyword">import</span> &#123; a &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./a.js&#x27;</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a); <span class="hljs-comment">// 输出 &#x27;Hello world&#x27;</span><br></code></pre></td></tr></table></figure><p>ES6模块化具有静态性，这种静态性质让依赖关系更加明显，有利于工具进行优化。此外，ES6模块是异步加载，也适合在浏览器环境中使用。</p><h1 id="前端工程化"><a href="#前端工程化" class="headerlink" title="前端工程化"></a>前端工程化</h1><h1 id="webpack打包优化"><a href="#webpack打包优化" class="headerlink" title="webpack打包优化"></a>webpack打包优化</h1><h1 id="封装"><a href="#封装" class="headerlink" title="封装"></a>封装</h1><h1 id="CDN缓存机制和原理"><a href="#CDN缓存机制和原理" class="headerlink" title="CDN缓存机制和原理"></a>CDN缓存机制和原理</h1><h1 id="websocket原理"><a href="#websocket原理" class="headerlink" title="websocket原理"></a>websocket原理</h1><h1 id="白屏时间分析"><a href="#白屏时间分析" class="headerlink" title="白屏时间分析"></a>白屏时间分析</h1><h1 id="登录功能"><a href="#登录功能" class="headerlink" title="登录功能"></a>登录功能</h1><h1 id="大文件上传"><a href="#大文件上传" class="headerlink" title="大文件上传"></a>大文件上传</h1><h1 id="Cookie-Session-SessionStorage-LocalStorage"><a href="#Cookie-Session-SessionStorage-LocalStorage" class="headerlink" title="Cookie, Session, SessionStorage, LocalStorage"></a>Cookie, Session, SessionStorage, LocalStorage</h1><h2 id="1-什么是Cookie？"><a href="#1-什么是Cookie？" class="headerlink" title="1. 什么是Cookie？"></a>1. 什么是Cookie？</h2><h3 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h3><p>Cookie是一种在客户端存储数据的机制，它将数据以键值对的形式存储在用户的浏览器中。Cookie具有以下属性：</p><ul><li><strong>名称和值</strong>：每个Cookie都有一个名称和对应的值，以键值对的形式表示。</li><li><strong>域（Domain）</strong>：Cookie的域属性指定了可以访问Cookie的域名。默认情况下，Cookie的域属性设置为创建Cookie的页面的域名。</li><li><strong>路径（Path）</strong>：Cookie的路径属性指定了可以访问Cookie的路径。默认情况下，Cookie的路径属性设置为创建Cookie的页面的路径。</li><li><strong>过期时间（Expires&#x2F;Max-Age）</strong>：Cookie的过期时间属性指定了Cookie的有效期限。可以通过设置<code>Expires</code>或<code>Max-Age</code>属性来定义过期时间。过期时间可以是一个具体的日期和时间，也可以是一个从当前时间开始的时间段。</li><li><strong>安全标志（Secure）</strong>：Cookie的安全标志属性指定了是否只在通过HTTPS协议发送请求时才发送Cookie。</li><li><strong>同站点标志（SameSite）</strong>：Cookie的同站点标志属性指定了是否限制Cookie只能在同一站点发送。可以设置为<code>Strict</code>（仅允许来自当前站点的请求携带Cookie）或<code>Lax</code>（允许部分跨站点请求携带Cookie）。</li></ul><h3 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h3><p>Cookie在Web开发中有多种应用场景，包括：</p><ul><li><strong>会话管理</strong>：Cookie常用于存储会话标识符，以便在用户访问不同页面时保持会话状态。</li><li><strong>身份验证</strong>：Cookie可以用于存储用户的身份验证凭证或令牌，以便在用户下次访问时自动登录。</li><li><strong>个性化设置</strong>：Cookie可以用于存储用户的个性化首选项，例如语言偏好、主题设置等。</li><li><strong>追踪和分析</strong>：Cookie可以</li></ul><p>用于追踪用户的行为和进行网站分析，例如记录用户访问的页面、点击的链接等。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 设置Cookie</span><br><span class="hljs-variable language_">document</span>.<span class="hljs-property">cookie</span> = <span class="hljs-string">&quot;username=John Doe; expires=Fri, 31 Dec 2023 23:59:59 GMT; path=/; secure; SameSite=Strict&quot;</span>;<br><br><span class="hljs-comment">// 读取Cookie</span><br><span class="hljs-keyword">const</span> cookies = <span class="hljs-variable language_">document</span>.<span class="hljs-property">cookie</span>.<span class="hljs-title function_">split</span>(<span class="hljs-string">&quot;; &quot;</span>);<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; cookies.<span class="hljs-property">length</span>; i++) &#123;<br>  <span class="hljs-keyword">const</span> cookie = cookies[i].<span class="hljs-title function_">split</span>(<span class="hljs-string">&quot;=&quot;</span>);<br>  <span class="hljs-keyword">const</span> name = cookie[<span class="hljs-number">0</span>];<br>  <span class="hljs-keyword">const</span> value = cookie[<span class="hljs-number">1</span>];<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(name + <span class="hljs-string">&quot;: &quot;</span> + value);<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="2-什么是Session？"><a href="#2-什么是Session？" class="headerlink" title="2. 什么是Session？"></a>2. 什么是Session？</h2><h3 id="属性-1"><a href="#属性-1" class="headerlink" title="属性"></a>属性</h3><p>Session是一种在服务器端存储和跟踪用户会话状态的机制。Session具有以下属性：</p><ul><li><strong>存储位置</strong>：Session数据存储在服务器端的内存或持久化介质中，而不是存储在客户端。</li><li><strong>会话ID</strong>：每个会话都有一个唯一的会话ID，用于标识该会话。会话ID通常通过Cookie或URL参数发送给客户端，并在后续请求中用于识别会话。</li><li><strong>过期时间</strong>：Session可以设置过期时间，以控制会话的有效期。过期时间可以是一个具体的日期和时间，也可以是一个从会话创建时开始的时间段。</li><li><strong>安全性</strong>：Session的会话ID需要进行保护，以防止会话劫持和其他安全问题。</li></ul><h3 id="应用场景-1"><a href="#应用场景-1" class="headerlink" title="应用场景"></a>应用场景</h3><p>Session在Web开发中有多种应用场景，包括：</p><ul><li><strong>用户身份验证</strong>：Session用于存储用户的身份验证状态，以便在用户访问需要验证的资源时进行验证。</li><li><strong>购物车</strong>：Session用于存储用户的购物车内容，以便在用户进行结账或继续购物时保持购物车状态。</li><li><strong>个性化设置</strong>：Session可以用于存储用户的个性化首选项，例如语言偏好、主题设置等。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;express&quot;</span>);<br><span class="hljs-keyword">const</span> session = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;express-session&quot;</span>);<br><br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();<br><br>app.<span class="hljs-title function_">use</span>(<span class="hljs-title function_">session</span>(&#123;<br>  <span class="hljs-attr">secret</span>: <span class="hljs-string">&quot;mysecret&quot;</span>,<br>  <span class="hljs-attr">resave</span>: <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">saveUninitialized</span>: <span class="hljs-literal">true</span>,<br>  <span class="hljs-attr">cookie</span>: &#123; <span class="hljs-attr">secure</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">sameSite</span>: <span class="hljs-string">&quot;strict&quot;</span>, <span class="hljs-attr">httpOnly</span>: <span class="hljs-literal">true</span> &#125;<br>&#125;));<br><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&quot;/&quot;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  req.<span class="hljs-property">session</span>.<span class="hljs-property">username</span> = <span class="hljs-string">&quot;John Doe&quot;</span>;<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&quot;Session is set.&quot;</span>);<br>&#125;);<br><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&quot;/profile&quot;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> username = req.<span class="hljs-property">session</span>.<span class="hljs-property">username</span>;<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&quot;Welcome, &quot;</span> + username);<br>&#125;);<br><br>app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Server is running on port 3000&quot;</span>);<br>&#125;);<br></code></pre></td></tr></table></figure><h2 id="3-什么是SessionStorage？"><a href="#3-什么是SessionStorage？" class="headerlink" title="3. 什么是SessionStorage？"></a>3. 什么是SessionStorage？</h2><h3 id="属性-2"><a href="#属性-2" class="headerlink" title="属性"></a>属性</h3><p>SessionStorage是一种在客户端存储临时数据的机制。SessionStorage具有以下属性：</p><ul><li><strong>存储位置</strong>：SessionStorage数据存储在客户端的内存中，与当前会话关联。</li><li><strong>会话范围</strong>：SessionStorage数据仅在浏览器会话期间保留，当用户关闭标签页或浏览器时数据将被清除。</li><li><strong>域和协议限制</strong>：SessionStorage数据只能在同一域和协议下访问。</li></ul><h3 id="应用场景-2"><a href="#应用场景-2" class="headerlink" title="#应用场景"></a><a href="https://www.coding-time.cn/js/advance/%E8%AF%A6%E8%A7%A3%E5%89%8D%E7%AB%AF%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8.html#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF-2">#</a>应用场景</h3><p>SessionStorage在Web开发中有多种应用场景，包括：</p><ul><li><strong>临时数据存储</strong>：SessionStorage可用于在页面之间传递临时数据，例如表单数据、临时状态等。</li><li><strong>表单数据保存</strong>：SessionStorage可用于保存用户填写的表单数据，以便在刷新页面或返回页面时恢复数据，防止数据丢失。</li><li><strong>单页应用状态管理</strong>：在单页应用中，可以使用SessionStorage来存储和管理应用的状态，例如当前选中的标签、展开&#x2F;收起的面板等。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 设置SessionStorage</span><br>sessionStorage.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">&quot;username&quot;</span>, <span class="hljs-string">&quot;John Doe&quot;</span>);<br><br><span class="hljs-comment">// 读取SessionStorage</span><br><span class="hljs-keyword">const</span> username = sessionStorage.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">&quot;username&quot;</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(username);<br></code></pre></td></tr></table></figure><h2 id="4-什么是LocalStorage？"><a href="#4-什么是LocalStorage？" class="headerlink" title="4. 什么是LocalStorage？"></a>4. 什么是LocalStorage？</h2><h3 id="属性-3"><a href="#属性-3" class="headerlink" title="属性"></a>属性</h3><p>LocalStorage是一种在客户端存储持久性数据的机制。LocalStorage具有以下属性：</p><ul><li><strong>存储位置</strong>：LocalStorage数据存储在客户端的持久化介质中，与浏览器相关联。</li><li><strong>持久性</strong>：LocalStorage数据不受会话结束或浏览器关闭的影响，会一直保留在浏览器中，除非被显式删除。</li><li><strong>域和协议限制</strong>：LocalStorage数据只能在同一域和协议下访问。</li></ul><h3 id="应用场景-3"><a href="#应用场景-3" class="headerlink" title="应用场景"></a>应用场景</h3><p>LocalStorage在Web开发中有多种应用场景，包括：</p><ul><li><strong>本地数据存储</strong>：LocalStorage可用于在客户端存储持久性数据，如用户首选项、缓存的数据等。</li><li><strong>离线应用</strong>：LocalStorage可用于存储离线应用所需的资源，例如HTML、CSS和JavaScript文件，以实现离线访问能力。</li><li><strong>单页应用状态管理</strong>：在单页应用中，可以使用LocalStorage来存储和管理应用的状态，例如当前选中的标签、展开&#x2F;收起的面板等。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 设置LocalStorage</span><br><span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">&quot;username&quot;</span>, <span class="hljs-string">&quot;John Doe&quot;</span>);<br><br><span class="hljs-comment">// 读取LocalStorage</span><br><span class="hljs-keyword">const</span> username = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">&quot;username&quot;</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(username);<br></code></pre></td></tr></table></figure><h2 id="5-Cookie-vs-Session-vs-SessionStorage-vs-LocalStorage"><a href="#5-Cookie-vs-Session-vs-SessionStorage-vs-LocalStorage" class="headerlink" title="5. Cookie vs. Session vs. SessionStorage vs. LocalStorage"></a>5. Cookie vs. Session vs. SessionStorage vs. LocalStorage</h2><table><thead><tr><th></th><th>属性</th><th>存储位置</th><th>生命周期</th><th>安全性</th><th>大小限制</th><th>跨域限制</th></tr></thead><tbody><tr><td>Cookie</td><td>键值对</td><td>客户端</td><td>可配置</td><td>受同源策略限制</td><td>约4KB</td><td>是</td></tr><tr><td>Session</td><td>会话ID和服务器端存储</td><td>服务器端</td><td>可配置</td><td>较高（会话ID保护）</td><td>无</td><td>否</td></tr><tr><td>SessionStorage</td><td>键值对</td><td>客户端</td><td>浏览器会话期间</td><td>同源</td><td>约5MB</td><td>否</td></tr><tr><td>LocalStorage</td><td>键值对</td><td>客户端</td><td>永久（需显式删除）</td><td>同源</td><td>约5MB</td><td>否</td></tr></tbody></table><p>Cookie、Session、SessionStorage和LocalStorage都是常见的Web存储解决方案，每种方案都有其适用的场景和特点。</p><ul><li>使用Cookie可以在客户端存储数据，适用于存储会话标识符、用户首选项和追踪用户行为等场景。</li><li>Session用于在服务器端存储和管理用户的会话状态，适用于身份验证、购物车和个性化设置等场景。</li><li>SessionStorage用于在浏览器会话期间存储临时数据，适用于传递数据、保存表单数据和单页应用状态管理等场景。</li><li>LocalStorage用于在客户端存储持久性数据，适用于本地数据存储、离线应用和单页应用状态管理等场景。</li></ul><p>根据具体的需求和场景，选择合适的存储方案可以更好地管理和使用数据。</p><h1 id="前端跨页面通信"><a href="#前端跨页面通信" class="headerlink" title="前端跨页面通信"></a>前端跨页面通信</h1><h3 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h3><p>Cookie是一种在浏览器中存储数据的机制，可以通过设置Cookie的值在不同页面之间传递数据。通过设置相同的Cookie名称和值，不同的页面可以读取和修改Cookie的值，实现跨页面数据的传递和共享。</p><p>使用Cookie进行跨页面通信的示例代码如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 在页面 A 中设置 Cookie</span><br><span class="hljs-variable language_">document</span>.<span class="hljs-property">cookie</span> = <span class="hljs-string">&quot;data=example&quot;</span>;<br><br><span class="hljs-comment">// 在页面 B 中读取 Cookie</span><br><span class="hljs-keyword">const</span> cookies = <span class="hljs-variable language_">document</span>.<span class="hljs-property">cookie</span>.<span class="hljs-title function_">split</span>(<span class="hljs-string">&quot;; &quot;</span>);<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; cookies.<span class="hljs-property">length</span>; i++) &#123;<br>  <span class="hljs-keyword">const</span> [name, value] = cookies[i].<span class="hljs-title function_">split</span>(<span class="hljs-string">&quot;=&quot;</span>);<br>  <span class="hljs-keyword">if</span> (name === <span class="hljs-string">&quot;data&quot;</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value); <span class="hljs-comment">// 输出 &quot;example&quot;</span><br>    <span class="hljs-keyword">break</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="LocalStorage-和-SessionStorage"><a href="#LocalStorage-和-SessionStorage" class="headerlink" title="LocalStorage 和 SessionStorage"></a>LocalStorage 和 SessionStorage</h3><p>LocalStorage和SessionStorage是浏览器提供的本地存储机制，可以在不同页面之间存储和读取数据。它们的区别在于数据的生命周期，LocalStorage中的数据在浏览器关闭后仍然保留，而SessionStorage中的数据在会话结束后被清除。</p><p>使用LocalStorage进行跨页面通信的示例代码如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 在页面 A 中存储数据到 LocalStorage</span><br><span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">&quot;data&quot;</span>, <span class="hljs-string">&quot;example&quot;</span>);<br><br><span class="hljs-comment">// 在页面 B 中读取 LocalStorage 的数据</span><br><span class="hljs-keyword">const</span> data = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">&quot;data&quot;</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data); <span class="hljs-comment">// 输出 &quot;example&quot;</span><br></code></pre></td></tr></table></figure><h3 id="Broadcast-Channel"><a href="#Broadcast-Channel" class="headerlink" title="Broadcast Channel"></a>Broadcast Channel</h3><p>Broadcast Channel是浏览器提供的API，用于在不同页面之间进行消息广播和接收。通过Broadcast Channel，我们可以创建一个频道，并在不同的页面之间发送和接收消息。</p><p>使用Broadcast Channel进行跨页面通信的示例代码如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 在页面 A 中创建 Broadcast Channel</span><br><span class="hljs-keyword">const</span> channel = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BroadcastChannel</span>(<span class="hljs-string">&quot;myChannel&quot;</span>);<br><br><span class="hljs-comment">// 在页面 B 中监听消息</span><br>channel.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;message&quot;</span>, <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(event.<span class="hljs-property">data</span>); <span class="hljs-comment">// 输出接收到的消息</span><br>&#125;);<br><br><span class="hljs-comment">// 在页面 A 中发送消息</span><br>channel.<span class="hljs-title function_">postMessage</span>(<span class="hljs-string">&quot;Hello from Page A&quot;</span>);<br></code></pre></td></tr></table></figure><h3 id="Window-postMessage"><a href="#Window-postMessage" class="headerlink" title="Window.postMessage"></a>Window.postMessage</h3><p>Window.postMessage是浏览器提供的API，用于在不同窗口或框架之间进行安全的跨页面通信。通过Window.postMessage，我们可以向其他窗口发送消息，并接收其他窗口发送的消息。</p><p>使用Window.postMessage进行跨页面通信的示例代码如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 在页面 A 中发送消息给页面 B</span><br><span class="hljs-variable language_">window</span>.<span class="hljs-property">opener</span>.<span class="hljs-title function_">postMessage</span>(<span class="hljs-string">&quot;Hello from Page A&quot;</span>, <span class="hljs-string">&quot;https://www.example.com&quot;</span>);<br><br><span class="hljs-comment">// 在页面 B 中监听消息</span><br><span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;message&quot;</span>, <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">if</span> (event.<span class="hljs-property">origin</span> === <span class="hljs-string">&quot;https://www.example.com&quot;</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(event.<span class="hljs-property">data</span>); <span class="hljs-comment">// 输出接收到的消息</span><br>  &#125;<br>&#125;);<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>技术</category>
      
    </categories>
    
    
    <tags>
      
      <tag>前端</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>浏览器</title>
    <link href="/2024/02/20/%E6%B5%8F%E8%A7%88%E5%99%A8/"/>
    <url>/2024/02/20/%E6%B5%8F%E8%A7%88%E5%99%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="网络相关"><a href="#网络相关" class="headerlink" title="网络相关"></a>网络相关</h1><p>浏览器中的请求标头（Request Headers）和响应标头（Response Headers）是 HTTP 请求和响应的一部分，它们包含了有关请求和响应的元数据信息。以下是这些标头中一些常见的参数及其含义：</p><h2 id="请求标头（Request-Headers）："><a href="#请求标头（Request-Headers）：" class="headerlink" title="请求标头（Request Headers）："></a><strong>请求标头（Request Headers）</strong>：</h2><ol><li><p><strong>User-Agent</strong>：</p><ul><li>含义：标识浏览器或客户端的信息，让服务器知道请求来自哪种浏览器或设备。</li><li>示例：<code>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.0.0 Safari/537.36</code></li></ul></li><li><p><strong>Host</strong>：</p><ul><li>含义：指示请求的目标服务器的主机名和端口号。</li><li>示例：<code>Host: example.com</code></li></ul></li><li><p><strong>Accept</strong>：</p><ul><li>含义：指示客户端所能接受的响应内容类型。服务器可以使用这个信息来提供合适的响应。</li><li>示例：<code>Accept: text/html, application/xhtml+xml, application/xml;q=0.9, */*;q=0.8</code></li></ul></li><li><p><strong>Authorization</strong>：</p><ul><li>含义：用于在请求中发送身份验证凭证，通常用于 HTTP 基本认证或 Bearer 令牌认证。</li><li>示例：<code>Authorization: Basic base64encodedcredentials</code></li></ul></li><li><p><strong>Cookie</strong>：</p><ul><li>含义：包含了客户端在先前请求中收到的 cookie 信息，用于跟踪用户会话状态。</li><li>示例：<code>Cookie: sessionId=abcdef123456</code></li></ul></li></ol><h2 id="响应标头（Response-Headers）："><a href="#响应标头（Response-Headers）：" class="headerlink" title="响应标头（Response Headers）："></a><strong>响应标头（Response Headers）</strong>：</h2><ol><li><p><strong>Content-Type</strong>：</p><ul><li>含义：指示响应内容的媒体类型（如 text&#x2F;html、application&#x2F;json 等）。</li><li>示例：<code>Content-Type: application/json; charset=utf-8</code></li></ul></li><li><p><strong>Content-Length</strong>：</p><ul><li>含义：指示响应主体的长度（以字节为单位）。</li><li>示例：<code>Content-Length: 1024</code></li></ul></li><li><p><strong>Cache-Control</strong>：</p><ul><li>含义：指示浏览器如何缓存响应。它可以包含多个指令，如 <code>max-age</code>（缓存时间）、<code>no-cache</code>（不缓存）、<code>no-store</code>（不存储）等。</li><li>示例：<code>Cache-Control: max-age=3600, public</code></li></ul></li><li><p><strong>Location</strong>：</p><ul><li>含义：通常用于重定向响应，指示浏览器应该跳转到的新位置。</li><li>示例：<code>Location: https://example.com/new-page</code></li></ul></li><li><p><strong>Set-Cookie</strong>：</p><ul><li>含义：用于设置一个或多个 cookie，可以在浏览器中存储数据。多个 cookie 可以通过多次设置该头部来实现。</li><li>示例：<code>Set-Cookie: cookieName=cookieValue; Path=/; Expires=Fri, 30 Sep 2023 23:59:59 GMT; HttpOnly</code></li></ul></li><li><p><strong>ETag</strong>：</p><ul><li>含义：指示响应资源的唯一标识符，可以用于缓存验证。当资源变化时，ETag 会改变，浏览器可以使用它来检查是否需要重新下载资源。</li><li>示例：<code>ETag: &quot;abc123&quot;</code></li></ul></li></ol><p>这些是一些常见的请求标头和响应标头参数，它们提供了有关请求和响应的重要信息，用于控制和管理HTTP通信。标头中的参数可以根据需求和场景进行设置和解析。</p>]]></content>
    
    
    <categories>
      
      <category>技术</category>
      
    </categories>
    
    
    <tags>
      
      <tag>浏览器</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>使用方法</title>
    <link href="/2023/05/14/%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/"/>
    <url>/2023/05/14/%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<h1 id="入门"><a href="#入门" class="headerlink" title="入门"></a>入门</h1><h2 id="1、安装hexo-cli"><a href="#1、安装hexo-cli" class="headerlink" title="1、安装hexo -cli"></a>1、安装hexo -cli</h2><p>使用npm或yarn安装hexo的脚手架工具hexo-cli</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">npm install -g hexo-cli<br></code></pre></td></tr></table></figure><h2 id="2、初始化项目"><a href="#2、初始化项目" class="headerlink" title="2、初始化项目"></a>2、初始化项目</h2><p>安装完成后，使用hexo命令初始化项目，后面为文件名</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">hexo init myBlog<br></code></pre></td></tr></table></figure><h2 id="3、安装依赖"><a href="#3、安装依赖" class="headerlink" title="3、安装依赖"></a>3、安装依赖</h2><p>进入项目目录，安装依赖</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd myBlog<br>npm install<br></code></pre></td></tr></table></figure><h2 id="4、启动项目"><a href="#4、启动项目" class="headerlink" title="4、启动项目"></a>4、启动项目</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">hexo server<br></code></pre></td></tr></table></figure><p>简写</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">hexo s<br></code></pre></td></tr></table></figure><h2 id="5、访问项目"><a href="#5、访问项目" class="headerlink" title="5、访问项目"></a>5、访问项目</h2><p>在浏览器中输入<a href="http://localhost:4000/%E5%8D%B3%E5%8F%AF%E8%AE%BF%E9%97%AE%E9%A1%B9%E7%9B%AE">http://localhost:4000/即可访问项目</a></p><h1 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h1><h2 id="1、-config-yml"><a href="#1、-config-yml" class="headerlink" title="1、_config.yml"></a>1、_config.yml</h2><p>项目的配置文件，可以在这里配置项目的信息，例如标题、描述、作者、语言、主题等等</p><h3 id="网站配置"><a href="#网站配置" class="headerlink" title="网站配置"></a>网站配置</h3><ul><li>title：网站标题</li><li>subtitle：副标题</li><li>description：描述</li><li>keywords：关键字</li><li>author：作者</li><li>language：语言</li><li>timezone：时区<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">title:</span> <span class="hljs-string">Hexo</span><br><span class="hljs-attr">subtitle:</span> <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-attr">description:</span> <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-attr">keywords:</span><br><span class="hljs-attr">author:</span> <span class="hljs-string">John</span> <span class="hljs-string">Doe</span><br><span class="hljs-attr">language:</span> <span class="hljs-string">en</span><br><span class="hljs-attr">timezone:</span> <span class="hljs-string">&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>可以修改成自己的<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">title:</span> <span class="hljs-string">Hexo</span><br><span class="hljs-attr">subtitle:</span> <span class="hljs-string">&#x27;主页&#x27;</span><br><span class="hljs-attr">description:</span> <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-attr">keywords:</span><br><span class="hljs-attr">author:</span> <span class="hljs-string">XieHongchen</span><br><span class="hljs-attr">language:</span> <span class="hljs-string">zh-CN</span><br><span class="hljs-attr">timezone:</span> <span class="hljs-string">&#x27;Asia/Shanghai&#x27;</span><br></code></pre></td></tr></table></figure></li></ul><h3 id="网址配置"><a href="#网址配置" class="headerlink" title="网址配置"></a>网址配置</h3><p>url是博客上线后的网址，会在分享等地方用到，一定要修改</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-string">url:http://example.com</span><br></code></pre></td></tr></table></figure><p>可以修改成自己的，GitHub的地址</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">url:</span> <span class="hljs-string">https://xiehongchen.github.io</span><br></code></pre></td></tr></table></figure><h2 id="2、scaffolds"><a href="#2、scaffolds" class="headerlink" title="2、scaffolds"></a>2、scaffolds</h2><ul><li>draft.md</li><li>FASTPANEL</li><li>post.md<br>模板文件夹，里面存放了3个模板文件，依次为草稿模板，页面模板和文字模板<br>当我们使用hex名称生成草稿、页面或文字的时候，就是赋值这些模板</li></ul><p>我们以文章模板为例进行说明。默认post.md内容为空，头部信息如下：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-meta">---</span><br><span class="hljs-attr">title:</span> &#123;&#123; <span class="hljs-string">title</span> &#125;&#125;<br><span class="hljs-attr">date:</span> &#123;&#123; <span class="hljs-string">date</span> &#125;&#125;<br><span class="hljs-attr">tags:</span><br><span class="hljs-meta">---</span><br></code></pre></td></tr></table></figure><p>如果我们想所有新生成的文章都带上分类字段。我们可以修改post.md的头部。我们给头部添加了categories字段。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-meta">---</span><br><span class="hljs-attr">title:</span> &#123;&#123; <span class="hljs-string">title</span> &#125;&#125;<br><span class="hljs-attr">date:</span> &#123;&#123; <span class="hljs-string">date</span> &#125;&#125;<br><span class="hljs-attr">tags:</span><br><span class="hljs-attr">categories:</span> <br><span class="hljs-meta">---</span><br></code></pre></td></tr></table></figure><p>这样我们使用 <code>hexo new a</code> 生成a.md文章的时候，a.md文章顶部都会带上categories字段。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-meta">---</span><br><span class="hljs-attr">title:</span> <span class="hljs-string">a</span><br><span class="hljs-attr">date:</span> <span class="hljs-number">2022-04-01 16:57:55</span><br><span class="hljs-attr">tags:</span><br><span class="hljs-attr">categories:</span><br><span class="hljs-meta">---</span><br></code></pre></td></tr></table></figure><h2 id="3、source"><a href="#3、source" class="headerlink" title="3、source"></a>3、source</h2><p>资源文件夹是存放用户资源的地方。除 _posts 文件夹之外，开头命名为 _ (下划线)的文件 &#x2F; 文件夹和隐藏的文件将会被忽略。Markdown 和 HTML 文件会被解析并放到 public 文件夹，而其他文件会被拷贝过去。<br>我们使用 <code>hexo new ……</code> 命令生成的页面或者文章，都会被放倒source文件夹下。</p><h2 id="4、themes"><a href="#4、themes" class="headerlink" title="4、themes"></a>4、themes</h2><p>themes文件夹存放的就是hexo的主题。</p><h2 id="5、Front-matter"><a href="#5、Front-matter" class="headerlink" title="5、Front-matter"></a>5、Front-matter</h2><p>Front-matter 是文件最上方以 — 分隔的区域，用于指定个别文件的变量，举例来说：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-meta">---</span><br><span class="hljs-attr">title:</span> <span class="hljs-string">旋转中的时差效果</span><br><span class="hljs-attr">date:</span> <span class="hljs-number">2023-04-28 21:09:11</span><br><span class="hljs-attr">tags:</span> [<span class="hljs-string">js</span>,<span class="hljs-string">前端</span>,<span class="hljs-string">css</span>]<br><span class="hljs-meta">---</span><br></code></pre></td></tr></table></figure><ul><li>layout：布局</li><li>title：标题</li><li>date：建立时间</li><li>updated：更新时间</li><li>comment：开启文章的评论功能</li><li>tags：标签（不适用于分页）</li><li>categories：分类（不适用于分页）</li><li>permalink：覆盖文章网址</li><li>sticky：置顶，普通为1</li></ul><blockquote><p>其中，分类和标签需要区别一下，分类具有顺序性和层次性，也就是说 Foo, Bar 不等于 Bar, Foo；而标签没有顺序和层次。</p></blockquote><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs subunit">categories:<br>- Diary<br><span class="hljs-keyword">tags:</span><br>- PS3<br>- Games<br></code></pre></td></tr></table></figure><h1 id="具体使用"><a href="#具体使用" class="headerlink" title="具体使用"></a>具体使用</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">hexo new [layout] &lt;title&gt;<br></code></pre></td></tr></table></figure><h2 id="文章"><a href="#文章" class="headerlink" title="文章"></a>文章</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">hexo new text<br></code></pre></td></tr></table></figure><h2 id="页面"><a href="#页面" class="headerlink" title="页面"></a>页面</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">hexo new page text<br></code></pre></td></tr></table></figure><h2 id="草稿"><a href="#草稿" class="headerlink" title="草稿"></a>草稿</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">hexo new draft text<br></code></pre></td></tr></table></figure><p>预览草稿</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">hexo server --draft<br></code></pre></td></tr></table></figure><p>将草稿发表到post中</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">hexo publish draft text<br></code></pre></td></tr></table></figure><h2 id="常见命令"><a href="#常见命令" class="headerlink" title="常见命令"></a>常见命令</h2><ul><li>新建<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">hexo new a<br></code></pre></td></tr></table></figure>简写<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">hexo n a<br></code></pre></td></tr></table></figure></li><li>Hexo 会监视文件变动并自动更新，除修改站点配置文件外,无须重启服务器,直接刷新网页即可生效。<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">hexo serve<br></code></pre></td></tr></table></figure></li><li>以静态模式启动<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">hexo serve -s<br></code></pre></td></tr></table></figure></li><li>更改访问端口 (默认端口为4000，’ctrl + c’关闭server)<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">hexo serve -p 5000<br></code></pre></td></tr></table></figure></li><li>自定义 IP<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">hexo server -i ip地址<br></code></pre></td></tr></table></figure></li><li>清除缓存 ,网页正常情况下可以忽略此条命令,执行该指令后,会删掉站点根目录下的public文件夹<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">hexo clean<br></code></pre></td></tr></table></figure></li><li>生成静态网页 (执行 $ hexo g后会在站点根目录下生成public文件夹, hexo会将”&#x2F;blog&#x2F;source&#x2F;“ 下面的.md后缀的文件编译为.html后缀的文件,存放在”&#x2F;blog&#x2F;public&#x2F; “ 路径下)<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">hexo generate<br></code></pre></td></tr></table></figure>简写<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">hexo g<br></code></pre></td></tr></table></figure></li><li>初始化XX文件夹名称<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">hexo init XX<br></code></pre></td></tr></table></figure></li><li>升级<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">npm update hexo -g<br></code></pre></td></tr></table></figure></li><li>安装<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">npm install hexo -g<br></code></pre></td></tr></table></figure></li><li>查看hexo版本号<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">hexo -v<br></code></pre></td></tr></table></figure></li><li>上传<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">hexo deploy<br></code></pre></td></tr></table></figure>简写<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">hexo d<br></code></pre></td></tr></table></figure></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>hexo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>旋转中的时差效果</title>
    <link href="/2023/04/28/%E6%97%8B%E8%BD%AC%E4%B8%AD%E7%9A%84%E6%97%B6%E5%B7%AE%E6%95%88%E6%9E%9C/"/>
    <url>/2023/04/28/%E6%97%8B%E8%BD%AC%E4%B8%AD%E7%9A%84%E6%97%B6%E5%B7%AE%E6%95%88%E6%9E%9C/</url>
    
    <content type="html"><![CDATA[<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><br><span class="language-css">        <span class="hljs-selector-class">.container</span>&#123;</span><br><span class="language-css">            <span class="hljs-attribute">width</span>: <span class="hljs-number">300px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">height</span>: <span class="hljs-number">300px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> auto;</span><br><span class="language-css">            <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">100px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">display</span>: grid;</span><br><span class="language-css">            <span class="hljs-attribute">grid-template-columns</span>: <span class="hljs-built_in">repeat</span>(<span class="hljs-number">3</span>, <span class="hljs-number">1</span>fr);</span><br><span class="language-css">            <span class="hljs-attribute">grid-template-rows</span>: <span class="hljs-built_in">repeat</span>(<span class="hljs-number">3</span>, <span class="hljs-number">1</span>fr);</span><br><span class="language-css">            <span class="hljs-attribute">grid-template</span>: </span><br><span class="language-css">            <span class="hljs-string">&quot;a a b&quot;</span></span><br><span class="language-css">            <span class="hljs-string">&quot;c d b&quot;</span></span><br><span class="language-css">            <span class="hljs-string">&quot;c e e&quot;</span>;</span><br><span class="language-css">            <span class="hljs-attribute">gap</span>: <span class="hljs-number">5px</span>;</span><br><span class="language-css">            <span class="hljs-attr">--r</span>: <span class="hljs-number">360deg</span>;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">        <span class="hljs-selector-class">.item</span>&#123;</span><br><span class="language-css">            <span class="hljs-attribute">overflow</span>: hidden;</span><br><span class="language-css">            <span class="hljs-attribute">border</span>: <span class="hljs-number">2px</span> solid;</span><br><span class="language-css">            <span class="hljs-attribute">object-fit</span>: cover;</span><br><span class="language-css">            <span class="hljs-attribute">display</span>: flex;</span><br><span class="language-css">            <span class="hljs-attribute">justify-content</span>: center;</span><br><span class="language-css">            <span class="hljs-attribute">align-items</span>: center;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">        <span class="hljs-selector-class">.item</span> <span class="hljs-selector-tag">img</span>&#123;</span><br><span class="language-css">            <span class="hljs-attribute">width</span>: <span class="hljs-number">260%</span>;</span><br><span class="language-css">            <span class="hljs-attribute">height</span>: <span class="hljs-number">260%</span>;</span><br><span class="language-css">            <span class="hljs-attr">--r</span>: -<span class="hljs-number">360deg</span>;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">        <span class="hljs-selector-class">.item</span><span class="hljs-selector-pseudo">:nth-child</span>(<span class="hljs-number">1</span>)&#123;</span><br><span class="language-css">            <span class="hljs-attribute">grid-area</span>: a;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">        <span class="hljs-selector-class">.item</span><span class="hljs-selector-pseudo">:nth-child</span>(<span class="hljs-number">2</span>)&#123;</span><br><span class="language-css">            <span class="hljs-attribute">grid-area</span>: b;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">        <span class="hljs-selector-class">.item</span><span class="hljs-selector-pseudo">:nth-child</span>(<span class="hljs-number">3</span>)&#123;</span><br><span class="language-css">            <span class="hljs-attribute">grid-area</span>: c;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">        <span class="hljs-selector-class">.item</span><span class="hljs-selector-pseudo">:nth-child</span>(<span class="hljs-number">4</span>)&#123;</span><br><span class="language-css">            <span class="hljs-attribute">grid-area</span>: d;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">        <span class="hljs-selector-class">.item</span><span class="hljs-selector-pseudo">:nth-child</span>(<span class="hljs-number">5</span>)&#123;</span><br><span class="language-css">            <span class="hljs-attribute">grid-area</span>: e;</span><br><span class="language-css">        &#125;</span><br><span class="language-css"></span><br><span class="language-css">        <span class="hljs-selector-class">.container</span>,</span><br><span class="language-css">        <span class="hljs-selector-class">.item</span> <span class="hljs-selector-tag">img</span>&#123;</span><br><span class="language-css">            <span class="hljs-attribute">animation</span>: rotation <span class="hljs-number">10s</span> infinite linear;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">        <span class="hljs-keyword">@keyframes</span> rotation &#123;</span><br><span class="language-css">            <span class="hljs-selector-tag">to</span>&#123;</span><br><span class="language-css">                <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">rotate</span>(<span class="hljs-built_in">var</span>(--r));</span><br><span class="language-css">            &#125;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;test.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;item&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./images/Capture001.png&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;item&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./images/Capture002.png&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;item&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./images/Capture002.png&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;item&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./images/Capture001.png&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;item&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./images/Capture001.png&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>css</tag>
      
      <tag>js</tag>
      
      <tag>前端</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>36进制求和</title>
    <link href="/2023/04/28/36%E8%BF%9B%E5%88%B6%E6%B1%82%E5%92%8C/"/>
    <url>/2023/04/28/36%E8%BF%9B%E5%88%B6%E6%B1%82%E5%92%8C/</url>
    
    <content type="html"><![CDATA[<h1 id="36进制求和"><a href="#36进制求和" class="headerlink" title="36进制求和"></a>36进制求和</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Test36Bin</span>(<span class="hljs-params">s, t</span>) &#123;<br>    <span class="hljs-keyword">let</span> chars = <span class="hljs-string">&#x27;0123456789abcdefghijklmnopqrstuvwxyz&#x27;</span>;<br>    <span class="hljs-keyword">let</span> carry = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">let</span> result = <span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = s.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>, j = t.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>; s[i] || t[j]; --i, --j) &#123;<br>        <span class="hljs-keyword">let</span> sum = carry + (s[i] ? chars.<span class="hljs-title function_">indexOf</span>(s[i]) : <span class="hljs-number">0</span>) + (t[j] ? chars.<span class="hljs-title function_">indexOf</span>(t[j]) : <span class="hljs-number">0</span>);<br>        carry = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(sum / <span class="hljs-number">36</span>)<br>        <span class="hljs-keyword">let</span> r = sum % <span class="hljs-number">36</span>;<br>        result += chars[r];<br>    &#125;<br>    <span class="hljs-keyword">if</span> (carry) &#123;<br>        result += <span class="hljs-string">&#x27;1&#x27;</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> result.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;&#x27;</span>).<span class="hljs-title function_">reverse</span>().<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;&#x27;</span>);<br>&#125;<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Test36Bin</span>(<span class="hljs-string">&#x27;zzzy&#x27;</span>, <span class="hljs-string">&#x27;zz&#x27;</span>)); <br></code></pre></td></tr></table></figure><blockquote><p>讲解</p><ol><li>获取36进制的所有字符</li><li>从后往前遍历两个字符串，如果有一个字符串遍历完了，就用0代替</li><li>求和，如果有进位，就加到下一次求和中</li><li>求和后，如果大于36，就取整，然后求余，余数就是当前位的值</li><li>如果有进位，就在最后加1</li><li>最后把结果反转，就是最终结果</li><li>36进制的最大值是zzzz，所以最大值是1295，所以不会超过1295</li><li>36进制的最小值是0，所以最小值是0，所以不会小于0</li></ol></blockquote>]]></content>
    
    
    <categories>
      
      <category>面试题</category>
      
    </categories>
    
    
    <tags>
      
      <tag>js</tag>
      
      <tag>前端</tag>
      
      <tag>进制</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>typescript</title>
    <link href="/2023/04/22/%E7%AC%94%E8%AE%B0/typescript-1/"/>
    <url>/2023/04/22/%E7%AC%94%E8%AE%B0/typescript-1/</url>
    
    <content type="html"><![CDATA[<h1 id="typescript"><a href="#typescript" class="headerlink" title="typescript"></a>typescript</h1><blockquote><p>学习：<a href="https://www.bilibili.com/video/BV1wR4y1377K">B站小满ZS</a></p><p>CSDN：<a href="https://blog.csdn.net/qq1195566313/category_11559497.html?spm=1001.2014.3001.5482">CSDN</a></p></blockquote><h2 id="基础类型"><a href="#基础类型" class="headerlink" title="基础类型"></a>基础类型</h2><p>基础类型：Boolean、Number、String、<code>null</code>、<code>undefined</code> 以及 ES6 的 Symbol 和 ES10 的 BigInt</p><h3 id="1、字符串类型"><a href="#1、字符串类型" class="headerlink" title="1、字符串类型"></a>1、字符串类型</h3><p>字符串是使用string定义的</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs TypeScript"><span class="hljs-keyword">let</span> <span class="hljs-attr">a</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">&#x27;123&#x27;</span><br><span class="hljs-comment">//普通声明</span><br> <br><span class="hljs-comment">//也可以使用es6的字符串模板</span><br><br><span class="hljs-keyword">let</span> <span class="hljs-attr">str</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">`dddd<span class="hljs-subst">$&#123;a&#125;</span>`</span><br></code></pre></td></tr></table></figure><p>其中 &#96;用来定义 ES6 中的模板字符串 ，${expr}用来在模板字符串中嵌入表达式。</p><h3 id="2、数字类型"><a href="#2、数字类型" class="headerlink" title="2、数字类型"></a>2、数字类型</h3><p>支持十六进制、十进制、八进制和二进制；</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">let</span> <span class="hljs-attr">notANumber</span>: <span class="hljs-built_in">number</span> = <span class="hljs-title class_">NaN</span>;<span class="hljs-comment">//Nan</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">num</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">123</span>;<span class="hljs-comment">//普通数字</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">infinityNumber</span>: <span class="hljs-built_in">number</span> = <span class="hljs-title class_">Infinity</span>;<span class="hljs-comment">//无穷大</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">decimal</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">6</span>;<span class="hljs-comment">//十进制</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">hex</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0xf00d</span>;<span class="hljs-comment">//十六进制</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">binary</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0b1010</span>;<span class="hljs-comment">//二进制</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">octal</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0o744</span>;<span class="hljs-comment">//八进制s</span><br></code></pre></td></tr></table></figure><h3 id="3、布尔类型"><a href="#3、布尔类型" class="headerlink" title="3、布尔类型"></a>3、布尔类型</h3><p>注意，使用构造函数 Boolean 创造的对象不是布尔值：</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">let</span> <span class="hljs-attr">createdBoolean</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Boolean</span>(<span class="hljs-number">1</span>)<br><span class="hljs-comment">//这样会报错 应为事实上 new Boolean() 返回的是一个 Boolean 对象 </span><br></code></pre></td></tr></table></figure><p>事实上 new Boolean() 返回的是一个 Boolean 对象 需要改成</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">let</span> <span class="hljs-attr">createdBoolean</span>: <span class="hljs-title class_">Boolean</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Boolean</span>(<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">let</span> <span class="hljs-attr">booleand</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">true</span> <span class="hljs-comment">//可以直接使用布尔值</span><br><br><span class="hljs-keyword">let</span> <span class="hljs-attr">booleand2</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-title class_">Boolean</span>(<span class="hljs-number">1</span>) <span class="hljs-comment">//也可以通过函数返回布尔值</span><br></code></pre></td></tr></table></figure><h3 id="4、空值类型"><a href="#4、空值类型" class="headerlink" title="4、空值类型"></a>4、空值类型</h3><p>JavaScript 没有空值（Void）的概念，在 TypeScript 中，可以用 void 表示没有任何返回值的函数</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">function</span> <span class="hljs-title function_">voidFn</span>(<span class="hljs-params"></span>): <span class="hljs-built_in">void</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;test void&#x27;</span>)<br>&#125;<br></code></pre></td></tr></table></figure><p>void 类型的用法，主要是用在我们不希望调用者关心函数返回值的情况下，比如通常的异步回调函数</p><p><strong>void也可以定义undefined 和 null类型</strong></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">let</span> <span class="hljs-attr">u</span>: <span class="hljs-built_in">void</span> = <span class="hljs-literal">undefined</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">n</span>: <span class="hljs-built_in">void</span> = <span class="hljs-literal">null</span>;<br></code></pre></td></tr></table></figure><h3 id="5、Null和undefined类型"><a href="#5、Null和undefined类型" class="headerlink" title="5、Null和undefined类型"></a>5、Null和undefined类型</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">let</span> <span class="hljs-attr">u</span>: <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;<span class="hljs-comment">//定义undefined</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">n</span>: <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;<span class="hljs-comment">//定义null</span><br></code></pre></td></tr></table></figure><p><strong>void 和 undefined 和 null 最大的区别</strong><br>与 void 的区别是，undefined 和 null 是所有类型的子类型。也就是说 undefined 类型的变量，可以赋值给 string 类型的变量：</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">//这样写会报错 void类型不可以分给其他类型</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">test</span>: <span class="hljs-built_in">void</span> = <span class="hljs-literal">undefined</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">num2</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">&quot;1&quot;</span><br></code></pre></td></tr></table></figure><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs ts">num2 = test<br><span class="hljs-comment">//这样是没问题的</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">test</span>: <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">num2</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">&quot;1&quot;</span><br><br>num2 = test<br><br><span class="hljs-comment">//或者这样的</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">test</span>: <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">num2</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">&quot;1&quot;</span><br><br>num2 = test<br></code></pre></td></tr></table></figure><p><strong>TIPS 注意：</strong><br>如果你配置了tsconfig.json 开启了严格模式</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ts">&#123;<br>    <span class="hljs-string">&quot;compilerOptions&quot;</span>:&#123;<br>        <span class="hljs-string">&quot;strict&quot;</span>: <span class="hljs-literal">true</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/../img/ts/28e31a2f9fc44427a067e29ccee485bd.png" alt="img"></p><p>null 不能 赋予 void 类型 </p><h2 id="任意类型"><a href="#任意类型" class="headerlink" title="任意类型"></a>任意类型</h2><p><strong>Any 类型 和 unknown 顶级类型</strong></p><h3 id="1-没有强制限定哪种类型，随时切换类型都可以-我们可以对-any-进行任何操作，不需要检查类型"><a href="#1-没有强制限定哪种类型，随时切换类型都可以-我们可以对-any-进行任何操作，不需要检查类型" class="headerlink" title="1.没有强制限定哪种类型，随时切换类型都可以 我们可以对 any 进行任何操作，不需要检查类型"></a>1.没有强制限定哪种类型，随时切换类型都可以 我们可以对 any 进行任何操作，不需要检查类型</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">let</span> <span class="hljs-attr">anys</span>:<span class="hljs-built_in">any</span> = <span class="hljs-number">123</span><br>anys = <span class="hljs-string">&#x27;123&#x27;</span><br>anys = <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><h3 id="2-声明变量的时候没有指定任意类型默认为any"><a href="#2-声明变量的时候没有指定任意类型默认为any" class="headerlink" title="2.声明变量的时候没有指定任意类型默认为any"></a>2.声明变量的时候没有指定任意类型默认为any</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">let</span> anys;<br>anys = <span class="hljs-string">&#x27;123&#x27;</span><br>anys = <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><h3 id="3-弊端如果使用any-就失去了TS类型检测的作用"><a href="#3-弊端如果使用any-就失去了TS类型检测的作用" class="headerlink" title="3.弊端如果使用any 就失去了TS类型检测的作用"></a>3.弊端如果使用any 就失去了TS类型检测的作用</h3><h3 id="4-TypeScript-3-0中引入的-unknown-类型也被认为是-top-type-，但它更安全。与-any-一样，所有类型都可以分配给unknown"><a href="#4-TypeScript-3-0中引入的-unknown-类型也被认为是-top-type-，但它更安全。与-any-一样，所有类型都可以分配给unknown" class="headerlink" title="4.TypeScript 3.0中引入的 unknown 类型也被认为是 top type ，但它更安全。与 any 一样，所有类型都可以分配给unknown"></a>4.TypeScript 3.0中引入的 unknown 类型也被认为是 top type ，但它更安全。与 any 一样，所有类型都可以分配给unknown</h3><p>unknow  unknow类型比any更加严格当你要使用any 的时候可以尝试使用unknow</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">//unknown 可以定义任何类型的值</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">value</span>: <span class="hljs-built_in">unknown</span>;<br><br>value = <span class="hljs-literal">true</span>;             <span class="hljs-comment">// OK</span><br>value = <span class="hljs-number">42</span>;               <span class="hljs-comment">// OK</span><br>value = <span class="hljs-string">&quot;Hello World&quot;</span>;    <span class="hljs-comment">// OK</span><br>value = [];               <span class="hljs-comment">// OK</span><br>value = &#123;&#125;;               <span class="hljs-comment">// OK</span><br>value = <span class="hljs-literal">null</span>;             <span class="hljs-comment">// OK</span><br>value = <span class="hljs-literal">undefined</span>;        <span class="hljs-comment">// OK</span><br>value = <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">&quot;type&quot;</span>);   <span class="hljs-comment">// OK</span><br><br><span class="hljs-comment">//这样写会报错unknow类型不能作为子类型只能作为父类型 any可以作为父类型和子类型</span><br><span class="hljs-comment">//unknown类型不能赋值给其他类型</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">names</span>:<span class="hljs-built_in">unknown</span> = <span class="hljs-string">&#x27;123&#x27;</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">names2</span>:<span class="hljs-built_in">string</span> = names<br><br><span class="hljs-comment">//这样就没问题 any类型是可以的</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">names</span>:<span class="hljs-built_in">any</span> = <span class="hljs-string">&#x27;123&#x27;</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">names2</span>:<span class="hljs-built_in">string</span> = names   <br><br><span class="hljs-comment">//unknown可赋值对象只有unknown 和 any</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">bbb</span>:<span class="hljs-built_in">unknown</span> = <span class="hljs-string">&#x27;123&#x27;</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">aaa</span>:<span class="hljs-built_in">any</span>= <span class="hljs-string">&#x27;456&#x27;</span><br><br>aaa = bbb<br></code></pre></td></tr></table></figure><p>区别2</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs ts">如果是<span class="hljs-built_in">any</span>类型在对象没有这个属性的时候还在获取是不会报错的<br><span class="hljs-keyword">let</span> <span class="hljs-attr">obj</span>:<span class="hljs-built_in">any</span> = &#123;<span class="hljs-attr">b</span>:<span class="hljs-number">1</span>&#125;<br>obj.<span class="hljs-property">a</span><br><br>如果是unknow 是不能调用属性和方法<br><span class="hljs-keyword">let</span> <span class="hljs-attr">obj</span>:<span class="hljs-built_in">unknown</span> = &#123;<span class="hljs-attr">b</span>:<span class="hljs-number">1</span>,<span class="hljs-attr">ccc</span>:():<span class="hljs-function"><span class="hljs-params">number</span>=&gt;</span><span class="hljs-number">213</span>&#125;<br>obj.<span class="hljs-property">b</span><br>obj.<span class="hljs-title function_">ccc</span>()<br></code></pre></td></tr></table></figure><h2 id="接口和对象类型"><a href="#接口和对象类型" class="headerlink" title="接口和对象类型"></a>接口和对象类型</h2><h3 id="对象的类型"><a href="#对象的类型" class="headerlink" title="对象的类型"></a>对象的类型</h3><p>在typescript中，我们定义对象的方式要用关键字<strong>interface</strong>（接口），我的理解是使用<strong>interface</strong>来定义一种约束，让数据的结构满足约束的格式。定义方式如下：</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">//这样写是会报错的 因为我们在person定义了a，b但是对象里面缺少b属性</span><br><span class="hljs-comment">//使用接口约束的时候不能多一个属性也不能少一个属性</span><br><span class="hljs-comment">//必须与接口保持一致</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Person</span> &#123;<br>    <span class="hljs-attr">b</span>:<span class="hljs-built_in">string</span>,<br>    <span class="hljs-attr">a</span>:<span class="hljs-built_in">string</span><br>&#125;<br> <br><span class="hljs-keyword">const</span> <span class="hljs-attr">person</span>:<span class="hljs-title class_">Person</span>  = &#123;<br>    <span class="hljs-attr">a</span>:<span class="hljs-string">&quot;213&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">//重名interface  可以合并</span><br><span class="hljs-keyword">interface</span> A&#123;<span class="hljs-attr">name</span>:<span class="hljs-built_in">string</span>&#125;<br><span class="hljs-keyword">interface</span> A&#123;<span class="hljs-attr">age</span>:<span class="hljs-built_in">number</span>&#125;<br><span class="hljs-keyword">var</span> <span class="hljs-attr">x</span>:A=&#123;<span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;xx&#x27;</span>,<span class="hljs-attr">age</span>:<span class="hljs-number">20</span>&#125;<br><span class="hljs-comment">//继承</span><br><span class="hljs-keyword">interface</span> A&#123;<br>    <span class="hljs-attr">name</span>:<span class="hljs-built_in">string</span><br>&#125;<br> <br><span class="hljs-keyword">interface</span> B <span class="hljs-keyword">extends</span> A&#123;<br>    <span class="hljs-attr">age</span>:<span class="hljs-built_in">number</span><br>&#125;<br> <br><span class="hljs-keyword">let</span> <span class="hljs-attr">obj</span>:B = &#123;<br>    <span class="hljs-attr">age</span>:<span class="hljs-number">18</span>,<br>    <span class="hljs-attr">name</span>:<span class="hljs-string">&quot;string&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="可选属性-使用-操作符"><a href="#可选属性-使用-操作符" class="headerlink" title="可选属性 使用?操作符"></a>可选属性 使用?操作符</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">//可选属性的含义是该属性可以不存在</span><br><span class="hljs-comment">//所以说这样写也是没问题的</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Person</span> &#123;<br>    b?:<span class="hljs-built_in">string</span>,<br>    <span class="hljs-attr">a</span>:<span class="hljs-built_in">string</span><br>&#125;<br> <br><span class="hljs-keyword">const</span> <span class="hljs-attr">person</span>:<span class="hljs-title class_">Person</span>  = &#123;<br>    <span class="hljs-attr">a</span>:<span class="hljs-string">&quot;213&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="任意属性-propName-string"><a href="#任意属性-propName-string" class="headerlink" title="任意属性 [propName: string]"></a>任意属性 [propName: string]</h3><p>需要注意的是，<strong>一旦定义了任意属性，那么确定属性和可选属性的类型都必须是它的类型的子集</strong>：</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">//在这个例子当中我们看到接口中并没有定义C但是并没有报错</span><br><span class="hljs-comment">//应为我们定义了[propName: string]: any;</span><br><span class="hljs-comment">//允许添加新的任意属性</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Person</span> &#123;<br>    b?:<span class="hljs-built_in">string</span>,<br>    <span class="hljs-attr">a</span>:<span class="hljs-built_in">string</span>,<br>    [<span class="hljs-attr">propName</span>: <span class="hljs-built_in">string</span>]: <span class="hljs-built_in">any</span>;<br>&#125;<br> <br><span class="hljs-keyword">const</span> <span class="hljs-attr">person</span>:<span class="hljs-title class_">Person</span>  = &#123;<br>    <span class="hljs-attr">a</span>:<span class="hljs-string">&quot;213&quot;</span>,<br>    <span class="hljs-attr">c</span>:<span class="hljs-string">&quot;123&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="只读属性-readonly"><a href="#只读属性-readonly" class="headerlink" title="只读属性 readonly"></a>只读属性 readonly</h3><p>readonly 只读属性是不允许被赋值的只能读取</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">//这样写是会报错的</span><br><span class="hljs-comment">//应为a是只读的不允许重新赋值</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Person</span> &#123;<br>    b?: <span class="hljs-built_in">string</span>,<br>    <span class="hljs-keyword">readonly</span> <span class="hljs-attr">a</span>: <span class="hljs-built_in">string</span>,<br>    [<span class="hljs-attr">propName</span>: <span class="hljs-built_in">string</span>]: <span class="hljs-built_in">any</span>;<br>&#125;<br> <br><span class="hljs-keyword">const</span> <span class="hljs-attr">person</span>: <span class="hljs-title class_">Person</span> = &#123;<br>    <span class="hljs-attr">a</span>: <span class="hljs-string">&quot;213&quot;</span>,<br>    <span class="hljs-attr">c</span>: <span class="hljs-string">&quot;123&quot;</span><br>&#125;<br> <br>person.<span class="hljs-property">a</span> = <span class="hljs-number">123</span><br></code></pre></td></tr></table></figure><h3 id="添加函数"><a href="#添加函数" class="headerlink" title="添加函数"></a>添加函数</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Person</span> &#123;<br>    b?: <span class="hljs-built_in">string</span>,<br>    <span class="hljs-keyword">readonly</span> <span class="hljs-attr">a</span>: <span class="hljs-built_in">string</span>,<br>    [<span class="hljs-attr">propName</span>: <span class="hljs-built_in">string</span>]: <span class="hljs-built_in">any</span>;<br>    <span class="hljs-attr">cb</span>:<span class="hljs-function">()=&gt;</span><span class="hljs-built_in">void</span><br>&#125;<br> <br><span class="hljs-keyword">const</span> <span class="hljs-attr">person</span>: <span class="hljs-title class_">Person</span> = &#123;<br>    <span class="hljs-attr">a</span>: <span class="hljs-string">&quot;213&quot;</span>,<br>    <span class="hljs-attr">c</span>: <span class="hljs-string">&quot;123&quot;</span>,<br>    <span class="hljs-attr">cb</span>:<span class="hljs-function">()=&gt;</span>&#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">123</span>)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="数组类型"><a href="#数组类型" class="headerlink" title="数组类型"></a>数组类型</h2><h3 id="数组的类型"><a href="#数组的类型" class="headerlink" title="数组的类型"></a>数组的类型</h3><p>类型[ ] </p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">//类型加中括号</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">arr</span>:<span class="hljs-built_in">number</span>[] = [<span class="hljs-number">123</span>]<br><span class="hljs-comment">//这样会报错定义了数字类型出现字符串是不允许的</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">arr</span>:<span class="hljs-built_in">number</span>[] = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-string">&#x27;1&#x27;</span>]<br><span class="hljs-comment">//操作方法添加也是不允许的</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">arr</span>:<span class="hljs-built_in">number</span>[] = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,]<br>arr.<span class="hljs-title function_">unshift</span>(<span class="hljs-string">&#x27;1&#x27;</span>)<br> <br> <br><span class="hljs-keyword">var</span> <span class="hljs-attr">arr</span>: <span class="hljs-built_in">number</span>[] = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]; <span class="hljs-comment">//数字类型的数组</span><br><span class="hljs-keyword">var</span> <span class="hljs-attr">arr2</span>: <span class="hljs-built_in">string</span>[] = [<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;2&quot;</span>]; <span class="hljs-comment">//字符串类型的数组</span><br><span class="hljs-keyword">var</span> <span class="hljs-attr">arr3</span>: <span class="hljs-built_in">any</span>[] = [<span class="hljs-number">1</span>, <span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-literal">true</span>]; <span class="hljs-comment">//任意类型的数组</span><br></code></pre></td></tr></table></figure><h3 id="数组泛型"><a href="#数组泛型" class="headerlink" title="数组泛型"></a>数组泛型</h3><p>规则 Array&lt;类型&gt;</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">let</span> <span class="hljs-attr">arr</span>:<span class="hljs-title class_">Array</span>&lt;<span class="hljs-built_in">number</span>&gt; = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>]<br></code></pre></td></tr></table></figure><h3 id="用接口表示数组"><a href="#用接口表示数组" class="headerlink" title="用接口表示数组"></a>用接口表示数组</h3><p>一般用来描述类数组 </p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">NumberArray</span> &#123;<br>    [<span class="hljs-attr">index</span>: <span class="hljs-built_in">number</span>]: <span class="hljs-built_in">number</span>;<br>&#125;<br><span class="hljs-keyword">let</span> <span class="hljs-attr">fibonacci</span>: <span class="hljs-title class_">NumberArray</span> = [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>];<br><span class="hljs-comment">//表示：只要索引的类型是数字时，那么值的类型必须是数字。</span><br></code></pre></td></tr></table></figure><h3 id="多维数组"><a href="#多维数组" class="headerlink" title="多维数组"></a>多维数组</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">let</span> <span class="hljs-attr">data</span>:<span class="hljs-built_in">number</span>[][] = [[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>], [<span class="hljs-number">3</span>,<span class="hljs-number">4</span>]];<br></code></pre></td></tr></table></figure><h3 id="arguments类数组"><a href="#arguments类数组" class="headerlink" title="arguments类数组"></a>arguments类数组</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Arr</span>(<span class="hljs-params">...args:<span class="hljs-built_in">any</span></span>): <span class="hljs-built_in">void</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">arguments</span>)<br>    <span class="hljs-comment">//错误的arguments 是类数组不能这样定义</span><br>    <span class="hljs-keyword">let</span> <span class="hljs-attr">arr</span>:<span class="hljs-built_in">number</span>[] = <span class="hljs-variable language_">arguments</span><br>&#125;<br><span class="hljs-title class_">Arr</span>(<span class="hljs-number">111</span>, <span class="hljs-number">222</span>, <span class="hljs-number">333</span>)<br> <br> <br> <br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Arr</span>(<span class="hljs-params">...args:<span class="hljs-built_in">any</span></span>): <span class="hljs-built_in">void</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">arguments</span>) <br>    <span class="hljs-comment">//ts内置对象IArguments 定义</span><br>    <span class="hljs-keyword">let</span> <span class="hljs-attr">arr</span>:<span class="hljs-title class_">IArguments</span> = <span class="hljs-variable language_">arguments</span><br>&#125;<br><span class="hljs-title class_">Arr</span>(<span class="hljs-number">111</span>, <span class="hljs-number">222</span>, <span class="hljs-number">333</span>)<br> <br><span class="hljs-comment">//其中 IArguments 是 TypeScript 中定义好了的类型，它实际上就是：</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">IArguments</span> &#123;<br>[<span class="hljs-attr">index</span>: <span class="hljs-built_in">number</span>]: <span class="hljs-built_in">any</span>;<br><span class="hljs-attr">length</span>: <span class="hljs-built_in">number</span>;<br><span class="hljs-attr">callee</span>: <span class="hljs-title class_">Function</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="any-在数组中的应用"><a href="#any-在数组中的应用" class="headerlink" title="any 在数组中的应用"></a>any 在数组中的应用</h3><p>一个常见的例子数组中可以存在任意类型</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">let</span> <span class="hljs-attr">list</span>: <span class="hljs-built_in">any</span>[] = [<span class="hljs-string">&#x27;test&#x27;</span>, <span class="hljs-number">1</span>, [],&#123;<span class="hljs-attr">a</span>:<span class="hljs-number">1</span>&#125;]<br></code></pre></td></tr></table></figure><h2 id="函数扩展"><a href="#函数扩展" class="headerlink" title="函数扩展"></a>函数扩展</h2><h3 id="函数的类型"><a href="#函数的类型" class="headerlink" title="函数的类型"></a>函数的类型</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">//注意，参数不能多传，也不能少传 必须按照约定的类型来</span><br><span class="hljs-keyword">const</span> fn = (<span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">age</span>:<span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">string</span> =&gt;</span> &#123;<br>    <span class="hljs-keyword">return</span> name + age<br>&#125;<br><span class="hljs-title function_">fn</span>(<span class="hljs-string">&#x27;张三&#x27;</span>,<span class="hljs-number">18</span>)<br></code></pre></td></tr></table></figure><h3 id="函数的可选参数"><a href="#函数的可选参数" class="headerlink" title="函数的可选参数?"></a>函数的可选参数?</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">//通过?表示该参数为可选参数</span><br><span class="hljs-keyword">const</span> fn = (<span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>, age?:<span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">string</span> =&gt;</span> &#123;<br>    <span class="hljs-keyword">return</span> name + age<br>&#125;<br><span class="hljs-title function_">fn</span>(<span class="hljs-string">&#x27;张三&#x27;</span>)<br></code></pre></td></tr></table></figure><h3 id="函数参数的默认值"><a href="#函数参数的默认值" class="headerlink" title="函数参数的默认值"></a>函数参数的默认值</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> fn = (<span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">&quot;我是默认值&quot;</span>): <span class="hljs-function"><span class="hljs-params">string</span> =&gt;</span> &#123;<br>    <span class="hljs-keyword">return</span> name<br>&#125;<br><span class="hljs-title function_">fn</span>()<br></code></pre></td></tr></table></figure><h3 id="接口定义函数"><a href="#接口定义函数" class="headerlink" title="接口定义函数"></a>接口定义函数</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">//定义参数 num 和 num2  ：后面定义返回值的类型</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Add</span> &#123;<br>    (<span class="hljs-attr">num</span>:  <span class="hljs-built_in">number</span>, <span class="hljs-attr">num2</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">number</span><br>&#125;<br> <br><span class="hljs-keyword">const</span> <span class="hljs-attr">fn</span>: <span class="hljs-title class_">Add</span> = (<span class="hljs-attr">num</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">num2</span>: <span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">number</span> =&gt;</span> &#123;<br>    <span class="hljs-keyword">return</span> num + num2<br>&#125;<br><span class="hljs-title function_">fn</span>(<span class="hljs-number">5</span>, <span class="hljs-number">5</span>)<br> <br> <br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">User</span>&#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;<br>    <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>;<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">getUserInfo</span>(<span class="hljs-params">user: User</span>): <span class="hljs-title class_">User</span> &#123;<br>  <span class="hljs-keyword">return</span> user<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="定义剩余参数"><a href="#定义剩余参数" class="headerlink" title="定义剩余参数"></a>定义剩余参数</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> fn = (<span class="hljs-attr">array</span>:<span class="hljs-built_in">number</span>[],...<span class="hljs-attr">items</span>:<span class="hljs-built_in">any</span>[]):<span class="hljs-built_in">any</span>[] =&gt; &#123;<br>       <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(array,items)<br>       <span class="hljs-keyword">return</span> items<br>&#125;<br> <br><span class="hljs-keyword">let</span> <span class="hljs-attr">a</span>:<span class="hljs-built_in">number</span>[] = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]<br> <br><span class="hljs-title function_">fn</span>(a,<span class="hljs-string">&#x27;4&#x27;</span>,<span class="hljs-string">&#x27;5&#x27;</span>,<span class="hljs-string">&#x27;6&#x27;</span>)<br></code></pre></td></tr></table></figure><h3 id="函数重载"><a href="#函数重载" class="headerlink" title="函数重载"></a>函数重载</h3><p>重载是方法名字相同，而参数不同，返回类型可以相同也可以不同。</p><p>如果参数类型不同，则参数类型应设置为 <strong>any</strong>。</p><p>参数数量不同你可以将不同的参数设置为可选。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params">params: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">void</span><br> <br><span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params">params: <span class="hljs-built_in">string</span>, params2: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">void</span><br> <br><span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params">params: <span class="hljs-built_in">any</span>, params2?: <span class="hljs-built_in">any</span></span>): <span class="hljs-built_in">void</span> &#123;<br> <br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(params)<br> <br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(params2)<br> <br>&#125;<br> <br> <br> <br><span class="hljs-title function_">fn</span>(<span class="hljs-number">123</span>)<br> <br><span class="hljs-title function_">fn</span>(<span class="hljs-string">&#x27;123&#x27;</span>,<span class="hljs-number">456</span>)<br></code></pre></td></tr></table></figure><h2 id="类型断言-联合类型-交叉类型"><a href="#类型断言-联合类型-交叉类型" class="headerlink" title="类型断言 | 联合类型 | 交叉类型"></a>类型断言 | 联合类型 | 交叉类型</h2><h3 id="联合类型"><a href="#联合类型" class="headerlink" title="联合类型"></a>联合类型</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">//例如我们的手机号通常是13XXXXXXX 为数字类型 这时候产品说需要支持座机</span><br><span class="hljs-comment">//所以我们就可以使用联合类型支持座机字符串</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">myPhone</span>: <span class="hljs-built_in">number</span> | <span class="hljs-built_in">string</span>  = <span class="hljs-string">&#x27;010-820&#x27;</span><br> <br> <br><span class="hljs-comment">//这样写是会报错的应为我们的联合类型只有数字和字符串并没有布尔值</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">myPhone</span>: <span class="hljs-built_in">number</span> | <span class="hljs-built_in">string</span>  = <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p><strong>函数使用联合类型</strong></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> fn = (<span class="hljs-attr">something</span>:<span class="hljs-built_in">number</span> | <span class="hljs-built_in">boolean</span>):<span class="hljs-function"><span class="hljs-params">boolean</span> =&gt;</span> &#123;<br>     <span class="hljs-keyword">return</span> !!something<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="交叉类型"><a href="#交叉类型" class="headerlink" title="交叉类型"></a>交叉类型</h3><p>多种类型的集合，联合对象将具有所联合类型的所有成员</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">People</span> &#123;<br>  <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>,<br>  height： <span class="hljs-built_in">number</span><br>&#125;<br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Man</span>&#123;<br>  <span class="hljs-attr">sex</span>: <span class="hljs-built_in">string</span><br>&#125;<br><span class="hljs-keyword">const</span> <span class="hljs-title function_">xiaoman</span> = (<span class="hljs-params">man: People &amp; Man</span>) =&gt; &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(man.<span class="hljs-property">age</span>)<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(man.<span class="hljs-property">height</span>)<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(man.<span class="hljs-property">sex</span>)<br>&#125;<br><span class="hljs-title function_">xiaoman</span>(&#123;<span class="hljs-attr">age</span>: <span class="hljs-number">18</span>,<span class="hljs-attr">height</span>: <span class="hljs-number">180</span>,<span class="hljs-attr">sex</span>: <span class="hljs-string">&#x27;male&#x27;</span>&#125;);<br></code></pre></td></tr></table></figure><h3 id="类型断言"><a href="#类型断言" class="headerlink" title="类型断言"></a>类型断言</h3><p>语法：<code>值 as 类型　　或　　&lt;类型&gt;值  value as string  &lt;string&gt;value</code></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">interface</span> A &#123;<br>       <span class="hljs-attr">run</span>: <span class="hljs-built_in">string</span><br>&#125;<br> <br><span class="hljs-keyword">interface</span> B &#123;<br>       <span class="hljs-attr">build</span>: <span class="hljs-built_in">string</span><br>&#125;<br> <br><span class="hljs-keyword">const</span> fn = (<span class="hljs-attr">type</span>: A | B): <span class="hljs-function"><span class="hljs-params">string</span> =&gt;</span> &#123;<br>       <span class="hljs-keyword">return</span> <span class="hljs-keyword">type</span>.<span class="hljs-property">run</span><br>&#125;<br><span class="hljs-comment">//这样写是有警告的应为B的接口上面是没有定义run这个属性的</span><br></code></pre></td></tr></table></figure><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">interface</span> A &#123;<br>       <span class="hljs-attr">run</span>: <span class="hljs-built_in">string</span><br>&#125;<br> <br><span class="hljs-keyword">interface</span> B &#123;<br>       <span class="hljs-attr">build</span>: <span class="hljs-built_in">string</span><br>&#125;<br> <br><span class="hljs-keyword">const</span> fn = (<span class="hljs-attr">type</span>: A | B): <span class="hljs-function"><span class="hljs-params">string</span> =&gt;</span> &#123;<br>       <span class="hljs-keyword">return</span> (<span class="hljs-keyword">type</span> <span class="hljs-keyword">as</span> A).<span class="hljs-property">run</span><br>&#125;<br><span class="hljs-comment">//可以使用类型断言来推断他传入的是A接口的值</span><br></code></pre></td></tr></table></figure><p>需要注意的是，类型断言只能够「欺骗」TypeScript 编译器，无法避免运行时的错误，反而滥用类型断言可能会导致运行时错误：</p><h3 id="使用any临时断言"><a href="#使用any临时断言" class="headerlink" title="使用any临时断言"></a>使用any临时断言</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-variable language_">window</span>.<span class="hljs-property">abc</span> = <span class="hljs-number">123</span><br><span class="hljs-comment">//这样写会报错因为window没有abc这个东西</span><br></code></pre></td></tr></table></figure><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ts">(<span class="hljs-variable language_">window</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>).<span class="hljs-property">abc</span> = <span class="hljs-number">123</span><br><span class="hljs-comment">//可以使用any临时断言在 any 类型的变量上，访问任何属性都是允许的。</span><br></code></pre></td></tr></table></figure><h3 id="as-const"><a href="#as-const" class="headerlink" title="as const"></a><code>as const</code></h3><p>是对字面值的<strong>断言</strong>，与const直接定义常量是有区别的</p><p>如果是普通类型跟直接const 声明是一样的</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> names = <span class="hljs-string">&#x27;小满&#x27;</span><br>names = <span class="hljs-string">&#x27;aa&#x27;</span> <span class="hljs-comment">//无法修改</span><br> <br> <br> <br> <br><span class="hljs-keyword">let</span> names2 = <span class="hljs-string">&#x27;小满&#x27;</span> <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span><br>names2 = <span class="hljs-string">&#x27;aa&#x27;</span> <span class="hljs-comment">//无法修改</span><br></code></pre></td></tr></table></figure><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">// 数组</span><br><span class="hljs-keyword">let</span> a1 = [<span class="hljs-number">10</span>, <span class="hljs-number">20</span>] <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>;<br><span class="hljs-keyword">const</span> a2 = [<span class="hljs-number">10</span>, <span class="hljs-number">20</span>];<br> <br>a1.<span class="hljs-title function_">unshift</span>(<span class="hljs-number">30</span>); <span class="hljs-comment">// 错误，此时已经断言字面量为[10, 20],数据无法做任何修改</span><br>a2.<span class="hljs-title function_">unshift</span>(<span class="hljs-number">30</span>); <span class="hljs-comment">// 通过，没有修改指针</span><br></code></pre></td></tr></table></figure><h3 id="类型断言是不具影响力的"><a href="#类型断言是不具影响力的" class="headerlink" title="类型断言是不具影响力的"></a>类型断言是不具影响力的</h3><p>在下面的例子中，将 something 断言为 boolean 虽然可以通过编译，但是并没有什么用 并不会影响结果, 因为编译过程中会删除类型断言</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">function</span> <span class="hljs-title function_">toBoolean</span>(<span class="hljs-params">something: <span class="hljs-built_in">any</span></span>): <span class="hljs-built_in">boolean</span> &#123;<br>    <span class="hljs-keyword">return</span> something <span class="hljs-keyword">as</span> <span class="hljs-built_in">boolean</span>;<br>&#125;<br> <br><span class="hljs-title function_">toBoolean</span>(<span class="hljs-number">1</span>);<br><span class="hljs-comment">// 返回值为 1</span><br><span class="hljs-comment">//</span><br></code></pre></td></tr></table></figure><h2 id="内置对象-amp-代码雨"><a href="#内置对象-amp-代码雨" class="headerlink" title="内置对象&amp;代码雨"></a>内置对象&amp;代码雨</h2><p>JavaScript 中有很多内置对象，它们可以直接在 TypeScript 中当做定义好了的类型。</p><h3 id="ECMAScript-的内置对象"><a href="#ECMAScript-的内置对象" class="headerlink" title="ECMAScript 的内置对象"></a>ECMAScript 的内置对象</h3><p><strong><code>Boolean</code>、Number、<code>string</code>、<code>RegExp</code>、<code>Date</code>、<code>Error</code></strong></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">let</span> <span class="hljs-attr">b</span>: <span class="hljs-title class_">Boolean</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Boolean</span>(<span class="hljs-number">1</span>)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(b)<br><span class="hljs-keyword">let</span> <span class="hljs-attr">n</span>: <span class="hljs-title class_">Number</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Number</span>(<span class="hljs-literal">true</span>)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(n)<br><span class="hljs-keyword">let</span> <span class="hljs-attr">s</span>: <span class="hljs-title class_">String</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(<span class="hljs-string">&#x27;哔哩哔哩关注小满zs&#x27;</span>)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(s)<br><span class="hljs-keyword">let</span> <span class="hljs-attr">d</span>: <span class="hljs-title class_">Date</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(d)<br><span class="hljs-keyword">let</span> <span class="hljs-attr">r</span>: <span class="hljs-title class_">RegExp</span> = <span class="hljs-regexp">/^1/</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(r)<br><span class="hljs-keyword">let</span> <span class="hljs-attr">e</span>: <span class="hljs-title class_">Error</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;error!&quot;</span>)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e)<br></code></pre></td></tr></table></figure><h3 id="DOM-和-BOM-的内置对象"><a href="#DOM-和-BOM-的内置对象" class="headerlink" title="DOM 和 BOM 的内置对象"></a>DOM 和 BOM 的内置对象</h3><p><strong><code>Document</code>、<code>HTMLElement</code>、<code>Event</code>、<code>NodeList</code> 等</strong></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">let</span> <span class="hljs-attr">body</span>: <span class="hljs-title class_">HTMLElement</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>;<br><span class="hljs-keyword">let</span> <span class="hljs-attr">allDiv</span>: <span class="hljs-title class_">NodeList</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;div&#x27;</span>);<br><span class="hljs-comment">//读取div 这种需要类型断言 或者加个判断应为读不到返回null</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">div</span>:<span class="hljs-title class_">HTMLElement</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;div&#x27;</span>) <span class="hljs-keyword">as</span> <span class="hljs-title class_">HTMLDivElement</span><br><span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">e: MouseEvent</span>) &#123;<br>    <br>&#125;);<br><span class="hljs-comment">//dom元素的映射表</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">HTMLElementTagNameMap</span> &#123;<br>    <span class="hljs-string">&quot;a&quot;</span>: <span class="hljs-title class_">HTMLAnchorElement</span>;<br>    <span class="hljs-string">&quot;abbr&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;address&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;applet&quot;</span>: <span class="hljs-title class_">HTMLAppletElement</span>;<br>    <span class="hljs-string">&quot;area&quot;</span>: <span class="hljs-title class_">HTMLAreaElement</span>;<br>    <span class="hljs-string">&quot;article&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;aside&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;audio&quot;</span>: <span class="hljs-title class_">HTMLAudioElement</span>;<br>    <span class="hljs-string">&quot;b&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;base&quot;</span>: <span class="hljs-title class_">HTMLBaseElement</span>;<br>    <span class="hljs-string">&quot;bdi&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;bdo&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;blockquote&quot;</span>: <span class="hljs-title class_">HTMLQuoteElement</span>;<br>    <span class="hljs-string">&quot;body&quot;</span>: <span class="hljs-title class_">HTMLBodyElement</span>;<br>    <span class="hljs-string">&quot;br&quot;</span>: <span class="hljs-title class_">HTMLBRElement</span>;<br>    <span class="hljs-string">&quot;button&quot;</span>: <span class="hljs-title class_">HTMLButtonElement</span>;<br>    <span class="hljs-string">&quot;canvas&quot;</span>: <span class="hljs-title class_">HTMLCanvasElement</span>;<br>    <span class="hljs-string">&quot;caption&quot;</span>: <span class="hljs-title class_">HTMLTableCaptionElement</span>;<br>    <span class="hljs-string">&quot;cite&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;code&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;col&quot;</span>: <span class="hljs-title class_">HTMLTableColElement</span>;<br>    <span class="hljs-string">&quot;colgroup&quot;</span>: <span class="hljs-title class_">HTMLTableColElement</span>;<br>    <span class="hljs-string">&quot;data&quot;</span>: <span class="hljs-title class_">HTMLDataElement</span>;<br>    <span class="hljs-string">&quot;datalist&quot;</span>: <span class="hljs-title class_">HTMLDataListElement</span>;<br>    <span class="hljs-string">&quot;dd&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;del&quot;</span>: <span class="hljs-title class_">HTMLModElement</span>;<br>    <span class="hljs-string">&quot;details&quot;</span>: <span class="hljs-title class_">HTMLDetailsElement</span>;<br>    <span class="hljs-string">&quot;dfn&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;dialog&quot;</span>: <span class="hljs-title class_">HTMLDialogElement</span>;<br>    <span class="hljs-string">&quot;dir&quot;</span>: <span class="hljs-title class_">HTMLDirectoryElement</span>;<br>    <span class="hljs-string">&quot;div&quot;</span>: <span class="hljs-title class_">HTMLDivElement</span>;<br>    <span class="hljs-string">&quot;dl&quot;</span>: <span class="hljs-title class_">HTMLDListElement</span>;<br>    <span class="hljs-string">&quot;dt&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;em&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;embed&quot;</span>: <span class="hljs-title class_">HTMLEmbedElement</span>;<br>    <span class="hljs-string">&quot;fieldset&quot;</span>: <span class="hljs-title class_">HTMLFieldSetElement</span>;<br>    <span class="hljs-string">&quot;figcaption&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;figure&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;font&quot;</span>: <span class="hljs-title class_">HTMLFontElement</span>;<br>    <span class="hljs-string">&quot;footer&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;form&quot;</span>: <span class="hljs-title class_">HTMLFormElement</span>;<br>    <span class="hljs-string">&quot;frame&quot;</span>: <span class="hljs-title class_">HTMLFrameElement</span>;<br>    <span class="hljs-string">&quot;frameset&quot;</span>: <span class="hljs-title class_">HTMLFrameSetElement</span>;<br>    <span class="hljs-string">&quot;h1&quot;</span>: <span class="hljs-title class_">HTMLHeadingElement</span>;<br>    <span class="hljs-string">&quot;h2&quot;</span>: <span class="hljs-title class_">HTMLHeadingElement</span>;<br>    <span class="hljs-string">&quot;h3&quot;</span>: <span class="hljs-title class_">HTMLHeadingElement</span>;<br>    <span class="hljs-string">&quot;h4&quot;</span>: <span class="hljs-title class_">HTMLHeadingElement</span>;<br>    <span class="hljs-string">&quot;h5&quot;</span>: <span class="hljs-title class_">HTMLHeadingElement</span>;<br>    <span class="hljs-string">&quot;h6&quot;</span>: <span class="hljs-title class_">HTMLHeadingElement</span>;<br>    <span class="hljs-string">&quot;head&quot;</span>: <span class="hljs-title class_">HTMLHeadElement</span>;<br>    <span class="hljs-string">&quot;header&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;hgroup&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;hr&quot;</span>: <span class="hljs-title class_">HTMLHRElement</span>;<br>    <span class="hljs-string">&quot;html&quot;</span>: <span class="hljs-title class_">HTMLHtmlElement</span>;<br>    <span class="hljs-string">&quot;i&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;iframe&quot;</span>: <span class="hljs-title class_">HTMLIFrameElement</span>;<br>    <span class="hljs-string">&quot;img&quot;</span>: <span class="hljs-title class_">HTMLImageElement</span>;<br>    <span class="hljs-string">&quot;input&quot;</span>: <span class="hljs-title class_">HTMLInputElement</span>;<br>    <span class="hljs-string">&quot;ins&quot;</span>: <span class="hljs-title class_">HTMLModElement</span>;<br>    <span class="hljs-string">&quot;kbd&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;label&quot;</span>: <span class="hljs-title class_">HTMLLabelElement</span>;<br>    <span class="hljs-string">&quot;legend&quot;</span>: <span class="hljs-title class_">HTMLLegendElement</span>;<br>    <span class="hljs-string">&quot;li&quot;</span>: <span class="hljs-title class_">HTMLLIElement</span>;<br>    <span class="hljs-string">&quot;link&quot;</span>: <span class="hljs-title class_">HTMLLinkElement</span>;<br>    <span class="hljs-string">&quot;main&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;map&quot;</span>: <span class="hljs-title class_">HTMLMapElement</span>;<br>    <span class="hljs-string">&quot;mark&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;marquee&quot;</span>: <span class="hljs-title class_">HTMLMarqueeElement</span>;<br>    <span class="hljs-string">&quot;menu&quot;</span>: <span class="hljs-title class_">HTMLMenuElement</span>;<br>    <span class="hljs-string">&quot;meta&quot;</span>: <span class="hljs-title class_">HTMLMetaElement</span>;<br>    <span class="hljs-string">&quot;meter&quot;</span>: <span class="hljs-title class_">HTMLMeterElement</span>;<br>    <span class="hljs-string">&quot;nav&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;noscript&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;object&quot;</span>: <span class="hljs-title class_">HTMLObjectElement</span>;<br>    <span class="hljs-string">&quot;ol&quot;</span>: <span class="hljs-title class_">HTMLOListElement</span>;<br>    <span class="hljs-string">&quot;optgroup&quot;</span>: <span class="hljs-title class_">HTMLOptGroupElement</span>;<br>    <span class="hljs-string">&quot;option&quot;</span>: <span class="hljs-title class_">HTMLOptionElement</span>;<br>    <span class="hljs-string">&quot;output&quot;</span>: <span class="hljs-title class_">HTMLOutputElement</span>;<br>    <span class="hljs-string">&quot;p&quot;</span>: <span class="hljs-title class_">HTMLParagraphElement</span>;<br>    <span class="hljs-string">&quot;param&quot;</span>: <span class="hljs-title class_">HTMLParamElement</span>;<br>    <span class="hljs-string">&quot;picture&quot;</span>: <span class="hljs-title class_">HTMLPictureElement</span>;<br>    <span class="hljs-string">&quot;pre&quot;</span>: <span class="hljs-title class_">HTMLPreElement</span>;<br>    <span class="hljs-string">&quot;progress&quot;</span>: <span class="hljs-title class_">HTMLProgressElement</span>;<br>    <span class="hljs-string">&quot;q&quot;</span>: <span class="hljs-title class_">HTMLQuoteElement</span>;<br>    <span class="hljs-string">&quot;rp&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;rt&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;ruby&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;s&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;samp&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;script&quot;</span>: <span class="hljs-title class_">HTMLScriptElement</span>;<br>    <span class="hljs-string">&quot;section&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;select&quot;</span>: <span class="hljs-title class_">HTMLSelectElement</span>;<br>    <span class="hljs-string">&quot;slot&quot;</span>: <span class="hljs-title class_">HTMLSlotElement</span>;<br>    <span class="hljs-string">&quot;small&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;source&quot;</span>: <span class="hljs-title class_">HTMLSourceElement</span>;<br>    <span class="hljs-string">&quot;span&quot;</span>: <span class="hljs-title class_">HTMLSpanElement</span>;<br>    <span class="hljs-string">&quot;strong&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;style&quot;</span>: <span class="hljs-title class_">HTMLStyleElement</span>;<br>    <span class="hljs-string">&quot;sub&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;summary&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;sup&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;table&quot;</span>: <span class="hljs-title class_">HTMLTableElement</span>;<br>    <span class="hljs-string">&quot;tbody&quot;</span>: <span class="hljs-title class_">HTMLTableSectionElement</span>;<br>    <span class="hljs-string">&quot;td&quot;</span>: <span class="hljs-title class_">HTMLTableDataCellElement</span>;<br>    <span class="hljs-string">&quot;template&quot;</span>: <span class="hljs-title class_">HTMLTemplateElement</span>;<br>    <span class="hljs-string">&quot;textarea&quot;</span>: <span class="hljs-title class_">HTMLTextAreaElement</span>;<br>    <span class="hljs-string">&quot;tfoot&quot;</span>: <span class="hljs-title class_">HTMLTableSectionElement</span>;<br>    <span class="hljs-string">&quot;th&quot;</span>: <span class="hljs-title class_">HTMLTableHeaderCellElement</span>;<br>    <span class="hljs-string">&quot;thead&quot;</span>: <span class="hljs-title class_">HTMLTableSectionElement</span>;<br>    <span class="hljs-string">&quot;time&quot;</span>: <span class="hljs-title class_">HTMLTimeElement</span>;<br>    <span class="hljs-string">&quot;title&quot;</span>: <span class="hljs-title class_">HTMLTitleElement</span>;<br>    <span class="hljs-string">&quot;tr&quot;</span>: <span class="hljs-title class_">HTMLTableRowElement</span>;<br>    <span class="hljs-string">&quot;track&quot;</span>: <span class="hljs-title class_">HTMLTrackElement</span>;<br>    <span class="hljs-string">&quot;u&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;ul&quot;</span>: <span class="hljs-title class_">HTMLUListElement</span>;<br>    <span class="hljs-string">&quot;var&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>    <span class="hljs-string">&quot;video&quot;</span>: <span class="hljs-title class_">HTMLVideoElement</span>;<br>    <span class="hljs-string">&quot;wbr&quot;</span>: <span class="hljs-title class_">HTMLElement</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="定义Promise"><a href="#定义Promise" class="headerlink" title="定义Promise"></a>定义Promise</h3><p>如果我们不指定返回的类型TS是推断不出来返回的是什么类型</p><p><img src="/../img/ts/1027f6bee3a84aa58ea4d349a50f48e0.png" alt="img"></p><p>指定返回的类型</p><p><img src="/../img/ts/b4e56fb2426e4502a043d43642312cd8.png" alt="img"></p><p>函数定义返回promise 语法规则:Promise<T> 类型 </p><p><img src="/../img/ts/68d399594565403cb757e7000b1e9a4b.png" alt="img"></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">function</span> <span class="hljs-title function_">promise</span>(<span class="hljs-params"></span>):<span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">number</span>&gt;&#123;<br>   <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">number</span>&gt;(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>)=&gt;</span>&#123;<br>       <span class="hljs-title function_">resolve</span>(<span class="hljs-number">1</span>)<br>   &#125;)<br>&#125;<br> <br><span class="hljs-title function_">promise</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span>=&gt;</span>&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res)<br>&#125;)<br></code></pre></td></tr></table></figure><p>当你在使用一些常用的方法的时候，TypeScript 实际上已经帮你做了很多类型判断的工作了</p><p>而他们的定义文件，则在 <a href="https://github.com/Microsoft/TypeScript/tree/master/src/lib">TypeScript 核心库的定义文件</a>中</p><p><img src="/../img/ts/144d5d4e8d7e41c1b792569000a0aac6.png" alt="img"></p><h3 id="代码雨案例"><a href="#代码雨案例" class="headerlink" title="代码雨案例"></a>代码雨案例</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">let</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#canvas&#x27;</span>) <span class="hljs-keyword">as</span> <span class="hljs-title class_">HTMLCanvasElement</span><br><span class="hljs-keyword">let</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&#x27;2d&#x27;</span>) <span class="hljs-keyword">as</span> <span class="hljs-title class_">CanvasRenderingContext2D</span><br>canvas.<span class="hljs-property">height</span> = screen.<span class="hljs-property">availHeight</span>; <span class="hljs-comment">//可视区域的高度</span><br>canvas.<span class="hljs-property">width</span> = screen.<span class="hljs-property">availWidth</span>; <span class="hljs-comment">//可视区域的宽度</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">str</span>: <span class="hljs-built_in">string</span>[] = <span class="hljs-string">&#x27;XMZSWSSBXMZSWSSBXMZSWSSBXMZSWSSBXMZSWSSB&#x27;</span>.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-keyword">let</span> <span class="hljs-title class_">Arr</span> = <span class="hljs-title class_">Array</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>(canvas.<span class="hljs-property">width</span> / <span class="hljs-number">10</span>)).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>) <span class="hljs-comment">//获取宽度例如1920 / 10 192</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Arr</span>);<br> <br><span class="hljs-keyword">const</span> <span class="hljs-title function_">rain</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>    ctx.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">&#x27;rgba(0,0,0,0.05)&#x27;</span><span class="hljs-comment">//填充背景颜色</span><br>    ctx.<span class="hljs-title function_">fillRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, canvas.<span class="hljs-property">width</span>, canvas.<span class="hljs-property">height</span>)<span class="hljs-comment">//背景</span><br>    ctx.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">&quot;#0f0&quot;</span>; <span class="hljs-comment">//文字颜色</span><br>    <span class="hljs-title class_">Arr</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">item, index</span>) =&gt;</span> &#123;<br>        ctx.<span class="hljs-title function_">fillText</span>(str[ <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * str.<span class="hljs-property">length</span>) ], index * <span class="hljs-number">10</span>, item + <span class="hljs-number">10</span>)<br>        <span class="hljs-title class_">Arr</span>[index] = item &gt;= canvas.<span class="hljs-property">height</span> || item &gt; <span class="hljs-number">10000</span> *  <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() ? <span class="hljs-number">0</span> : item + <span class="hljs-number">10</span>; <span class="hljs-comment">//添加随机数让字符随机出现不至于那么平整</span><br>    &#125;)<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Arr</span>);<br>    <br>&#125;<br><span class="hljs-built_in">setInterval</span>(rain, <span class="hljs-number">40</span>)<br></code></pre></td></tr></table></figure><p><img src="/../img/ts/6c4083b3ce5141f6a3e13b6d4cb19fb2.png" alt="img"></p><h2 id="Class类"><a href="#Class类" class="headerlink" title="Class类"></a>Class类</h2><p>ES6提供了更接近传统语言的写法，引入了Class（类）这个概念，作为对象的模板。通过class关键字，可以定义类。基本上，ES6的class可以看作只是一个语法糖，它的绝大部分功能，ES5都可以做到，新的class写法只是让对象原型的写法更加清晰、更像面向对象编程的语法而已。上面的代码用ES6的“类”改写，就是下面这样。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">//定义类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> &#123;<br>    <span class="hljs-title function_">constructor</span> () &#123;<br> <br>    &#125;<br>    run () &#123;<br>        <br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="定义类"><a href="#定义类" class="headerlink" title="定义类"></a>定义类</h3><p><img src="/../img/ts/3acdefe6f1074aaea36bd7c9e06fe4d2.png" alt="img"></p><p>在TypeScript是不允许直接在constructor 定义变量的 需要在constructor上面先声明</p><p><img src="/../img/ts/a5f9ca6e2bcc48738d59b816acf79b52.png" alt="img"></p><p>这样引发了第二个问题你如果了定义了变量不用 也会报错 通常是给个默认值 或者 进行赋值</p><p><img src="/../img/ts/48c2c425bc1c47599557a8103ff30b83.png" alt="img"></p><p><img src="/../img/ts/47d53797b01349d684bb973fd073673c.png" alt="img"></p><h3 id="类的修饰符"><a href="#类的修饰符" class="headerlink" title="类的修饰符"></a>类的修饰符</h3><p> <strong>public private protected</strong></p><p><img src="/../img/ts/2eaca794296640b183cdcdddb221ee68.png" alt="img"></p><p>使用public 修饰符 可以让你定义的变量 内部访问 也可以外部访问 如果不写默认就是public</p><p><img src="/../img/ts/a4a2499d7600474dac78dc9a3af3afa2.png" alt="img"></p><p>使用 private 修饰符 代表定义的变量私有的只能在内部访问 不能在外部访问</p><p><img src="/../img/ts/d64333f651ec4a799ca665cae11d0d72.png" alt="img"></p><p><img src="/../img/ts/5ac43616ad77488284bae4205db3f6c8.png" alt="img"></p><p>使用 protected 修饰符 代表定义的变量私有的只能在内部和继承的子类中访问 不能在外部访问</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-attr">name</span>:<span class="hljs-built_in">string</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-attr">age</span>:<span class="hljs-built_in">number</span> <br>    <span class="hljs-keyword">protected</span> <span class="hljs-attr">some</span>:<span class="hljs-built_in">any</span><br>    <span class="hljs-title function_">constructor</span> (<span class="hljs-attr">name</span>:<span class="hljs-built_in">string</span>,<span class="hljs-attr">ages</span>:<span class="hljs-built_in">number</span>,<span class="hljs-attr">some</span>:<span class="hljs-built_in">any</span>) &#123;<br>       <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name<br>       <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = ages<br>       <span class="hljs-variable language_">this</span>.<span class="hljs-property">some</span> = some<br>    &#125;<br>    run () &#123;<br> <br>    &#125;<br>&#125;<br> <br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Man</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Person</span>&#123;<br>    <span class="hljs-title function_">constructor</span> () &#123;<br>        <span class="hljs-variable language_">super</span>(<span class="hljs-string">&quot;张三&quot;</span>,<span class="hljs-number">18</span>,<span class="hljs-number">1</span>)<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">some</span>)<br>    &#125;<br>    create () &#123;<br>       <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">some</span>)<br>    &#125;<br>&#125;<br><span class="hljs-keyword">let</span> xiaoman = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&#x27;小满&#x27;</span>,<span class="hljs-number">18</span>,<span class="hljs-number">1</span>)<br><span class="hljs-keyword">let</span> man = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Man</span>()<br>man.<span class="hljs-property">some</span><br></code></pre></td></tr></table></figure><h3 id="static-静态属性-和-静态方法"><a href="#static-静态属性-和-静态方法" class="headerlink" title="static 静态属性 和 静态方法"></a>static 静态属性 和 静态方法</h3><p><img src="/../img/ts/dd66b961270146ada29a9525d750feeb.png" alt="img"></p><p>我们用static 定义的属性 不可以通过this 去访问 只能通过类名去调用</p><p><img src="/../img/ts/0e398a1e6ad7452a8d607821e3969bdf.png" alt="img"></p><p>static 静态函数 同样也是不能通过this 去调用 也是通过类名去调用</p><p><img src="/../img/ts/a6bdc54f0e9140ebafdcb6b0568c164a.png" alt="img"></p><p>需注意： 如果两个函数都是static 静态的是可以通过this互相调用</p><p><img src="/../img/ts/77712c790646400ba121cb061994a762.png" alt="img"></p><h3 id="interface-定义-类"><a href="#interface-定义-类" class="headerlink" title="interface 定义 类"></a>interface 定义 类</h3><p><img src="/../img/ts/fe05924183054a489cf8613feb579be7.png" alt="img"></p><p>ts interface 定义类 使用关键字 implements  后面跟interface的名字多个用逗号隔开 继承还是用extends</p><p>super()其实是符类的prototype.constructor.call</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs ts"> <br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">PersonClass</span> &#123;<br>    <span class="hljs-title function_">get</span>(<span class="hljs-attr">type</span>: <span class="hljs-built_in">boolean</span>): <span class="hljs-built_in">boolean</span><br>&#125;<br> <br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">PersonClass2</span>&#123;<br>    <span class="hljs-title function_">set</span>():<span class="hljs-built_in">void</span>,<br>    <span class="hljs-attr">asd</span>:<span class="hljs-built_in">string</span><br>&#125;<br> <br><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span><br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = <span class="hljs-string">&quot;123&quot;</span><br>    &#125;<br>&#125;<br> <br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">A</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">PersonClass</span>,<span class="hljs-title class_">PersonClass2</span> &#123;<br>    <span class="hljs-attr">asd</span>: <span class="hljs-built_in">string</span><br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">super</span>()<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">asd</span> = <span class="hljs-string">&#x27;123&#x27;</span><br>    &#125;<br>    <span class="hljs-title function_">get</span>(<span class="hljs-params"><span class="hljs-keyword">type</span>:<span class="hljs-built_in">boolean</span></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">type</span><br>    &#125;<br>    set () &#123;<br> <br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="抽象类"><a href="#抽象类" class="headerlink" title="抽象类"></a>抽象类</h3><p>应用场景如果你写的类实例化之后毫无用处此时我可以把他定义为抽象类</p><p>或者你也可以把他作为一个基类-&gt; 通过继承一个派生类去实现基类的一些方法</p><p>我们看例子</p><p>下面这段代码会报错抽象类无法被实例化</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> &#123;<br>   <span class="hljs-keyword">public</span> <span class="hljs-attr">name</span>:<span class="hljs-built_in">string</span><br>   <br>&#125;<br> <br><span class="hljs-keyword">new</span> <span class="hljs-title function_">A</span>()<br></code></pre></td></tr></table></figure><p>例子2</p><p>我们在A类定义了 getName 抽象方法但为实现</p><p>我们B类实现了A定义的抽象方法 如不实现就不报错 <strong>我们定义的抽象方法必须在派生类实现</strong></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> &#123;<br>   <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span><br>   <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span></span>) &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;<br>   &#125;<br>   <span class="hljs-title function_">print</span>(): <span class="hljs-built_in">string</span> &#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span><br>   &#125;<br> <br>   <span class="hljs-keyword">abstract</span> <span class="hljs-title function_">getName</span>(): <span class="hljs-built_in">string</span><br>&#125;<br> <br><span class="hljs-keyword">class</span> <span class="hljs-title class_">B</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">A</span> &#123;<br>   <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;<br>      <span class="hljs-variable language_">super</span>(<span class="hljs-string">&#x27;小满&#x27;</span>)<br>   &#125;<br>   <span class="hljs-title function_">getName</span>(): <span class="hljs-built_in">string</span> &#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span><br>   &#125;<br>&#125;<br> <br><span class="hljs-keyword">let</span> b = <span class="hljs-keyword">new</span> <span class="hljs-title function_">B</span>();<br> <br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(b.<span class="hljs-title function_">getName</span>());<br></code></pre></td></tr></table></figure><p>视频案例</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">//1. class 的基本用法 继承 和 类型约束</span><br><span class="hljs-comment">//2. class 的修饰符 readonly  private protected public</span><br><span class="hljs-comment">//3. super 原理</span><br><span class="hljs-comment">//4. 静态方法</span><br><span class="hljs-comment">//5. get set</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Options</span> &#123;<br>    <span class="hljs-attr">el</span>: <span class="hljs-built_in">string</span> | <span class="hljs-title class_">HTMLElement</span><br>&#125;<br> <br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">VueCls</span> &#123;<br>    <span class="hljs-title function_">init</span>(): <span class="hljs-built_in">void</span><br>    <span class="hljs-attr">options</span>: <span class="hljs-title class_">Options</span><br>&#125;<br> <br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Vnode</span> &#123;<br>    <span class="hljs-attr">tag</span>: <span class="hljs-built_in">string</span><br>    text?: <span class="hljs-built_in">string</span><br>    props?: &#123;<br>        id?: <span class="hljs-built_in">number</span> | <span class="hljs-built_in">string</span><br>        key?: <span class="hljs-built_in">number</span> | <span class="hljs-built_in">string</span> | <span class="hljs-built_in">object</span><br>    &#125;<br>    children?: <span class="hljs-title class_">Vnode</span>[]<br>&#125;<br> <br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Dom</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;<br> <br>    &#125;<br> <br>    <span class="hljs-keyword">private</span> <span class="hljs-title function_">createElement</span>(<span class="hljs-attr">el</span>: <span class="hljs-built_in">string</span>): <span class="hljs-title class_">HTMLElement</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(el)<br>    &#125;<br> <br>    <span class="hljs-keyword">protected</span> <span class="hljs-title function_">setText</span>(<span class="hljs-params">el: Element, text: <span class="hljs-built_in">string</span> | <span class="hljs-literal">null</span></span>) &#123;<br>        el.<span class="hljs-property">textContent</span> = text;<br>    &#125;<br> <br>    <span class="hljs-keyword">protected</span> <span class="hljs-title function_">render</span>(<span class="hljs-attr">createElement</span>: <span class="hljs-title class_">Vnode</span>): <span class="hljs-title class_">HTMLElement</span> &#123;<br>        <span class="hljs-keyword">const</span> el = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createElement</span>(createElement.<span class="hljs-property">tag</span>)<br>        <span class="hljs-keyword">if</span> (createElement.<span class="hljs-property">children</span> &amp;&amp; <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(createElement.<span class="hljs-property">children</span>)) &#123;<br>            createElement.<span class="hljs-property">children</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> &#123;<br>                <span class="hljs-keyword">const</span> child = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">render</span>(item)<br>                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setText</span>(child, item.<span class="hljs-property">text</span> ?? <span class="hljs-literal">null</span>)<br>                el.<span class="hljs-title function_">appendChild</span>(child)<br>            &#125;)<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setText</span>(el, createElement.<span class="hljs-property">text</span> ?? <span class="hljs-literal">null</span>)<br>        &#125;<br>        <span class="hljs-keyword">return</span> el;<br>    &#125;<br>&#125;<br> <br> <br> <br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Vue</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Dom</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">VueCls</span> &#123;<br>    <span class="hljs-attr">options</span>: <span class="hljs-title class_">Options</span><br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options: Options</span>) &#123;<br>        <span class="hljs-variable language_">super</span>()<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span> = options;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">init</span>()<br>    &#125;<br> <br>   <span class="hljs-keyword">static</span> version () &#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;1.0.0&#x27;</span><br>   &#125;<br> <br>   <span class="hljs-keyword">public</span> <span class="hljs-title function_">init</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">let</span> app = <span class="hljs-keyword">typeof</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">el</span> == <span class="hljs-string">&#x27;string&#x27;</span> ? <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">el</span>) : <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">el</span>;<br>        <span class="hljs-keyword">let</span> <span class="hljs-attr">data</span>: <span class="hljs-title class_">Vnode</span> = &#123;<br>            <span class="hljs-attr">tag</span>: <span class="hljs-string">&quot;div&quot;</span>,<br>            <span class="hljs-attr">props</span>: &#123;<br>                <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,<br>                <span class="hljs-attr">key</span>: <span class="hljs-number">1</span><br>            &#125;,<br>            <span class="hljs-attr">children</span>: [<br>                &#123;<br>                    <span class="hljs-attr">tag</span>: <span class="hljs-string">&quot;div&quot;</span>,<br>                    <span class="hljs-attr">text</span>: <span class="hljs-string">&quot;子集1&quot;</span>,<br>                &#125;,<br>                &#123;<br>                    <span class="hljs-attr">tag</span>: <span class="hljs-string">&quot;div&quot;</span>,<br>                    <span class="hljs-attr">text</span>: <span class="hljs-string">&quot;子集2&quot;</span><br>                &#125;<br>            ]<br>        &#125;<br>        app?.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">render</span>(data))<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(app);<br> <br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">mount</span>(app <span class="hljs-keyword">as</span> <span class="hljs-title class_">Element</span>)<br>    &#125;<br> <br>   <span class="hljs-keyword">public</span> <span class="hljs-title function_">mount</span>(<span class="hljs-params">app: Element</span>) &#123;<br>        <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">append</span>(app)<br>    &#125;<br>&#125;<br> <br> <br><span class="hljs-keyword">const</span> v = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;<br>    <span class="hljs-attr">el</span>: <span class="hljs-string">&quot;#app&quot;</span><br>&#125;)<br></code></pre></td></tr></table></figure><h2 id="元组类型"><a href="#元组类型" class="headerlink" title="元组类型"></a>元组类型</h2><p>如果需要一个固定大小的不同类型值的集合，我们需要使用元组。 </p><h3 id="元组就是数组的变种"><a href="#元组就是数组的变种" class="headerlink" title="元组就是数组的变种"></a>元组就是数组的变种</h3><p><strong>元组（Tuple）是固定数量的不同类型的元素的组合</strong>。</p><p>元组与集合的不同之处在于，元组中的元素类型可以是不同的，而且数量固定。元组的好处在于可以把多个元素作为一个单元传递。如果一个方法需要返回多个值，可以把这多个值作为元组返回，而不需要创建额外的类来表示。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">let</span> <span class="hljs-attr">arr</span>:[<span class="hljs-built_in">number</span>,<span class="hljs-built_in">string</span>] = [<span class="hljs-number">1</span>,<span class="hljs-string">&#x27;string&#x27;</span>]<br> <br> <br><span class="hljs-keyword">let</span> <span class="hljs-attr">arr2</span>: <span class="hljs-keyword">readonly</span> [<span class="hljs-built_in">number</span>,<span class="hljs-built_in">boolean</span>,<span class="hljs-built_in">string</span>,<span class="hljs-literal">undefined</span>] = [<span class="hljs-number">1</span>,<span class="hljs-literal">true</span>,<span class="hljs-string">&#x27;sring&#x27;</span>,<span class="hljs-literal">undefined</span>]<br></code></pre></td></tr></table></figure><p>当赋值或访问一个已知索引的元素时，会得到正确的类型：</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">let</span> <span class="hljs-attr">arr</span>:[<span class="hljs-built_in">number</span>,<span class="hljs-built_in">string</span>] = [<span class="hljs-number">1</span>,<span class="hljs-string">&#x27;string&#x27;</span>]<br>arr[<span class="hljs-number">0</span>].<span class="hljs-property">length</span> <span class="hljs-comment">//error</span><br>arr[<span class="hljs-number">1</span>].<span class="hljs-property">length</span> <span class="hljs-comment">//success</span><br> <br><span class="hljs-comment">//数字是没有length 的</span><br></code></pre></td></tr></table></figure><p>元组类型还可以支持自定义名称和变为可选的</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">let</span> <span class="hljs-attr">a</span>:[<span class="hljs-attr">x</span>:<span class="hljs-built_in">number</span>,y?:<span class="hljs-built_in">boolean</span>] = [<span class="hljs-number">1</span>]<br></code></pre></td></tr></table></figure><h3 id="越界元素"><a href="#越界元素" class="headerlink" title="越界元素"></a>越界元素</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">let</span> <span class="hljs-attr">arr</span>:[<span class="hljs-built_in">number</span>,<span class="hljs-built_in">string</span>] = [<span class="hljs-number">1</span>,<span class="hljs-string">&#x27;string&#x27;</span>]<br> <br>arr.<span class="hljs-title function_">push</span>(<span class="hljs-literal">true</span>)<span class="hljs-comment">//error</span><br></code></pre></td></tr></table></figure><p>对于越界的元素他的类型被限制为 联合类型（就是你在元组中定义的类型）如下图</p><p><img src="/../img/ts/29f23f5e7fdb43f69a6d19ee7c9c3df6.png" alt="img"></p><h3 id="应用场景-例如定义excel返回的数据"><a href="#应用场景-例如定义excel返回的数据" class="headerlink" title="应用场景 例如定义excel返回的数据"></a><strong>应用场景 例如定义excel返回的数据</strong></h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">let</span> <span class="hljs-attr">excel</span>: [<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>, <span class="hljs-built_in">number</span>, <span class="hljs-built_in">string</span>][] = [<br>    [<span class="hljs-string">&#x27;title&#x27;</span>, <span class="hljs-string">&#x27;name&#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;123&#x27;</span>],<br>    [<span class="hljs-string">&#x27;title&#x27;</span>, <span class="hljs-string">&#x27;name&#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;123&#x27;</span>],<br>    [<span class="hljs-string">&#x27;title&#x27;</span>, <span class="hljs-string">&#x27;name&#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;123&#x27;</span>],<br>    [<span class="hljs-string">&#x27;title&#x27;</span>, <span class="hljs-string">&#x27;name&#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;123&#x27;</span>],<br>    [<span class="hljs-string">&#x27;title&#x27;</span>, <span class="hljs-string">&#x27;name&#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;123&#x27;</span>],<br>]<br></code></pre></td></tr></table></figure><h2 id="枚举类型"><a href="#枚举类型" class="headerlink" title="枚举类型"></a>枚举类型</h2><p>在javaScript中是没有枚举的概念的TS帮我们定义了枚举这个类型</p><blockquote><p>使用枚举 通过enum关键字定义我们的枚举</p></blockquote><h3 id="数字枚举"><a href="#数字枚举" class="headerlink" title="数字枚举"></a>数字枚举</h3><p>例如 红绿蓝 Red &#x3D; 0 Green &#x3D; 1 Blue&#x3D; 2 分别代表红色0 绿色为1 蓝色为2</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">enum</span> <span class="hljs-title class_">Types</span>&#123;<br>   <span class="hljs-title class_">Red</span>,<br>   <span class="hljs-title class_">Green</span>,<br>   <span class="hljs-title class_">BLue</span><br>&#125;<br></code></pre></td></tr></table></figure><p>这样写就可以实现应为ts定义的枚举中的每一个组员默认都是从0开始的所以也就是</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">enum</span> <span class="hljs-title class_">Types</span>&#123;<br>   <span class="hljs-title class_">Red</span> = <span class="hljs-number">0</span>,<br>   <span class="hljs-title class_">Green</span> = <span class="hljs-number">1</span>,<br>   <span class="hljs-title class_">BLue</span> = <span class="hljs-number">2</span><br>&#125;<br><span class="hljs-comment">//默认就是从0开始的 可以不写值</span><br></code></pre></td></tr></table></figure><p>增长枚举</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">enum</span> <span class="hljs-title class_">Types</span>&#123;<br>   <span class="hljs-title class_">Red</span> = <span class="hljs-number">1</span>,<br>   <span class="hljs-title class_">Green</span>,<br>   <span class="hljs-title class_">BLue</span><br>&#125;<br></code></pre></td></tr></table></figure><p>如上，我们定义了一个数字枚举， Red使用初始化为 <code>1</code>。 其余的成员会从 <code>1</code>开始自动增长。 换句话说， Type<code>.Red</code>的值为 <code>1</code>， <code>Green</code>为 <code>2</code>， <code>Blue</code>为 <code>3</code>。</p><h3 id="字符串枚举"><a href="#字符串枚举" class="headerlink" title="字符串枚举"></a>字符串枚举</h3><p>字符串枚举的概念很简单。 在一个字符串枚举里，每个成员都必须用字符串字面量，或另外一个字符串枚举成员进行初始化。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">enum</span> <span class="hljs-title class_">Types</span>&#123;<br>   <span class="hljs-title class_">Red</span> = <span class="hljs-string">&#x27;red&#x27;</span>,<br>   <span class="hljs-title class_">Green</span> = <span class="hljs-string">&#x27;green&#x27;</span>,<br>   <span class="hljs-title class_">BLue</span> = <span class="hljs-string">&#x27;blue&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>由于字符串枚举没有自增长的行为，字符串枚举可以很好的序列化。 换句话说，如果你正在调试并且必须要读一个数字枚举的运行时的值，这个值通常是很难读的 - 它并不能表达有用的信息，字符串枚举允许你提供一个运行时有意义的并且可读的值，独立于枚举成员的名字。</p><h3 id="异构枚举"><a href="#异构枚举" class="headerlink" title="异构枚举"></a>异构枚举</h3><p>枚举可以混合字符串和数字成员</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">enum</span> <span class="hljs-title class_">Types</span>&#123;<br>   <span class="hljs-title class_">No</span> = <span class="hljs-string">&quot;No&quot;</span>,<br>   <span class="hljs-title class_">Yes</span> = <span class="hljs-number">1</span>,<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="接口枚举"><a href="#接口枚举" class="headerlink" title="接口枚举"></a>接口枚举</h3><p>定义一个枚举Types 定义一个接口A 他有一个属性red 值为Types.yyds</p><p>声明对象的时候要遵循这个规则</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">enum</span> <span class="hljs-title class_">Types</span> &#123;<br>   yyds,<br>   dddd<br>&#125;<br><span class="hljs-keyword">interface</span> A &#123;<br>   <span class="hljs-attr">red</span>:<span class="hljs-title class_">Types</span>.<span class="hljs-property">yyds</span><br>&#125;<br> <br><span class="hljs-keyword">let</span> <span class="hljs-attr">obj</span>:A = &#123;<br>   <span class="hljs-attr">red</span>:<span class="hljs-title class_">Types</span>.<span class="hljs-property">yyds</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="const枚举"><a href="#const枚举" class="headerlink" title="const枚举"></a><code>const</code>枚举</h3><p>let  和 var 都是不允许的声明只能使用const</p><p>大多数情况下，枚举是十分有效的方案。 然而在某些情况下需求很严格。 为了避免在额外生成的代码上的开销和额外的非直接的对枚举成员的访问，我们可以使用 const枚举。 常量枚举通过在枚举上使用 const修饰符来定义</p><ul><li><p>const 声明的枚举会被编译成常量</p></li><li><p>普通声明的枚举编译完后是个对象</p></li></ul><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">Types</span>&#123;<br>   <span class="hljs-title class_">No</span> = <span class="hljs-string">&quot;No&quot;</span>,<br>   <span class="hljs-title class_">Yes</span> = <span class="hljs-number">1</span>,<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="Const-声明编译之后"><a href="#Const-声明编译之后" class="headerlink" title="Const 声明编译之后"></a>Const 声明编译之后</h4><p><img src="/../img/ts/3ff5c0fc49664f42a652860339263559.png" alt="img"></p><h4 id="普通声明编译之后"><a href="#普通声明编译之后" class="headerlink" title="普通声明编译之后"></a>普通声明编译之后</h4><p><img src="/../img/ts/90f8768bb3114370b5cc9bcdcf002ee6.png" alt="img"></p><h3 id="反向映射"><a href="#反向映射" class="headerlink" title="反向映射"></a>反向映射</h3><p>它包含了正向映射（ <code>name</code> -&gt; <code>value</code>）和反向映射（ <code>value</code> -&gt; <code>name</code>）</p><p>要注意的是 <em>不会</em>为字符串枚举成员生成反向映射。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">enum</span> <span class="hljs-title class_">Enum</span> &#123;<br>   fall<br>&#125;<br><span class="hljs-keyword">let</span> a = <span class="hljs-title class_">Enum</span>.<span class="hljs-property">fall</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a); <span class="hljs-comment">//0</span><br><span class="hljs-keyword">let</span> nameOfA = <span class="hljs-title class_">Enum</span>[a]; <br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(nameOfA); <span class="hljs-comment">//fall</span><br></code></pre></td></tr></table></figure><h2 id="类型推论-类型别名"><a href="#类型推论-类型别名" class="headerlink" title="类型推论|类型别名"></a>类型推论|类型别名</h2><h3 id="什么是类型推论"><a href="#什么是类型推论" class="headerlink" title="什么是类型推论"></a>什么是类型推论</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs TypeScript"><span class="hljs-keyword">let</span> str = <span class="hljs-string">&quot;小满zs&quot;</span><br></code></pre></td></tr></table></figure><ul><li>我声明了一个变量但是没有定义类型</li></ul><p>TypeScript 会在没有明确的指定类型的时候推测出一个类型，这就是类型推论</p><p><img src="/../img/ts/1d631575a0084ec6a1c8d288665472fa.png" alt="img"></p><p>所以TS帮我推断出来这是一个string类型</p><p><img src="/../img/ts/a1de5ad7b2f944c5943c93e76598a665.png" alt="img"></p><p>不能够在赋值给别的类型</p><ul><li>如果你声明变量没有定义类型也没有赋值这时候TS会推断成any类型可以进行任何操作</li></ul><p><img src="/../img/ts/ac55d781b42d40e9a2864244147b60ed.png" alt="img"></p><h3 id="类型别名"><a href="#类型别名" class="headerlink" title="类型别名"></a>类型别名</h3><p>type 关键字（可以给一个类型定义一个名字）多用于复合类型</p><p> 定义类型别名</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">type</span> str = <span class="hljs-built_in">string</span><br> <br> <br><span class="hljs-keyword">let</span> <span class="hljs-attr">s</span>:str = <span class="hljs-string">&quot;我是小满&quot;</span><br> <br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(s);<br></code></pre></td></tr></table></figure><p> 定义函数别名</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs TypeScript"><span class="hljs-keyword">type</span> str = <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">string</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">s</span>: str = <span class="hljs-function">() =&gt;</span> <span class="hljs-string">&quot;我是小满&quot;</span><br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(s);<br></code></pre></td></tr></table></figure><p> 定义联合类型别名</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs TypeScript"><span class="hljs-keyword">type</span> str = <span class="hljs-built_in">string</span> | <span class="hljs-built_in">number</span><br> <br> <br><span class="hljs-keyword">let</span> <span class="hljs-attr">s</span>: str = <span class="hljs-number">123</span><br> <br><span class="hljs-keyword">let</span> <span class="hljs-attr">s2</span>: str = <span class="hljs-string">&#x27;123&#x27;</span><br> <br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(s,s2);<br></code></pre></td></tr></table></figure><p>定义值的别名</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">type</span> value = <span class="hljs-built_in">boolean</span> | <span class="hljs-number">0</span> | <span class="hljs-string">&#x27;213&#x27;</span><br> <br> <br><span class="hljs-keyword">let</span> <span class="hljs-attr">s</span>:value = <span class="hljs-literal">true</span><br><span class="hljs-comment">//变量s的值  只能是上面value定义的值</span><br></code></pre></td></tr></table></figure><h3 id="type-和-interface-还是一些区别的-虽然都可以定义类型"><a href="#type-和-interface-还是一些区别的-虽然都可以定义类型" class="headerlink" title="type 和 interface 还是一些区别的 虽然都可以定义类型"></a>type 和 interface 还是一些区别的 虽然都可以定义类型</h3><p>1.interface可以继承  type 只能通过 &amp; 交叉类型合并</p><p>2.type 可以定义 联合类型 和 可以使用一些操作符 interface不行</p><p>3.interface 遇到重名的会合并 type 不行</p><h3 id="type高级用法"><a href="#type高级用法" class="headerlink" title="type高级用法"></a>type高级用法</h3><p>左边的值会作为右边值的子类型遵循图中上下的包含关系</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">type</span> a = <span class="hljs-number">1</span> <span class="hljs-keyword">extends</span> <span class="hljs-built_in">number</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span> <span class="hljs-comment">//1</span><br> <br><span class="hljs-keyword">type</span> a = <span class="hljs-number">1</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Number</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span> <span class="hljs-comment">//1</span><br> <br><span class="hljs-keyword">type</span> a = <span class="hljs-number">1</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Object</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span> <span class="hljs-comment">//1</span><br> <br><span class="hljs-keyword">type</span> a = <span class="hljs-number">1</span> <span class="hljs-keyword">extends</span> <span class="hljs-built_in">any</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span> <span class="hljs-comment">//1</span><br> <br><span class="hljs-keyword">type</span> a = <span class="hljs-number">1</span> <span class="hljs-keyword">extends</span> unknow ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span> <span class="hljs-comment">//1</span><br> <br><span class="hljs-keyword">type</span> a = <span class="hljs-number">1</span> <span class="hljs-keyword">extends</span> <span class="hljs-built_in">never</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span> <span class="hljs-comment">//0</span><br></code></pre></td></tr></table></figure><p><img src="/../img/ts/5e0a471d4f894d6492543f6ee1243f34.png" alt="img"></p><h2 id="never类型"><a href="#never类型" class="headerlink" title="never类型"></a>never类型</h2><p>TypeScript 将使用 never 类型来表示不应该存在的状态</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">// 返回never的函数必须存在无法达到的终点</span><br> <br><span class="hljs-comment">// 因为必定抛出异常，所以 error 将不会有返回值</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">error</span>(<span class="hljs-params">message: <span class="hljs-built_in">string</span></span>): <span class="hljs-built_in">never</span> &#123;<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(message);<br>&#125;<br> <br><span class="hljs-comment">// 因为存在死循环，所以 loop 将不会有返回值</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">loop</span>(<span class="hljs-params"></span>): <span class="hljs-built_in">never</span> &#123;<br>    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) &#123;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="never-与-void-的差异"><a href="#never-与-void-的差异" class="headerlink" title="never 与 void 的差异"></a>never 与 <code>void</code> 的差异</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">//void类型只是没有返回值 但本身不会出错</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Void</span>(<span class="hljs-params"></span>):<span class="hljs-built_in">void</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>();<br>&#125;<br> <br><span class="hljs-comment">//只会抛出异常没有返回值</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Never</span>(<span class="hljs-params"></span>):<span class="hljs-built_in">never</span> &#123;<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;aaa&#x27;</span>)<br>&#125;<br></code></pre></td></tr></table></figure><p>差异2  当我们鼠标移上去的时候会发现 只有void和number  never在联合类型中会被直接移除</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">type</span> A = <span class="hljs-built_in">void</span> | <span class="hljs-built_in">number</span> | <span class="hljs-built_in">never</span><br></code></pre></td></tr></table></figure><h3 id="never-类型的一个应用场景"><a href="#never-类型的一个应用场景" class="headerlink" title="never 类型的一个应用场景"></a>never 类型的一个应用场景</h3><p>举一个我们可能会见到的例子</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">type</span> A = <span class="hljs-string">&#x27;小满&#x27;</span> | <span class="hljs-string">&#x27;大满&#x27;</span> | <span class="hljs-string">&#x27;超大满&#x27;</span> <br> <br><span class="hljs-keyword">function</span> <span class="hljs-title function_">isXiaoMan</span>(<span class="hljs-params">value:A</span>) &#123;<br>   <span class="hljs-keyword">switch</span> (value) &#123;<br>       <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;小满&quot;</span>:<br>           <span class="hljs-keyword">break</span> <br>       <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;大满&quot;</span>:<br>          <span class="hljs-keyword">break</span> <br>       <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;超大满&quot;</span>:<br>          <span class="hljs-keyword">break</span> <br>       <span class="hljs-attr">default</span>:<br>          <span class="hljs-comment">//是用于场景兜底逻辑</span><br>          <span class="hljs-keyword">const</span> <span class="hljs-attr">error</span>:<span class="hljs-built_in">never</span> = value;<br>          <span class="hljs-keyword">return</span> error<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>比如新来了一个同事他新增了一个篮球，我们必须手动找到所有 switch 代码并处理，否则将有可能引入 BUG 。</p><p>而且这将是一个“隐蔽型”的BUG，如果回归面不够广，很难发现此类BUG。</p><p>那 TS 有没有办法帮助我们在类型检查阶段发现这个问题呢？</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs TypeScript"><span class="hljs-keyword">type</span> A = <span class="hljs-string">&#x27;小满&#x27;</span> | <span class="hljs-string">&#x27;大满&#x27;</span> | <span class="hljs-string">&#x27;超大满&#x27;</span> | <span class="hljs-string">&quot;小小满&quot;</span><br> <br><span class="hljs-keyword">function</span> <span class="hljs-title function_">isXiaoMan</span>(<span class="hljs-params">value:A</span>) &#123;<br>   <span class="hljs-keyword">switch</span> (value) &#123;<br>       <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;小满&quot;</span>:<br>           <span class="hljs-keyword">break</span> <br>       <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;大满&quot;</span>:<br>          <span class="hljs-keyword">break</span> <br>       <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;超大满&quot;</span>:<br>          <span class="hljs-keyword">break</span> <br>       <span class="hljs-attr">default</span>:<br>          <span class="hljs-comment">//是用于场景兜底逻辑</span><br>          <span class="hljs-keyword">const</span> <span class="hljs-attr">error</span>:<span class="hljs-built_in">never</span> = value;<br>          <span class="hljs-keyword">return</span> error<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>由于任何类型都不能赋值给 <code>never</code> 类型的变量，所以当存在进入 <code>default</code> 分支的可能性时，TS的类型检查会及时帮我们发现这个问题</p><h2 id="symbol类型"><a href="#symbol类型" class="headerlink" title="symbol类型"></a>symbol类型</h2><p>自ECMAScript 2015起，<code>symbol</code>成为了一种新的原生类型，就像<code>number</code>和<code>string</code>一样。</p><p><code>symbol</code>类型的值是通过<code>Symbol</code>构造函数创建的。</p><p>可以传递参做为唯一标识 只支持 string 和 number类型的参数</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">let</span> sym1 = <span class="hljs-title class_">Symbol</span>();<br><span class="hljs-keyword">let</span> sym2 = <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">&quot;key&quot;</span>); <span class="hljs-comment">// 可选的字符串key</span><br></code></pre></td></tr></table></figure><h3 id="Symbol的值是唯一的"><a href="#Symbol的值是唯一的" class="headerlink" title="Symbol的值是唯一的"></a><strong>Symbol的值是唯一的</strong></h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> s1 = <span class="hljs-title class_">Symbol</span>()<br><span class="hljs-keyword">const</span> s2 = <span class="hljs-title class_">Symbol</span>()<br><span class="hljs-comment">// s1 === s2 =&gt;false</span><br><span class="hljs-comment">// for Symbol for全局symbol有没有注册过这个key，如果有直接拿来用，没有的话她就会去创建一个</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Symbol</span>.<span class="hljs-title function_">for</span>(<span class="hljs-string">&#x27;xie&#x27;</span>) === <span class="hljs-title class_">Symbol</span>.<span class="hljs-title function_">for</span>(<span class="hljs-string">&#x27;xie&#x27;</span>)) <span class="hljs-comment">// true</span><br></code></pre></td></tr></table></figure><h3 id="用作对象属性的键"><a href="#用作对象属性的键" class="headerlink" title="用作对象属性的键"></a>用作对象属性的键</h3><p>解决属性重复的key，仿重</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">let</span> sym = <span class="hljs-title class_">Symbol</span>();<br> <br><span class="hljs-keyword">let</span> obj = &#123;<br>    [sym]: <span class="hljs-string">&quot;value&quot;</span><br>&#125;;<br> <br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj[sym]); <span class="hljs-comment">// &quot;value&quot;</span><br></code></pre></td></tr></table></figure><h3 id="使用symbol定义的属性，是不能通过如下方式遍历拿到的"><a href="#使用symbol定义的属性，是不能通过如下方式遍历拿到的" class="headerlink" title="使用symbol定义的属性，是不能通过如下方式遍历拿到的"></a>使用symbol定义的属性，是不能通过如下方式遍历拿到的</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs TypeScript"><span class="hljs-keyword">const</span> symbol1 = <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">&#x27;666&#x27;</span>)<br><span class="hljs-keyword">const</span> symbol2 = <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">&#x27;777&#x27;</span>)<br><span class="hljs-keyword">const</span> obj1= &#123;<br>   [symbol1]: <span class="hljs-string">&#x27;小满&#x27;</span>,<br>   [symbol2]: <span class="hljs-string">&#x27;二蛋&#x27;</span>,<br>   <span class="hljs-attr">age</span>: <span class="hljs-number">19</span>,<br>   <span class="hljs-attr">sex</span>: <span class="hljs-string">&#x27;女&#x27;</span><br>&#125;<br><span class="hljs-comment">// 1 for in 遍历</span><br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> obj1) &#123;<br>   <span class="hljs-comment">// 注意在console看key,是不是没有遍历到symbol1</span><br>   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(key)<br>&#125;<br><span class="hljs-comment">// 2 Object.keys 遍历</span><br><span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(obj1)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(obj1))<br><span class="hljs-comment">// 3 getOwnPropertyNames</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getOwnPropertyNames</span>(obj1))<br><span class="hljs-comment">// 4 JSON.stringfy</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(obj1))<br></code></pre></td></tr></table></figure><p>如何拿到</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">// 1 拿到具体的symbol 属性,对象中有几个就会拿到几个，但拿不到其他属性，如age</span><br><span class="hljs-title class_">Object</span>. (obj1)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getOwnPropertySymbols</span>(obj1))<br><span class="hljs-comment">// 2 es6 的 Reflect 拿到对象的所有属性</span><br><span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">ownKeys</span>(obj1)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">ownKeys</span>(obj1))<br></code></pre></td></tr></table></figure><h3 id="Symbol-iterator-迭代器-和-生成器-for-of"><a href="#Symbol-iterator-迭代器-和-生成器-for-of" class="headerlink" title="Symbol.iterator 迭代器 和 生成器 for of"></a>Symbol.iterator 迭代器 和 生成器 for of</h3><p>支持遍历大部分类型迭代器 arr nodeList argumetns set map 等</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">var</span> arr = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>];<br><span class="hljs-keyword">let</span> iterator = arr[<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">iterator</span>]();<br> <br><span class="hljs-comment">// 一个一个来，最后没有了done就会返回true</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(iterator.<span class="hljs-title function_">next</span>());  <span class="hljs-comment">//&#123; value: 1, done: false &#125;</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(iterator.<span class="hljs-title function_">next</span>());  <span class="hljs-comment">//&#123; value: 2, done: false &#125;</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(iterator.<span class="hljs-title function_">next</span>());  <span class="hljs-comment">//&#123; value: 3, done: false &#125;</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(iterator.<span class="hljs-title function_">next</span>());  <span class="hljs-comment">//&#123; value: 4, done: false &#125;</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(iterator.<span class="hljs-title function_">next</span>());  <span class="hljs-comment">//&#123; value: undefined, done: true &#125;</span><br></code></pre></td></tr></table></figure><p>测试用例</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Item</span> &#123;<br>    <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>,<br>    <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span><br>&#125;<br><br><span class="hljs-keyword">const</span> <span class="hljs-attr">array</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-title class_">Item</span>&gt; = [&#123; <span class="hljs-attr">age</span>: <span class="hljs-number">123</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;1&quot;</span> &#125;, &#123; <span class="hljs-attr">age</span>: <span class="hljs-number">123</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;2&quot;</span> &#125;, &#123; <span class="hljs-attr">age</span>: <span class="hljs-number">123</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;3&quot;</span> &#125;]<br><br><span class="hljs-keyword">type</span> mapTypes = <span class="hljs-built_in">string</span> | <span class="hljs-built_in">number</span><br><span class="hljs-keyword">const</span> <span class="hljs-attr">map</span>:<span class="hljs-title class_">Map</span>&lt;mapTypes,mapTypes&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>()<br><br>map.<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;王爷&#x27;</span>)<br>map.<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;陆北&#x27;</span>)<br><br><span class="hljs-keyword">const</span> obj = &#123;<br>    <span class="hljs-attr">aaa</span>:<span class="hljs-number">123</span>,<br>    <span class="hljs-attr">bbb</span>:<span class="hljs-number">456</span><br>&#125;<br><br><span class="hljs-keyword">let</span> <span class="hljs-attr">set</span>:<span class="hljs-title class_">Set</span>&lt;<span class="hljs-built_in">number</span>&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>])<br><span class="hljs-comment">// let it:Iterator&lt;Item&gt; = array[Symbol.iterator]()</span><br><span class="hljs-keyword">const</span> gen = (<span class="hljs-attr">erg</span>:<span class="hljs-built_in">any</span>): <span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> &#123;<br>    <span class="hljs-keyword">let</span> <span class="hljs-attr">it</span>: <span class="hljs-title class_">Iterator</span>&lt;<span class="hljs-built_in">any</span>&gt; = erg[<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">iterator</span>]()<br>    <span class="hljs-keyword">let</span> <span class="hljs-attr">next</span>:<span class="hljs-built_in">any</span>= &#123; <span class="hljs-attr">done</span>: <span class="hljs-literal">false</span> &#125;<br>    <span class="hljs-keyword">while</span> (!next.<span class="hljs-property">done</span>) &#123;<br>        next =  it.<span class="hljs-title function_">next</span>()<br>        <span class="hljs-keyword">if</span> (!next.<span class="hljs-property">done</span>) &#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(next.<span class="hljs-property">value</span>)<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-title function_">gen</span>(array)<br></code></pre></td></tr></table></figure><p>我们平时开发中不会手动调用iterator 应为 他是有语法糖的就是<strong>for of</strong>  记住 for of 是不能循环对象的，因为对象没有 iterator  </p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> value <span class="hljs-keyword">of</span> map) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value)<br>&#125;<br></code></pre></td></tr></table></figure><p>数组解构的原理其实也是调用迭代器的</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">var</span> [a,b,c] = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]<br><br><span class="hljs-keyword">var</span> x = [...xxxx]<br></code></pre></td></tr></table></figure><p> 那我们可以自己实现一个迭代器让对象支持for of</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> obj = &#123;<br>    <span class="hljs-attr">max</span>: <span class="hljs-number">5</span>,<br>    <span class="hljs-attr">current</span>: <span class="hljs-number">0</span>,<br>    [<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">iterator</span>]() &#123;<br>        <span class="hljs-keyword">return</span> &#123;<br>            <span class="hljs-attr">max</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">max</span>,<br>            <span class="hljs-attr">current</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">current</span>,<br>            <span class="hljs-title function_">next</span>(<span class="hljs-params"></span>) &#123;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">current</span> == <span class="hljs-variable language_">this</span>.<span class="hljs-property">max</span>) &#123;<br>                    <span class="hljs-keyword">return</span> &#123;<br>                        <span class="hljs-attr">value</span>: <span class="hljs-literal">undefined</span>,<br>                        <span class="hljs-attr">done</span>: <span class="hljs-literal">true</span><br>                    &#125;<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-keyword">return</span> &#123;<br>                        <span class="hljs-attr">value</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">current</span>++,<br>                        <span class="hljs-attr">done</span>: <span class="hljs-literal">false</span><br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>([...obj])<br><br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> val <span class="hljs-keyword">of</span> obj) &#123;<br>   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(val);<br><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="以下为这些symbols的列表"><a href="#以下为这些symbols的列表" class="headerlink" title="以下为这些symbols的列表"></a>以下为这些symbols的列表</h3><ul><li>Symbol.hasInstance</li></ul><p>方法，会被instanceof运算符调用。构造器对象用来识别一个对象是否是其实例。</p><ul><li>Symbol.isConcatSpreadable</li></ul><p>布尔值，表示当在一个对象上调用Array.prototype.concat时，这个对象的数组元素是否可展开。</p><ul><li>Symbol.iterator</li></ul><p>方法，被for-of语句调用。返回对象的默认迭代器。</p><ul><li>Symbol.match</li></ul><p>方法，被String.prototype.match调用。正则表达式用来匹配字符串。</p><ul><li>Symbol.replace</li></ul><p>方法，被String.prototype.replace调用。正则表达式用来替换字符串中匹配的子串。</p><ul><li>Symbol.search</li></ul><p>方法，被String.prototype.search调用。正则表达式返回被匹配部分在字符串中的索引。</p><ul><li>Symbol.species</li></ul><p>函数值，为一个构造函数。用来创建派生对象。</p><ul><li>Symbol.split</li></ul><p>方法，被String.prototype.split调用。正则表达式来用分割字符串。</p><ul><li>Symbol.toPrimitive</li></ul><p>方法，被ToPrimitive抽象操作调用。把对象转换为相应的原始值。</p><ul><li>Symbol.toStringTag</li></ul><p>方法，被内置方法Object.prototype.toString调用。返回创建对象时默认的字符串描述。</p><ul><li>Symbol.unscopables</li></ul><p>对象，它自己拥有的属性会被with作用域排除在外。</p><h2 id="泛型"><a href="#泛型" class="headerlink" title="泛型"></a>泛型</h2><p>泛型在TypeScript 是很重要的东西 例如vue3 是用ts编写的 里面用到了非常多的泛型</p><h3 id="函数泛型"><a href="#函数泛型" class="headerlink" title="函数泛型"></a>函数泛型</h3><p>我写了两个函数一个是数字类型的函数，另一个是字符串类型的函数,其实就是类型不同，</p><p>实现的功能是一样的，这时候我们就可以使用泛型来优化</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">function</span> <span class="hljs-title function_">num</span> (<span class="hljs-attr">a</span>:<span class="hljs-built_in">number</span>,<span class="hljs-attr">b</span>:<span class="hljs-built_in">number</span>) : <span class="hljs-title class_">Array</span>&lt;<span class="hljs-built_in">number</span>&gt; &#123;<br>    <span class="hljs-keyword">return</span> [a ,b];<br>&#125;<br><span class="hljs-title function_">num</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">str</span> (<span class="hljs-attr">a</span>:<span class="hljs-built_in">string</span>,<span class="hljs-attr">b</span>:<span class="hljs-built_in">string</span>) : <span class="hljs-title class_">Array</span>&lt;<span class="hljs-built_in">string</span>&gt; &#123;<br>    <span class="hljs-keyword">return</span> [a ,b];<br>&#125;<br><span class="hljs-title function_">str</span>(<span class="hljs-string">&#x27;独孤&#x27;</span>,<span class="hljs-string">&#x27;求败&#x27;</span>)<br></code></pre></td></tr></table></figure><p><strong>泛型优化</strong></p><p>语法为函数名字后面跟一个&lt;参数名&gt; 参数名可以随便写 例如我这儿写了T</p><p>当我们使用这个函数的时候把参数的类型传进去就可以了 （也就是动态类型）</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">function</span> <span class="hljs-title class_">Add</span>&lt;T&gt;(<span class="hljs-attr">a</span>: T, <span class="hljs-attr">b</span>: T): <span class="hljs-title class_">Array</span>&lt;T&gt;  &#123;<br>    <span class="hljs-keyword">return</span> [a,b]<br>&#125;<br> <br><span class="hljs-title class_">Add</span>&lt;<span class="hljs-built_in">number</span>&gt;(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)<br><span class="hljs-title class_">Add</span>&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>)<br></code></pre></td></tr></table></figure><p>我们也可以使用不同的泛型参数名，只要在数量上和使用方式上能对应上就可以</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">function</span> <span class="hljs-title class_">Sub</span>&lt;T,U&gt;(<span class="hljs-attr">a</span>:T,<span class="hljs-attr">b</span>:U):<span class="hljs-title class_">Array</span>&lt;T|U&gt; &#123;<br>    <span class="hljs-keyword">const</span> <span class="hljs-attr">params</span>:<span class="hljs-title class_">Array</span>&lt;T|U&gt; = [a,b]<br>    <span class="hljs-keyword">return</span> params<br>&#125;<br> <br> <br><span class="hljs-title class_">Sub</span>&lt;<span class="hljs-title class_">Boolean</span>,<span class="hljs-built_in">number</span>&gt;(<span class="hljs-literal">false</span>,<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><h3 id="定义泛型接口"><a href="#定义泛型接口" class="headerlink" title="定义泛型接口"></a>定义泛型接口</h3><p>声明接口的时候 在名字后面加一个&lt;参数&gt;</p><p>使用的时候传递类型</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">MyInter</span>&lt;T&gt; &#123;<br>   (<span class="hljs-attr">arg</span>: T): T<br>&#125;<br> <br><span class="hljs-keyword">function</span> fn&lt;T&gt;(<span class="hljs-attr">arg</span>: T): T &#123;<br>   <span class="hljs-keyword">return</span> arg<br>&#125;<br> <br><span class="hljs-keyword">let</span> <span class="hljs-attr">result</span>: <span class="hljs-title class_">MyInter</span>&lt;<span class="hljs-built_in">number</span>&gt; = fn<br> <br><span class="hljs-title function_">result</span>(<span class="hljs-number">123</span>)<br></code></pre></td></tr></table></figure><h3 id="对象字面量泛型"><a href="#对象字面量泛型" class="headerlink" title="对象字面量泛型"></a>对象字面量泛型</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">let</span> <span class="hljs-attr">foo</span>: &#123; &lt;T&gt;(<span class="hljs-attr">arg</span>: T): T &#125;<br> <br>foo = <span class="hljs-keyword">function</span> &lt;T&gt;(<span class="hljs-attr">arg</span>:T):T &#123;<br>   <span class="hljs-keyword">return</span> arg<br>&#125;<br> <br><span class="hljs-title function_">foo</span>(<span class="hljs-number">123</span>)<br></code></pre></td></tr></table></figure><p><img src="/../img/ts/7457446b9f3e48728ef7d97c585f1403.png" alt="img"></p><p>这时候我们就可以使用泛型约束</p><p>于是，我们就得对使用的泛型进行约束，我们约束其为具有<code>length</code>属性的类型，这里我们会用到<code>interface</code>,代码如下</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Len</span> &#123;<br>   <span class="hljs-attr">length</span>:<span class="hljs-built_in">number</span><br>&#125;<br> <br><span class="hljs-keyword">function</span> getLegnth&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Len</span>&gt;(<span class="hljs-attr">arg</span>:T) &#123;<br>  <span class="hljs-keyword">return</span> arg.<span class="hljs-property">length</span><br>&#125;<br> <br>getLegnth&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-string">&#x27;123&#x27;</span>)<br></code></pre></td></tr></table></figure><h3 id="使用keyof-约束对象"><a href="#使用keyof-约束对象" class="headerlink" title="使用keyof 约束对象"></a>使用keyof 约束对象</h3><p>其中使用了TS泛型和泛型约束。首先定义了T类型并使用extends关键字继承object类型的子类型，然后使用keyof操作符获取T类型的所有键，它的返回 类型是联合 类型，最后利用extends关键字约束 K类型必须为keyof T联合类型的子类型</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">function</span> prop&lt;T, K <span class="hljs-keyword">extends</span> keyof T&gt;(<span class="hljs-attr">obj</span>: T, <span class="hljs-attr">key</span>: K) &#123;<br>   <span class="hljs-keyword">return</span> obj[key]<br>&#125;<br> <br> <br><span class="hljs-keyword">let</span> o = &#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">c</span>: <span class="hljs-number">3</span> &#125;<br> <br><span class="hljs-title function_">prop</span>(o, <span class="hljs-string">&#x27;a&#x27;</span>) <br><span class="hljs-title function_">prop</span>(o, <span class="hljs-string">&#x27;d&#x27;</span>) <span class="hljs-comment">//此时就会报错发现找不到</span><br></code></pre></td></tr></table></figure><h3 id="泛型类"><a href="#泛型类" class="headerlink" title="泛型类"></a>泛型类</h3><p>声明方法跟函数类似名称后面定义&lt;类型&gt;</p><p>使用的时候确定类型new Sub<number>()</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Sub</span>&lt;T&gt;&#123;<br>   <span class="hljs-attr">attr</span>: T[] = [];<br>   add (<span class="hljs-attr">a</span>:T):T[] &#123;<br>      <span class="hljs-keyword">return</span> [a]<br>   &#125;<br>&#125;<br> <br><span class="hljs-keyword">let</span> s = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Sub</span>&lt;<span class="hljs-built_in">number</span>&gt;()<br>s.<span class="hljs-property">attr</span> = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]<br>s.<span class="hljs-title function_">add</span>(<span class="hljs-number">123</span>)<br> <br><span class="hljs-keyword">let</span> str = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Sub</span>&lt;<span class="hljs-built_in">string</span>&gt;()<br>str.<span class="hljs-property">attr</span> = [<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>]<br>str.<span class="hljs-title function_">add</span>(<span class="hljs-string">&#x27;123&#x27;</span>)<br></code></pre></td></tr></table></figure><h2 id="tsconfig-json配置文件"><a href="#tsconfig-json配置文件" class="headerlink" title="tsconfig.json配置文件"></a>tsconfig.json配置文件</h2><h3 id="生成tsconfig-json-文件"><a href="#生成tsconfig-json-文件" class="headerlink" title="生成tsconfig.json 文件"></a>生成tsconfig.json 文件</h3><p>这个文件是通过<code>tsc --init</code>命令生成的</p><p>配置详解</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-string">&quot;compilerOptions&quot;</span>: &#123;<br>  <span class="hljs-string">&quot;incremental&quot;</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// TS编译器在第一次编译之后会生成一个存储编译信息的文件，第二次编译会在第一次的基础上进行增量编译，可以提高编译的速度</span><br>  <span class="hljs-string">&quot;tsBuildInfoFile&quot;</span>: <span class="hljs-string">&quot;./buildFile&quot;</span>, <span class="hljs-comment">// 增量编译文件的存储位置</span><br>  <span class="hljs-string">&quot;diagnostics&quot;</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 打印诊断信息 </span><br>  <span class="hljs-string">&quot;target&quot;</span>: <span class="hljs-string">&quot;ES5&quot;</span>, <span class="hljs-comment">// 目标语言的版本</span><br>  <span class="hljs-string">&quot;module&quot;</span>: <span class="hljs-string">&quot;CommonJS&quot;</span>, <span class="hljs-comment">// 生成代码的模板标准</span><br>  <span class="hljs-string">&quot;outFile&quot;</span>: <span class="hljs-string">&quot;./app.js&quot;</span>, <span class="hljs-comment">// 将多个相互依赖的文件生成一个文件，可以用在AMD模块中，即开启时应设置&quot;module&quot;: &quot;AMD&quot;,</span><br>  <span class="hljs-string">&quot;lib&quot;</span>: [<span class="hljs-string">&quot;DOM&quot;</span>, <span class="hljs-string">&quot;ES2015&quot;</span>, <span class="hljs-string">&quot;ScriptHost&quot;</span>, <span class="hljs-string">&quot;ES2019.Array&quot;</span>], <span class="hljs-comment">// TS需要引用的库，即声明文件，es5 默认引用dom、es5、scripthost,如需要使用es的高级版本特性，通常都需要配置，如es8的数组新特性需要引入&quot;ES2019.Array&quot;,</span><br>  <span class="hljs-string">&quot;allowJS&quot;</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 允许编译器编译JS，JSX文件</span><br>  <span class="hljs-string">&quot;checkJs&quot;</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 允许在JS文件中报错，通常与allowJS一起使用</span><br>  <span class="hljs-string">&quot;outDir&quot;</span>: <span class="hljs-string">&quot;./dist&quot;</span>, <span class="hljs-comment">// 指定输出目录</span><br>  <span class="hljs-string">&quot;rootDir&quot;</span>: <span class="hljs-string">&quot;./&quot;</span>, <span class="hljs-comment">// 指定输出文件目录(用于输出)，用于控制输出目录结构</span><br>  <span class="hljs-string">&quot;declaration&quot;</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 生成声明文件，开启后会自动生成声明文件</span><br>  <span class="hljs-string">&quot;declarationDir&quot;</span>: <span class="hljs-string">&quot;./file&quot;</span>, <span class="hljs-comment">// 指定生成声明文件存放目录</span><br>  <span class="hljs-string">&quot;emitDeclarationOnly&quot;</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 只生成声明文件，而不会生成js文件</span><br>  <span class="hljs-string">&quot;sourceMap&quot;</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 生成目标文件的sourceMap文件</span><br>  <span class="hljs-string">&quot;inlineSourceMap&quot;</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 生成目标文件的inline SourceMap，inline SourceMap会包含在生成的js文件中</span><br>  <span class="hljs-string">&quot;declarationMap&quot;</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 为声明文件生成sourceMap</span><br>  <span class="hljs-string">&quot;typeRoots&quot;</span>: [], <span class="hljs-comment">// 声明文件目录，默认时node_modules/@types</span><br>  <span class="hljs-string">&quot;types&quot;</span>: [], <span class="hljs-comment">// 加载的声明文件包</span><br>  <span class="hljs-string">&quot;removeComments&quot;</span>:<span class="hljs-literal">true</span>, <span class="hljs-comment">// 删除注释 </span><br>  <span class="hljs-string">&quot;noEmit&quot;</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 不输出文件,即编译后不会生成任何js文件</span><br>  <span class="hljs-string">&quot;noEmitOnError&quot;</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 发送错误时不输出任何文件</span><br>  <span class="hljs-string">&quot;noEmitHelpers&quot;</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 不生成helper函数，减小体积，需要额外安装，常配合importHelpers一起使用</span><br>  <span class="hljs-string">&quot;importHelpers&quot;</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 通过tslib引入helper函数，文件必须是模块</span><br>  <span class="hljs-string">&quot;downlevelIteration&quot;</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 降级遍历器实现，如果目标源是es3/5，那么遍历器会有降级的实现</span><br>  <span class="hljs-string">&quot;strict&quot;</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 开启所有严格的类型检查</span><br>  <span class="hljs-string">&quot;alwaysStrict&quot;</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 在代码中注入&#x27;use strict&#x27;</span><br>  <span class="hljs-string">&quot;noImplicitAny&quot;</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 不允许隐式的any类型</span><br>  <span class="hljs-string">&quot;strictNullChecks&quot;</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 不允许把null、undefined赋值给其他类型的变量</span><br>  <span class="hljs-string">&quot;strictFunctionTypes&quot;</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 不允许函数参数双向协变</span><br>  <span class="hljs-string">&quot;strictPropertyInitialization&quot;</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 类的实例属性必须初始化</span><br>  <span class="hljs-string">&quot;strictBindCallApply&quot;</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 严格的bind/call/apply检查</span><br>  <span class="hljs-string">&quot;noImplicitThis&quot;</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 不允许this有隐式的any类型</span><br>  <span class="hljs-string">&quot;noUnusedLocals&quot;</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 检查只声明、未使用的局部变量(只提示不报错)</span><br>  <span class="hljs-string">&quot;noUnusedParameters&quot;</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 检查未使用的函数参数(只提示不报错)</span><br>  <span class="hljs-string">&quot;noFallthroughCasesInSwitch&quot;</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 防止switch语句贯穿(即如果没有break语句后面不会执行)</span><br>  <span class="hljs-string">&quot;noImplicitReturns&quot;</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">//每个分支都会有返回值</span><br>  <span class="hljs-string">&quot;esModuleInterop&quot;</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 允许export=导出，由import from 导入</span><br>  <span class="hljs-string">&quot;allowUmdGlobalAccess&quot;</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 允许在模块中全局变量的方式访问umd模块</span><br>  <span class="hljs-string">&quot;moduleResolution&quot;</span>: <span class="hljs-string">&quot;node&quot;</span>, <span class="hljs-comment">// 模块解析策略，ts默认用node的解析策略，即相对的方式导入</span><br>  <span class="hljs-string">&quot;baseUrl&quot;</span>: <span class="hljs-string">&quot;./&quot;</span>, <span class="hljs-comment">// 解析非相对模块的基地址，默认是当前目录</span><br>  <span class="hljs-string">&quot;paths&quot;</span>: &#123; <span class="hljs-comment">// 路径映射，相对于baseUrl</span><br>    <span class="hljs-comment">// 如使用jq时不想使用默认版本，而需要手动指定版本，可进行如下配置</span><br>    <span class="hljs-string">&quot;jquery&quot;</span>: [<span class="hljs-string">&quot;node_modules/jquery/dist/jquery.min.js&quot;</span>]<br>  &#125;,<br>  <span class="hljs-string">&quot;rootDirs&quot;</span>: [<span class="hljs-string">&quot;src&quot;</span>,<span class="hljs-string">&quot;out&quot;</span>], <span class="hljs-comment">// 将多个目录放在一个虚拟目录下，用于运行时，即编译后引入文件的位置可能发生变化，这也设置可以虚拟src和out在同一个目录下，不用再去改变路径也不会报错</span><br>  <span class="hljs-string">&quot;listEmittedFiles&quot;</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 打印输出文件</span><br>  <span class="hljs-string">&quot;listFiles&quot;</span>: <span class="hljs-literal">true</span><span class="hljs-comment">// 打印编译的文件(包括引用的声明文件)</span><br>&#125;<br> <br><span class="hljs-comment">// 指定一个匹配列表（属于自动指定该路径下的所有ts相关文件）</span><br><span class="hljs-string">&quot;include&quot;</span>: [<br>   <span class="hljs-string">&quot;src/**/*&quot;</span><br>],<br><span class="hljs-comment">// 指定一个排除列表（include的反向操作）</span><br> <span class="hljs-string">&quot;exclude&quot;</span>: [<br>   <span class="hljs-string">&quot;demo.ts&quot;</span><br>],<br><span class="hljs-comment">// 指定哪些文件使用该配置（属于手动一个个指定文件）</span><br> <span class="hljs-string">&quot;files&quot;</span>: [<br>   <span class="hljs-string">&quot;demo.ts&quot;</span><br>]<br></code></pre></td></tr></table></figure><p> 介绍几个常用的</p><h3 id="1-include"><a href="#1-include" class="headerlink" title="1.include"></a>1.include</h3><p>指定编译文件默认是编译当前目录下所有的ts文件</p><h3 id="2-exclude"><a href="#2-exclude" class="headerlink" title="2.exclude"></a>2.exclude</h3><p>指定排除的文件</p><h3 id="3-target"><a href="#3-target" class="headerlink" title="3.target"></a>3.target</h3><p>指定编译js 的版本例如es5  es6</p><h3 id="4-allowJS"><a href="#4-allowJS" class="headerlink" title="4.allowJS"></a>4.allowJS</h3><p>是否允许编译js文件</p><h3 id="5-removeComments"><a href="#5-removeComments" class="headerlink" title="5.removeComments"></a>5.removeComments</h3><p>是否在编译过程中删除文件中的注释</p><h3 id="6-rootDir"><a href="#6-rootDir" class="headerlink" title="6.rootDir"></a>6.rootDir</h3><p>编译文件的目录</p><h3 id="7-outDir"><a href="#7-outDir" class="headerlink" title="7.outDir"></a>7.outDir</h3><p>输出的目录</p><h3 id="8-sourceMap"><a href="#8-sourceMap" class="headerlink" title="8.sourceMap"></a>8.sourceMap</h3><p>代码源文件</p><h3 id="9-strict"><a href="#9-strict" class="headerlink" title="9.strict"></a>9.strict</h3><p>严格模式</p><h3 id="10-module"><a href="#10-module" class="headerlink" title="10.module"></a>10.module</h3><p>默认common.js  可选es6模式 amd  umd 等</p><h2 id="namespace命名空间"><a href="#namespace命名空间" class="headerlink" title="namespace命名空间"></a>namespace命名空间</h2><p>我们在工作中无法避免全局变量造成的污染，TypeScript提供了namespace 避免这个问题出现</p><ul><li>内部模块，主要用于组织代码，避免命名冲突。</li><li>命名空间内的类默认私有</li><li>通过 <code>export</code> 暴露</li><li>通过 <code>namespace</code> 关键字定义</li></ul><blockquote><p>TypeScript与ECMAScript 2015一样，任何包含顶级<code>import</code>或者<code>export</code>的文件都被当成一个模块。相反地，如果一个文件不带有顶级的<code>import</code>或者<code>export</code>声明，那么它的内容被视为全局可见的（因此对模块也是可见的）</p></blockquote><p>命名空间中通过<code>export</code>将想要暴露的部分导出</p><p>如果不用export 导出是无法读取其值的</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">namespace</span> a &#123;<br>    <span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">Time</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1000</span><br>    <span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> fn = &lt;T&gt;(<span class="hljs-attr">arg</span>: T): <span class="hljs-function"><span class="hljs-params">T</span> =&gt;</span> &#123;<br>        <span class="hljs-keyword">return</span> arg<br>    &#125;<br>    <span class="hljs-title function_">fn</span>(<span class="hljs-title class_">Time</span>)<br>&#125;<br> <br> <br><span class="hljs-keyword">namespace</span> b &#123;<br>     <span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">Time</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1000</span><br>     <span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> fn = &lt;T&gt;(<span class="hljs-attr">arg</span>: T): <span class="hljs-function"><span class="hljs-params">T</span> =&gt;</span> &#123;<br>        <span class="hljs-keyword">return</span> arg<br>    &#125;<br>    <span class="hljs-title function_">fn</span>(<span class="hljs-title class_">Time</span>)<br>&#125;<br> <br>a.<span class="hljs-property">Time</span><br>b.<span class="hljs-property">Time</span><br></code></pre></td></tr></table></figure><p>嵌套命名空间</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">namespace</span> a &#123;<br>    <span class="hljs-keyword">export</span> <span class="hljs-keyword">namespace</span> b &#123;<br>        <span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Vue</span> &#123;<br>            <span class="hljs-attr">parameters</span>: <span class="hljs-built_in">string</span><br>            <span class="hljs-title function_">constructor</span>(<span class="hljs-params">parameters: <span class="hljs-built_in">string</span></span>) &#123;<br>                <span class="hljs-variable language_">this</span>.<span class="hljs-property">parameters</span> = parameters<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br> <br><span class="hljs-keyword">let</span> v = a.<span class="hljs-property">b</span>.<span class="hljs-property">Vue</span><br> <br><span class="hljs-keyword">new</span> <span class="hljs-title function_">v</span>(<span class="hljs-string">&#x27;1&#x27;</span>)<br></code></pre></td></tr></table></figure><p>抽离命名空间</p><p>a.ts</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">namespace</span> V &#123;<br>    <span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> a = <span class="hljs-number">1</span><br>&#125;<br></code></pre></td></tr></table></figure><p>b.ts</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> &#123;V&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../observer/index&#x27;</span><br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(V);<br></code></pre></td></tr></table></figure><p> &#x2F;&#x2F;{a:1}</p><p>简化命名空间</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">namespace</span> A  &#123;<br>    <span class="hljs-keyword">export</span> <span class="hljs-keyword">namespace</span> B &#123;<br>        <span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> C = <span class="hljs-number">1</span><br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">import</span> X = A.<span class="hljs-property">B</span>.<span class="hljs-property">C</span><br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(X);<br></code></pre></td></tr></table></figure><p>合并命名空间</p><p>重名的命名空间会合并</p><p><img src="/../img/ts/bf816965597949c69329ad5f17e0efd5.png" alt="img"></p><h2 id="三斜线指令"><a href="#三斜线指令" class="headerlink" title="三斜线指令"></a>三斜线指令</h2><p>三斜线指令是包含单个XML标签的单行注释。 注释的内容会做为编译器指令使用。</p><p>三斜线指令仅可放在包含它的文件的最顶端。 一个三斜线指令的前面只能出现单行或多行注释，这包括其它的三斜线指令。 如果它们出现在一个语句或声明之后，那么它们会被当做普通的单行注释，并且不具有特殊的涵义。</p><p><code>/// &lt;reference path=&quot;...&quot; /&gt;</code>指令是三斜线指令中最常见的一种。 它用于声明文件间的 依赖。</p><p>三斜线引用告诉编译器在编译过程中要引入的额外的文件。</p><p>你也可以把它理解能import，它可以告诉编译器在编译过程中要引入的额外的文件<br>例如a.ts</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">namespace</span> A &#123;<br>    <span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">fn</span> = (<span class="hljs-params"></span>) =&gt; <span class="hljs-string">&#x27;a&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>b.ts</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">namespace</span> A &#123;<br>    <span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">fn2</span> = (<span class="hljs-params"></span>) =&gt; <span class="hljs-string">&#x27;b&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>index.ts</p><p>引入之后直接可以使用变量A</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">///&lt;reference path=&quot;./index2.ts&quot; /&gt;</span><br><span class="hljs-comment">///&lt;reference path=&quot;./index3.ts&quot; /&gt;</span><br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(A);<br></code></pre></td></tr></table></figure><p>声明文件引入</p><p>例如，把<code> /// &lt;reference types=&quot;node&quot; /&gt;</code>引入到声明文件，表明这个文件使用了 <code>@types/node/index.d.ts</code>里面声明的名字； 并且，这个包需要在编译阶段与声明文件一起被包含进来。</p><p>仅当在你需要写一个d.ts文件时才使用这个指令。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">///&lt;reference types=&quot;node&quot; /&gt;</span><br></code></pre></td></tr></table></figure><p>注意事项：</p><p>如果你在配置文件 配置了noResolve 或者自身调用自身文件会报错</p><p><img src="/../img/ts/d5f623bd195e4d6c8104b151a0dd2e09.png" alt="img"></p><h2 id="声明文件d-ts"><a href="#声明文件d-ts" class="headerlink" title="声明文件d.ts"></a>声明文件d.ts</h2><h3 id="声明文件-declare"><a href="#声明文件-declare" class="headerlink" title="声明文件 declare"></a>声明文件 declare</h3><p>当使用第三方库时，我们需要引用它的声明文件，才能获得对应的代码补全、接口提示等功能。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">declare</span> <span class="hljs-keyword">var</span> 声明全局变量<br><span class="hljs-keyword">declare</span> <span class="hljs-keyword">function</span> 声明全局方法<br><span class="hljs-keyword">declare</span> <span class="hljs-keyword">class</span> 声明全局类<br><span class="hljs-keyword">declare</span> <span class="hljs-keyword">enum</span> 声明全局枚举类型<br><span class="hljs-keyword">declare</span> <span class="hljs-keyword">namespace</span> 声明（含有子属性的）全局对象<br>interface 和 type 声明全局类型<br>/// &lt;reference /&gt; 三斜线指令<br></code></pre></td></tr></table></figure><p>例如我们有一个express 和 axios</p><p><img src="/../img/ts/4846847abe1f4359b777584e7a237c72.png" alt="img"></p><p> 发现express 报错了</p><p>让我们去下载他的声明文件</p><p>npm install @types&#x2F;node -D</p><p>那为什么axios 没有报错</p><p>我们可以去node_modules 下面去找axios 的package json</p><p><img src="/../img/ts/56e5d930f9144c3aaf50faf638906976.png" alt="img"></p><p> 发现axios已经指定了声明文件 所以没有报错可以直接用</p><p>通过语法declare 暴露我们声明的axios 对象</p><p>declare  const axios: AxiosStatic;</p><p>如果有一些第三方包确实没有声明文件我们可以自己去定义</p><p>名称.d.ts 创建一个文件去声明</p><h3 id="案例手写声明文件"><a href="#案例手写声明文件" class="headerlink" title="案例手写声明文件"></a>案例手写声明文件</h3><p><strong>index.ts</strong></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> express <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;express&#x27;</span><br> <br> <br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>()<br> <br><span class="hljs-keyword">const</span> router = express.<span class="hljs-title class_">Router</span>()<br> <br>app.<span class="hljs-title function_">use</span>(<span class="hljs-string">&#x27;/api&#x27;</span>, router)<br> <br>router.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/list&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>    res.<span class="hljs-title function_">json</span>(&#123;<br>        <span class="hljs-attr">code</span>: <span class="hljs-number">200</span><br>    &#125;)<br>&#125;)<br> <br>app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">9001</span>,<span class="hljs-function">()=&gt;</span>&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">9001</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><p><strong>express.d.ts</strong></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">declare</span> <span class="hljs-variable language_">module</span> <span class="hljs-string">&#x27;express&#x27;</span> &#123;<br>    <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Router</span> &#123;<br>        <span class="hljs-title function_">get</span>(<span class="hljs-attr">path</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">cb</span>: <span class="hljs-function">(<span class="hljs-params">req: <span class="hljs-built_in">any</span>, res: <span class="hljs-built_in">any</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>): <span class="hljs-built_in">void</span><br>    &#125;<br>    <span class="hljs-keyword">interface</span> <span class="hljs-title class_">App</span> &#123;<br> <br>        <span class="hljs-title function_">use</span>(<span class="hljs-attr">path</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">router</span>: <span class="hljs-built_in">any</span>): <span class="hljs-built_in">void</span><br>        <span class="hljs-title function_">listen</span>(<span class="hljs-attr">port</span>: <span class="hljs-built_in">number</span>, cb?: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>): <span class="hljs-built_in">void</span><br>    &#125;<br>    <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Express</span> &#123;<br>        (): <span class="hljs-title class_">App</span><br>        <span class="hljs-title class_">Router</span>(): <span class="hljs-title class_">Router</span><br> <br>    &#125;<br>    <span class="hljs-keyword">const</span> <span class="hljs-attr">express</span>: <span class="hljs-title class_">Express</span><br>    <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> express<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="Mixins混入"><a href="#Mixins混入" class="headerlink" title="Mixins混入"></a>Mixins混入</h2><p>TypeScript 混入 Mixins 其实vue也有mixins这个东西 你可以把他看作为合并</p><h3 id="1-对象混入"><a href="#1-对象混入" class="headerlink" title="1.对象混入"></a>1.对象混入</h3><p>可以使用es6的Object.assign 合并多个对象</p><p>此时 people 会被推断成一个交差类型 Name &amp; Age &amp; sex;</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Name</span> &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span><br>&#125;<br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Age</span> &#123;<br>    <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span><br>&#125;<br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Sex</span> &#123;<br>    <span class="hljs-attr">sex</span>: <span class="hljs-built_in">number</span><br>&#125;<br> <br><span class="hljs-keyword">let</span> <span class="hljs-attr">people1</span>: <span class="hljs-title class_">Name</span> = &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;小满&quot;</span> &#125;<br><span class="hljs-keyword">let</span> <span class="hljs-attr">people2</span>: <span class="hljs-title class_">Age</span> = &#123; <span class="hljs-attr">age</span>: <span class="hljs-number">20</span> &#125;<br><span class="hljs-keyword">let</span> <span class="hljs-attr">people3</span>: <span class="hljs-title class_">Sex</span> = &#123; <span class="hljs-attr">sex</span>: <span class="hljs-number">1</span> &#125;<br> <br><span class="hljs-keyword">const</span> people = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(people1,people2,people3)<br></code></pre></td></tr></table></figure><h3 id="2-类的混入"><a href="#2-类的混入" class="headerlink" title="2.类的混入"></a>2.类的混入</h3><p>首先声明两个mixins类 （严格模式要关闭不然编译不过）</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> &#123;<br>    <span class="hljs-attr">type</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;<br>    <span class="hljs-title function_">changeType</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">type</span> = !<span class="hljs-variable language_">this</span>.<span class="hljs-property">type</span><br>    &#125;<br>&#125;<br> <br> <br><span class="hljs-keyword">class</span> <span class="hljs-title class_">B</span> &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">&#x27;张三&#x27;</span>;<br>    <span class="hljs-title function_">getName</span>(): <span class="hljs-built_in">string</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>下面创建一个类，结合了这两个mixins</p><p>首先应该注意到的是，没使用extends而是使用implements。 把类当成了接口</p><p>我们可以这么做来达到目的，为将要mixin进来的属性方法创建出占位属性。 这告诉编译器这些成员在运行时是可用的。 这样就能使用mixin带来的便利，虽说需要提前定义一些占位属性</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">class</span> <span class="hljs-title class_">C</span> <span class="hljs-keyword">implements</span> A,B&#123;<br>    <span class="hljs-attr">type</span>:<span class="hljs-built_in">boolean</span><br>    <span class="hljs-attr">changeType</span>:<span class="hljs-function">()=&gt;</span><span class="hljs-built_in">void</span>;<br>    <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;<br>    <span class="hljs-attr">getName</span>:<span class="hljs-function">()=&gt;</span> <span class="hljs-built_in">string</span><br>&#125;<br></code></pre></td></tr></table></figure><p>最后，创建这个帮助函数，帮我们做混入操作。 它会遍历mixins上的所有属性，并复制到目标上去，把之前的占位属性替换成真正的实现代码</p><p>Object.getOwnPropertyNames()可以获取对象自身的属性，除去他继承来的属性，<br>对它所有的属性遍历，它是一个数组，遍历一下它所有的属性名</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-title class_">Mixins</span>(C, [A, B])<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Mixins</span>(<span class="hljs-params">curCls: <span class="hljs-built_in">any</span>, itemCls: <span class="hljs-built_in">any</span>[]</span>) &#123;<br>    itemCls.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> &#123;<br>        <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getOwnPropertyNames</span>(item.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">name</span> =&gt;</span> &#123;<br>            curCls.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>[name] = item.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>[name]<br>        &#125;)<br>    &#125;)<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="装饰器Decorator"><a href="#装饰器Decorator" class="headerlink" title="装饰器Decorator"></a>装饰器Decorator</h2><p>它们不仅增加了代码的可读性，清晰地表达了意图，而且提供一种方便的手段，增加或修改类的功能</p><p>若要启用实验性的装饰器特性，你必须在命令行或<code>tsconfig.json</code>里启用编译器选项</p><p><img src="/../img/ts/60df9a1067bf4dbd89d5a19897367f27.png" alt="img"></p><h3 id="装饰器"><a href="#装饰器" class="headerlink" title="装饰器"></a>装饰器</h3><p><em>装饰器</em>是一种特殊类型的声明，它能够被附加到类声明，方法， 访问符，属性或参数上。</p><p>首先定义一个类</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;<br> <br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>定义一个类装饰器函数 他会把ClassA的构造函数传入你的watcher函数当做第一个参数</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> <span class="hljs-attr">watcher</span>: <span class="hljs-title class_">ClassDecorator</span> = <span class="hljs-function">(<span class="hljs-params">target: <span class="hljs-built_in">Function</span></span>) =&gt;</span> &#123;<br>    target.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">getParams</span> = &lt;T&gt;(<span class="hljs-attr">params</span>: T):<span class="hljs-function"><span class="hljs-params">T</span> =&gt;</span> &#123;<br>        <span class="hljs-keyword">return</span> params<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>使用的时候 直接通过@函数名使用</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-meta">@watcher</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;<br> <br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>验证</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> a = <span class="hljs-keyword">new</span> <span class="hljs-title function_">A</span>();<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>((a <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>).<span class="hljs-title function_">getParams</span>(<span class="hljs-string">&#x27;123&#x27;</span>));<br></code></pre></td></tr></table></figure><h3 id="装饰器工厂"><a href="#装饰器工厂" class="headerlink" title="装饰器工厂"></a>装饰器工厂</h3><p>其实也就是一个高阶函数 外层的函数接受值 里层的函数最终接受类的构造函数</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> watcher = (<span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>): <span class="hljs-function"><span class="hljs-params">ClassDecorator</span> =&gt;</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-function">(<span class="hljs-params">target: <span class="hljs-built_in">Function</span></span>) =&gt;</span> &#123;<br>        target.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">getParams</span> = &lt;T&gt;(<span class="hljs-attr">params</span>: T): <span class="hljs-function"><span class="hljs-params">T</span> =&gt;</span> &#123;<br>            <span class="hljs-keyword">return</span> params<br>        &#125;<br>        target.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">getOptions</span> = (): <span class="hljs-function"><span class="hljs-params">string</span> =&gt;</span> &#123;<br>            <span class="hljs-keyword">return</span> name<br>        &#125;<br>    &#125;<br>&#125;<br> <br><span class="hljs-meta">@watcher</span>(<span class="hljs-string">&#x27;name&#x27;</span>)<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;<br> <br>    &#125;<br>&#125;<br> <br><span class="hljs-keyword">const</span> a = <span class="hljs-keyword">new</span> <span class="hljs-title function_">A</span>();<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>((a <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>).<span class="hljs-title function_">getParams</span>(<span class="hljs-string">&#x27;123&#x27;</span>));<br></code></pre></td></tr></table></figure><h3 id="装饰器组合"><a href="#装饰器组合" class="headerlink" title="装饰器组合"></a>装饰器组合</h3><p>就是可以使用多个装饰器</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> watcher = (<span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>): <span class="hljs-function"><span class="hljs-params">ClassDecorator</span> =&gt;</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-function">(<span class="hljs-params">target: <span class="hljs-built_in">Function</span></span>) =&gt;</span> &#123;<br>        target.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">getParams</span> = &lt;T&gt;(<span class="hljs-attr">params</span>: T): <span class="hljs-function"><span class="hljs-params">T</span> =&gt;</span> &#123;<br>            <span class="hljs-keyword">return</span> params<br>        &#125;<br>        target.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">getOptions</span> = (): <span class="hljs-function"><span class="hljs-params">string</span> =&gt;</span> &#123;<br>            <span class="hljs-keyword">return</span> name<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">const</span> watcher2 = (<span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>): <span class="hljs-function"><span class="hljs-params">ClassDecorator</span> =&gt;</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-function">(<span class="hljs-params">target: <span class="hljs-built_in">Function</span></span>) =&gt;</span> &#123;<br>        target.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">getNames</span> = ():<span class="hljs-function"><span class="hljs-params">string</span> =&gt;</span> &#123;<br>            <span class="hljs-keyword">return</span> name<br>        &#125;<br>    &#125;<br>&#125;<br> <br><span class="hljs-meta">@watcher2</span>(<span class="hljs-string">&#x27;name2&#x27;</span>)<br><span class="hljs-meta">@watcher</span>(<span class="hljs-string">&#x27;name&#x27;</span>)<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;<br> <br>    &#125;<br>&#125;<br> <br> <br><span class="hljs-keyword">const</span> a = <span class="hljs-keyword">new</span> <span class="hljs-title function_">A</span>();<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>((a <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>).<span class="hljs-title function_">getOptions</span>());<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>((a <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>).<span class="hljs-title function_">getNames</span>());<br></code></pre></td></tr></table></figure><h3 id="方法装饰器"><a href="#方法装饰器" class="headerlink" title="方法装饰器"></a>方法装饰器</h3><p>返回三个参数</p><ol><li>对于静态成员来说是类的构造函数，对于实例成员是类的原型对象。</li><li>成员的名字。</li><li>成员的<em>属性描述符</em>。</li></ol><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs ts">[<br>  &#123;&#125;,<br>  <span class="hljs-string">&#x27;setParasm&#x27;</span>,<br>  &#123;<br>    <span class="hljs-attr">value</span>: [<span class="hljs-title class_">Function</span>: setParasm],<br>    <span class="hljs-attr">writable</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">false</span>,<br>    <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span><br>  &#125;<br>]<br></code></pre></td></tr></table></figure><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> <span class="hljs-attr">met</span>:<span class="hljs-title class_">MethodDecorator</span> = <span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(args);<br>&#125;<br> <br><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;<br> <br>    &#125;<br>    <span class="hljs-meta">@met</span><br>    getName ():<span class="hljs-built_in">string</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;小满&#x27;</span><br>    &#125;<br>&#125;<br> <br> <br><span class="hljs-keyword">const</span> a = <span class="hljs-keyword">new</span> <span class="hljs-title function_">A</span>();<br></code></pre></td></tr></table></figure><h3 id="属性装饰器"><a href="#属性装饰器" class="headerlink" title="属性装饰器"></a>属性装饰器</h3><p>返回两个参数</p><ol><li>对于静态成员来说是类的构造函数，对于实例成员是类的原型对象。</li><li>属性的名字。</li></ol><p>[ {}, ‘name’, undefined ]</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> <span class="hljs-attr">met</span>:<span class="hljs-title class_">PropertyDecorator</span> = <span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(args);<br>&#125;<br> <br><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> &#123;<br>    <span class="hljs-meta">@met</span><br>    <span class="hljs-attr">name</span>:<span class="hljs-built_in">string</span><br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;<br> <br>    &#125;<br>   <br>&#125;<br> <br> <br><span class="hljs-keyword">const</span> a = <span class="hljs-keyword">new</span> <span class="hljs-title function_">A</span>();<br></code></pre></td></tr></table></figure><h3 id="参数装饰器"><a href="#参数装饰器" class="headerlink" title="参数装饰器"></a>参数装饰器</h3><p>返回三个参数</p><ol><li>对于静态成员来说是类的构造函数，对于实例成员是类的原型对象。</li><li>成员的名字。</li><li>参数在函数参数列表中的索引。</li></ol><p>[ {}, ‘setParasm’, 0 ]</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> <span class="hljs-attr">met</span>:<span class="hljs-title class_">ParameterDecorator</span> = <span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(args);<br>&#125;<br> <br><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;<br> <br>    &#125;<br>    setParasm (<span class="hljs-meta">@met</span> <span class="hljs-attr">name</span>:<span class="hljs-built_in">string</span> = <span class="hljs-string">&#x27;213&#x27;</span>) &#123;<br> <br>    &#125;<br>&#125;<br> <br> <br><span class="hljs-keyword">const</span> a = <span class="hljs-keyword">new</span> <span class="hljs-title function_">A</span>();<br></code></pre></td></tr></table></figure><p>元数据存储</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;reflect-metadata&#x27;</span><br></code></pre></td></tr></table></figure><p>可以快速存储元数据然后在用到的地方取出来 defineMetadata getMetadata</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">//1.类装饰器 ClassDecorator </span><br><span class="hljs-comment">//2.属性装饰器 PropertyDecorator</span><br><span class="hljs-comment">//3.参数装饰器 ParameterDecorator</span><br><span class="hljs-comment">//4.方法装饰器 MethodDecorator PropertyDescriptor &#x27;https://api.apiopen.top/api/getHaoKanVideo?page=0&amp;size=10&#x27;</span><br><span class="hljs-comment">//5.装饰器工厂</span><br><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;axios&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;reflect-metadata&#x27;</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">Base</span>  = (<span class="hljs-params">base:<span class="hljs-built_in">string</span></span>) =&gt; &#123;<br>    <span class="hljs-keyword">const</span> <span class="hljs-attr">fn</span>:<span class="hljs-title class_">ClassDecorator</span> = <span class="hljs-function">(<span class="hljs-params">target</span>) =&gt;</span> &#123;<br>        target.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">base</span> = base;<br>    &#125;<br>    <span class="hljs-keyword">return</span> fn<br>&#125; <br> <br><span class="hljs-keyword">const</span> <span class="hljs-title function_">Get</span> = (<span class="hljs-params">url:<span class="hljs-built_in">string</span></span>) =&gt; &#123;<br>   <span class="hljs-keyword">const</span> <span class="hljs-attr">fn</span>:<span class="hljs-title class_">MethodDecorator</span> = <span class="hljs-function">(<span class="hljs-params">target:<span class="hljs-built_in">any</span>,key,descriptor:PropertyDescriptor</span>) =&gt;</span> &#123;<br>        axios.<span class="hljs-title function_">get</span>(url).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span>=&gt;</span>&#123;<br>            <span class="hljs-keyword">const</span> key = <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">getMetadata</span>(<span class="hljs-string">&#x27;key&#x27;</span>,target)<br>            descriptor.<span class="hljs-title function_">value</span>(key ? res.<span class="hljs-property">data</span>[key] : res.<span class="hljs-property">data</span>)<br>        &#125;)<br>        <br>   &#125;<br>   <span class="hljs-keyword">return</span> fn<br>&#125;<br> <br><span class="hljs-keyword">const</span> <span class="hljs-title function_">result</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-keyword">const</span> <span class="hljs-attr">fn</span>:<span class="hljs-title class_">ParameterDecorator</span> = <span class="hljs-function">(<span class="hljs-params">target:<span class="hljs-built_in">any</span>,key,index</span>) =&gt;</span> &#123;<br>        <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">defineMetadata</span>(<span class="hljs-string">&#x27;key&#x27;</span>,<span class="hljs-string">&#x27;result&#x27;</span>,target)<br>    &#125;<br>    <span class="hljs-keyword">return</span> fn<br>&#125;<br> <br><span class="hljs-keyword">const</span> <span class="hljs-title class_">Bt</span>:<span class="hljs-title class_">PropertyDecorator</span> = <span class="hljs-function">(<span class="hljs-params">target,key</span>) =&gt;</span> &#123;<br>   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(target,key)<br>&#125;<br> <br><span class="hljs-meta">@Base</span>(<span class="hljs-string">&#x27;/api&#x27;</span>)<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Http</span> &#123;<br>    <span class="hljs-meta">@Bt</span><br>    <span class="hljs-attr">xiaoman</span>:<span class="hljs-built_in">string</span><br>    <span class="hljs-title function_">constructor</span> () &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">xiaoman</span> = <span class="hljs-string">&#x27;xiaoman&#x27;</span><br>    &#125;<br>    <span class="hljs-meta">@Get</span>(<span class="hljs-string">&#x27;https://api.apiopen.top/api/getHaoKanVideo?page=0&amp;size=10&#x27;</span>)<br>    getList (<span class="hljs-meta">@result</span>() <span class="hljs-attr">data</span>:<span class="hljs-built_in">any</span>) &#123;<br>        <span class="hljs-comment">// console.log(data)</span><br>         <br>    &#125;<br>    <span class="hljs-comment">// @Post(&#x27;/aaaa&#x27;)</span><br>    create () &#123;<br> <br>    &#125;<br>&#125;<br> <br><span class="hljs-keyword">const</span> http = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Http</span>() <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span><br> <br><span class="hljs-comment">// console.log(http.base)</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>前端</tag>
      
      <tag>ts</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>请求</title>
    <link href="/2023/04/22/%E8%AF%B7%E6%B1%82/"/>
    <url>/2023/04/22/%E8%AF%B7%E6%B1%82/</url>
    
    <content type="html"><![CDATA[<h1 id="请求"><a href="#请求" class="headerlink" title="请求"></a>请求</h1><h2 id="1、封装请求"><a href="#1、封装请求" class="headerlink" title="1、封装请求"></a>1、封装请求</h2><p><code>requset.js</code>用于封装请求<br>然后<code>api</code>文件夹添加请求方法</p><ul><li>uniapp封装uni.requset</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> store <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/store/store.js&#x27;</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br><span class="hljs-attr">common</span>: &#123;<br><span class="hljs-attr">url</span>: <span class="hljs-string">&quot;http://localhost:3000/api&quot;</span>,<br><span class="hljs-comment">// url:  baseUrl + &quot;/api&quot;,</span><br><span class="hljs-attr">data</span>: &#123;&#125;,<br><span class="hljs-attr">header</span>: &#123;<br><span class="hljs-string">&quot;Content-Type&quot;</span>: <span class="hljs-string">&quot;application/json&quot;</span>,<br><span class="hljs-string">&quot;Content-Type&quot;</span>: <span class="hljs-string">&quot;application/x-www-form-urlencoded&quot;</span><br>&#125;,<br><span class="hljs-attr">method</span>: <span class="hljs-string">&quot;GET&quot;</span>,<br><span class="hljs-attr">dataType</span>: <span class="hljs-string">&quot;json&quot;</span><br>&#125;,<br><span class="hljs-comment">// options-请求参数</span><br><span class="hljs-title function_">request</span>(<span class="hljs-params">options = &#123;&#125;</span>) &#123;<br>uni.<span class="hljs-title function_">showLoading</span>(&#123;<br><span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;加载中&#x27;</span><br>&#125;);<br><br>options.<span class="hljs-property">url</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">common</span>.<span class="hljs-property">url</span> + options.<span class="hljs-property">url</span>;<br>options.<span class="hljs-property">data</span> = options.<span class="hljs-property">data</span> || <span class="hljs-variable language_">this</span>.<span class="hljs-property">common</span>.<span class="hljs-property">data</span>;<br>options.<span class="hljs-property">header</span> = options.<span class="hljs-property">header</span> || <span class="hljs-variable language_">this</span>.<span class="hljs-property">common</span>.<span class="hljs-property">header</span>;<br>options.<span class="hljs-property">method</span> = options.<span class="hljs-property">method</span> || <span class="hljs-variable language_">this</span>.<span class="hljs-property">common</span>.<span class="hljs-property">method</span>;<br>options.<span class="hljs-property">dataType</span> = options.<span class="hljs-property">dataType</span> || <span class="hljs-variable language_">this</span>.<span class="hljs-property">common</span>.<span class="hljs-property">dataType</span>;<br><br><span class="hljs-comment">// 判断是否传入了header头的token进行用户是否登录的验证</span><br><span class="hljs-keyword">if</span> (options.<span class="hljs-property">header</span>.<span class="hljs-property">token</span>) &#123;<br><span class="hljs-keyword">const</span> token = store.<span class="hljs-property">state</span>.<span class="hljs-property">user</span>.<span class="hljs-property">token</span>;<br><span class="hljs-keyword">if</span> (!token) &#123;<br>uni.<span class="hljs-title function_">showToast</span>(&#123;<br><span class="hljs-attr">title</span>: <span class="hljs-string">&quot;请先登录&quot;</span>,<br><span class="hljs-attr">icon</span>: <span class="hljs-string">&quot;none&quot;</span><br>&#125;)<br><span class="hljs-keyword">return</span> uni.<span class="hljs-title function_">navigateTo</span>(&#123;<br><span class="hljs-attr">url</span>: <span class="hljs-string">&quot;/pages/login/login&quot;</span><br>&#125;)<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>options.<span class="hljs-property">header</span>.<span class="hljs-property">Authorization</span> = <span class="hljs-string">`Bearer <span class="hljs-subst">$&#123;token&#125;</span>`</span><br>&#125;<br>&#125;<br><span class="hljs-keyword">let</span> requestTask;<br><span class="hljs-comment">// 返回一个promise</span><br><span class="hljs-keyword">const</span> promie = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">res, rej</span>) =&gt;</span> &#123;<br>requestTask =<br>uni.<span class="hljs-title function_">request</span>(&#123;<br>...options,<br><span class="hljs-attr">success</span>: <span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> &#123;<br><span class="hljs-comment">// console.log(&quot;成功*******************&quot;);</span><br><span class="hljs-comment">// console.log(&quot;result的结果&quot;);</span><br><span class="hljs-comment">// console.log(result);</span><br><span class="hljs-keyword">if</span> (result.<span class="hljs-property">statusCode</span> != <span class="hljs-number">200</span>) &#123;<br>uni.<span class="hljs-title function_">hideLoading</span>();<br><span class="hljs-keyword">return</span> <span class="hljs-title function_">rej</span>();<br>&#125;<br><span class="hljs-comment">// 关闭加载中</span><br>uni.<span class="hljs-title function_">hideLoading</span>();<br><span class="hljs-keyword">let</span> data = result.<span class="hljs-property">data</span><br><span class="hljs-title function_">res</span>(data);<br>&#125;,<br><span class="hljs-attr">fail</span>: <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;<br>uni.<span class="hljs-title function_">hideLoading</span>();<br>uni.<span class="hljs-title function_">showToast</span>(&#123;<br><span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;请求失败，请检查网络&#x27;</span>,<br><span class="hljs-attr">icon</span>: <span class="hljs-string">&#x27;none&#x27;</span>,<br><span class="hljs-attr">duration</span>: <span class="hljs-number">2000</span><br>&#125;)<br><span class="hljs-title function_">rej</span>(err)<br>&#125;<br>&#125;)<br>&#125;)<br><span class="hljs-comment">// 给promise添加一个abort方法，用于取消请求</span><br>promie.<span class="hljs-property">abort</span> = <span class="hljs-function">() =&gt;</span> &#123;<br>requestTask &amp;&amp; requestTask.<span class="hljs-title function_">abort</span>();<br>&#125;<br><span class="hljs-keyword">return</span> promie;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>方法，api文件夹的<code>order.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> $http <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/config/request.js&#x27;</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">payCart</span>(<span class="hljs-params">order_id,payStatus</span>) &#123;<br><span class="hljs-keyword">return</span> $http.<span class="hljs-title function_">request</span>(&#123;<br><span class="hljs-attr">url</span>: <span class="hljs-string">&quot;/orders/pay&quot;</span>,<br><span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;put&#x27;</span>,<br><span class="hljs-attr">header</span>: &#123;<br><span class="hljs-attr">token</span>: <span class="hljs-literal">true</span><br>&#125;,<br><span class="hljs-attr">data</span>: &#123;<br><span class="hljs-attr">order_id</span>: order_id,<br><span class="hljs-attr">payStatus</span>:payStatus<br>&#125;<br>&#125;)<br>&#125;<br></code></pre></td></tr></table></figure><p>使用</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">payCart</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">order_id</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">payStatus</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> &#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res)<br>&#125;).<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> &#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err);<br>&#125;)<br><span class="hljs-comment">// 设置一个定时器，如果 5 秒钟之后还没有获取到数据，就终止请求</span><br><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br><span class="hljs-title function_">payCart</span>().<span class="hljs-title function_">abort</span>()<br>&#125;,<span class="hljs-number">5000</span>)<br></code></pre></td></tr></table></figure><h2 id="2、设置请求重载"><a href="#2、设置请求重载" class="headerlink" title="2、设置请求重载"></a>2、设置请求重载</h2><p>可以通过封装一个请求重试的函数，在请求失败时判断当前重试次数是否小于限定的最大重试次数，若小于则延迟一定时间后再次发起请求，并增加重试次数，若大于则停止重试。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 封装一个请求重试函数</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">retryRequest</span>(<span class="hljs-params">options, maxRetry = <span class="hljs-number">3</span>, interval = <span class="hljs-number">1000</span></span>) &#123;<br>  <span class="hljs-keyword">let</span> retryCount = <span class="hljs-number">0</span>; <span class="hljs-comment">// 重试次数</span><br>  <span class="hljs-keyword">const</span> <span class="hljs-title function_">request</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>    uni.<span class="hljs-title function_">request</span>(&#123;<br>      ...options,<br>      <span class="hljs-title function_">success</span>(<span class="hljs-params">res</span>) &#123;<br>        options.<span class="hljs-property">success</span> &amp;&amp; options.<span class="hljs-title function_">success</span>(res);<br>      &#125;,<br>      <span class="hljs-title function_">fail</span>(<span class="hljs-params">err</span>) &#123;<br>        <span class="hljs-keyword">if</span> (retryCount &lt; maxRetry) &#123; <span class="hljs-comment">// 如果重试次数小于最大重试次数</span><br>          retryCount++; <span class="hljs-comment">// 增加重试次数</span><br>          <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123; <span class="hljs-comment">// 延迟一定时间后再次发起请求</span><br>            <span class="hljs-title function_">request</span>();<br>          &#125;, interval);<br>        &#125; <span class="hljs-keyword">else</span> &#123; <span class="hljs-comment">// 如果重试次数大于等于最大重试次数</span><br>          options.<span class="hljs-property">fail</span> &amp;&amp; options.<span class="hljs-title function_">fail</span>(err); <span class="hljs-comment">// 请求失败</span><br>        &#125;<br>      &#125;<br>    &#125;);<br>  &#125;;<br>  <span class="hljs-title function_">request</span>();<br>&#125;<br><br><span class="hljs-comment">// 使用示例</span><br><span class="hljs-title function_">retryRequest</span>(&#123;<br>  <span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;http://example.com/api&#x27;</span>,<br>  <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;GET&#x27;</span>,<br>  <span class="hljs-title function_">success</span>(<span class="hljs-params">res</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res);<br>  &#125;,<br>  <span class="hljs-title function_">fail</span>(<span class="hljs-params">err</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err);<br>  &#125;<br>&#125;, <span class="hljs-number">3</span>, <span class="hljs-number">1000</span>); <span class="hljs-comment">// 最大重试次数为 3，重试间隔为 1000ms</span><br></code></pre></td></tr></table></figure><h2 id="xhr"><a href="#xhr" class="headerlink" title="xhr"></a>xhr</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();<br>xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;https://api.example.com/data&#x27;</span>, <span class="hljs-literal">true</span>);  <span class="hljs-comment">// 设置请求方法、URL和异步标志</span><br>xhr.<span class="hljs-property">onreadystatechange</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">if</span> (xhr.<span class="hljs-property">readyState</span> === <span class="hljs-number">4</span> &amp;&amp; xhr.<span class="hljs-property">status</span> === <span class="hljs-number">200</span>) &#123;  <span class="hljs-comment">// 检查请求的状态和响应的状态码</span><br>    <span class="hljs-keyword">const</span> response = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(xhr.<span class="hljs-property">responseText</span>);  <span class="hljs-comment">// 解析响应数据</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response);<br>  &#125;<br>&#125;;<br>xhr.<span class="hljs-title function_">send</span>();  <span class="hljs-comment">// 发送请求</span><br></code></pre></td></tr></table></figure><h2 id="fetch"><a href="#fetch" class="headerlink" title="fetch"></a>fetch</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;https://api.example.com/data&#x27;</span>)<br>  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> response.<span class="hljs-title function_">json</span>())<br>  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data))<br>  .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(error));<br></code></pre></td></tr></table></figure><p>Fetch API的<code>response</code>对象表示HTTP响应，它包含了与响应相关的信息和方法。<code>response</code>对象提供了多个属性和方法，用于访问和处理响应数据。</p><p>其中，常用的属性和方法有：</p><ul><li><code>response.ok</code>：一个只读的布尔值属性，表示响应是否成功（状态码在 200-299 范围内）。</li><li><code>response.status</code>：一个只读的整数属性，表示响应的HTTP状态码。</li><li><code>response.statusText</code>：一个只读的字符串属性，表示响应的HTTP状态文本。</li><li><code>response.headers</code>：一个只读的 Headers 对象，表示响应头部信息。</li><li><code>response.json()</code>：一个方法，返回一个Promise，用于将响应体解析为JSON格式的JavaScript对象。</li><li><code>response.text()</code>：一个方法，返回一个Promise，用于将响应体解析为纯文本字符串。</li><li><code>response.blob()</code>：一个方法，返回一个Promise，用于将响应体解析为 Blob 对象。</li><li><code>response.arrayBuffer()</code>：一个方法，返回一个Promise，用于将响应体解析为 ArrayBuffer 数据。</li><li><code>response.formData()</code>：一个方法，返回一个Promise，用于将响应体解析为 FormData 对象。</li></ul><p>根据需求，可以使用这些属性和方法来获取和处理响应数据。例如，可以使用<code>response.json()</code>方法将响应体解析为JSON对象，或者使用<code>response.text()</code>方法将响应体解析为文本字符串。</p><h2 id="axios"><a href="#axios" class="headerlink" title="axios"></a>axios</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js">axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;https://api.example.com/data&#x27;</span>)<br>  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response.<span class="hljs-property">data</span>))<br>  .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(error));<br></code></pre></td></tr></table></figure><h2 id="请求参数"><a href="#请求参数" class="headerlink" title="请求参数"></a>请求参数</h2><h3 id="FormData"><a href="#FormData" class="headerlink" title="FormData"></a>FormData</h3><p>表单数据格式，需要设置请求头的<code>Content-Type</code>为<code>application/x-www-form-urlencoded</code></p><h3 id="URLSearchParams"><a href="#URLSearchParams" class="headerlink" title="URLSearchParams"></a>URLSearchParams</h3>]]></content>
    
    
    <categories>
      
      <category>问题</category>
      
    </categories>
    
    
    <tags>
      
      <tag>js</tag>
      
      <tag>前端</tag>
      
      <tag>前端请求</tag>
      
      <tag>uniapp封装请求</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>nodejs</title>
    <link href="/2023/03/22/%E7%AC%94%E8%AE%B0/nodejs/"/>
    <url>/2023/03/22/%E7%AC%94%E8%AE%B0/nodejs/</url>
    
    <content type="html"><![CDATA[<h1 id="Node-js"><a href="#Node-js" class="headerlink" title="Node.js"></a>Node.js</h1><blockquote><p>Node.js是一个基于Chrome V8引擎的JavaScript运行环境</p></blockquote><ol><li>浏览器是JavaScript的前端运行环境</li><li>Node.js是JavaScript的后端运行环境</li><li>Node.js中无法调用DOM和BOM等浏览器内置API</li></ol><ul><li>基于 <a href="http://www.expressjs.com.cn/">Express 框架 (opens new window)</a>，可以快速构建 Web 应用</li><li>基于 <a href="https://electronjs.org/">Electron 框架 (opens new window)</a>，可以构建跨平台的桌面应用</li><li>基于 <a href="http://restify.com/">restify 框架 (opens new window)</a>，可以快速构建 API 接口项目</li><li>读写和操作数据库、创建实用的命令行工具辅助前端开发</li></ul><h2 id="fs文件系统模块"><a href="#fs文件系统模块" class="headerlink" title="fs文件系统模块"></a>fs文件系统模块</h2><h3 id="1、fs-readFile"><a href="#1、fs-readFile" class="headerlink" title="1、fs.readFile()"></a>1、fs.readFile()</h3><h4 id="简单文件读取"><a href="#简单文件读取" class="headerlink" title="简单文件读取"></a>简单文件读取</h4><p>语法格式：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">fs.<span class="hljs-title function_">readFile</span>(path[, options], callback)<br></code></pre></td></tr></table></figure><ul><li><code>path</code>：文件路径</li><li><code>options</code>：配置选项，若是字符串则指定编码格式<ul><li><code>encoding</code>：编码格式</li><li><code>flag</code>：打开方式</li></ul></li><li><code>callback</code>：回调函数<ul><li><code>err</code>：错误信息</li><li><code>data</code>：读取的数据，如果未指定编码格式则返回一个 Buffer</li></ul></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>)<br><br>fs.<span class="hljs-title function_">readFile</span>(<span class="hljs-string">&#x27;./files/1.txt&#x27;</span>, <span class="hljs-string">&#x27;utf-8&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">err, data</span>) =&gt; &#123;<br>  <span class="hljs-keyword">if</span>(err) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;failed!&#x27;</span> + err.<span class="hljs-property">message</span>)<br>  &#125;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;content:&#x27;</span> + data)<br>&#125;)<br><br><br><span class="hljs-comment">// 复制文件内容</span><br>fs.<span class="hljs-title function_">readFile</span>(<span class="hljs-string">&quot;C:/Users/笔记.mp3&quot;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">err, data</span>) &#123;<br><span class="hljs-keyword">if</span>(!err) &#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data);<br><span class="hljs-comment">// 将data写入到文件中</span><br>fs.<span class="hljs-title function_">writeFile</span>(<span class="hljs-string">&quot;C:/Users/hello.jpg&quot;</span>, data, <span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>)&#123;<br><span class="hljs-keyword">if</span>(!err)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;文件写入成功&quot;</span>);<br>&#125;<br>&#125; );<br>&#125;<br>&#125;);<br></code></pre></td></tr></table></figure><h4 id="流式文件读取"><a href="#流式文件读取" class="headerlink" title="流式文件读取"></a>流式文件读取</h4><ul><li>简单文件读取的方式会一次性读取文件内容到内存中，若文件较大，会占用过多内存影响系统性能，且读取速度慢</li><li>大文件适合用流式文件读取，它会分多次将文件读取到内存中</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>)<br><br><span class="hljs-comment">// 创建一个可读流</span><br><span class="hljs-keyword">var</span> rs = fs.<span class="hljs-title function_">createReadStream</span>(<span class="hljs-string">&#x27;C:/Users/笔记.mp3&#x27;</span>)<br><span class="hljs-comment">// 创建一个可写流</span><br><span class="hljs-keyword">var</span> ws = fs.<span class="hljs-title function_">createWriteStream</span>(<span class="hljs-string">&#x27;a.mp3&#x27;</span>)<br><br><span class="hljs-comment">// 监听流的开启和关闭</span><br><span class="hljs-comment">// 这几个监听不是必须的</span><br>rs.<span class="hljs-title function_">once</span>(<span class="hljs-string">&#x27;open&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;可读流打开了~~&#x27;</span>)<br>&#125;)<br><br>rs.<span class="hljs-title function_">once</span>(<span class="hljs-string">&#x27;close&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;可读流关闭了~~&#x27;</span>)<br>  <span class="hljs-comment">//数据读取完毕，关闭可写流</span><br>  ws.<span class="hljs-title function_">end</span>()<br>&#125;)<br><br>ws.<span class="hljs-title function_">once</span>(<span class="hljs-string">&#x27;open&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;可写流打开了~~&#x27;</span>)<br>&#125;)<br><br>ws.<span class="hljs-title function_">once</span>(<span class="hljs-string">&#x27;close&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;可写流关闭了~~&#x27;</span>)<br>&#125;)<br><br><span class="hljs-comment">//要读取一个可读流中的数据，要为可读流绑定一个data事件，data事件绑定完毕自动开始读取数据</span><br>rs.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;data&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data)<br>  <span class="hljs-comment">//将读取到的数据写入到可写流中</span><br>  ws.<span class="hljs-title function_">write</span>(data)<br>&#125;)<br></code></pre></td></tr></table></figure><p>简便方式：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>)<br><br><span class="hljs-keyword">var</span> rs = fs.<span class="hljs-title function_">createReadStream</span>(<span class="hljs-string">&#x27;C:/Users/lilichao/Desktop/笔记.mp3&#x27;</span>)<br><span class="hljs-keyword">var</span> ws = fs.<span class="hljs-title function_">createWriteStream</span>(<span class="hljs-string">&#x27;b.mp3&#x27;</span>)<br><br><span class="hljs-comment">// pipe()可以将可读流中的内容，直接输出到可写流中</span><br>rs.<span class="hljs-title function_">pipe</span>(ws)<br></code></pre></td></tr></table></figure><h3 id="2、fs-writeFile"><a href="#2、fs-writeFile" class="headerlink" title="2、fs.writeFile()"></a>2、fs.writeFile()</h3><h4 id="简单文件写入"><a href="#简单文件写入" class="headerlink" title="简单文件写入"></a>简单文件写入</h4><p>语法格式：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">fs.<span class="hljs-title function_">writeFile</span>(file, data[, options], callback)<br></code></pre></td></tr></table></figure><ul><li><code>file</code>：文件路径</li><li><code>data</code>：写入内容</li><li><code>options</code>：配置选项，包含 <code>encoding, mode, flag</code>；若是字符串则指定编码格式</li><li><code>callback</code>：回调函数</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>)<br>fs.<span class="hljs-title function_">writeFile</span>(<span class="hljs-string">&#x27;./files/2.txt&#x27;</span>, <span class="hljs-string">&#x27;Hello Nodejs&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">err</span>) &#123;<br>  <span class="hljs-keyword">if</span> (err) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;failed!&#x27;</span> + err.<span class="hljs-property">message</span>)<br>  &#125;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;success!&#x27;</span>)<br>&#125;)<br><br>fs.<span class="hljs-title function_">writeFile</span>(<span class="hljs-string">&#x27;C:/Users/hello.txt&#x27;</span>, <span class="hljs-string">&#x27;通过 writeFile 写入的内容&#x27;</span>, &#123; <span class="hljs-attr">flag</span>: <span class="hljs-string">&#x27;w&#x27;</span> &#125;, <span class="hljs-keyword">function</span> (<span class="hljs-params">err</span>) &#123;<br>  <span class="hljs-keyword">if</span> (!err) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;写入成功！&#x27;</span>)<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err)<br>  &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><h4 id="流式文件写入"><a href="#流式文件写入" class="headerlink" title="流式文件写入"></a>流式文件写入</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 同步、异步、简单文件的写入都不适合大文件的写入，性能较差，容易导致内存溢出</span><br><span class="hljs-keyword">var</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>)<br><br><span class="hljs-comment">// 创建一个可写流</span><br><span class="hljs-keyword">var</span> ws = fs.<span class="hljs-title function_">createWriteStream</span>(<span class="hljs-string">&#x27;hello3.txt&#x27;</span>)<br><br>ws.<span class="hljs-title function_">once</span>(<span class="hljs-string">&#x27;open&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;流打开了~~&#x27;</span>)<br>&#125;)<br><br>ws.<span class="hljs-title function_">once</span>(<span class="hljs-string">&#x27;close&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;流关闭了~~&#x27;</span>)<br>&#125;)<br><br><span class="hljs-comment">// 通过ws向文件中输出内容</span><br>ws.<span class="hljs-title function_">write</span>(<span class="hljs-string">&#x27;通过可写流写入文件的内容&#x27;</span>)<br>ws.<span class="hljs-title function_">write</span>(<span class="hljs-string">&#x27;1&#x27;</span>)<br>ws.<span class="hljs-title function_">write</span>(<span class="hljs-string">&#x27;2&#x27;</span>)<br>ws.<span class="hljs-title function_">write</span>(<span class="hljs-string">&#x27;3&#x27;</span>)<br>ws.<span class="hljs-title function_">write</span>(<span class="hljs-string">&#x27;4&#x27;</span>)<br><br><span class="hljs-comment">// 关闭流</span><br>ws.<span class="hljs-title function_">end</span>()<br></code></pre></td></tr></table></figure><h3 id="路径动态拼接问题-dirname"><a href="#路径动态拼接问题-dirname" class="headerlink" title="路径动态拼接问题 __dirname"></a>路径动态拼接问题 <code>__dirname</code></h3><ul><li>在使用 fs 模块操作文件时，如果提供的操作路径是以 <code>./</code> 或 <code>../</code> 开头的相对路径时，容易出现路径动态拼接错误的问题</li><li>原因：代码在运行的时候，会以执行 node 命令时所处的目录，动态拼接出被操作文件的完整路径</li><li>解决方案：在使用 fs 模块操作文件时，直接提供完整的路径，从而防止路径动态拼接的问题</li><li><code>__dirname</code> 获取文件所处的绝对路径</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js">fs.<span class="hljs-title function_">readFile</span>(__dirname + <span class="hljs-string">&#x27;/files/1.txt&#x27;</span>, <span class="hljs-string">&#x27;utf8&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">err, data</span>) &#123;<br>  ...<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="其它操作"><a href="#其它操作" class="headerlink" title="其它操作"></a>其它操作</h3><p>验证路径是否存在：</p><ul><li><code>fs.exists(path, callback)</code></li><li><code>fs.existsSync(path)</code></li></ul><p>获取文件信息：</p><ul><li><code>fs.stat(path, callback)</code></li><li><code>fs.stat(path)</code></li></ul><p>删除文件：</p><ul><li><code>fs.unlink(path, callback)</code></li><li><code>fs.unlinkSync(path)</code></li></ul><p>列出文件：</p><ul><li><code>fs.readdir(path[,options], callback)</code></li><li><code>fs.readdirSync(path[, options])</code></li></ul><p>截断文件：</p><ul><li><code>fs.truncate(path, len, callback)</code></li><li><code>fs.truncateSync(path, len)</code></li></ul><p>建立目录：</p><ul><li><code>fs.mkdir(path[, mode], callback)</code></li><li><code>fs.mkdirSync(path[, mode])</code></li></ul><p>删除目录：</p><ul><li><code>fs.rmdir(path, callback)</code></li><li><code>fs.rmdirSync(path)</code></li></ul><p>重命名文件和目录：</p><ul><li><code>fs.rename(oldPath, newPath, callback)</code></li><li><code>fs.renameSync(oldPath, newPath)</code></li></ul><p>监视文件更改：</p><ul><li><code>fs.watchFile(filename[, options], listener)</code></li></ul><h2 id="path路径模块"><a href="#path路径模块" class="headerlink" title="path路径模块"></a>path路径模块</h2><p>path 模块是 Node.js 官方提供的、用来处理路径的模块。它提供了一系列的方法和属性，用来满足用户对路径的处理需求。</p><h3 id="路径拼接-path-join"><a href="#路径拼接-path-join" class="headerlink" title="路径拼接 path.join()"></a>路径拼接 <code>path.join()</code></h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>)<br><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>)<br><br><span class="hljs-comment">// 注意 ../ 会抵消前面的路径</span><br><span class="hljs-comment">// ./ 会被忽略</span><br><span class="hljs-keyword">const</span> pathStr = path.<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;/a&#x27;</span>, <span class="hljs-string">&#x27;/b/c&#x27;</span>, <span class="hljs-string">&#x27;../../&#x27;</span>, <span class="hljs-string">&#x27;./d&#x27;</span>, <span class="hljs-string">&#x27;e&#x27;</span>)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(pathStr) <span class="hljs-comment">// \a\d\e</span><br><br>fs.<span class="hljs-title function_">readFile</span>(path.<span class="hljs-title function_">join</span>(__dirname, <span class="hljs-string">&#x27;./files/1.txt&#x27;</span>), <span class="hljs-string">&#x27;utf8&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">err, dataStr</span>) &#123;<br>  <span class="hljs-keyword">if</span> (err) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err.<span class="hljs-property">message</span>)<br>  &#125;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(dataStr)<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="获取路径中文件名-path-basename"><a href="#获取路径中文件名-path-basename" class="headerlink" title="获取路径中文件名 path.basename()"></a>获取路径中文件名 <code>path.basename()</code></h3><p>使用 <code>path.basename()</code> 方法，可以获取路径中的最后一部分，常通过该方法获取路径中的文件名</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">path.<span class="hljs-title function_">basename</span>(path[, ext])<br></code></pre></td></tr></table></figure><ul><li>path: 文件路径</li><li>ext: 文件扩展名</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>)<br><br><span class="hljs-comment">// 定义文件的存放路径</span><br><span class="hljs-keyword">const</span> fpath = <span class="hljs-string">&#x27;/a/b/c/index.html&#x27;</span><br><br><span class="hljs-keyword">const</span> fullName = path.<span class="hljs-title function_">basename</span>(fpath)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(fullName) <span class="hljs-comment">// index.html</span><br><br><span class="hljs-keyword">const</span> nameWithoutExt = path.<span class="hljs-title function_">basename</span>(fpath, <span class="hljs-string">&#x27;.html&#x27;</span>)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(nameWithoutExt) <span class="hljs-comment">// index</span><br></code></pre></td></tr></table></figure><h3 id="获取路径中文件扩展名-path-extname"><a href="#获取路径中文件扩展名-path-extname" class="headerlink" title="获取路径中文件扩展名 path.extname()"></a>获取路径中文件扩展名 <code>path.extname()</code></h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>)<br><br><span class="hljs-keyword">const</span> fpath = <span class="hljs-string">&#x27;/a/b/c/index.html&#x27;</span><br><br><span class="hljs-keyword">const</span> fext = path.<span class="hljs-title function_">extname</span>(fpath)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(fext) <span class="hljs-comment">// .html</span><br></code></pre></td></tr></table></figure><h3 id="时钟案例"><a href="#时钟案例" class="headerlink" title="时钟案例"></a>时钟案例</h3><p><img src="/img/nodejs/shizhong.png" alt="image"></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 1.1 导入 fs 模块</span><br><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>)<br><span class="hljs-comment">// 1.2 导入 path 模块</span><br><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>)<br><br><span class="hljs-comment">// 1.3 定义正则表达式，分别匹配 &lt;style&gt;&lt;/style&gt; 和 &lt;script&gt;&lt;/script&gt; 标签</span><br><span class="hljs-keyword">const</span> regStyle = <span class="hljs-regexp">/&lt;style&gt;[\s\S]*&lt;\/style&gt;/</span><br><span class="hljs-keyword">const</span> regScript = <span class="hljs-regexp">/&lt;script&gt;[\s\S]*&lt;\/script&gt;/</span><br><br><span class="hljs-comment">// 2.1 调用 fs.readFile() 方法读取文件</span><br>fs.<span class="hljs-title function_">readFile</span>(path.<span class="hljs-title function_">join</span>(__dirname, <span class="hljs-string">&#x27;../素材/index.html&#x27;</span>), <span class="hljs-string">&#x27;utf8&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">err, dataStr</span>) &#123;<br>  <span class="hljs-comment">// 2.2 读取 HTML 文件失败</span><br>  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;读取HTML文件失败！&#x27;</span> + err.<span class="hljs-property">message</span>)<br>  <span class="hljs-comment">// 2.3 读取文件成功后，调用对应的三个方法，分别拆解出 css, js, html 文件</span><br>  <span class="hljs-title function_">resolveCSS</span>(dataStr)<br>  <span class="hljs-title function_">resolveJS</span>(dataStr)<br>  <span class="hljs-title function_">resolveHTML</span>(dataStr)<br>&#125;)<br><br><span class="hljs-comment">// 3.1 定义处理 css 样式的方法</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">resolveCSS</span>(<span class="hljs-params">htmlStr</span>) &#123;<br>  <span class="hljs-comment">// 3.2 使用正则提取需要的内容</span><br>  <span class="hljs-keyword">const</span> r1 = regStyle.<span class="hljs-title function_">exec</span>(htmlStr)<br>  <span class="hljs-comment">// 3.3 将提取出来的样式字符串，进行字符串的 replace 替换操作</span><br>  <span class="hljs-keyword">const</span> newCSS = r1[<span class="hljs-number">0</span>].<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;&lt;style&gt;&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>).<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;&lt;/style&gt;&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>  <span class="hljs-comment">// 3.4 调用 fs.writeFile() 方法，将提取的样式，写入到 clock 目录中 index.css 的文件里面</span><br>  fs.<span class="hljs-title function_">writeFile</span>(path.<span class="hljs-title function_">join</span>(__dirname, <span class="hljs-string">&#x27;./clock/index.css&#x27;</span>), newCSS, <span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>) &#123;<br>    <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;写入 CSS 样式失败！&#x27;</span> + err.<span class="hljs-property">message</span>)<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;写入样式文件成功！&#x27;</span>)<br>  &#125;)<br>&#125;<br><br><span class="hljs-comment">// 4.1 定义处理 js 脚本的方法</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">resolveJS</span>(<span class="hljs-params">htmlStr</span>) &#123;<br>  <span class="hljs-comment">// 4.2 通过正则，提取对应的 &lt;script&gt;&lt;/script&gt; 标签内容</span><br>  <span class="hljs-keyword">const</span> r2 = regScript.<span class="hljs-title function_">exec</span>(htmlStr)<br>  <span class="hljs-comment">// 4.3 将提取出来的内容，做进一步的处理</span><br>  <span class="hljs-keyword">const</span> newJS = r2[<span class="hljs-number">0</span>].<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;&lt;script&gt;&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>).<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;&lt;/script&gt;&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>  <span class="hljs-comment">// 4.4 将处理的结果，写入到 clock 目录中的 index.js 文件里面</span><br>  fs.<span class="hljs-title function_">writeFile</span>(path.<span class="hljs-title function_">join</span>(__dirname, <span class="hljs-string">&#x27;./clock/index.js&#x27;</span>), newJS, <span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>) &#123;<br>    <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;写入 JavaScript 脚本失败！&#x27;</span> + err.<span class="hljs-property">message</span>)<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;写入 JS 脚本成功！&#x27;</span>)<br>  &#125;)<br>&#125;<br><br><span class="hljs-comment">// 5.1 定义处理 HTML 结构的方法</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">resolveHTML</span>(<span class="hljs-params">htmlStr</span>) &#123;<br>  <span class="hljs-comment">// 5.2 将字符串调用 replace 方法，把内嵌的 style 和 script 标签，替换为外联的 link 和 script 标签</span><br>  <span class="hljs-keyword">const</span> newHTML = htmlStr.<span class="hljs-title function_">replace</span>(regStyle, <span class="hljs-string">&#x27;&lt;link rel=&quot;stylesheet&quot; href=&quot;./index.css&quot; /&gt;&#x27;</span>).<span class="hljs-title function_">replace</span>(regScript, <span class="hljs-string">&#x27;&lt;script src=&quot;./index.js&quot;&gt;&lt;/script&gt;&#x27;</span>)<br>  <span class="hljs-comment">// 5.3 写入 index.html 这个文件</span><br>  fs.<span class="hljs-title function_">writeFile</span>(path.<span class="hljs-title function_">join</span>(__dirname, <span class="hljs-string">&#x27;./clock/index.html&#x27;</span>), newHTML, <span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>) &#123;<br>    <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;写入 HTML 文件失败！&#x27;</span> + err.<span class="hljs-property">message</span>)<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;写入 HTML 页面成功！&#x27;</span>)<br>  &#125;)<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="http-模块"><a href="#http-模块" class="headerlink" title="http 模块"></a>http 模块</h2><p>http 模块是 Node.js 官方提供的、用来创建 web 服务器的模块。</p><h3 id="创建基本-Web-服务器"><a href="#创建基本-Web-服务器" class="headerlink" title="创建基本 Web 服务器"></a>创建基本 Web 服务器</h3><ol><li>导入http模块</li><li>创建web服务器实例</li><li>为服务器实例绑定request事件，监听客户端的请求</li><li>启动服务器</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 1. 导入 http 模块</span><br><span class="hljs-keyword">const</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;http&#x27;</span>)<br><span class="hljs-comment">// 2. 创建 web 服务器实例</span><br><span class="hljs-keyword">const</span> server = http.<span class="hljs-title function_">createServer</span>()<br><span class="hljs-comment">// 3. 为服务器实例绑定 request 事件，监听客户端的请求</span><br>server.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;request&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Someone visit our web server.&#x27;</span>)<br>&#125;)<br><span class="hljs-comment">// 4. 启动服务器</span><br>server.<span class="hljs-title function_">listen</span>(<span class="hljs-number">8080</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;server running at http://127.0.0.1:8080&#x27;</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="req请求对象、res响应对象"><a href="#req请求对象、res响应对象" class="headerlink" title="req请求对象、res响应对象"></a>req请求对象、res响应对象</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;http&#x27;</span>)<br><span class="hljs-keyword">const</span> server = http.<span class="hljs-title function_">createServer</span>()<br><span class="hljs-comment">// req 是请求对象，包含了与客户端相关的数据和属性</span><br>server.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;request&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// req.url 是客户端请求的 URL 地址</span><br>  <span class="hljs-keyword">const</span> url = req.<span class="hljs-property">url</span><br>  <span class="hljs-comment">// req.method 是客户端请求的 method 类型</span><br>  <span class="hljs-keyword">const</span> method = req.<span class="hljs-property">method</span><br>  <span class="hljs-keyword">const</span> str = <span class="hljs-string">`Your request url is <span class="hljs-subst">$&#123;url&#125;</span>, and request method is <span class="hljs-subst">$&#123;method&#125;</span>`</span><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str)<br>  <span class="hljs-comment">// 调用 res.end() 方法，向客户端响应一些内容</span><br>  res.<span class="hljs-title function_">end</span>(str)<br>&#125;)<br>server.<span class="hljs-title function_">listen</span>(<span class="hljs-number">80</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;server running at http://127.0.0.1&#x27;</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="中文乱码"><a href="#中文乱码" class="headerlink" title="中文乱码"></a>中文乱码</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;http&#x27;</span>)<br><span class="hljs-keyword">const</span> server = http.<span class="hljs-title function_">createServer</span>()<br><br>server.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;request&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// 定义一个字符串，包含中文的内容</span><br>  <span class="hljs-keyword">const</span> str = <span class="hljs-string">`您请求的 URL 地址是 <span class="hljs-subst">$&#123;req.url&#125;</span>，请求的 method 类型为 <span class="hljs-subst">$&#123;req.method&#125;</span>`</span><br>  <span class="hljs-comment">// 调用 res.setHeader() 方法，设置  -Type 响应头，解决中文乱码的问题</span><br>  res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&#x27;Content-Type&#x27;</span>, <span class="hljs-string">&#x27;text/html; charset=utf-8&#x27;</span>)<br>  <span class="hljs-comment">// res.end() 将内容响应给客户端</span><br>  res.<span class="hljs-title function_">end</span>(str)<br>&#125;)<br><br>server.<span class="hljs-title function_">listen</span>(<span class="hljs-number">80</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;server running at http://127.0.0.1&#x27;</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="根据不同的url响应不同的html内容"><a href="#根据不同的url响应不同的html内容" class="headerlink" title="根据不同的url响应不同的html内容"></a>根据不同的url响应不同的html内容</h3><ul><li>核心实现步骤<ul><li>获取请求的url地址</li><li>设置默认的响应内容为 404 No Found</li><li>判断用户请求是否为  &#x2F;  或  &#x2F;index.html首页</li><li>判断用户请求是否为&#x2F;ablout.html</li><li>设置Content-Type 响应头，防止中文乱码</li><li>使用res.end() 把内容响应给客户端</li></ul></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;http&#x27;</span>)<br><span class="hljs-keyword">const</span> server = http.<span class="hljs-title function_">createServer</span>()<br><br>server.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;request&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// 1. 获取请求的 url 地址</span><br>  <span class="hljs-keyword">const</span> url = req.<span class="hljs-property">url</span><br>  <span class="hljs-comment">// 2. 设置默认的响应内容为 404 Not found</span><br>  <span class="hljs-keyword">let</span> content = <span class="hljs-string">&#x27;&lt;h1&gt;404 Not found!&lt;/h1&gt;&#x27;</span><br>  <span class="hljs-comment">// 3. 判断用户请求的是否为 / 或 /index.html 首页</span><br>  <span class="hljs-comment">// 4. 判断用户请求的是否为 /about.html 关于页面</span><br>  <span class="hljs-keyword">if</span> (url === <span class="hljs-string">&#x27;/&#x27;</span> || url === <span class="hljs-string">&#x27;/index.html&#x27;</span>) &#123;<br>    content = <span class="hljs-string">&#x27;&lt;h1&gt;首页&lt;/h1&gt;&#x27;</span><br>  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (url === <span class="hljs-string">&#x27;/about.html&#x27;</span>) &#123;<br>    content = <span class="hljs-string">&#x27;&lt;h1&gt;关于页面&lt;/h1&gt;&#x27;</span><br>  &#125;<br>  <span class="hljs-comment">// 5. 设置 Content-Type 响应头，防止中文乱码</span><br>  res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&#x27;Content-Type&#x27;</span>, <span class="hljs-string">&#x27;text/html; charset=utf-8&#x27;</span>)<br>  <span class="hljs-comment">// 6. 使用 res.end() 把内容响应给客户端</span><br>  res.<span class="hljs-title function_">end</span>(content)<br>&#125;)<br><br>server.<span class="hljs-title function_">listen</span>(<span class="hljs-number">80</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;server running at http://127.0.0.1&#x27;</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="实现clock时钟的web服务器"><a href="#实现clock时钟的web服务器" class="headerlink" title="实现clock时钟的web服务器"></a>实现clock时钟的web服务器</h3><ul><li>实现步骤<ul><li>导入需要的模块</li><li>创建基本的web服务器</li><li>将资源的请求url地址映射为文件的存放地址</li><li>读取文件内容并响应给客户端</li><li>优化资源的路径</li></ul></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 1.1 导入 http 模块</span><br><span class="hljs-keyword">const</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;http&#x27;</span>)<br><span class="hljs-comment">// 1.2 导入 fs 模块</span><br><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>)<br><span class="hljs-comment">// 1.3 导入 path 模块</span><br><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>)<br><br><span class="hljs-comment">// 2.1 创建 web 服务器</span><br><span class="hljs-keyword">const</span> server = http.<span class="hljs-title function_">createServer</span>()<br><span class="hljs-comment">// 2.2 监听 web 服务器的 request 事件</span><br>server.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;request&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// 3.1 获取到客户端请求的 URL 地址</span><br>  <span class="hljs-comment">//     /clock/index.html</span><br>  <span class="hljs-comment">//     /clock/index.css</span><br>  <span class="hljs-comment">//     /clock/index.js</span><br>  <span class="hljs-keyword">const</span> url = req.<span class="hljs-property">url</span><br>  <span class="hljs-comment">// 3.2 把请求的 URL 地址映射为具体文件的存放路径</span><br>  <span class="hljs-comment">// const fpath = path.join(__dirname, url)</span><br>  <span class="hljs-comment">// 5.1 预定义一个空白的文件存放路径</span><br>  <span class="hljs-keyword">let</span> fpath = <span class="hljs-string">&#x27;&#x27;</span><br>  <span class="hljs-keyword">if</span> (url === <span class="hljs-string">&#x27;/&#x27;</span>) &#123;<br>    fpath = path.<span class="hljs-title function_">join</span>(__dirname, <span class="hljs-string">&#x27;./clock/index.html&#x27;</span>)<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-comment">//     /index.html</span><br>    <span class="hljs-comment">//     /index.css</span><br>    <span class="hljs-comment">//     /index.js</span><br>    fpath = path.<span class="hljs-title function_">join</span>(__dirname, <span class="hljs-string">&#x27;/clock&#x27;</span>, url)<br>  &#125;<br><br>  <span class="hljs-comment">// 4.1 根据“映射”过来的文件路径读取文件的内容</span><br>  fs.<span class="hljs-title function_">readFile</span>(fpath, <span class="hljs-string">&#x27;utf8&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">err, dataStr</span>) =&gt;</span> &#123;<br>    <span class="hljs-comment">// 4.2 读取失败，向客户端响应固定的“错误消息”</span><br>    <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">end</span>(<span class="hljs-string">&#x27;404 Not found.&#x27;</span>)<br>    <span class="hljs-comment">// 4.3 读取成功，将读取成功的内容，响应给客户端</span><br>    res.<span class="hljs-title function_">end</span>(dataStr)<br>  &#125;)<br>&#125;)<br><span class="hljs-comment">// 2.3 启动服务器</span><br>server.<span class="hljs-title function_">listen</span>(<span class="hljs-number">80</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;server running at http://127.0.0.1&#x27;</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><h2 id="模块化"><a href="#模块化" class="headerlink" title="模块化"></a>模块化</h2><h3 id="模块化概念"><a href="#模块化概念" class="headerlink" title="模块化概念"></a>模块化概念</h3><ul><li>模块化是指解决一个复杂问题时，自顶向下逐层把系统划分为若干模块的过程，模块是可组合、分解和更换的单元。</li><li>模块化可提高代码的复用性和可维护性，实现按需加载。</li><li>模块化规范是对代码进行模块化拆分和组合时需要遵守的规则，如使用何种语法格式引用模块和向外暴露成员。</li></ul><h3 id="Node-js-中模块的分类"><a href="#Node-js-中模块的分类" class="headerlink" title="Node.js 中模块的分类"></a>Node.js 中模块的分类</h3><ul><li>内置模块（官方提供的，如fs、path、http等）</li><li>自定义模块（用户创建每个 .js 文件，都是自定义模块）</li><li>第三方模块（第三方开发出来的模块。需要下载）</li></ul><h3 id="Node-js-中的模块作用域"><a href="#Node-js-中的模块作用域" class="headerlink" title="Node.js 中的模块作用域"></a>Node.js 中的模块作用域</h3><ul><li>和函数作用域类似，在自定义模块中定义的变量、方法等成员，只能在当前模块内被访问，这种模块级别的访问限制，叫做模块作用域</li><li>防止全局变量污染</li></ul><h3 id="模块作用域的成员module对象"><a href="#模块作用域的成员module对象" class="headerlink" title="模块作用域的成员module对象"></a>模块作用域的成员module对象</h3><ul><li>自定义模块中都有一个 <code>module</code> 对象，存储了和当前模块有关的信息</li><li>在自定义模块中，可以使用 <code>module.exports</code> 对象，将模块内的成员共享出去，供外界使用。导入自定义模块时，得到的就是 <code>module.exports</code> 指向的对象。</li><li>默认情况下，<code>exports</code> 和 <code>module.exports</code> 指向同一个对象。最终共享的结果，以 <code>module.exports</code> 指向的对象为准。</li><li>ES6中使用<code>export</code>代替<code>module.exports</code></li></ul><h3 id="CommonJS-模块化规范"><a href="#CommonJS-模块化规范" class="headerlink" title="CommonJS 模块化规范"></a>CommonJS 模块化规范</h3><ul><li>每个模块内部，<code>module</code> 变量代表当前模块</li><li><code>module</code> 变量是一个对象，<code>module.exports</code> 是对外的接口</li><li>加载某个模块即加载该模块的 <code>module.exports</code> 属性</li></ul><h3 id="模块加载机制"><a href="#模块加载机制" class="headerlink" title="模块加载机制"></a>模块加载机制</h3><ul><li>模块第一次加载后会<strong>被缓存</strong>，即多次调用 <code>require()</code> 不会导致模块的代码被执行多次，提高模块加载效率。</li><li>ES6中使用<code>import</code>代替<code>require()</code></li></ul><h4 id="内置模块加载"><a href="#内置模块加载" class="headerlink" title="内置模块加载"></a>内置模块加载</h4><ul><li>内置模块加载优先级最高。</li></ul><h4 id="自定义模块加载"><a href="#自定义模块加载" class="headerlink" title="自定义模块加载"></a>自定义模块加载</h4><p>加载自定义模块时，路径要以 <code>./</code> 或 <code>../</code> 开头，否则会作为内置模块或第三方模块加载。</p><p>导入自定义模块时，若省略文件扩展名，则 Node.js 会按顺序尝试加载文件：</p><ul><li>按确切的文件名加载</li><li>补全 <code>.js</code> 扩展名加载</li><li>补全 <code>.json</code> 扩展名加载</li><li>补全 <code>.node</code> 扩展名加载</li><li>报错</li></ul><h4 id="第三方模块加载"><a href="#第三方模块加载" class="headerlink" title="第三方模块加载"></a>第三方模块加载</h4><ul><li>若导入第三方模块， Node.js 会从<strong>当前模块的父目录</strong>开始，尝试从 <code>/node_modules</code> 文件夹中加载第三方模块。</li><li>如果没有找到对应的第三方模块，则移动到再<strong>上一层父目录</strong>中，进行加载，直到<strong>文件系统的根目录</strong>。</li></ul><p>例如，假设在 <code>C:\Users\bruce\project\foo.js</code> 文件里调用了 <code>require(&#39;tools&#39;)</code>，则 Node.js 会按以下顺序查找：</p><ul><li><code>C:\Users\bruce\project\node_modules\tools</code></li><li><code>C:\Users\bruce\node_modules\tools</code></li><li><code>C:\Users\node_modules\tools</code></li><li><code>C:\node_modules\tools</code></li></ul><h4 id="目录作为模块加载"><a href="#目录作为模块加载" class="headerlink" title="目录作为模块加载"></a>目录作为模块加载</h4><p>当把目录作为模块标识符进行加载的时候，有三种加载方式：</p><ul><li>在被加载的目录下查找 <code>package.json</code> 的文件，并寻找 <code>main</code> 属性，作为 <code>require()</code> 加载的入口</li><li>如果没有 <code>package.json</code> 文件，或者 <code>main</code> 入口不存在或无法解析，则 Node.js 将会试图加载目录下的 <code>index.js</code> 文件。</li><li>若失败则报错</li></ul><h2 id="npm和包"><a href="#npm和包" class="headerlink" title="npm和包"></a>npm和包</h2><h3 id="1、什么是包"><a href="#1、什么是包" class="headerlink" title="1、什么是包"></a>1、什么是包</h3><ul><li>Node.js 中的第三方模块叫做包</li></ul><h3 id="2、包的作用"><a href="#2、包的作用" class="headerlink" title="2、包的作用"></a>2、包的作用</h3><ul><li>由于Node.js的内置模块仅提供了一些底层API，导致在基于内置模块进行项目开发时，效率很低</li><li>包是基于内置模块封装出来的，提供了更高级、更方便的API，极大的提高了效率</li><li>包和内置模块的关系，相当于jQuery和浏览器内置API的关系</li></ul><p><img src="/img/nodejs/bao.png" alt="image"></p><h3 id="3、npm"><a href="#3、npm" class="headerlink" title="3、npm"></a>3、npm</h3><ul><li>安装</li></ul><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript"><span class="hljs-built_in">npm</span> install &lt;Module Name&gt;<br><span class="hljs-built_in">npm</span> i &lt;Module Name&gt;<br><span class="hljs-regexp">//</span>这个自动安装最新版本<br><br><span class="hljs-built_in">npm</span> install express@<span class="hljs-number">2.2</span><span class="hljs-number">.1</span><span class="hljs-comment">#指定版本</span><br><span class="hljs-built_in">npm</span> install express          <span class="hljs-comment"># 本地安装</span><br><span class="hljs-built_in">npm</span> install express -g   <span class="hljs-comment"># 全局安装</span><br></code></pre></td></tr></table></figure><ul><li>卸载</li></ul><p></p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript"><span class="hljs-built_in">npm</span> uninstall &lt;Module Name&gt;<br><br><span class="hljs-built_in">npm</span> uninstall express<br><span class="hljs-regexp">//</span>会从dependencies节点中删除<br><span class="hljs-built_in">npm</span> uninstall express -g<span class="hljs-comment">#卸载全局包</span><br></code></pre></td></tr></table></figure><ul><li>更新</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">npm <span class="hljs-keyword">update</span> <span class="hljs-operator">&lt;</span><span class="hljs-keyword">Module</span> Name<span class="hljs-operator">&gt;</span><br><br>npm <span class="hljs-keyword">update</span> express<br></code></pre></td></tr></table></figure><ul><li>搜索</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">npm <span class="hljs-keyword">search</span> <span class="hljs-operator">&lt;</span><span class="hljs-keyword">Module</span> Name<span class="hljs-operator">&gt;</span><br><br>npm <span class="hljs-keyword">search</span> express<br></code></pre></td></tr></table></figure><h3 id="4、包管理配置文件"><a href="#4、包管理配置文件" class="headerlink" title="4、包管理配置文件"></a>4、包管理配置文件</h3><ul><li>npm规定，在项目根目录中，必须提供一个叫做 <code>package.json</code> 的包管理配置文件，用来记录与项目相关的一些配置信息</li><li>例如<ul><li>项目的名称、版本号、描述等</li><li>项目中都用到了哪些包</li><li>哪些包只在开发期间会用到</li><li>哪些包在开发和部署时都需要用到</li></ul></li></ul><h4 id="创建package-json"><a href="#创建package-json" class="headerlink" title="创建package.json"></a>创建package.json</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>作用：在执行命令所处的目录中，快速新建 package.json 文件<br>npm init -y<br></code></pre></td></tr></table></figure><ul><li>项目文件夹的名称不能使用中文，不能有空格</li></ul><h4 id="dependencies节点"><a href="#dependencies节点" class="headerlink" title="dependencies节点"></a>dependencies节点</h4><ul><li>记录使用npm install 命令安装了哪些包</li></ul><p>如果有些包只在项目开发阶段用到，上线之后用不到，就把这些包放到devDependencies节点中</p><p>如果有些包在项目开发和上线阶段用到，就把这些包放到dependencies节点中</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>安装指定的包，并记录到 devDependencies 节点中<br>npm i 包名 -D<br><span class="hljs-regexp">//</span>等价于,完整写法包名和-D顺序不重要<br>npm install 包名 --save-dev<br></code></pre></td></tr></table></figure><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">npm<span class="hljs-built_in"> config </span><span class="hljs-built_in">set</span> <span class="hljs-attribute">registry</span>=https://registry.npm.taobao.org/<br></code></pre></td></tr></table></figure><h4 id="一次性安装所有的包"><a href="#一次性安装所有的包" class="headerlink" title="一次性安装所有的包"></a>一次性安装所有的包</h4><p>可以运行 <code>npm install</code> 或<code>npm i</code> 一次性安装所有的依赖包</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript"><span class="hljs-regexp">//</span>执行<span class="hljs-built_in">npm</span> install 命令时，<span class="hljs-built_in">npm</span> 包管理工具先读取 package.json 中的 dependencies 节点<br><span class="hljs-regexp">//</span>读取到记录的所有依赖包名称和版本号后，<span class="hljs-built_in">npm</span> 包管理工具会把这些包一次性下载到项目中<br><span class="hljs-built_in">npm</span> install<br><span class="hljs-built_in">npm</span> i<br></code></pre></td></tr></table></figure><h4 id="包的分类"><a href="#包的分类" class="headerlink" title="包的分类"></a>包的分类</h4><h5 id="1-项目包"><a href="#1-项目包" class="headerlink" title="1.项目包"></a>1.项目包</h5><p>那些被安装到项目的 node_modules 目录的包都是项目包</p><ul><li>开发依赖包(devDependencies)</li><li>核心依赖包     (dependencies)</li></ul><h5 id="2-全局包"><a href="#2-全局包" class="headerlink" title="2.全局包"></a>2.全局包</h5><p>在 <code>C:\Users\用户目录\AppData\Roaming\npm\node_modules</code>目录下</p><ul><li>工具性质的包，才有全局安装的必要性</li><li>参考官方提供的使用说明</li></ul><h5 id="３-i5ting-toc"><a href="#３-i5ting-toc" class="headerlink" title="３.i5ting_toc"></a>３.i5ting_toc</h5><p>可以把md文档转为html页面的小工具</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">i5ting_toc -f 要转换的md文件路径 -o<br><span class="hljs-regexp">//</span> -o 转换完后使用默认浏览器打开<br></code></pre></td></tr></table></figure><h3 id="5、规范的包结构"><a href="#5、规范的包结构" class="headerlink" title="5、规范的包结构"></a>5、规范的包结构</h3><p>一个规范的包，它的组成结构，必须符合以下３点要求：</p><ul><li>包必须以单独的目录而存在</li><li>包的顶级目录下要必须包含 这个包管理配置文件</li><li><code>package.json</code> 中必须包含 name，verson，main 这个是三个属性，分别代表包的名字、版本号、包的入口</li></ul><h3 id="6、开发属于自己的包"><a href="#6、开发属于自己的包" class="headerlink" title="6、开发属于自己的包"></a>6、开发属于自己的包</h3><p>初始化包的基本结构</p><ul><li>新建itheima-tools文件夹，作为包的根目录</li><li>在itheima-tools文件夹中，新建如下三个文件：<ul><li>package.json(包管理配置文件)</li><li>index.js   (包的入口文件)</li><li>README.md   (包的说明文档)</li></ul></li></ul><h3 id="7、发布npm包"><a href="#7、发布npm包" class="headerlink" title="7、发布npm包"></a>7、发布npm包</h3><h1 id="express"><a href="#express" class="headerlink" title="express"></a>express</h1><h2 id="Express-初体验"><a href="#Express-初体验" class="headerlink" title="Express 初体验"></a>Express 初体验</h2><ul><li><p>官方给出的概念：Express 是基于 Node.js 平台，快速、开放、极简的 Web 开发框架。</p></li><li><p>通俗的理解：Express 的作用和 Node.js 内置的 http 模块类似，是专门用来创建 Web 服务器的。</p></li><li><p>Express 的本质：就是一个 npm 上的第三方包，提供了快速创建 Web 服务器的便捷方法。</p></li></ul><h3 id="Express和http"><a href="#Express和http" class="headerlink" title="Express和http"></a>Express和http</h3><ul><li><code>http</code> 内置模块用起来很复杂，开发效率低；<code>Express</code> 是基于内置的 <code>http</code> 模块进一步封装出来的，能够极大的提高开发效率。</li><li>类似于浏览器中 Web API 和 jQuery 的关系。<code>Express</code>是基于<code>http</code>进一步封装出来的。</li></ul><blockquote><p>对于前端程序员来说，最常见的两种服务器，分别是： </p></blockquote><ul><li><p>Web 网站服务器：专门对外提供 Web 网页资源的服务器。 </p></li><li><p>API 接口服务器：专门对外提供 API 接口的服务器。</p></li></ul><p>使用 Express，我们可以方便、快速的创建 Web 网站的服务器或 API 接口的服务器</p><h3 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h3><p>安装 Express：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm install express<br></code></pre></td></tr></table></figure><p>创建服务器，监听客户端请求，并返回内容：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 1. 导入 express</span><br><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-comment">// 2. 创建 web 服务器</span><br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>()<br><br><span class="hljs-comment">// 4. 监听客户端的 GET 和 POST 请求，并向客户端响应具体的内容</span><br><span class="hljs-comment">//参数1：客户端请求的url地址参数2：请求对应的处理函数</span><br><span class="hljs-comment">//req：请求对象res：响应对象</span><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/user&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// 调用 express 提供的 res.send() 方法，向客户端响应一个 JSON 对象</span><br>  res.<span class="hljs-title function_">send</span>(&#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;zs&#x27;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">20</span>, <span class="hljs-attr">gender</span>: <span class="hljs-string">&#x27;男&#x27;</span> &#125;)<br>&#125;)<br>app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/user&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// 调用 express 提供的 res.send() 方法，向客户端响应一个 文本字符串</span><br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;请求成功&#x27;</span>)<br>&#125;)<br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// 通过 req.query 可以获取到客户端发送过来的 查询参数</span><br>  <span class="hljs-comment">// 客户端使用 ？name=zs&amp;age=20 这种查询字符串形式，发送到服务器的参数</span><br>  <span class="hljs-comment">// 注意：默认情况下，req.query 是一个空对象</span><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(req.<span class="hljs-property">query</span>)<br>  res.<span class="hljs-title function_">send</span>(req.<span class="hljs-property">query</span>)<br>&#125;)<br><span class="hljs-comment">// 注意：这里的 :id 是一个动态的参数</span><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/user/:ids/:username&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// req.params 是动态匹配到的 URL 参数，默认也是一个空对象</span><br>  <span class="hljs-comment">// 里面存放着通过 : 动态匹配到的参数值</span><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(req.<span class="hljs-property">params</span>)<br>  res.<span class="hljs-title function_">send</span>(req.<span class="hljs-property">params</span>)<br>&#125;)<br><br><span class="hljs-comment">// 3. 启动 web 服务器</span><br>app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">80</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;express server running at http://127.0.0.1&#x27;</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><ul><li>监听 GET 请求——通过 app.get() 方法，可以监听客户端的 GET 请求</li><li>监听 POST 请求——通过 app.post() 方法，可以监听客户端的 POST 请求</li><li>把内容响应给客户端——通过 res.send() 方法，可以把处理好的内容，发送给客户端</li><li>获取 URL 中携带的查询参数——通过 req.query 对象，可以访问到客户端通过查询字符串的形式，发送到服务器的参数</li><li>获取 URL 中的动态参数——通过 req.params 对象，可以访问到 URL 中，通过 : 匹配到的动态参数</li></ul><h3 id="托管静态资源"><a href="#托管静态资源" class="headerlink" title="托管静态资源"></a>托管静态资源</h3><ul><li>通过 <code>express.static()</code> 方法可创建<strong>静态资源服务器</strong>，向外开放访问静态资源。</li><li>Express 在指定的静态目录中查找文件，并对外提供资源的访问路径，存放静态文件的目录名不会出现在 URL 中</li><li>访问静态资源时，会根据托管顺序查找文件</li><li>可为静态资源访问路径添加<strong>前缀</strong></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>()<br><br><span class="hljs-comment">// 在这里，调用 express.static() 方法，快速的对外提供静态资源</span><br>app.<span class="hljs-title function_">use</span>(<span class="hljs-string">&#x27;/files&#x27;</span>, express.<span class="hljs-title function_">static</span>(<span class="hljs-string">&#x27;./files&#x27;</span>))<br>app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">static</span>(<span class="hljs-string">&#x27;./clock&#x27;</span>))<br><br>app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">80</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;express server running at http://127.0.0.1&#x27;</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="nodemon"><a href="#nodemon" class="headerlink" title="nodemon"></a>nodemon</h3><ul><li><p>当基于 Node.js 编写了一个网站应用的时候，传统的方式，是运行 node app.js 命令，来启动项目。</p><ul><li>这样做的坏处是： 代码被修改之后，需要手动重启项目。</li></ul></li><li><p>现在，我们可以将 node 命令替换为 nodemon 命令，使用 nodemon app.js 来启动项目。</p><ul><li>这样做的好处是：代码 被修改之后，会被 nodemon 监听到，从而实现自动重启项目的效果。</li></ul></li></ul><h2 id="Express路由"><a href="#Express路由" class="headerlink" title="Express路由"></a>Express路由</h2><ul><li>广义上来讲，路由就是映射关系</li><li>在 Express 中，路由指的是<strong>客户端的请求与服务器处理函数之间的映射关系</strong></li><li>Express 中的路由分 3 部分组成，分别是<strong>请求的类型、请求的 URL 地址、处理函数</strong></li></ul><p>格式如下:</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">app.<span class="hljs-keyword">METHOD</span>(<span class="hljs-type">PATH</span>, <span class="hljs-keyword">HANDLER</span>)<br></code></pre></td></tr></table></figure><h3 id="路由的匹配过程"><a href="#路由的匹配过程" class="headerlink" title="路由的匹配过程"></a>路由的匹配过程</h3><ul><li><p>每当一个请求到达服务器之后，需要先经过路由的匹配，只有匹配成功之后，才会调用对应的处理函数。</p></li><li><p>在匹配时，会按照路由的顺序进行匹配，如果请求类型和请求的 URL 同时匹配成功，则 Express 会将这次请求，转 交给对应的 function 函数进行处理。</p></li><li><p>可以简单理解为switch语句</p></li></ul><p><img src="/img/nodejs/luyou.png" alt="image"></p><p>路由匹配的注意点：</p><ul><li>按照定义的先后顺序进行匹配</li><li><strong>请求类型和请求的URL同时匹配成功</strong>， 才会调用对应的处理函数</li></ul><h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>()<br><br><span class="hljs-comment">// 挂载路由</span><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;hello world.&#x27;</span>)<br>&#125;)<br>app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Post Request.&#x27;</span>)<br>&#125;)<br><br>app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">80</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;http://127.0.0.1&#x27;</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="模块化路由"><a href="#模块化路由" class="headerlink" title="模块化路由"></a>模块化路由</h3><p>为了方便对路由进行模块化的管理，Express 不建议将路由直接挂载到 app 上，而是推荐将路由抽离为单独的模块。 将路由抽离为单独模块的步骤如下：</p><ol><li>创建路由模块对应的 .js 文件</li><li>调用 express.Router() 函数创建路由对象</li><li>向路由对象上挂载具体的路由</li><li>使用 module.exports 向外共享路由对象</li><li>使用 app.use() 函数注册路由模块</li></ol><p><strong>创建路由模块</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>()<br><br><span class="hljs-comment">// app.use(&#x27;/files&#x27;, express.static(&#x27;./files&#x27;))</span><br><br><span class="hljs-comment">// 1. 导入路由模块</span><br><span class="hljs-keyword">const</span> router = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./03.router&#x27;</span>)<br><span class="hljs-comment">// 2. 注册路由模块</span><br>app.<span class="hljs-title function_">use</span>(<span class="hljs-string">&#x27;/api&#x27;</span>, router)<br><br><span class="hljs-comment">// 注意： app.use() 函数的作用，就是来注册全局中间件</span><br><br>app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">80</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;http://127.0.0.1&#x27;</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><h2 id="Express中间件"><a href="#Express中间件" class="headerlink" title="Express中间件"></a>Express中间件</h2><ul><li>中间件（Middleware ），特指业务流程的<strong>中间处理环节</strong></li></ul><h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><h4 id="调用流程"><a href="#调用流程" class="headerlink" title="调用流程"></a><strong>调用流程</strong></h4><ul><li>当一个请求到达 Express 的服务器之后，可以连续调用多个中间件，从而对这次请求进行预处理</li></ul><p><img src="/img/nodejs/zhongjianjian.png" alt="image"></p><h4 id="中间件的格式"><a href="#中间件的格式" class="headerlink" title="中间件的格式"></a>中间件的格式</h4><p>Express 的中间件，本质上就是一个 function 处理函数，Express 中间件的格式如下：</p><p><img src="/img/nodejs/geshi.png" alt="image"></p><ul><li>注意：中间件函数的形参列表中，必须包含 next 参数。而路由处理函数中只包含 req 和 res</li></ul><h4 id="next-函数的作用"><a href="#next-函数的作用" class="headerlink" title="next 函数的作用"></a>next 函数的作用</h4><ul><li>next 函数是实现多个中间件连续调用的关键，它表示把流转关系转交给下一个中间件或路由。</li></ul><p><img src="/img/nodejs/zuoyong.png" alt="image"></p><h3 id="使用-1"><a href="#使用-1" class="headerlink" title="使用"></a>使用</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 定义一个最简单的中间件函数</span><br><span class="hljs-keyword">const</span> mw = <span class="hljs-keyword">function</span> (<span class="hljs-params">req, res, next</span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;这是最简单的中间件函数&#x27;</span>)<br>  <span class="hljs-comment">// 把流转关系，转交给下一个中间件或路由</span><br>  <span class="hljs-title function_">next</span>()<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="全局生效的中间件"><a href="#全局生效的中间件" class="headerlink" title="全局生效的中间件"></a>全局生效的中间件</h3><ul><li>客户端发起的任何请求，到达服务器之后，都会触发的中间件，叫做全局生效的中间件</li><li>通过调用 app.use(中间件函数)，即可定义一个全局生效的中间件</li><li>可以使用 <code>app.use()</code> 连续定义多个全局中间件。客户端请求到达服务器之后，会按照中间件定义的<strong>先后顺序依次进行</strong> 调用</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>()<br><br><span class="hljs-comment">// 定义第一个全局中间件</span><br>app.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">req, res, next</span>) =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;调用了第1个全局中间件&#x27;</span>)<br>  <span class="hljs-title function_">next</span>()<br>&#125;)<br><span class="hljs-comment">// 定义第二个全局中间件</span><br>app.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">req, res, next</span>) =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;调用了第2个全局中间件&#x27;</span>)<br>  <span class="hljs-title function_">next</span>()<br>&#125;)<br><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/user&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;User page.&#x27;</span>)<br>&#125;)<br><br>app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">80</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;http://127.0.0.1&#x27;</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="中间件的作用"><a href="#中间件的作用" class="headerlink" title="中间件的作用"></a>中间件的作用</h3><p>多个中间件之间，共享同一份 <code>req</code> 和 <code>res</code>。</p><p>基于这样的特性，我们可以在上游的中间件中，<strong>统一为 req 或 res 对象添 加自定义的属性或方法</strong>，供下游的中间件或路由进行使用。</p><p><img src="/img/nodejs/zuoyong2.png" alt="image"></p><h3 id="局部生效的中间件"><a href="#局部生效的中间件" class="headerlink" title="局部生效的中间件"></a>局部生效的中间件</h3><ul><li>不使用 app.use() 定义的中间件，叫做局部生效的中间件</li><li>可以在路由中，通过如下两种等价的方式，使用多个局部中间件</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>()<br><br><span class="hljs-comment">// 定义中间件函数</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">mw1</span> = (<span class="hljs-params">req, res, next</span>) =&gt; &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;调用了第一个局部生效的中间件&#x27;</span>)<br>  <span class="hljs-title function_">next</span>()<br>&#125;<br><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">mw2</span> = (<span class="hljs-params">req, res, next</span>) =&gt; &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;调用了第二个局部生效的中间件&#x27;</span>)<br>  <span class="hljs-title function_">next</span>()<br>&#125;<br><br><span class="hljs-comment">// 两种定义局部中间件的方式</span><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/hello&#x27;</span>, mw2, mw1, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;hello page.&#x27;</span>))<br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/about&#x27;</span>, [mw1, mw2], <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;about page.&#x27;</span>))<br><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/user&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;User page.&#x27;</span>))<br><br>app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">80</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Express server running at http://127.0.0.1&#x27;</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><ul><li>一定要在<strong>路由之前注册中间件</strong></li><li>客户端发送过来的请求，可以连续调用多个中间件进行处理</li><li>执行完中间件的业务代码之后，不要忘记调用 <strong>next()</strong> 函数</li><li>为了防止代码逻辑混乱，<strong>调用 next() 函数后不要再写额外的代码</strong></li><li>连续调用多个中间件时，多个中间件之间，<strong>共享 req 和 res 对象</strong></li></ul><h3 id="中间件的分类"><a href="#中间件的分类" class="headerlink" title="中间件的分类"></a>中间件的分类</h3><h4 id="1、应用级别的中间件"><a href="#1、应用级别的中间件" class="headerlink" title="1、应用级别的中间件"></a>1、应用级别的中间件</h4><ul><li>通过 app.use() 或 app.get() 或 app.post() ，绑定到 app 实例上的中间件，叫做应用级别的中间件</li></ul><h4 id="2、路由级别的中间件"><a href="#2、路由级别的中间件" class="headerlink" title="2、路由级别的中间件"></a>2、路由级别的中间件</h4><ul><li>绑定到 <code>express.Router()</code> 实例上的中间件，叫做路由级别的中间件。用法和应用级别中间件没有区别。应用级别中间件是绑定到 <code>app</code> 实例上，路由级别中间件绑定到 <code>router</code> 实例上。</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>()<br><span class="hljs-keyword">const</span> router = express.<span class="hljs-title class_">Router</span>()<br><br>router.<span class="hljs-title function_">use</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">req, res, next</span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">1</span>)<br>  <span class="hljs-title function_">next</span>()<br>&#125;)<br><br>app.<span class="hljs-title function_">use</span>(<span class="hljs-string">&#x27;/&#x27;</span>, router)<br></code></pre></td></tr></table></figure><h4 id="3、错误级别的中间件"><a href="#3、错误级别的中间件" class="headerlink" title="3、错误级别的中间件"></a>3、错误级别的中间件</h4><ul><li>用来捕获整个项目中发生的异常错误，从而防止项目异常崩溃的问题</li><li>错误级别中间件的处理函数中，必须有 4 个形参，形参顺序从前到后分别是 <code>(err, req, res, next)</code> 。</li><li><strong>错误级别的中间件必须注册在所有路由之后</strong></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>()<br><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;服务器内部发生了错误！&#x27;</span>)<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Home page.&#x27;</span>)<br>&#125;)<br><br><span class="hljs-comment">// 定义错误级别的中间件，捕获整个项目的异常错误，从而防止程序的崩溃</span><br>app.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">err, req, res, next</span>) =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;发生了错误！&#x27;</span> + err.<span class="hljs-property">message</span>)<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Error：&#x27;</span> + err.<span class="hljs-property">message</span>)<br>&#125;)<br><br>app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">80</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Express server running at http://127.0.0.1&#x27;</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><h4 id="4、Express-内置的中间件"><a href="#4、Express-内置的中间件" class="headerlink" title="4、Express 内置的中间件"></a>4、Express 内置的中间件</h4><p>自 Express 4.16.0 版本开始，Express 内置了 3 个常用的中间件，极大的提高了 Express 项目的开发效率和体验：</p><ul><li><code>express.static</code> 快速托管静态资源的内置中间件，例如： HTML 文件、图片、CSS 样式等（无兼容性）</li><li><code>express.json</code> 解析 JSON 格式的请求体数据（有兼容性，仅在 4.16.0+ 版本中可用）</li><li><code>express.urlencoded</code> 解析 URL-encoded 格式的请求体数据（有兼容性，仅在 4.16.0+ 版本中可用）</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 导入 express 模块</span><br><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-comment">// 创建 express 的服务器实例</span><br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>()<br><br><span class="hljs-comment">// 注意：除了错误级别的中间件，其他的中间件，必须在路由之前进行配置</span><br><span class="hljs-comment">// 通过 express.json() 这个中间件，解析表单中的 JSON 格式的数据</span><br>app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">json</span>())<br><span class="hljs-comment">// 通过 express.urlencoded() 这个中间件，来解析 表单中的 url-encoded 格式的数据</span><br>app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">urlencoded</span>(&#123; <span class="hljs-attr">extended</span>: <span class="hljs-literal">false</span> &#125;))<br><br>app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/user&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// 在服务器，可以使用 req.body 这个属性，来接收客户端发送过来的请求体数据</span><br>  <span class="hljs-comment">// 默认情况下，如果不配置解析表单数据的中间件，则 req.body 默认等于 undefined</span><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(req.<span class="hljs-property">body</span>)<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;ok&#x27;</span>)<br>&#125;)<br><br>app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/book&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// 在服务器端，可以通过 req,body 来获取 JSON 格式的表单数据和 url-encoded 格式的数据</span><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(req.<span class="hljs-property">body</span>)<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;ok&#x27;</span>)<br>&#125;)<br><br><span class="hljs-comment">// 调用 app.listen 方法，指定端口号并启动web服务器</span><br>app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">80</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Express server running at http://127.0.0.1&#x27;</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><h4 id="5、第三方的中间件"><a href="#5、第三方的中间件" class="headerlink" title="5、第三方的中间件"></a>5、第三方的中间件</h4><ul><li>非 Express 官方内置的，而是由第三方开发出来的中间件，叫做第三方中间件。在项目中，大家可以按需下载并配置 第三方中间件，从而提高项目的开发效率。</li></ul><p>例如：在 <a href="mailto:&#101;&#x78;&#x70;&#x72;&#x65;&#x73;&#115;&#64;&#x34;&#46;&#49;&#54;&#46;&#48;">&#101;&#x78;&#x70;&#x72;&#x65;&#x73;&#115;&#64;&#x34;&#46;&#49;&#54;&#46;&#48;</a> 之前的版本中，经常使用 body-parser 这个第三方中间件，来解析请求体数据。使用步 骤如下： </p><ol><li>运行 npm install body-parser 安装中间件 </li><li>使用 require 导入中间件 </li><li>调用 app.use() 注册并使用中间件</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 导入 express 模块</span><br><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-comment">// 创建 express 的服务器实例</span><br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>()<br><br><span class="hljs-comment">// 1. 导入解析表单数据的中间件 body-parser</span><br><span class="hljs-keyword">const</span> parser = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;body-parser&#x27;</span>)<br><span class="hljs-comment">// 2. 使用 app.use() 注册中间件</span><br>app.<span class="hljs-title function_">use</span>(parser.<span class="hljs-title function_">urlencoded</span>(&#123; <span class="hljs-attr">extended</span>: <span class="hljs-literal">false</span> &#125;))<br><span class="hljs-comment">// app.use(express.urlencoded(&#123; extended: false &#125;))</span><br><br>app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/user&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// 如果没有配置任何解析表单数据的中间件，则 req.body 默认等于 undefined</span><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(req.<span class="hljs-property">body</span>)<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;ok&#x27;</span>)<br>&#125;)<br><br><span class="hljs-comment">// 调用 app.listen 方法，指定端口号并启动web服务器</span><br>app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">80</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Express server running at http://127.0.0.1&#x27;</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="自定义中间件"><a href="#自定义中间件" class="headerlink" title="自定义中间件"></a>自定义中间件</h3><p>自己手动模拟一个类似于 express.urlencoded 这样的中间件，来解析 POST 提交到服务器的表单数据。 实现步骤： </p><ol><li>定义中间件 <ul><li>使用 app.use() 来定义全局生效的中间件</li></ul></li><li>监听 req 的 data 事件 <ul><li>在中间件中，需要监听 req 对象的 data 事件，来获取客户端发送到服务器的数据</li><li>如果数据量比较大，无法一次性发送完毕，则客户端会把数据切割后，分批发送到服务器。所以 data 事件可能会触 发多次，每一次触发 data 事件时，获取到数据只是完整数据的一部分，需要手动对接收到的数据进行拼接</li></ul></li><li>监听 req 的 end 事件 <ul><li>当请求体数据接收完毕之后，会自动触发 req 的 end 事件。 </li><li>因此，我们可以在 req 的 end 事件中，拿到并处理完整的请求体数据</li></ul></li><li>使用 querystring 模块解析请求体数据 <ul><li>Node.js 内置了一个 querystring 模块，专门用来处理查询字符串。通过这个模块提供的 parse() 函数，可以轻松把 查询字符串，解析成对象的格式</li></ul></li><li>将解析出来的数据对象挂载为 req.body <ul><li>上游的中间件和下游的中间件及路由之间，共享同一份 req 和 res。因此，我们可以将解析出来的数据，挂载为 req  的自定义属性，命名为 req.body，供下游使用</li></ul></li><li>将自定义中间件封装为模块<ul><li>为了优化代码的结构，我们可以把自定义的中间件函数，封装为独立的模块</li></ul></li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 导入 express 模块</span><br><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-comment">// 创建 express 的服务器实例</span><br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>()<br><span class="hljs-comment">// 导入 Node.js 内置的 querystring 模块</span><br><span class="hljs-keyword">const</span> qs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;querystring&#x27;</span>)<br><br><span class="hljs-comment">// 这是解析表单数据的中间件</span><br>app.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">req, res, next</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// 定义中间件具体的业务逻辑</span><br>  <span class="hljs-comment">// 1. 定义一个 str 字符串，专门用来存储客户端发送过来的请求体数据</span><br>  <span class="hljs-keyword">let</span> str = <span class="hljs-string">&#x27;&#x27;</span><br>  <span class="hljs-comment">// 2. 监听 req 的 data 事件</span><br>  req.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;data&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">chunk</span>) =&gt;</span> &#123;<br>    str += chunk<br>  &#125;)<br>  <span class="hljs-comment">// 3. 监听 req 的 end 事件</span><br>  req.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;end&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-comment">// 在 str 中存放的是完整的请求体数据</span><br>    <span class="hljs-comment">// console.log(str)</span><br>    <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> 把字符串格式的请求体数据，解析成对象格式</span><br>    <span class="hljs-keyword">const</span> body = qs.<span class="hljs-title function_">parse</span>(str)  <span class="hljs-comment">//调用qs.parse()方法，把查询字符串解析为对象</span><br>    req.<span class="hljs-property">body</span> = body <span class="hljs-comment">//将解析出来的请求对象，挂载为req.body对象</span><br>    <span class="hljs-title function_">next</span>()  <span class="hljs-comment">//最后，next()函数，执行后续的业务逻辑</span><br>  &#125;)<br>&#125;)<br><br>app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/user&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  res.<span class="hljs-title function_">send</span>(req.<span class="hljs-property">body</span>)<br>&#125;)<br><br><span class="hljs-comment">// 调用 app.listen 方法，指定端口号并启动web服务器</span><br>app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">80</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Express server running at http://127.0.0.1&#x27;</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><p><strong>封装</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 导入 express 模块</span><br><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-comment">// 创建 express 的服务器实例</span><br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>()<br><br><span class="hljs-comment">// 1. 导入自己封装的中间件模块</span><br><span class="hljs-keyword">const</span> customBodyParser = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./14.custom-body-parser&#x27;</span>)<br><span class="hljs-comment">// 2. 将自定义的中间件函数，注册为全局可用的中间件</span><br>app.<span class="hljs-title function_">use</span>(customBodyParser)<br><br>app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/user&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  res.<span class="hljs-title function_">send</span>(req.<span class="hljs-property">body</span>)<br>&#125;)<br><br><span class="hljs-comment">// 调用 app.listen 方法，指定端口号并启动web服务器</span><br>app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">80</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Express server running at http://127.0.0.1&#x27;</span>)<br>&#125;)<br><br>--------------------------------------------------------------<br><span class="hljs-comment">// custom-body-parser.js</span><br><span class="hljs-comment">// 导入 Node.js 内置的 querystring 模块</span><br><span class="hljs-keyword">const</span> qs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;querystring&#x27;</span>)<br><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">bodyParser</span> = (<span class="hljs-params">req, res, next</span>) =&gt; &#123;<br>  <span class="hljs-comment">// 定义中间件具体的业务逻辑</span><br>  <span class="hljs-comment">// 1. 定义一个 str 字符串，专门用来存储客户端发送过来的请求体数据</span><br>  <span class="hljs-keyword">let</span> str = <span class="hljs-string">&#x27;&#x27;</span><br>  <span class="hljs-comment">// 2. 监听 req 的 data 事件</span><br>  req.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;data&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">chunk</span>) =&gt;</span> &#123;<br>    str += chunk<br>  &#125;)<br>  <span class="hljs-comment">// 3. 监听 req 的 end 事件</span><br>  req.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;end&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-comment">// 在 str 中存放的是完整的请求体数据</span><br>    <span class="hljs-comment">// console.log(str)</span><br>    <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> 把字符串格式的请求体数据，解析成对象格式</span><br>    <span class="hljs-keyword">const</span> body = qs.<span class="hljs-title function_">parse</span>(str)<br>    req.<span class="hljs-property">body</span> = body<br>    <span class="hljs-title function_">next</span>()<br>  &#125;)<br>&#125;<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = bodyParser<br></code></pre></td></tr></table></figure><h2 id="使用Express写接口"><a href="#使用Express写接口" class="headerlink" title="使用Express写接口"></a>使用Express写接口</h2><h3 id="CORS-跨域资源共享"><a href="#CORS-跨域资源共享" class="headerlink" title="CORS 跨域资源共享"></a>CORS 跨域资源共享</h3><h4 id="1、接口的跨域问题"><a href="#1、接口的跨域问题" class="headerlink" title="1、接口的跨域问题"></a>1、接口的跨域问题</h4><p>解决接口跨域问题的方案主要有两种： </p><ol><li>CORS（主流的解决方案，推荐使用） </li><li>JSONP（有缺陷的解决方案：只支持 GET 请求）</li></ol><h4 id="2、使用-cors-中间件解决跨域问题"><a href="#2、使用-cors-中间件解决跨域问题" class="headerlink" title="2、使用 cors 中间件解决跨域问题"></a>2、使用 cors 中间件解决跨域问题</h4><p>cors 是 Express 的一个第三方中间件。通过安装和配置 cors 中间件，可以很方便地解决跨域问题。 使用步骤分为如下 3 步：  </p><ol><li>运行 <code>npm install cors</code> 安装中间件 </li><li>使用 <code>const cors = require(&#39;cors&#39;)</code> 导入中间件 </li><li>在路由之前调用 <code>app.use(cors())</code> 配置中间件</li></ol><h4 id="3、什么是-CORS"><a href="#3、什么是-CORS" class="headerlink" title="3、什么是 CORS"></a>3、什么是 CORS</h4><ul><li>CORS （Cross-Origin Resource Sharing，跨域资源共享）由一系列 HTTP 响应头组成，这些 HTTP 响应头决定 <strong>浏览器是否阻止前端 JS 代码跨域获取资源</strong></li><li>浏览器的同<strong>源安全策略</strong>默认会阻止网页“跨域”获取资源。但如果接口服务器配置了 CORS 相关的 HTTP 响应头， 就可以解除浏览器端的跨域访问限制</li></ul><p><img src="/img/nodejs/cors.png" alt="image"></p><h4 id="4、CORS-的注意事项"><a href="#4、CORS-的注意事项" class="headerlink" title="4、CORS 的注意事项"></a>4、CORS 的注意事项</h4><ul><li>CORS 主要在服务器端进行配置。客户端浏览器无须做任何额外的配置，即可请求开启了 CORS 的接口</li><li>CORS 在浏览器中有兼容性。只有支持 XMLHttpRequest Level2 的浏览器，才能正常访问开启了 CORS 的服 务端接口（例如：IE10+、Chrome4+、FireFox3.5+）</li></ul><h4 id="5、CORS-常见响应头"><a href="#5、CORS-常见响应头" class="headerlink" title="5、CORS 常见响应头"></a>5、CORS 常见响应头</h4><h5 id="1、CORS-响应头部-Access-Control-Allow-Origi"><a href="#1、CORS-响应头部-Access-Control-Allow-Origi" class="headerlink" title="1、CORS 响应头部- Access-Control-Allow-Origi"></a>1、CORS 响应头部- Access-Control-Allow-Origi</h5><p>响应头部中可以携带一个 Access-Control-Allow-Origin 字段，其语法如下: </p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">Access-Control-Allow-origin:<span class="hljs-variable">&lt;origin&gt;</span> |<span class="hljs-string"> *</span><br></code></pre></td></tr></table></figure><p>其中，origin 参数的值指定了允许访问该资源的外域 URL。</p><p>例如，下面的字段值将只允许来自 <a href="http://itcast.cn/">http://itcast.cn</a> 的请求</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">res.set<span class="hljs-constructor">Header(&#x27;Access-Control-Allow-<span class="hljs-params">origin</span>&#x27;,&#x27;<span class="hljs-params">http</span>:<span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-params">itcast</span>.<span class="hljs-params">cn</span>&#x27;)</span><br></code></pre></td></tr></table></figure><p>如果指定了 Access-Control-Allow-Origin 字段的值为通配符 *，表示允许来自任何域的请求</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">res<span class="hljs-selector-class">.setHeader</span>(<span class="hljs-string">&#x27;Access-Control-Allow-origin&#x27;</span>,<span class="hljs-string">&#x27;*&#x27;</span>)<br></code></pre></td></tr></table></figure><h5 id="2、CORS-响应头部-Access-Control-Allow-Headers"><a href="#2、CORS-响应头部-Access-Control-Allow-Headers" class="headerlink" title="2、CORS 响应头部 - Access-Control-Allow-Headers"></a>2、CORS 响应头部 - Access-Control-Allow-Headers</h5><p>默认情况下，CORS 仅支持客户端向服务器发送如下的 9 个请求头：</p><ul><li><p><code>Accept</code>、<code>Accept-Language</code>、<code>Content-Language</code>、<code>DPR</code>、<code>Downlink</code>、<code>Save-Data</code>、<code>Viewport-Width</code>、<code>Width</code> 、 <code>Content-Type</code> （值仅限于 <code>text/plain</code>、<code>multipart/form-data</code>、<code>application/x-www-form-urlencoded</code> 三者之一） </p></li><li><p>如果客户端向服务器发送了额外的请求头信息，则需要在服务器端，通过 Access-Control-Allow-Headers 对额外 的请求头进行声明，否则这次请求会失败！</p></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//允许客户端额外向服务器发送 Content-Type 请求头和 X-Custom-Header 请求头</span><br><span class="hljs-comment">//多个请求头之间使用逗号进行分隔</span><br>res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Headers&#x27;</span>, <span class="hljs-string">&#x27;Content-Type, X-Custom-Header&#x27;</span>)<br></code></pre></td></tr></table></figure><h5 id="3、CORS-响应头部-Access-Control-Allow-Methods"><a href="#3、CORS-响应头部-Access-Control-Allow-Methods" class="headerlink" title="3、CORS 响应头部 - Access-Control-Allow-Methods"></a>3、CORS 响应头部 - Access-Control-Allow-Methods</h5><ul><li>默认情况下，CORS 仅支持客户端发起 GET、POST、HEAD 请求</li><li>如果客户端希望通过 PUT、DELETE 等方式请求服务器的资源，则需要在服务器端，通过 <code>Access-Control-Alow-Methods</code> 来指明实际请求所允许使用的 HTTP 方法</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//只允许 GET、POST、HEAD DELETE  请求方式</span><br>res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Methods&#x27;</span>, <span class="hljs-string">&#x27;POST, GET, DELETE, HEAD&#x27;</span>)<br><span class="hljs-comment">//允许所有的 HTTP请求方式</span><br>res.<span class="hljs-title function_">setHEader</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Methods&#x27;</span>, <span class="hljs-string">&#x27;*&#x27;</span>)<br></code></pre></td></tr></table></figure><h4 id="6、CORS请求的分类"><a href="#6、CORS请求的分类" class="headerlink" title="6、CORS请求的分类"></a>6、CORS请求的分类</h4><p>客户端在请求 CORS 接口时，根据请求方式和请求头的不同，可以将 CORS 的请求分为两大类</p><ul><li>简单请求</li><li>预检请求</li></ul><h5 id="1、简单请求"><a href="#1、简单请求" class="headerlink" title="1、简单请求"></a>1、简单请求</h5><p>同时满足以下两大条件的请求，就属于简单请求</p><ul><li>请求方式：GET、POST、HEAD 三者之一</li><li>HTTP 头部信息不超过以下几种字段：无自定义头部字段、Accept、Accept-Language、Content-Language、DPR、 Downlink、Save-Data、Viewport-Width、Width 、Content-Type（只有三个值application&#x2F;x-www-formurlencoded、multipart&#x2F;form-data、text&#x2F;plain</li></ul><h5 id="2、预检请求"><a href="#2、预检请求" class="headerlink" title="2、预检请求"></a>2、预检请求</h5><p>只要符合以下任何一个条件的请求，都需要进行预检请求： </p><ul><li>请求方式为 GET、POST、HEAD 之外的请求 Method 类型 </li><li>请求头中包含自定义头部字段 </li><li>向服务器发送了 application&#x2F;json 格式的数据</li></ul><p><strong>在浏览器与服务器正式通信之前，浏览器会先发送 <code>OPTION</code> 请求进行预检，以获知服务器是否允许该实际请求，所以这一 次的 OPTION 请求称为“预检请求”。服务器成功响应预检请求后，才会发送真正的请求，并且携带真实数据</strong></p><h5 id="3、简单请求和预检请求的区别"><a href="#3、简单请求和预检请求的区别" class="headerlink" title="3、简单请求和预检请求的区别"></a>3、简单请求和预检请求的区别</h5><ul><li><p>简单请求的特点：客户端与服务器之间只会发生一次请求。</p></li><li><p>预检请求的特点：客户端与服务器之间会发生两次请求，OPTION 预检请求成功之后，才会发起真正的请求。</p></li></ul><h3 id="JSONP-接口"><a href="#JSONP-接口" class="headerlink" title="JSONP 接口"></a>JSONP 接口</h3><h4 id="1、JSONP-的概念与特点"><a href="#1、JSONP-的概念与特点" class="headerlink" title="1、JSONP 的概念与特点"></a>1、JSONP 的概念与特点</h4><p><strong>概念</strong>：浏览器端通过  script  标签的 src 属性，请求服务器上的数据，同时，服务器返回一个函数的调用。这种请求数据 的方式叫做 JSONP。</p><p><strong>特点</strong>： </p><ol><li>JSONP 不属于真正的 Ajax 请求，因为它没有使用 XMLHttpRequest 这个对象。 </li><li>JSONP 仅支持 GET 请求，不支持 POST、PUT、DELETE 等请求</li></ol><h4 id="2、JSONP-接口"><a href="#2、JSONP-接口" class="headerlink" title="2、JSONP 接口"></a>2、JSONP 接口</h4><p><strong>创建 JSONP 接口的注意事项</strong></p><ul><li>如果项目中已经配置了 CORS 跨域资源共享，为了防止冲突，必须在配置 CORS 中间件之前声明 JSONP 的接口。否则 JSONP 接口会被处理成开启了 CORS 的接口。</li></ul><p><img src="/img/nodejs/jiekou.png" alt="image"></p><h4 id="3、实现-JSONP-接口的步骤"><a href="#3、实现-JSONP-接口的步骤" class="headerlink" title="3、实现 JSONP 接口的步骤"></a>3、实现 JSONP 接口的步骤</h4><ol><li>获取客户端发送过来的回调函数的名字 </li><li>得到要通过 JSONP 形式发送给客户端的数据 </li><li>根据前两步得到的数据，拼接出一个函数调用的字符串 </li><li>把上一步拼接得到的字符串，响应给客户端的</li></ol><h4 id="4、实现-JSONP-接口的具体代码"><a href="#4、实现-JSONP-接口的具体代码" class="headerlink" title="4、实现 JSONP 接口的具体代码"></a>4、实现 JSONP 接口的具体代码</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 导入 express</span><br><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-comment">// 创建服务器实例</span><br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>()<br><br><span class="hljs-comment">// 配置解析表单数据的中间件</span><br>app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">urlencoded</span>(&#123; <span class="hljs-attr">extended</span>: <span class="hljs-literal">false</span> &#125;))<br><br><span class="hljs-comment">// 必须在配置 cors 中间件之前，配置 JSONP 的接口</span><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/api/jsonp&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> 定义 JSONP 接口具体的实现过程</span><br>  <span class="hljs-comment">// 1. 得到函数的名称</span><br>  <span class="hljs-keyword">const</span> funcName = req.<span class="hljs-property">query</span>.<span class="hljs-property">callback</span><br>  <span class="hljs-comment">// 2. 定义要发送到客户端的数据对象</span><br>  <span class="hljs-keyword">const</span> data = &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;zs&#x27;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">22</span> &#125;<br>  <span class="hljs-comment">// 3. 拼接出一个函数的调用</span><br>  <span class="hljs-keyword">const</span> scriptStr = <span class="hljs-string">`<span class="hljs-subst">$&#123;funcName&#125;</span>(<span class="hljs-subst">$&#123;<span class="hljs-built_in">JSON</span>.stringify(data)&#125;</span>)`</span><br>  <span class="hljs-comment">// 4. 把拼接的字符串，响应给客户端</span><br>  res.<span class="hljs-title function_">send</span>(scriptStr)<br>&#125;)<br><br><span class="hljs-comment">// 一定要在路由之前，配置 cors 这个中间件，从而解决接口跨域的问题</span><br><span class="hljs-keyword">const</span> cors = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;cors&#x27;</span>)<br>app.<span class="hljs-title function_">use</span>(<span class="hljs-title function_">cors</span>())<br><br><span class="hljs-comment">// 导入路由模块</span><br><span class="hljs-keyword">const</span> router  = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./16.apiRouter&#x27;</span>)<br><span class="hljs-comment">// 把路由模块，注册到 app 上</span><br>app.<span class="hljs-title function_">use</span>(<span class="hljs-string">&#x27;/api&#x27;</span>, router)<br><br><span class="hljs-comment">// 启动服务器</span><br>app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">80</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;express server running at http://127.0.0.1&#x27;</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><h4 id="5、在网页中使用-jQuery-发起-JSONP-请求"><a href="#5、在网页中使用-jQuery-发起-JSONP-请求" class="headerlink" title="5、在网页中使用 jQuery 发起 JSONP 请求"></a>5、在网页中使用 jQuery 发起 JSONP 请求</h4><ul><li>调用 $.ajax() 函数，提供 JSONP 的配置选项，从而发起 JSONP 请求</li></ul><p><img src="/img/nodejs/qingqiu.png" alt="image"></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js">$(<span class="hljs-string">&#x27;#btnJSONP&#x27;</span>).<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>          $.<span class="hljs-title function_">ajax</span>(&#123;<br>            <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;GET&#x27;</span>,<br>            <span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;http://127.0.0.1/api/jsonp&#x27;</span>,<br>            <span class="hljs-attr">dataType</span>: <span class="hljs-string">&#x27;jsonp&#x27;</span>,<br>            <span class="hljs-attr">success</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">res</span>) &#123;<br>              <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res)<br>            &#125;,<br>          &#125;)<br>        &#125;)<br></code></pre></td></tr></table></figure><h1 id="数据库和身份认证"><a href="#数据库和身份认证" class="headerlink" title="数据库和身份认证"></a>数据库和身份认证</h1><h1 id="后台"><a href="#后台" class="headerlink" title="后台"></a>后台</h1><h2 id="1-项目初始化"><a href="#1-项目初始化" class="headerlink" title="1. 项目初始化"></a>1. 项目初始化</h2><h3 id="1-1-创建项目"><a href="#1-1-创建项目" class="headerlink" title="1.1 创建项目"></a>1.1 创建项目</h3><ol><li>新建 <code>api_server</code> 文件夹作为项目根目录，并在项目根目录中运行如下的命令，初始化包管理配置文件：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm init -y<br></code></pre></td></tr></table></figure><ol><li>运行如下的命令，安装特定版本的 <code>express</code>：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm i express@4.17.1<br></code></pre></td></tr></table></figure><ol><li>在项目根目录中新建 <code>app.js</code> 作为整个项目的入口文件，并初始化如下的代码：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-comment">// 创建 express 的服务器实例</span><br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>()<br><br><span class="hljs-comment">// write your code here...</span><br><br><span class="hljs-comment">// 调用 app.listen 方法，指定端口号并启动web服务器</span><br>app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3007</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;api server running at http://127.0.0.1:3007&#x27;</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="1-2-配置-cors-跨域"><a href="#1-2-配置-cors-跨域" class="headerlink" title="1.2 配置 cors 跨域"></a>1.2 配置 cors 跨域</h3><ol><li>运行如下的命令，安装 <code>cors</code> 中间件：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm i cors@2.8.5<br></code></pre></td></tr></table></figure><ol><li>在 <code>app.js</code> 中导入并配置 <code>cors</code> 中间件：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> cors = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;cors&#x27;</span>)<br><br>app.<span class="hljs-title function_">use</span>(<span class="hljs-title function_">cors</span>())<br></code></pre></td></tr></table></figure><h3 id="1-3-配置解析表单数据的中间件"><a href="#1-3-配置解析表单数据的中间件" class="headerlink" title="1.3 配置解析表单数据的中间件"></a>1.3 配置解析表单数据的中间件</h3><ol><li>通过如下的代码，配置解析 <code>application/x-www-form-urlencoded</code> 格式的表单数据的中间件：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">urlencoded</span>(&#123; <span class="hljs-attr">extended</span>: <span class="hljs-literal">false</span> &#125;))<br></code></pre></td></tr></table></figure><h3 id="1-4-初始化路由相关的文件夹"><a href="#1-4-初始化路由相关的文件夹" class="headerlink" title="1.4 初始化路由相关的文件夹"></a>1.4 初始化路由相关的文件夹</h3><ol><li>在项目根目录中，新建 <code>router</code> 文件夹，用来存放所有的<code>路由</code>模块</li></ol><blockquote><p>路由模块中，只存放客户端的请求与处理函数之间的映射关系</p></blockquote><ol><li>在项目根目录中，新建 <code>router_handler</code> 文件夹，用来存放所有的 <code>路由处理函数模块</code></li></ol><blockquote><p>路由处理函数模块中，专门负责存放每个路由对应的处理函数</p></blockquote><h3 id="1-5-初始化用户路由模块"><a href="#1-5-初始化用户路由模块" class="headerlink" title="1.5 初始化用户路由模块"></a>1.5 初始化用户路由模块</h3><ol><li>在 <code>router</code> 文件夹中，新建 <code>user.js</code> 文件，作为用户的路由模块，并初始化代码：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-comment">// 创建路由对象</span><br><span class="hljs-keyword">const</span> router = express.<span class="hljs-title class_">Router</span>()<br><br><span class="hljs-comment">// 注册新用户</span><br>router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/reguser&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;reguser OK&#x27;</span>)<br>&#125;)<br><br><span class="hljs-comment">// 登录</span><br>router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/login&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;login OK&#x27;</span>)<br>&#125;)<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = router<br></code></pre></td></tr></table></figure><ol><li>在 <code>app.js</code> 中，导入注册用户路由模块 ：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> userRouter = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./router/user&#x27;</span>)<br>app.<span class="hljs-title function_">use</span>(<span class="hljs-string">&#x27;/api&#x27;</span>, userRouter)<br></code></pre></td></tr></table></figure><h3 id="1-6-抽离用户路由模块中的处理函数"><a href="#1-6-抽离用户路由模块中的处理函数" class="headerlink" title="1.6 抽离用户路由模块中的处理函数"></a>1.6 抽离用户路由模块中的处理函数</h3><blockquote><p>目的：为了保证 <code>路由模块</code> 的纯粹性，所有的 <code>路由处理函数</code>，必须抽离到对应的 <code>路由处理函数模块</code> 中</p></blockquote><ol><li>在 <code>/router_handler/user.js</code> 中，使用 <code>exports</code> 对象，分别向外共享如下两个 <code>路由处理函数</code> ：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 在这里定义和用户相关的路由处理函数，供 /router/user.js 模块进行调用</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-comment">// 注册用户的处理函数</span><br><span class="hljs-built_in">exports</span>.<span class="hljs-property">regUser</span> = <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;reguser OK&#x27;</span>)<br>&#125;<br><br><span class="hljs-comment">// 登录的处理函数</span><br><span class="hljs-built_in">exports</span>.<span class="hljs-property">login</span> = <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;login OK&#x27;</span>)<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>将 <code>/router/user.js</code> 中的代码修改为如下结构：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-keyword">const</span> router = express.<span class="hljs-title class_">Router</span>()<br><br><span class="hljs-comment">// 导入用户路由处理函数模块</span><br><span class="hljs-keyword">const</span> userHandler = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../router_handler/user&#x27;</span>)<br><br><span class="hljs-comment">// 注册新用户</span><br>router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/reguser&#x27;</span>, userHandler.<span class="hljs-property">regUser</span>)<br><span class="hljs-comment">// 登录</span><br>router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/login&#x27;</span>, userHandler.<span class="hljs-property">login</span>)<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = router<br></code></pre></td></tr></table></figure><h2 id="2-登录注册"><a href="#2-登录注册" class="headerlink" title="2. 登录注册"></a>2. 登录注册</h2><h3 id="2-1-新建-ev-users-表"><a href="#2-1-新建-ev-users-表" class="headerlink" title="2.1 新建 ev_users 表"></a>2.1 新建 ev_users 表</h3><ol><li>在 <code>test</code> 数据库中，新建 <code>ev_users</code> 表如下：</li></ol><p><img src="https://brucecai55520.gitee.io/bruceblog/assets/img/ev_users.77f8cdd3.png" alt="ev_users表结构"></p><h3 id="2-2-安装并配置-mysql-模块"><a href="#2-2-安装并配置-mysql-模块" class="headerlink" title="2.2 安装并配置 mysql 模块"></a>2.2 安装并配置 mysql 模块</h3><blockquote><p>在 API 接口项目中，需要安装并配置 <code>mysql</code> 这个第三方模块，来连接和操作 MySQL 数据库</p></blockquote><ol><li>运行如下命令，安装 <code>mysql</code> 模块：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm i mysql@2.18.1<br></code></pre></td></tr></table></figure><p>1</p><ol><li>在项目根目录中新建 <code>/db/index.js</code> 文件，在此自定义模块中创建数据库的连接对象：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> mysql = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;mysql&#x27;</span>)<br><br><span class="hljs-comment">// 创建数据库连接对象</span><br><span class="hljs-keyword">const</span> db = mysql.<span class="hljs-title function_">createPool</span>(&#123;<br>  <span class="hljs-attr">host</span>: <span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<br>  <span class="hljs-attr">user</span>: <span class="hljs-string">&#x27;root&#x27;</span>,<br>  <span class="hljs-attr">password</span>: <span class="hljs-string">&#x27;admin123&#x27;</span>,<br>  <span class="hljs-attr">database</span>: <span class="hljs-string">&#x27;my_db_01&#x27;</span>,<br>&#125;)<br><br><span class="hljs-comment">// 向外共享 db 数据库连接对象</span><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = db<br></code></pre></td></tr></table></figure><h3 id="2-3-注册"><a href="#2-3-注册" class="headerlink" title="2.3 注册"></a>2.3 注册</h3><h4 id="2-3-0-实现步骤"><a href="#2-3-0-实现步骤" class="headerlink" title="2.3.0 实现步骤"></a>2.3.0 实现步骤</h4><ol><li>检测表单数据是否合法</li><li>检测用户名是否被占用</li><li>对密码进行加密处理</li><li>插入新用户</li></ol><h4 id="2-3-1-检测表单数据是否合法"><a href="#2-3-1-检测表单数据是否合法" class="headerlink" title="2.3.1 检测表单数据是否合法"></a>2.3.1 检测表单数据是否合法</h4><ol><li>判断用户名和密码是否为空</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 接收表单数据</span><br><span class="hljs-keyword">const</span> userinfo = req.<span class="hljs-property">body</span><br><span class="hljs-comment">// 判断数据是否合法</span><br><span class="hljs-keyword">if</span> (!userinfo.<span class="hljs-property">username</span> || !userinfo.<span class="hljs-property">password</span>) &#123;<br>  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">send</span>(&#123; <span class="hljs-attr">status</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;用户名或密码不能为空！&#x27;</span> &#125;)<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="2-3-2-检测用户名是否被占用"><a href="#2-3-2-检测用户名是否被占用" class="headerlink" title="2.3.2 检测用户名是否被占用"></a>2.3.2 检测用户名是否被占用</h4><ol><li>导入数据库操作模块：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> db = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../db/index&#x27;</span>)<br></code></pre></td></tr></table></figure><ol><li>定义 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> sql = <span class="hljs-string">`select * from ev_users where username=?`</span><br></code></pre></td></tr></table></figure><ol><li>执行 SQL 语句并根据结果判断用户名是否被占用：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js">db.<span class="hljs-title function_">query</span>(sql, [userinfo.<span class="hljs-property">username</span>], <span class="hljs-keyword">function</span> (<span class="hljs-params">err, results</span>) &#123;<br>  <span class="hljs-comment">// 执行 SQL 语句失败</span><br>  <span class="hljs-keyword">if</span> (err) &#123;<br>    <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">send</span>(&#123; <span class="hljs-attr">status</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">message</span>: err.<span class="hljs-property">message</span> &#125;)<br>  &#125;<br>  <span class="hljs-comment">// 用户名被占用</span><br>  <span class="hljs-keyword">if</span> (results.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) &#123;<br>    <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">send</span>(&#123; <span class="hljs-attr">status</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;用户名被占用，请更换其他用户名！&#x27;</span> &#125;)<br>  &#125;<br>  <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> 用户名可用，继续后续流程...</span><br>&#125;)<br></code></pre></td></tr></table></figure><h4 id="2-3-3-对密码进行加密处理"><a href="#2-3-3-对密码进行加密处理" class="headerlink" title="2.3.3 对密码进行加密处理"></a>2.3.3 对密码进行加密处理</h4><blockquote><p>为了保证密码的安全性，不建议在数据库以 <code>明文</code> 的形式保存用户密码，推荐对密码进行 <code>加密存储</code></p></blockquote><hr><p>在当前项目中，使用 <code>bcryptjs</code> 对用户密码进行加密，优点：</p><ul><li>加密之后的密码，<strong>无法被逆向破解</strong></li><li>同一明文密码多次加密，得到的<strong>加密结果各不相同</strong>，保证了安全性</li></ul><hr><ol><li>运行如下命令，安装指定版本的 <code>bcryptjs</code> ：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm i bcryptjs@2.4.3<br></code></pre></td></tr></table></figure><ol><li>在 <code>/router_handler/user.js</code> 中，导入 <code>bcryptjs</code> ：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> bcrypt = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;bcryptjs&#x27;</span>)<br></code></pre></td></tr></table></figure><ol><li>在注册用户的处理函数中，确认用户名可用之后，调用 <code>bcrypt.hashSync(明文密码, 随机盐的长度)</code> 方法，对用户的密码进行加密处理：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 对用户的密码,进行 bcrype 加密，返回值是加密之后的密码字符串</span><br>userinfo.<span class="hljs-property">password</span> = bcrypt.<span class="hljs-title function_">hashSync</span>(userinfo.<span class="hljs-property">password</span>, <span class="hljs-number">10</span>)<br></code></pre></td></tr></table></figure><h4 id="2-3-4-插入新用户"><a href="#2-3-4-插入新用户" class="headerlink" title="2.3.4 插入新用户"></a>2.3.4 插入新用户</h4><ol><li>定义插入用户的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> sql = <span class="hljs-string">&#x27;insert into ev_users set ?&#x27;</span><br></code></pre></td></tr></table></figure><ol><li>调用 <code>db.query()</code> 执行 SQL 语句，插入新用户：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js">db.<span class="hljs-title function_">query</span>(sql, &#123; <span class="hljs-attr">username</span>: userinfo.<span class="hljs-property">username</span>, <span class="hljs-attr">password</span>: userinfo.<span class="hljs-property">password</span> &#125;, <span class="hljs-keyword">function</span> (<span class="hljs-params">err, results</span>) &#123;<br>  <span class="hljs-comment">// 执行 SQL 语句失败</span><br>  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">send</span>(&#123; <span class="hljs-attr">status</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">message</span>: err.<span class="hljs-property">message</span> &#125;)<br>  <span class="hljs-comment">// SQL 语句执行成功，但影响行数不为 1</span><br>  <span class="hljs-keyword">if</span> (results.<span class="hljs-property">affectedRows</span> !== <span class="hljs-number">1</span>) &#123;<br>    <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">send</span>(&#123; <span class="hljs-attr">status</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;注册用户失败，请稍后再试！&#x27;</span> &#125;)<br>  &#125;<br>  <span class="hljs-comment">// 注册成功</span><br>  res.<span class="hljs-title function_">send</span>(&#123; <span class="hljs-attr">status</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;注册成功！&#x27;</span> &#125;)<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="2-4-优化-res-send-代码"><a href="#2-4-优化-res-send-代码" class="headerlink" title="2.4 优化 res.send() 代码"></a>2.4 优化 res.send() 代码</h3><blockquote><p>在处理函数中，需要多次调用 <code>res.send()</code> 向客户端响应 <code>处理失败</code> 的结果，为了简化代码，可以手动封装一个 res.cc() 函数</p></blockquote><ol><li>在 <code>app.js</code> 中，所有路由之前，声明一个全局中间件，为 res 对象挂载一个 <code>res.cc()</code> 函数 ：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 响应数据的中间件</span><br>app.<span class="hljs-title function_">use</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">req, res, next</span>) &#123;<br>  <span class="hljs-comment">// status = 0 为成功； status = 1 为失败； 默认将 status 的值设置为 1，方便处理失败的情况</span><br>  res.<span class="hljs-property">cc</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">err, status = <span class="hljs-number">1</span></span>) &#123;<br>    res.<span class="hljs-title function_">send</span>(&#123;<br>      <span class="hljs-comment">// 状态</span><br>      status,<br>      <span class="hljs-comment">// 状态描述，判断 err 是 错误对象 还是 字符串</span><br>      <span class="hljs-attr">message</span>: err <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Error</span> ? err.<span class="hljs-property">message</span> : err,<br>    &#125;)<br>  &#125;<br>  <span class="hljs-title function_">next</span>()<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="2-5-优化表单数据验证"><a href="#2-5-优化表单数据验证" class="headerlink" title="2.5 优化表单数据验证"></a>2.5 优化表单数据验证</h3><blockquote><p>表单验证的原则：前端验证为辅，后端验证为主，后端<strong>永远不要相信</strong>前端提交过来的<strong>任何内容</strong></p></blockquote><p>在实际开发中，前后端都需要对表单的数据进行合法性的验证，而且，<strong>后端做为数据合法性验证的最后一个关口</strong>，在拦截非法数据方面，起到了至关重要的作用。</p><p>单纯的使用 <code>if...else...</code> 的形式对数据合法性进行验证，效率低下、出错率高、维护性差。因此，推荐使用<strong>第三方数据验证模块</strong>，来降低出错率、提高验证的效率与可维护性，<strong>让后端程序员把更多的精力放在核心业务逻辑的处理上</strong>。</p><ol><li>安装 <code>joi</code> 包，为表单中携带的每个数据项，定义验证规则：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm install joi<br></code></pre></td></tr></table></figure><ol><li>安装 <code>@escook/express-joi</code> 中间件，来实现自动对表单数据进行验证的功能：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm i @escook/express-joi<br></code></pre></td></tr></table></figure><ol><li>新建 <code>/schema/user.js</code> 用户信息验证规则模块，并初始化代码如下：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> joi = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;joi&#x27;</span>)<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * string() 值必须是字符串</span><br><span class="hljs-comment"> * alphanum() 值只能是包含 a-zA-Z0-9 的字符串</span><br><span class="hljs-comment"> * min(length) 最小长度</span><br><span class="hljs-comment"> * max(length) 最大长度</span><br><span class="hljs-comment"> * required() 值是必填项，不能为 undefined</span><br><span class="hljs-comment"> * pattern(正则表达式) 值必须符合正则表达式的规则</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-comment">// 用户名的验证规则</span><br><span class="hljs-keyword">const</span> username = joi.<span class="hljs-title function_">string</span>().<span class="hljs-title function_">alphanum</span>().<span class="hljs-title function_">min</span>(<span class="hljs-number">1</span>).<span class="hljs-title function_">max</span>(<span class="hljs-number">10</span>).required()<br><span class="hljs-comment">// 密码的验证规则</span><br><span class="hljs-keyword">const</span> password = joi<br>  .<span class="hljs-title function_">string</span>()<br>  .<span class="hljs-title function_">pattern</span>(<span class="hljs-regexp">/^[\S]&#123;6,12&#125;$/</span>)<br>  .required()<br><br><span class="hljs-comment">// 注册和登录表单的验证规则对象</span><br><span class="hljs-built_in">exports</span>.<span class="hljs-property">reg_login_schema</span> = &#123;<br>  <span class="hljs-comment">// 表示需要对 req.body 中的数据进行验证</span><br>  <span class="hljs-attr">body</span>: &#123;<br>    username,<br>    password,<br>  &#125;,<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>修改 <code>/router/user.js</code> 中的代码如下：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-keyword">const</span> router = express.<span class="hljs-title class_">Router</span>()<br><br><span class="hljs-comment">// 导入用户路由处理函数模块</span><br><span class="hljs-keyword">const</span> userHandler = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../router_handler/user&#x27;</span>)<br><br><span class="hljs-comment">// 1. 导入验证表单数据的中间件</span><br><span class="hljs-keyword">const</span> expressJoi = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;@escook/express-joi&#x27;</span>)<br><span class="hljs-comment">// 2. 导入需要的验证规则对象</span><br><span class="hljs-keyword">const</span> &#123; reg_login_schema &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../schema/user&#x27;</span>)<br><br><span class="hljs-comment">// 注册新用户</span><br><span class="hljs-comment">// 3. 在注册新用户的路由中，声明局部中间件，对当前请求中携带的数据进行验证</span><br><span class="hljs-comment">// 3.1 数据验证通过后，会把这次请求流转给后面的路由处理函数</span><br><span class="hljs-comment">// 3.2 数据验证失败后，终止后续代码的执行，并抛出一个全局的 Error 错误，进入全局错误级别中间件中进行处理</span><br>router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/reguser&#x27;</span>, <span class="hljs-title function_">expressJoi</span>(reg_login_schema), userHandler.<span class="hljs-property">regUser</span>)<br><span class="hljs-comment">// 登录</span><br>router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/login&#x27;</span>, userHandler.<span class="hljs-property">login</span>)<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = router<br></code></pre></td></tr></table></figure><ol><li>在 <code>app.js</code> 的全局错误级别中间件中，捕获验证失败的错误，并把验证失败的结果响应给客户端：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> joi = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;joi&#x27;</span>)<br><br><span class="hljs-comment">// 错误中间件</span><br>app.<span class="hljs-title function_">use</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">err, req, res, next</span>) &#123;<br>  <span class="hljs-comment">// 数据验证失败</span><br>  <span class="hljs-keyword">if</span> (err <span class="hljs-keyword">instanceof</span> joi.<span class="hljs-property">ValidationError</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(err)<br>  <span class="hljs-comment">// 未知错误</span><br>  res.<span class="hljs-title function_">cc</span>(err)<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="2-6-登录"><a href="#2-6-登录" class="headerlink" title="2.6 登录"></a>2.6 登录</h3><h4 id="2-6-0-实现步骤"><a href="#2-6-0-实现步骤" class="headerlink" title="2.6.0 实现步骤"></a>2.6.0 实现步骤</h4><ol><li>检测表单数据是否合法</li><li>根据用户名查询用户的数据</li><li>判断用户输入的密码是否正确</li><li>生成 JWT 的 Token 字符串</li></ol><h4 id="2-6-1-检测登录表单的数据是否合法"><a href="#2-6-1-检测登录表单的数据是否合法" class="headerlink" title="2.6.1 检测登录表单的数据是否合法"></a>2.6.1 检测登录表单的数据是否合法</h4><ol><li>将 <code>/router/user.js</code> 中 <code>登录</code> 的路由代码修改如下：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 登录的路由</span><br>router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/login&#x27;</span>, <span class="hljs-title function_">expressJoi</span>(reg_login_schema), userHandler.<span class="hljs-property">login</span>)<br></code></pre></td></tr></table></figure><h4 id="2-6-2-根据用户名查询用户的数据"><a href="#2-6-2-根据用户名查询用户的数据" class="headerlink" title="2.6.2 根据用户名查询用户的数据"></a>2.6.2 根据用户名查询用户的数据</h4><ol><li>接收表单数据：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> userinfo = req.<span class="hljs-property">body</span><br></code></pre></td></tr></table></figure><ol><li>定义 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> sql = <span class="hljs-string">`select * from ev_users where username=?`</span><br></code></pre></td></tr></table></figure><ol><li>执行 SQL 语句，查询用户的数据：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js">db.<span class="hljs-title function_">query</span>(sql, userinfo.<span class="hljs-property">username</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">err, results</span>) &#123;<br>  <span class="hljs-comment">// 执行 SQL 语句失败</span><br>  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(err)<br>  <span class="hljs-comment">// 执行 SQL 语句成功，但是查询到数据条数不等于 1</span><br>  <span class="hljs-keyword">if</span> (results.<span class="hljs-property">length</span> !== <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(<span class="hljs-string">&#x27;登录失败！&#x27;</span>)<br>  <span class="hljs-comment">// TODO：判断用户输入的登录密码是否和数据库中的密码一致</span><br>&#125;)<br></code></pre></td></tr></table></figure><h4 id="2-6-3-判断用户输入的密码是否正确"><a href="#2-6-3-判断用户输入的密码是否正确" class="headerlink" title="2.6.3 判断用户输入的密码是否正确"></a>2.6.3 判断用户输入的密码是否正确</h4><blockquote><p>核心实现思路：调用 <code>bcrypt.compareSync(用户提交的密码, 数据库中的密码)</code> 方法比较密码是否一致</p></blockquote><blockquote><p>返回值是布尔值（true 一致、false 不一致）</p></blockquote><p>具体的实现代码如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 拿着用户输入的密码,和数据库中存储的密码进行对比</span><br><span class="hljs-keyword">const</span> compareResult = bcrypt.<span class="hljs-title function_">compareSync</span>(userinfo.<span class="hljs-property">password</span>, results[<span class="hljs-number">0</span>].<span class="hljs-property">password</span>)<br><br><span class="hljs-comment">// 如果对比的结果等于 false, 则证明用户输入的密码错误</span><br><span class="hljs-keyword">if</span> (!compareResult) &#123;<br>  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(<span class="hljs-string">&#x27;登录失败！&#x27;</span>)<br>&#125;<br><br><span class="hljs-comment">// TODO：登录成功，生成 Token 字符串</span><br></code></pre></td></tr></table></figure><h4 id="2-6-4-生成-JWT-的-Token-字符串"><a href="#2-6-4-生成-JWT-的-Token-字符串" class="headerlink" title="2.6.4 生成 JWT 的 Token 字符串"></a>2.6.4 生成 JWT 的 Token 字符串</h4><blockquote><p>核心注意点：在生成 Token 字符串的时候，一定要剔除 <strong>密码</strong> 和 <strong>头像</strong> 的值</p></blockquote><ol><li>通过 ES6 的高级语法，快速剔除 <code>密码</code> 和 <code>头像</code> 的值：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 剔除完毕之后，user 中只保留了用户的 id, username, nickname, email 这四个属性的值</span><br><span class="hljs-keyword">const</span> user = &#123; ...results[<span class="hljs-number">0</span>], <span class="hljs-attr">password</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-attr">user_pic</span>: <span class="hljs-string">&#x27;&#x27;</span> &#125;<br></code></pre></td></tr></table></figure><ol><li>运行如下的命令，安装生成 Token 字符串的包：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm i jsonwebtoken@8.5.1<br></code></pre></td></tr></table></figure><ol><li>在 <code>/router_handler/user.js</code> 模块的头部区域，导入 <code>jsonwebtoken</code> 包：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 用这个包来生成 Token 字符串</span><br><span class="hljs-keyword">const</span> jwt = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;jsonwebtoken&#x27;</span>)<br></code></pre></td></tr></table></figure><ol><li>创建 <code>config.js</code> 文件，并向外共享 <strong>加密</strong> 和 <strong>还原</strong> Token 的 <code>jwtSecretKey</code> 字符串：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">jwtSecretKey</span>: <span class="hljs-string">&#x27;Bruce&#x27;</span>,<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>将用户信息对象加密成 Token 字符串：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 导入配置文件</span><br><span class="hljs-keyword">const</span> config = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../config&#x27;</span>)<br><br><span class="hljs-comment">// 生成 Token 字符串</span><br><span class="hljs-keyword">const</span> tokenStr = jwt.<span class="hljs-title function_">sign</span>(user, config.<span class="hljs-property">jwtSecretKey</span>, &#123;<br>  <span class="hljs-attr">expiresIn</span>: <span class="hljs-string">&#x27;10h&#x27;</span>, <span class="hljs-comment">// token 有效期为 10 个小时</span><br>&#125;)<br></code></pre></td></tr></table></figure><ol><li>将生成的 Token 字符串响应给客户端：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js">res.<span class="hljs-title function_">send</span>(&#123;<br>  <span class="hljs-attr">status</span>: <span class="hljs-number">0</span>,<br>  <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;登录成功！&#x27;</span>,<br>  <span class="hljs-comment">// 为了方便客户端使用 Token，在服务器端直接拼接上 Bearer 的前缀</span><br>  <span class="hljs-attr">token</span>: <span class="hljs-string">&#x27;Bearer &#x27;</span> + tokenStr,<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="2-7-配置解析-Token-的中间件"><a href="#2-7-配置解析-Token-的中间件" class="headerlink" title="2.7 配置解析 Token 的中间件"></a>2.7 配置解析 Token 的中间件</h3><ol><li>运行如下的命令，安装解析 Token 的中间件：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">npm i express-jwt@<span class="hljs-number">5.3</span><span class="hljs-number">.3</span><br></code></pre></td></tr></table></figure><ol><li>在 <code>app.js</code> 中注册路由之前，配置解析 Token 的中间件：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 导入配置文件</span><br><span class="hljs-keyword">const</span> config = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./config&#x27;</span>)<br><br><span class="hljs-comment">// 解析 token 的中间件</span><br><span class="hljs-keyword">const</span> expressJWT = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express-jwt&#x27;</span>)<br><br><span class="hljs-comment">// 使用 .unless(&#123; path: [/^\/api\//] &#125;) 指定哪些接口不需要进行 Token 的身份认证</span><br>app.<span class="hljs-title function_">use</span>(<span class="hljs-title function_">expressJWT</span>(&#123; <span class="hljs-attr">secret</span>: config.<span class="hljs-property">jwtSecretKey</span> &#125;).<span class="hljs-title function_">unless</span>(&#123; <span class="hljs-attr">path</span>: [<span class="hljs-regexp">/^\/api\//</span>] &#125;))<br></code></pre></td></tr></table></figure><ol><li>在 <code>app.js</code> 中的 <code>错误级别中间件</code> 里面，捕获并处理 Token 认证失败后的错误：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 错误中间件</span><br>app.<span class="hljs-title function_">use</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">err, req, res, next</span>) &#123;<br>  <span class="hljs-comment">// 省略其它代码...</span><br><br>  <span class="hljs-comment">// 捕获身份认证失败的错误</span><br>  <span class="hljs-keyword">if</span> (err.<span class="hljs-property">name</span> === <span class="hljs-string">&#x27;UnauthorizedError&#x27;</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(<span class="hljs-string">&#x27;身份认证失败！&#x27;</span>)<br><br>  <span class="hljs-comment">// 未知错误...</span><br>&#125;)<br></code></pre></td></tr></table></figure><h2 id="3-个人中心"><a href="#3-个人中心" class="headerlink" title="3. 个人中心"></a>3. 个人中心</h2><h3 id="3-1-获取用户的基本信息"><a href="#3-1-获取用户的基本信息" class="headerlink" title="3.1 获取用户的基本信息"></a>3.1 获取用户的基本信息</h3><h4 id="3-1-0-实现步骤"><a href="#3-1-0-实现步骤" class="headerlink" title="3.1.0 实现步骤"></a>3.1.0 实现步骤</h4><ol><li>初始化 <strong>路由</strong> 模块</li><li>初始化 <strong>路由处理函数</strong> 模块</li><li>获取用户的基本信息</li></ol><h4 id="3-1-1-初始化路由模块"><a href="#3-1-1-初始化路由模块" class="headerlink" title="3.1.1 初始化路由模块"></a>3.1.1 初始化路由模块</h4><ol><li>创建 <code>/router/userinfo.js</code> 路由模块，并初始化如下的代码结构：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 导入 express</span><br><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-comment">// 创建路由对象</span><br><span class="hljs-keyword">const</span> router = express.<span class="hljs-title class_">Router</span>()<br><br><span class="hljs-comment">// 获取用户的基本信息</span><br>router.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/userinfo&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;ok&#x27;</span>)<br>&#125;)<br><br><span class="hljs-comment">// 向外共享路由对象</span><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = router<br></code></pre></td></tr></table></figure><ol><li>在 <code>app.js</code> 中导入并使用个人中心的路由模块：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 导入并使用用户信息路由模块</span><br><span class="hljs-keyword">const</span> userinfoRouter = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./router/userinfo&#x27;</span>)<br><span class="hljs-comment">// 注意：以 /my 开头的接口，都是有权限的接口，需要进行 Token 身份认证</span><br>app.<span class="hljs-title function_">use</span>(<span class="hljs-string">&#x27;/my&#x27;</span>, userinfoRouter)<br></code></pre></td></tr></table></figure><h4 id="3-1-2-初始化路由处理函数模块"><a href="#3-1-2-初始化路由处理函数模块" class="headerlink" title="3.1.2 初始化路由处理函数模块"></a>3.1.2 初始化路由处理函数模块</h4><ol><li>创建 <code>/router_handler/userinfo.js</code> 路由处理函数模块，并初始化如下的代码结构：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 获取用户基本信息的处理函数</span><br><span class="hljs-built_in">exports</span>.<span class="hljs-property">getUserInfo</span> = <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;ok&#x27;</span>)<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>修改 <code>/router/userinfo.js</code> 中的代码如下：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-keyword">const</span> router = express.<span class="hljs-title class_">Router</span>()<br><br><span class="hljs-comment">// 导入用户信息的处理函数模块</span><br><span class="hljs-keyword">const</span> userinfo_handler = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../router_handler/userinfo&#x27;</span>)<br><br><span class="hljs-comment">// 获取用户的基本信息</span><br>router.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/userinfo&#x27;</span>, userinfo_handler.<span class="hljs-property">getUserInfo</span>)<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = router<br></code></pre></td></tr></table></figure><h4 id="3-1-3-获取用户的基本信息"><a href="#3-1-3-获取用户的基本信息" class="headerlink" title="3.1.3 获取用户的基本信息"></a>3.1.3 获取用户的基本信息</h4><ol><li>在 <code>/router_handler/userinfo.js</code> 头部导入数据库操作模块：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 导入数据库操作模块</span><br><span class="hljs-keyword">const</span> db = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../db/index&#x27;</span>)<br></code></pre></td></tr></table></figure><ol><li>定义 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 根据用户的 id，查询用户的基本信息</span><br><span class="hljs-comment">// 注意：为了防止用户的密码泄露，需要排除 password 字段</span><br><span class="hljs-keyword">const</span> sql = <span class="hljs-string">`select id, username, nickname, email, user_pic from ev_users where id=?`</span><br></code></pre></td></tr></table></figure><ol><li>调用 <code>db.query()</code> 执行 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 注意：req 对象上的 user 属性，是 Token 解析成功，express-jwt 中间件帮我们挂载上去的</span><br>db.<span class="hljs-title function_">query</span>(sql, req.<span class="hljs-property">user</span>.<span class="hljs-property">id</span>, <span class="hljs-function">(<span class="hljs-params">err, results</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// 1. 执行 SQL 语句失败</span><br>  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(err)<br><br>  <span class="hljs-comment">// 2. 执行 SQL 语句成功，但是查询到的数据条数不等于 1</span><br>  <span class="hljs-keyword">if</span> (results.<span class="hljs-property">length</span> !== <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(<span class="hljs-string">&#x27;获取用户信息失败！&#x27;</span>)<br><br>  <span class="hljs-comment">// 3. 将用户信息响应给客户端</span><br>  res.<span class="hljs-title function_">send</span>(&#123;<br>    <span class="hljs-attr">status</span>: <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;获取用户基本信息成功！&#x27;</span>,<br>    <span class="hljs-attr">data</span>: results[<span class="hljs-number">0</span>],<br>  &#125;)<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="3-2-更新用户的基本信息"><a href="#3-2-更新用户的基本信息" class="headerlink" title="3.2 更新用户的基本信息"></a>3.2 更新用户的基本信息</h3><h4 id="3-2-0-实现步骤"><a href="#3-2-0-实现步骤" class="headerlink" title="3.2.0 实现步骤"></a>3.2.0 实现步骤</h4><ol><li>定义路由和处理函数</li><li>验证表单数据</li><li>实现更新用户基本信息的功能</li></ol><h4 id="3-2-1-定义路由和处理函数"><a href="#3-2-1-定义路由和处理函数" class="headerlink" title="3.2.1 定义路由和处理函数"></a>3.2.1 定义路由和处理函数</h4><ol><li>在 <code>/router/userinfo.js</code> 模块中，新增 <code>更新用户基本信息</code> 的路由：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 更新用户的基本信息</span><br>router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/userinfo&#x27;</span>, userinfo_handler.<span class="hljs-property">updateUserInfo</span>)<br></code></pre></td></tr></table></figure><ol><li>在 <code>/router_handler/userinfo.js</code> 模块中，定义并向外共享 <code>更新用户基本信息</code> 的路由处理函数：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 更新用户基本信息的处理函数</span><br><span class="hljs-built_in">exports</span>.<span class="hljs-property">updateUserInfo</span> = <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;ok&#x27;</span>)<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="3-2-2-验证表单数据"><a href="#3-2-2-验证表单数据" class="headerlink" title="3.2.2 验证表单数据"></a>3.2.2 验证表单数据</h4><ol><li>在 <code>/schema/user.js</code> 验证规则模块中，定义 <code>id</code>，<code>nickname</code>，<code>email</code> 的验证规则如下：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 定义 id, nickname, emial 的验证规则</span><br><span class="hljs-keyword">const</span> id = joi.<span class="hljs-title function_">number</span>().<span class="hljs-title function_">integer</span>().<span class="hljs-title function_">min</span>(<span class="hljs-number">1</span>).required()<br><span class="hljs-keyword">const</span> nickname = joi.<span class="hljs-title function_">string</span>().required()<br><span class="hljs-keyword">const</span> email = joi.<span class="hljs-title function_">string</span>().<span class="hljs-title function_">email</span>().required()<br></code></pre></td></tr></table></figure><ol><li>并使用 <code>exports</code> 向外共享如下的 <code>验证规则对象</code>：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 验证规则对象 - 更新用户基本信息</span><br><span class="hljs-built_in">exports</span>.<span class="hljs-property">update_userinfo_schema</span> = &#123;<br>  <span class="hljs-attr">body</span>: &#123;<br>    id,<br>    nickname,<br>    email,<br>  &#125;,<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>在 <code>/router/userinfo.js</code> 模块中，导入验证数据合法性的中间件：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 导入验证数据合法性的中间件</span><br><span class="hljs-keyword">const</span> expressJoi = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;@escook/express-joi&#x27;</span>)<br></code></pre></td></tr></table></figure><ol><li>在 <code>/router/userinfo.js</code> 模块中，导入需要的验证规则对象：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 导入需要的验证规则对象</span><br><span class="hljs-keyword">const</span> &#123; update_userinfo_schema &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../schema/user&#x27;</span>)<br></code></pre></td></tr></table></figure><ol><li>在 <code>/router/userinfo.js</code> 模块中，修改 <code>更新用户的基本信息</code> 的路由如下：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 更新用户的基本信息</span><br>router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/userinfo&#x27;</span>, <span class="hljs-title function_">expressJoi</span>(update_userinfo_schema), userinfo_handler.<span class="hljs-property">updateUserInfo</span>)<br></code></pre></td></tr></table></figure><h4 id="3-2-3-实现更新用户基本信息的功能"><a href="#3-2-3-实现更新用户基本信息的功能" class="headerlink" title="3.2.3 实现更新用户基本信息的功能"></a>3.2.3 实现更新用户基本信息的功能</h4><ol><li>定义待执行的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> sql = <span class="hljs-string">`update ev_users set ? where id=?`</span><br></code></pre></td></tr></table></figure><ol><li>调用 <code>db.query()</code> 执行 SQL 语句并传参：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js">db.<span class="hljs-title function_">query</span>(sql, [req.<span class="hljs-property">body</span>, req.<span class="hljs-property">body</span>.<span class="hljs-property">id</span>], <span class="hljs-function">(<span class="hljs-params">err, results</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// 执行 SQL 语句失败</span><br>  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(err)<br><br>  <span class="hljs-comment">// 执行 SQL 语句成功，但影响行数不为 1</span><br>  <span class="hljs-keyword">if</span> (results.<span class="hljs-property">affectedRows</span> !== <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(<span class="hljs-string">&#x27;修改用户基本信息失败！&#x27;</span>)<br><br>  <span class="hljs-comment">// 修改用户信息成功</span><br>  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(<span class="hljs-string">&#x27;修改用户基本信息成功！&#x27;</span>, <span class="hljs-number">0</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="3-3-重置密码"><a href="#3-3-重置密码" class="headerlink" title="3.3 重置密码"></a>3.3 重置密码</h3><h4 id="3-3-0-实现步骤"><a href="#3-3-0-实现步骤" class="headerlink" title="3.3.0 实现步骤"></a>3.3.0 实现步骤</h4><ol><li>定义路由和处理函数</li><li>验证表单数据</li><li>实现重置密码的功能</li></ol><h4 id="3-3-1-定义路由和处理函数"><a href="#3-3-1-定义路由和处理函数" class="headerlink" title="3.3.1 定义路由和处理函数"></a>3.3.1 定义路由和处理函数</h4><ol><li>在 <code>/router/userinfo.js</code> 模块中，新增 <code>重置密码</code> 的路由：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 重置密码的路由</span><br>router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/updatepwd&#x27;</span>, userinfo_handler.<span class="hljs-property">updatePassword</span>)<br></code></pre></td></tr></table></figure><ol><li>在 <code>/router_handler/userinfo.js</code> 模块中，定义并向外共享 <code>重置密码</code> 的路由处理函数：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 重置密码的处理函数</span><br><span class="hljs-built_in">exports</span>.<span class="hljs-property">updatePassword</span> = <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;ok&#x27;</span>)<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="3-3-2-验证表单数据"><a href="#3-3-2-验证表单数据" class="headerlink" title="3.3.2 验证表单数据"></a>3.3.2 验证表单数据</h4><blockquote><p>核心验证思路：旧密码与新密码，必须符合密码的验证规则，并且新密码不能与旧密码一致！</p></blockquote><ol><li>在 <code>/schema/user.js</code> 模块中，使用 <code>exports</code> 向外共享如下的 <code>验证规则对象</code>：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 验证规则对象 - 重置密码</span><br><span class="hljs-built_in">exports</span>.<span class="hljs-property">update_password_schema</span> = &#123;<br>  <span class="hljs-attr">body</span>: &#123;<br>    <span class="hljs-comment">// 使用 password 这个规则，验证 req.body.oldPwd 的值</span><br>    <span class="hljs-attr">oldPwd</span>: password,<br>    <span class="hljs-comment">// 使用 joi.not(joi.ref(&#x27;oldPwd&#x27;)).concat(password) 规则，验证 req.body.newPwd 的值</span><br>    <span class="hljs-comment">// 解读：</span><br>    <span class="hljs-comment">// 1. joi.ref(&#x27;oldPwd&#x27;) 表示 newPwd 的值必须和 oldPwd 的值保持一致</span><br>    <span class="hljs-comment">// 2. joi.not(joi.ref(&#x27;oldPwd&#x27;)) 表示 newPwd 的值不能等于 oldPwd 的值</span><br>    <span class="hljs-comment">// 3. .concat() 用于合并 joi.not(joi.ref(&#x27;oldPwd&#x27;)) 和 password 这两条验证规则</span><br>    <span class="hljs-attr">newPwd</span>: joi.<span class="hljs-title function_">not</span>(joi.<span class="hljs-title function_">ref</span>(<span class="hljs-string">&#x27;oldPwd&#x27;</span>)).<span class="hljs-title function_">concat</span>(password),<br>  &#125;,<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>在 <code>/router/userinfo.js</code> 模块中，导入需要的验证规则对象：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 导入需要的验证规则对象</span><br><span class="hljs-keyword">const</span> &#123; update_userinfo_schema, update_password_schema &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../schema/user&#x27;</span>)<br></code></pre></td></tr></table></figure><ol><li>并在 <code>重置密码的路由</code> 中，使用 <code>update_password_schema</code> 规则验证表单的数据，示例代码如下：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/updatepwd&#x27;</span>, <span class="hljs-title function_">expressJoi</span>(update_password_schema), userinfo_handler.<span class="hljs-property">updatePassword</span>)<br></code></pre></td></tr></table></figure><h4 id="3-3-3-实现重置密码的功能"><a href="#3-3-3-实现重置密码的功能" class="headerlink" title="3.3.3 实现重置密码的功能"></a>3.3.3 实现重置密码的功能</h4><ol><li>根据 <code>id</code> 查询用户是否存在：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 定义根据 id 查询用户数据的 SQL 语句</span><br><span class="hljs-keyword">const</span> sql = <span class="hljs-string">`select * from ev_users where id=?`</span><br><br><span class="hljs-comment">// 执行 SQL 语句查询用户是否存在</span><br>db.<span class="hljs-title function_">query</span>(sql, req.<span class="hljs-property">user</span>.<span class="hljs-property">id</span>, <span class="hljs-function">(<span class="hljs-params">err, results</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// 执行 SQL 语句失败</span><br>  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(err)<br><br>  <span class="hljs-comment">// 检查指定 id 的用户是否存在</span><br>  <span class="hljs-keyword">if</span> (results.<span class="hljs-property">length</span> !== <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(<span class="hljs-string">&#x27;用户不存在！&#x27;</span>)<br><br>  <span class="hljs-comment">// TODO：判断提交的旧密码是否正确</span><br>&#125;)<br></code></pre></td></tr></table></figure><ol><li>判断提交的 <strong>旧密码</strong> 是否正确：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 在头部区域导入 bcryptjs 后，</span><br><span class="hljs-comment">// 即可使用 bcrypt.compareSync(提交的密码，数据库中的密码) 方法验证密码是否正确</span><br><span class="hljs-comment">// compareSync() 函数的返回值为布尔值，true 表示密码正确，false 表示密码错误</span><br><span class="hljs-keyword">const</span> bcrypt = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;bcryptjs&#x27;</span>)<br><br><span class="hljs-comment">// 判断提交的旧密码是否正确</span><br><span class="hljs-keyword">const</span> compareResult = bcrypt.<span class="hljs-title function_">compareSync</span>(req.<span class="hljs-property">body</span>.<span class="hljs-property">oldPwd</span>, results[<span class="hljs-number">0</span>].<span class="hljs-property">password</span>)<br><span class="hljs-keyword">if</span> (!compareResult) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(<span class="hljs-string">&#x27;原密码错误！&#x27;</span>)<br></code></pre></td></tr></table></figure><ol><li>对新密码进行 <code>bcrypt</code> 加密之后，更新到数据库中：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 定义更新用户密码的 SQL 语句</span><br><span class="hljs-keyword">const</span> sql = <span class="hljs-string">`update ev_users set password=? where id=?`</span><br><br><span class="hljs-comment">// 对新密码进行 bcrypt 加密处理</span><br><span class="hljs-keyword">const</span> newPwd = bcrypt.<span class="hljs-title function_">hashSync</span>(req.<span class="hljs-property">body</span>.<span class="hljs-property">newPwd</span>, <span class="hljs-number">10</span>)<br><br><span class="hljs-comment">// 执行 SQL 语句，根据 id 更新用户的密码</span><br>db.<span class="hljs-title function_">query</span>(sql, [newPwd, req.<span class="hljs-property">user</span>.<span class="hljs-property">id</span>], <span class="hljs-function">(<span class="hljs-params">err, results</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// SQL 语句执行失败</span><br>  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(err)<br><br>  <span class="hljs-comment">// SQL 语句执行成功，但是影响行数不等于 1</span><br>  <span class="hljs-keyword">if</span> (results.<span class="hljs-property">affectedRows</span> !== <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(<span class="hljs-string">&#x27;更新密码失败！&#x27;</span>)<br><br>  <span class="hljs-comment">// 更新密码成功</span><br>  res.<span class="hljs-title function_">cc</span>(<span class="hljs-string">&#x27;更新密码成功！&#x27;</span>, <span class="hljs-number">0</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="3-4-更新用户头像"><a href="#3-4-更新用户头像" class="headerlink" title="3.4 更新用户头像"></a>3.4 更新用户头像</h3><h4 id="3-4-0-实现步骤"><a href="#3-4-0-实现步骤" class="headerlink" title="3.4.0 实现步骤"></a>3.4.0 实现步骤</h4><ol><li>定义路由和处理函数</li><li>验证表单数据</li><li>实现更新用户头像的功能</li></ol><h4 id="3-4-1-定义路由和处理函数"><a href="#3-4-1-定义路由和处理函数" class="headerlink" title="3.4.1 定义路由和处理函数"></a>3.4.1 定义路由和处理函数</h4><ol><li>在 <code>/router/userinfo.js</code> 模块中，新增 <code>更新用户头像</code> 的路由：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 更新用户头像的路由</span><br>router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/update/avatar&#x27;</span>, userinfo_handler.<span class="hljs-property">updateAvatar</span>)<br></code></pre></td></tr></table></figure><ol><li>在 <code>/router_handler/userinfo.js</code> 模块中，定义并向外共享 <code>更新用户头像</code> 的路由处理函数：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 更新用户头像的处理函数</span><br><span class="hljs-built_in">exports</span>.<span class="hljs-property">updateAvatar</span> = <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;ok&#x27;</span>)<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="3-4-2-验证表单数据"><a href="#3-4-2-验证表单数据" class="headerlink" title="3.4.2 验证表单数据"></a>3.4.2 验证表单数据</h4><ol><li>在 <code>/schema/user.js</code> 验证规则模块中，定义 <code>avatar</code> 的验证规则如下：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// dataUri() 指的是如下格式的字符串数据：</span><br><span class="hljs-comment">// data:image/png;base64,VE9PTUFOWVNFQ1JFVFM=</span><br><span class="hljs-keyword">const</span> avatar = joi.<span class="hljs-title function_">string</span>().<span class="hljs-title function_">dataUri</span>().required()<br></code></pre></td></tr></table></figure><ol><li>并使用 <code>exports</code> 向外共享如下的 <code>验证规则对象</code>：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 验证规则对象 - 更新头像</span><br><span class="hljs-built_in">exports</span>.<span class="hljs-property">update_avatar_schema</span> = &#123;<br>  <span class="hljs-attr">body</span>: &#123;<br>    avatar,<br>  &#125;,<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>在 <code>/router/userinfo.js</code> 模块中，导入需要的验证规则对象：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> &#123; update_avatar_schema &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../schema/user&#x27;</span>)<br></code></pre></td></tr></table></figure><ol><li>在 <code>/router/userinfo.js</code> 模块中，修改 <code>更新用户头像</code> 的路由如下：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/update/avatar&#x27;</span>, <span class="hljs-title function_">expressJoi</span>(update_avatar_schema), userinfo_handler.<span class="hljs-property">updateAvatar</span>)<br></code></pre></td></tr></table></figure><h4 id="3-4-3-实现更新用户头像的功能"><a href="#3-4-3-实现更新用户头像的功能" class="headerlink" title="3.4.3 实现更新用户头像的功能"></a>3.4.3 实现更新用户头像的功能</h4><ol><li>定义更新用户头像的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> sql = <span class="hljs-string">&#x27;update ev_users set user_pic=? where id=?&#x27;</span><br></code></pre></td></tr></table></figure><ol><li>调用 <code>db.query()</code> 执行 SQL 语句，更新对应用户的头像：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js">db.<span class="hljs-title function_">query</span>(sql, [req.<span class="hljs-property">body</span>.<span class="hljs-property">avatar</span>, req.<span class="hljs-property">user</span>.<span class="hljs-property">id</span>], <span class="hljs-function">(<span class="hljs-params">err, results</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// 执行 SQL 语句失败</span><br>  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(err)<br><br>  <span class="hljs-comment">// 执行 SQL 语句成功，但是影响行数不等于 1</span><br>  <span class="hljs-keyword">if</span> (results.<span class="hljs-property">affectedRows</span> !== <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(<span class="hljs-string">&#x27;更新头像失败！&#x27;</span>)<br><br>  <span class="hljs-comment">// 更新用户头像成功</span><br>  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(<span class="hljs-string">&#x27;更新头像成功！&#x27;</span>, <span class="hljs-number">0</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><h2 id="4-文章分类管理"><a href="#4-文章分类管理" class="headerlink" title="4. 文章分类管理"></a>4. 文章分类管理</h2><h3 id="4-1-新建-ev-article-cate-表"><a href="#4-1-新建-ev-article-cate-表" class="headerlink" title="4.1 新建 ev_article_cate 表"></a>4.1 新建 ev_article_cate 表</h3><p><img src="https://brucecai55520.gitee.io/bruceblog/assets/img/ev_article_cate.f52fe7ce.png" alt="文章分类表结构"></p><h3 id="4-2-获取文章分类列表"><a href="#4-2-获取文章分类列表" class="headerlink" title="4.2 获取文章分类列表"></a>4.2 获取文章分类列表</h3><h4 id="4-2-0-实现步骤"><a href="#4-2-0-实现步骤" class="headerlink" title="4.2.0 实现步骤"></a>4.2.0 实现步骤</h4><ol><li>初始化路由模块</li><li>初始化路由处理函数模块</li><li>获取文章分类列表数据</li></ol><h4 id="4-2-1-初始化路由模块"><a href="#4-2-1-初始化路由模块" class="headerlink" title="4.2.1 初始化路由模块"></a>4.2.1 初始化路由模块</h4><ol><li>创建 <code>/router/artcate.js</code> 路由模块，并初始化如下的代码结构：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 导入 express</span><br><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-comment">// 创建路由对象</span><br><span class="hljs-keyword">const</span> router = express.<span class="hljs-title class_">Router</span>()<br><br><span class="hljs-comment">// 获取文章分类的列表数据</span><br>router.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/cates&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;ok&#x27;</span>)<br>&#125;)<br><br><span class="hljs-comment">// 向外共享路由对象</span><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = router<br></code></pre></td></tr></table></figure><ol><li>在 <code>app.js</code> 中导入并使用文章分类的路由模块：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 导入并使用文章分类路由模块</span><br><span class="hljs-keyword">const</span> artCateRouter = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./router/artcate&#x27;</span>)<br><span class="hljs-comment">// 为文章分类的路由挂载统一的访问前缀 /my/article</span><br>app.<span class="hljs-title function_">use</span>(<span class="hljs-string">&#x27;/my/article&#x27;</span>, artCateRouter)<br></code></pre></td></tr></table></figure><h4 id="4-2-2-初始化路由处理函数模块"><a href="#4-2-2-初始化路由处理函数模块" class="headerlink" title="4.2.2 初始化路由处理函数模块"></a>4.2.2 初始化路由处理函数模块</h4><ol><li>创建 <code>/router_handler/artcate.js</code> 路由处理函数模块，并初始化如下的代码结构：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 获取文章分类列表数据的处理函数</span><br><span class="hljs-built_in">exports</span>.<span class="hljs-property">getArticleCates</span> = <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;ok&#x27;</span>)<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>修改 <code>/router/artcate.js</code> 中的代码如下：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-keyword">const</span> router = express.<span class="hljs-title class_">Router</span>()<br><br><span class="hljs-comment">// 导入文章分类的路由处理函数模块</span><br><span class="hljs-keyword">const</span> artcate_handler = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../router_handler/artcate&#x27;</span>)<br><br><span class="hljs-comment">// 获取文章分类的列表数据</span><br>router.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/cates&#x27;</span>, artcate_handler.<span class="hljs-property">getArticleCates</span>)<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = router<br></code></pre></td></tr></table></figure><h4 id="4-2-3-获取文章分类列表数据"><a href="#4-2-3-获取文章分类列表数据" class="headerlink" title="4.2.3 获取文章分类列表数据"></a>4.2.3 获取文章分类列表数据</h4><ol><li>在 <code>/router_handler/artcate.js</code> 头部导入数据库操作模块：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 导入数据库操作模块</span><br><span class="hljs-keyword">const</span> db = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../db/index&#x27;</span>)<br></code></pre></td></tr></table></figure><ol><li>定义 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 根据分类的状态，获取所有未被删除的分类列表数据</span><br><span class="hljs-comment">// is_delete 为 0 表示没有被 标记为删除 的数据</span><br><span class="hljs-keyword">const</span> sql = <span class="hljs-string">&#x27;select * from ev_article_cate where is_delete=0 order by id asc&#x27;</span><br></code></pre></td></tr></table></figure><ol><li>调用 <code>db.query()</code> 执行 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js">db.<span class="hljs-title function_">query</span>(sql, <span class="hljs-function">(<span class="hljs-params">err, results</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// 1. 执行 SQL 语句失败</span><br>  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(err)<br><br>  <span class="hljs-comment">// 2. 执行 SQL 语句成功</span><br>  res.<span class="hljs-title function_">send</span>(&#123;<br>    <span class="hljs-attr">status</span>: <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;获取文章分类列表成功！&#x27;</span>,<br>    <span class="hljs-attr">data</span>: results,<br>  &#125;)<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="4-3-新增文章分类"><a href="#4-3-新增文章分类" class="headerlink" title="4.3 新增文章分类"></a>4.3 新增文章分类</h3><h4 id="4-3-0-实现步骤"><a href="#4-3-0-实现步骤" class="headerlink" title="4.3.0 实现步骤"></a>4.3.0 实现步骤</h4><ol><li>定义路由和处理函数</li><li>验证表单数据</li><li>查询 <code>分类名称</code> 与 <code>分类别名</code> 是否被占用</li><li>实现新增文章分类的功能</li></ol><h4 id="4-3-1-定义路由和处理函数"><a href="#4-3-1-定义路由和处理函数" class="headerlink" title="4.3.1 定义路由和处理函数"></a>4.3.1 定义路由和处理函数</h4><ol><li>在 <code>/router/artcate.js</code> 模块中，添加 <code>新增文章分类</code> 的路由：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 新增文章分类的路由</span><br>router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/addcates&#x27;</span>, artcate_handler.<span class="hljs-property">addArticleCates</span>)<br></code></pre></td></tr></table></figure><ol><li>在 <code>/router_handler/artcate.js</code> 模块中，定义并向外共享 <code>新增文章分类</code> 的路由处理函数：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 新增文章分类的处理函数</span><br><span class="hljs-built_in">exports</span>.<span class="hljs-property">addArticleCates</span> = <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;ok&#x27;</span>)<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="4-3-2-验证表单数据"><a href="#4-3-2-验证表单数据" class="headerlink" title="4.3.2 验证表单数据"></a>4.3.2 验证表单数据</h4><ol><li>创建 <code>/schema/artcate.js</code> 文章分类数据验证模块，并定义如下的验证规则：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 导入定义验证规则的模块</span><br><span class="hljs-keyword">const</span> joi = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;joi&#x27;</span>)<br><br><span class="hljs-comment">// 定义 分类名称 和 分类别名 的校验规则</span><br><span class="hljs-keyword">const</span> name = joi.<span class="hljs-title function_">string</span>().required()<br><span class="hljs-keyword">const</span> alias = joi.<span class="hljs-title function_">string</span>().<span class="hljs-title function_">alphanum</span>().required()<br><br><span class="hljs-comment">// 校验规则对象 - 添加分类</span><br><span class="hljs-built_in">exports</span>.<span class="hljs-property">add_cate_schema</span> = &#123;<br>  <span class="hljs-attr">body</span>: &#123;<br>    name,<br>    alias,<br>  &#125;,<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>在 <code>/router/artcate.js</code> 模块中，使用 <code>add_cate_schema</code> 对数据进行验证：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 导入验证数据的中间件</span><br><span class="hljs-keyword">const</span> expressJoi = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;@escook/express-joi&#x27;</span>)<br><span class="hljs-comment">// 导入文章分类的验证模块</span><br><span class="hljs-keyword">const</span> &#123; add_cate_schema &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../schema/artcate&#x27;</span>)<br><br><span class="hljs-comment">// 新增文章分类的路由</span><br>router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/addcates&#x27;</span>, <span class="hljs-title function_">expressJoi</span>(add_cate_schema), artcate_handler.<span class="hljs-property">addArticleCates</span>)<br></code></pre></td></tr></table></figure><h4 id="4-3-3-查询分类名称与别名是否被占用"><a href="#4-3-3-查询分类名称与别名是否被占用" class="headerlink" title="4.3.3 查询分类名称与别名是否被占用"></a>4.3.3 查询分类名称与别名是否被占用</h4><ol><li>定义查重的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 定义查询 分类名称 与 分类别名 是否被占用的 SQL 语句</span><br><span class="hljs-keyword">const</span> sql = <span class="hljs-string">`select * from ev_article_cate where name=? or alias=?`</span><br></code></pre></td></tr></table></figure><ol><li>调用 <code>db.query()</code> 执行查重的操作：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 执行查重操作</span><br>db.<span class="hljs-title function_">query</span>(sql, [req.<span class="hljs-property">body</span>.<span class="hljs-property">name</span>, req.<span class="hljs-property">body</span>.<span class="hljs-property">alias</span>], <span class="hljs-function">(<span class="hljs-params">err, results</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// 执行 SQL 语句失败</span><br>  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(err)<br><br>  <span class="hljs-comment">// 判断 分类名称 和 分类别名 是否被占用</span><br>  <span class="hljs-keyword">if</span> (results.<span class="hljs-property">length</span> === <span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(<span class="hljs-string">&#x27;分类名称与别名被占用，请更换后重试！&#x27;</span>)<br>  <span class="hljs-comment">// 分别判断 分类名称 和 分类别名 是否被占用</span><br>  <span class="hljs-keyword">if</span> (results.<span class="hljs-property">length</span> === <span class="hljs-number">1</span> &amp;&amp; results[<span class="hljs-number">0</span>].<span class="hljs-property">name</span> === req.<span class="hljs-property">body</span>.<span class="hljs-property">name</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(<span class="hljs-string">&#x27;分类名称被占用，请更换后重试！&#x27;</span>)<br>  <span class="hljs-keyword">if</span> (results.<span class="hljs-property">length</span> === <span class="hljs-number">1</span> &amp;&amp; results[<span class="hljs-number">0</span>].<span class="hljs-property">alias</span> === req.<span class="hljs-property">body</span>.<span class="hljs-property">alias</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(<span class="hljs-string">&#x27;分类别名被占用，请更换后重试！&#x27;</span>)<br><br>  <span class="hljs-comment">// TODO：新增文章分类</span><br>&#125;)<br></code></pre></td></tr></table></figure><h4 id="4-3-4-实现新增文章分类的功能"><a href="#4-3-4-实现新增文章分类的功能" class="headerlink" title="4.3.4 实现新增文章分类的功能"></a>4.3.4 实现新增文章分类的功能</h4><ol><li>定义新增文章分类的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> sql = <span class="hljs-string">`insert into ev_article_cate set ?`</span><br></code></pre></td></tr></table></figure><ol><li>调用 <code>db.query()</code> 执行新增文章分类的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js">db.<span class="hljs-title function_">query</span>(sql, req.<span class="hljs-property">body</span>, <span class="hljs-function">(<span class="hljs-params">err, results</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// SQL 语句执行失败</span><br>  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(err)<br><br>  <span class="hljs-comment">// SQL 语句执行成功，但是影响行数不等于 1</span><br>  <span class="hljs-keyword">if</span> (results.<span class="hljs-property">affectedRows</span> !== <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(<span class="hljs-string">&#x27;新增文章分类失败！&#x27;</span>)<br><br>  <span class="hljs-comment">// 新增文章分类成功</span><br>  res.<span class="hljs-title function_">cc</span>(<span class="hljs-string">&#x27;新增文章分类成功！&#x27;</span>, <span class="hljs-number">0</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="4-4-根据-Id-删除文章分类"><a href="#4-4-根据-Id-删除文章分类" class="headerlink" title="4.4 根据 Id 删除文章分类"></a>4.4 根据 Id 删除文章分类</h3><h4 id="4-4-0-实现步骤"><a href="#4-4-0-实现步骤" class="headerlink" title="4.4.0 实现步骤"></a>4.4.0 实现步骤</h4><ol><li>定义路由和处理函数</li><li>验证表单数据</li><li>实现删除文章分类的功能</li></ol><h4 id="4-4-1-定义路由和处理函数"><a href="#4-4-1-定义路由和处理函数" class="headerlink" title="4.4.1 定义路由和处理函数"></a>4.4.1 定义路由和处理函数</h4><ol><li>在 <code>/router/artcate.js</code> 模块中，添加 <code>删除文章分类</code> 的路由：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 删除文章分类的路由</span><br>router.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/deletecate/:id&#x27;</span>, artcate_handler.<span class="hljs-property">deleteCateById</span>)<br></code></pre></td></tr></table></figure><ol><li>在 <code>/router_handler/artcate.js</code> 模块中，定义并向外共享 <code>删除文章分类</code> 的路由处理函数：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 删除文章分类的处理函数</span><br><span class="hljs-built_in">exports</span>.<span class="hljs-property">deleteCateById</span> = <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;ok&#x27;</span>)<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="4-4-2-验证表单数据"><a href="#4-4-2-验证表单数据" class="headerlink" title="4.4.2 验证表单数据"></a>4.4.2 验证表单数据</h4><ol><li>在 <code>/schema/artcate.js</code> 验证规则模块中，定义 id 的验证规则如下：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 定义 分类Id 的校验规则</span><br><span class="hljs-keyword">const</span> id = joi.<span class="hljs-title function_">number</span>().<span class="hljs-title function_">integer</span>().<span class="hljs-title function_">min</span>(<span class="hljs-number">1</span>).required()<br></code></pre></td></tr></table></figure><ol><li>并使用 <code>exports</code> 向外共享如下的 <code>验证规则对象</code>：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 校验规则对象 - 删除分类</span><br><span class="hljs-built_in">exports</span>.<span class="hljs-property">delete_cate_schema</span> = &#123;<br>  <span class="hljs-attr">params</span>: &#123;<br>    id,<br>  &#125;,<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>在 <code>/router/artcate.js</code> 模块中，导入需要的验证规则对象，并在路由中使用：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 导入删除分类的验证规则对象</span><br><span class="hljs-keyword">const</span> &#123; delete_cate_schema &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../schema/artcate&#x27;</span>)<br><br><span class="hljs-comment">// 删除文章分类的路由</span><br>router.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/deletecate/:id&#x27;</span>, <span class="hljs-title function_">expressJoi</span>(delete_cate_schema), artcate_handler.<span class="hljs-property">deleteCateById</span>)<br></code></pre></td></tr></table></figure><h4 id="4-4-3-实现删除文章分类的功能"><a href="#4-4-3-实现删除文章分类的功能" class="headerlink" title="4.4.3 实现删除文章分类的功能"></a>4.4.3 实现删除文章分类的功能</h4><ol><li>定义删除文章分类的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> sql = <span class="hljs-string">`update ev_article_cate set is_delete=1 where id=?`</span><br></code></pre></td></tr></table></figure><ol><li>调用 <code>db.query()</code> 执行删除文章分类的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js">db.<span class="hljs-title function_">query</span>(sql, req.<span class="hljs-property">params</span>.<span class="hljs-property">id</span>, <span class="hljs-function">(<span class="hljs-params">err, results</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// 执行 SQL 语句失败</span><br>  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(err)<br><br>  <span class="hljs-comment">// SQL 语句执行成功，但是影响行数不等于 1</span><br>  <span class="hljs-keyword">if</span> (results.<span class="hljs-property">affectedRows</span> !== <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(<span class="hljs-string">&#x27;删除文章分类失败！&#x27;</span>)<br><br>  <span class="hljs-comment">// 删除文章分类成功</span><br>  res.<span class="hljs-title function_">cc</span>(<span class="hljs-string">&#x27;删除文章分类成功！&#x27;</span>, <span class="hljs-number">0</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="4-5-根据-Id-获取文章分类数据"><a href="#4-5-根据-Id-获取文章分类数据" class="headerlink" title="4.5 根据 Id 获取文章分类数据"></a>4.5 根据 Id 获取文章分类数据</h3><h4 id="4-5-0-实现步骤"><a href="#4-5-0-实现步骤" class="headerlink" title="4.5.0 实现步骤"></a>4.5.0 实现步骤</h4><ol><li>定义路由和处理函数</li><li>验证表单数据</li><li>实现获取文章分类的功能</li></ol><h4 id="4-5-1-定义路由和处理函数"><a href="#4-5-1-定义路由和处理函数" class="headerlink" title="4.5.1 定义路由和处理函数"></a>4.5.1 定义路由和处理函数</h4><ol><li>在 <code>/router/artcate.js</code> 模块中，添加 <code>根据 Id 获取文章分类</code> 的路由：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">router.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/cates/:id&#x27;</span>, artcate_handler.<span class="hljs-property">getArticleById</span>)<br></code></pre></td></tr></table></figure><ol><li>在 <code>/router_handler/artcate.js</code> 模块中，定义并向外共享 <code>根据 Id 获取文章分类</code> 的路由处理函数：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 根据 Id 获取文章分类的处理函数</span><br><span class="hljs-built_in">exports</span>.<span class="hljs-property">getArticleById</span> = <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;ok&#x27;</span>)<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="4-5-2-验证表单数据"><a href="#4-5-2-验证表单数据" class="headerlink" title="4.5.2 验证表单数据"></a>4.5.2 验证表单数据</h4><ol><li>在 <code>/schema/artcate.js</code> 验证规则模块中，使用 <code>exports</code> 向外共享如下的 <code>验证规则对象</code>：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 校验规则对象 - 根据 Id 获取分类</span><br><span class="hljs-built_in">exports</span>.<span class="hljs-property">get_cate_schema</span> = &#123;<br>  <span class="hljs-attr">params</span>: &#123;<br>    id,<br>  &#125;,<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>在 <code>/router/artcate.js</code> 模块中，导入需要的验证规则对象，并在路由中使用：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 导入根据 Id 获取分类的验证规则对象</span><br><span class="hljs-keyword">const</span> &#123; get_cate_schema &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../schema/artcate&#x27;</span>)<br><br><span class="hljs-comment">// 根据 Id 获取文章分类的路由</span><br>router.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/cates/:id&#x27;</span>, <span class="hljs-title function_">expressJoi</span>(get_cate_schema), artcate_handler.<span class="hljs-property">getArticleById</span>)<br></code></pre></td></tr></table></figure><h4 id="4-5-3-实现获取文章分类的功能"><a href="#4-5-3-实现获取文章分类的功能" class="headerlink" title="4.5.3 实现获取文章分类的功能"></a>4.5.3 实现获取文章分类的功能</h4><ol><li>定义根据 Id 获取文章分类的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> sql = <span class="hljs-string">`select * from ev_article_cate where id=?`</span><br></code></pre></td></tr></table></figure><ol><li>调用 <code>db.query()</code> 执行 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js">db.<span class="hljs-title function_">query</span>(sql, req.<span class="hljs-property">params</span>.<span class="hljs-property">id</span>, <span class="hljs-function">(<span class="hljs-params">err, results</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// 执行 SQL 语句失败</span><br>  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(err)<br><br>  <span class="hljs-comment">// SQL 语句执行成功，但是没有查询到任何数据</span><br>  <span class="hljs-keyword">if</span> (results.<span class="hljs-property">length</span> !== <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(<span class="hljs-string">&#x27;获取文章分类数据失败！&#x27;</span>)<br><br>  <span class="hljs-comment">// 把数据响应给客户端</span><br>  res.<span class="hljs-title function_">send</span>(&#123;<br>    <span class="hljs-attr">status</span>: <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;获取文章分类数据成功！&#x27;</span>,<br>    <span class="hljs-attr">data</span>: results[<span class="hljs-number">0</span>],<br>  &#125;)<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="4-6-根据-Id-更新文章分类数据"><a href="#4-6-根据-Id-更新文章分类数据" class="headerlink" title="4.6 根据 Id 更新文章分类数据"></a>4.6 根据 Id 更新文章分类数据</h3><h4 id="4-6-0-实现步骤"><a href="#4-6-0-实现步骤" class="headerlink" title="4.6.0 实现步骤"></a>4.6.0 实现步骤</h4><ol><li>定义路由和处理函数</li><li>验证表单数据</li><li>查询 <code>分类名称</code> 与 <code>分类别名</code> 是否被占用</li><li>实现更新文章分类的功能</li></ol><h4 id="4-6-1-定义路由和处理函数"><a href="#4-6-1-定义路由和处理函数" class="headerlink" title="4.6.1 定义路由和处理函数"></a>4.6.1 定义路由和处理函数</h4><ol><li>在 <code>/router/artcate.js</code> 模块中，添加 <code>更新文章分类</code> 的路由：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 更新文章分类的路由</span><br>router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/updatecate&#x27;</span>, artcate_handler.<span class="hljs-property">updateCateById</span>)<br></code></pre></td></tr></table></figure><ol><li>在 <code>/router_handler/artcate.js</code> 模块中，定义并向外共享 <code>更新文章分类</code> 的路由处理函数：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 更新文章分类的处理函数</span><br><span class="hljs-built_in">exports</span>.<span class="hljs-property">updateCateById</span> = <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;ok&#x27;</span>)<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="4-6-2-验证表单数据"><a href="#4-6-2-验证表单数据" class="headerlink" title="4.6.2 验证表单数据"></a>4.6.2 验证表单数据</h4><ol><li>在 <code>/schema/artcate.js</code> 验证规则模块中，使用 <code>exports</code> 向外共享如下的 <code>验证规则对象</code>：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 校验规则对象 - 更新分类</span><br><span class="hljs-built_in">exports</span>.<span class="hljs-property">update_cate_schema</span> = &#123;<br>  <span class="hljs-attr">body</span>: &#123;<br>    <span class="hljs-title class_">Id</span>: id,<br>    name,<br>    alias,<br>  &#125;,<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>在 <code>/router/artcate.js</code> 模块中，导入需要的验证规则对象，并在路由中使用：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 导入更新文章分类的验证规则对象</span><br><span class="hljs-keyword">const</span> &#123; update_cate_schema &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../schema/artcate&#x27;</span>)<br><br><span class="hljs-comment">// 更新文章分类的路由</span><br>router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/updatecate&#x27;</span>, <span class="hljs-title function_">expressJoi</span>(update_cate_schema), artcate_handler.<span class="hljs-property">updateCateById</span>)<br></code></pre></td></tr></table></figure><h4 id="4-5-4-查询分类名称与别名是否被占用"><a href="#4-5-4-查询分类名称与别名是否被占用" class="headerlink" title="4.5.4 查询分类名称与别名是否被占用"></a>4.5.4 查询分类名称与别名是否被占用</h4><ol><li>定义查重的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 定义查询 分类名称 与 分类别名 是否被占用的 SQL 语句</span><br><span class="hljs-keyword">const</span> sql = <span class="hljs-string">`select * from ev_article_cate where Id&lt;&gt;? and (name=? or alias=?)`</span><br></code></pre></td></tr></table></figure><ol><li>调用 <code>db.query()</code> 执行查重的操作：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 执行查重操作</span><br>db.<span class="hljs-title function_">query</span>(sql, [req.<span class="hljs-property">body</span>.<span class="hljs-property">Id</span>, req.<span class="hljs-property">body</span>.<span class="hljs-property">name</span>, req.<span class="hljs-property">body</span>.<span class="hljs-property">alias</span>], <span class="hljs-function">(<span class="hljs-params">err, results</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// 执行 SQL 语句失败</span><br>  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(err)<br><br>  <span class="hljs-comment">// 判断 分类名称 和 分类别名 是否被占用</span><br>  <span class="hljs-keyword">if</span> (results.<span class="hljs-property">length</span> === <span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(<span class="hljs-string">&#x27;分类名称与别名被占用，请更换后重试！&#x27;</span>)<br>  <span class="hljs-keyword">if</span> (results.<span class="hljs-property">length</span> === <span class="hljs-number">1</span> &amp;&amp; results[<span class="hljs-number">0</span>].<span class="hljs-property">name</span> === req.<span class="hljs-property">body</span>.<span class="hljs-property">name</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(<span class="hljs-string">&#x27;分类名称被占用，请更换后重试！&#x27;</span>)<br>  <span class="hljs-keyword">if</span> (results.<span class="hljs-property">length</span> === <span class="hljs-number">1</span> &amp;&amp; results[<span class="hljs-number">0</span>].<span class="hljs-property">alias</span> === req.<span class="hljs-property">body</span>.<span class="hljs-property">alias</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(<span class="hljs-string">&#x27;分类别名被占用，请更换后重试！&#x27;</span>)<br><br>  <span class="hljs-comment">// TODO：更新文章分类</span><br>&#125;)<br></code></pre></td></tr></table></figure><h4 id="4-5-5-实现更新文章分类的功能"><a href="#4-5-5-实现更新文章分类的功能" class="headerlink" title="4.5.5 实现更新文章分类的功能"></a>4.5.5 实现更新文章分类的功能</h4><ol><li>定义更新文章分类的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> sql = <span class="hljs-string">`update ev_article_cate set ? where Id=?`</span><br></code></pre></td></tr></table></figure><ol><li>调用 <code>db.query()</code> 执行 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js">db.<span class="hljs-title function_">query</span>(sql, [req.<span class="hljs-property">body</span>, req.<span class="hljs-property">body</span>.<span class="hljs-property">Id</span>], <span class="hljs-function">(<span class="hljs-params">err, results</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// 执行 SQL 语句失败</span><br>  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(err)<br><br>  <span class="hljs-comment">// SQL 语句执行成功，但是影响行数不等于 1</span><br>  <span class="hljs-keyword">if</span> (results.<span class="hljs-property">affectedRows</span> !== <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(<span class="hljs-string">&#x27;更新文章分类失败！&#x27;</span>)<br><br>  <span class="hljs-comment">// 更新文章分类成功</span><br>  res.<span class="hljs-title function_">cc</span>(<span class="hljs-string">&#x27;更新文章分类成功！&#x27;</span>, <span class="hljs-number">0</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><h2 id="5-文章管理"><a href="#5-文章管理" class="headerlink" title="5. 文章管理"></a>5. 文章管理</h2><h3 id="5-1-新建-ev-articles-表"><a href="#5-1-新建-ev-articles-表" class="headerlink" title="5.1 新建 ev_articles 表"></a>5.1 新建 ev_articles 表</h3><p><img src="https://brucecai55520.gitee.io/bruceblog/assets/img/ev_articles.01220b03.png" alt="ev_articles表结构"></p><h3 id="5-2-发布新文章"><a href="#5-2-发布新文章" class="headerlink" title="5.2 发布新文章"></a>5.2 发布新文章</h3><h4 id="5-2-0-实现步骤"><a href="#5-2-0-实现步骤" class="headerlink" title="5.2.0 实现步骤"></a>5.2.0 实现步骤</h4><ol><li>初始化路由模块</li><li>初始化路由处理函数模块</li><li>使用 multer 解析表单数据</li><li>验证表单数据</li><li>实现发布文章的功能</li></ol><h4 id="5-2-1-初始化路由模块"><a href="#5-2-1-初始化路由模块" class="headerlink" title="5.2.1 初始化路由模块"></a>5.2.1 初始化路由模块</h4><ol><li>创建 <code>/router/article.js</code> 路由模块，并初始化如下的代码结构：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 导入 express</span><br><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-comment">// 创建路由对象</span><br><span class="hljs-keyword">const</span> router = express.<span class="hljs-title class_">Router</span>()<br><br><span class="hljs-comment">// 发布新文章</span><br>router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/add&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;ok&#x27;</span>)<br>&#125;)<br><br><span class="hljs-comment">// 向外共享路由对象</span><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = router<br></code></pre></td></tr></table></figure><ol><li>在 <code>app.js</code> 中导入并使用文章的路由模块：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 导入并使用文章路由模块</span><br><span class="hljs-keyword">const</span> articleRouter = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./router/article&#x27;</span>)<br><span class="hljs-comment">// 为文章的路由挂载统一的访问前缀 /my/article</span><br>app.<span class="hljs-title function_">use</span>(<span class="hljs-string">&#x27;/my/article&#x27;</span>, articleRouter)<br></code></pre></td></tr></table></figure><h4 id="5-2-2-初始化路由处理函数模块"><a href="#5-2-2-初始化路由处理函数模块" class="headerlink" title="5.2.2 初始化路由处理函数模块"></a>5.2.2 初始化路由处理函数模块</h4><ol><li>创建 <code>/router_handler/article.js</code> 路由处理函数模块，并初始化如下的代码结构：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 发布新文章的处理函数</span><br><span class="hljs-built_in">exports</span>.<span class="hljs-property">addArticle</span> = <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;ok&#x27;</span>)<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>修改 <code>/router/article.js</code> 中的代码如下：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-keyword">const</span> router = express.<span class="hljs-title class_">Router</span>()<br><br><span class="hljs-comment">// 导入文章的路由处理函数模块</span><br><span class="hljs-keyword">const</span> article_handler = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../router_handler/article&#x27;</span>)<br><br><span class="hljs-comment">// 发布新文章</span><br>router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/add&#x27;</span>, article_handler.<span class="hljs-property">addArticle</span>)<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = router<br></code></pre></td></tr></table></figure><h4 id="5-2-3-使用-multer-解析表单数据"><a href="#5-2-3-使用-multer-解析表单数据" class="headerlink" title="5.2.3 使用 multer 解析表单数据"></a>5.2.3 使用 multer 解析表单数据</h4><blockquote><p>注意：使用 <code>express.urlencoded()</code> 中间件无法解析 <code>multipart/form-data</code> 格式的请求体数据。</p></blockquote><blockquote><p>当前项目，推荐使用 multer 来解析 <code>multipart/form-data</code> 格式的表单数据。<a href="https://www.npmjs.com/package/multer">https://www.npmjs.com/package/multer</a></p></blockquote><ol><li>运行如下的终端命令，在项目中安装 <code>multer</code>：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm i multer@1.4.2<br></code></pre></td></tr></table></figure><ol><li>在 <code>/router_handler/article.js</code> 模块中导入并配置 <code>multer</code>：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 导入解析 formdata 格式表单数据的包</span><br><span class="hljs-keyword">const</span> multer = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;multer&#x27;</span>)<br><span class="hljs-comment">// 导入处理路径的核心模块</span><br><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>)<br><br><span class="hljs-comment">// 创建 multer 的实例对象，通过 dest 属性指定文件的存放路径</span><br><span class="hljs-keyword">const</span> upload = <span class="hljs-title function_">multer</span>(&#123; <span class="hljs-attr">dest</span>: path.<span class="hljs-title function_">join</span>(__dirname, <span class="hljs-string">&#x27;../uploads&#x27;</span>) &#125;)<br></code></pre></td></tr></table></figure><ol><li>修改 <code>发布新文章</code> 的路由如下：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 发布新文章的路由</span><br><span class="hljs-comment">// upload.single() 是一个局部生效的中间件，用来解析 FormData 格式的表单数据</span><br><span class="hljs-comment">// 将文件类型的数据，解析并挂载到 req.file 属性中</span><br><span class="hljs-comment">// 将文本类型的数据，解析并挂载到 req.body 属性中</span><br>router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/add&#x27;</span>, upload.<span class="hljs-title function_">single</span>(<span class="hljs-string">&#x27;cover_img&#x27;</span>), article_handler.<span class="hljs-property">addArticle</span>)<br></code></pre></td></tr></table></figure><ol><li>在 <code>/router_handler/article.js</code> 模块中的 <code>addArticle</code> 处理函数中，将 <code>multer</code> 解析出来的数据进行打印：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 发布新文章的处理函数</span><br><span class="hljs-built_in">exports</span>.<span class="hljs-property">addArticle</span> = <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(req.<span class="hljs-property">body</span>) <span class="hljs-comment">// 文本类型的数据</span><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;--------分割线----------&#x27;</span>)<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(req.<span class="hljs-property">file</span>) <span class="hljs-comment">// 文件类型的数据</span><br><br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;ok&#x27;</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><h4 id="5-2-4-验证表单数据"><a href="#5-2-4-验证表单数据" class="headerlink" title="5.2.4 验证表单数据"></a>5.2.4 验证表单数据</h4><blockquote><p>实现思路：通过 express-joi <strong>自动验证</strong> req.body 中的文本数据；通过 if 判断<strong>手动验证</strong> req.file 中的文件数据；</p></blockquote><ol><li>创建 <code>/schema/article.js</code> 验证规则模块，并初始化如下的代码结构：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 导入定义验证规则的模块</span><br><span class="hljs-keyword">const</span> joi = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;joi&#x27;</span>)<br><br><span class="hljs-comment">// 定义 标题、分类Id、内容、发布状态 的验证规则</span><br><span class="hljs-keyword">const</span> title = joi.<span class="hljs-title function_">string</span>().required()<br><span class="hljs-keyword">const</span> cate_id = joi.<span class="hljs-title function_">number</span>().<span class="hljs-title function_">integer</span>().<span class="hljs-title function_">min</span>(<span class="hljs-number">1</span>).required()<br><span class="hljs-keyword">const</span> content = joi.<span class="hljs-title function_">string</span>().required().<span class="hljs-title function_">allow</span>(<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-keyword">const</span> state = joi.<span class="hljs-title function_">string</span>().<span class="hljs-title function_">valid</span>(<span class="hljs-string">&#x27;已发布&#x27;</span>, <span class="hljs-string">&#x27;草稿&#x27;</span>).required()<br><br><span class="hljs-comment">// 验证规则对象 - 发布文章</span><br><span class="hljs-built_in">exports</span>.<span class="hljs-property">add_article_schema</span> = &#123;<br>  <span class="hljs-attr">body</span>: &#123;<br>    title,<br>    cate_id,<br>    content,<br>    state,<br>  &#125;,<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>在 <code>/router/article.js</code> 模块中，导入需要的验证规则对象，并在路由中使用：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 导入验证数据的中间件</span><br><span class="hljs-keyword">const</span> expressJoi = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;@escook/express-joi&#x27;</span>)<br><span class="hljs-comment">// 导入文章的验证模块</span><br><span class="hljs-keyword">const</span> &#123; add_article_schema &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../schema/article&#x27;</span>)<br><br><span class="hljs-comment">// 发布新文章的路由</span><br><span class="hljs-comment">// 注意：在当前的路由中，先后使用了两个中间件：</span><br><span class="hljs-comment">//       先使用 multer 解析表单数据</span><br><span class="hljs-comment">//       再使用 expressJoi 对解析的表单数据进行验证</span><br>router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/add&#x27;</span>, upload.<span class="hljs-title function_">single</span>(<span class="hljs-string">&#x27;cover_img&#x27;</span>), <span class="hljs-title function_">expressJoi</span>(add_article_schema), article_handler.<span class="hljs-property">addArticle</span>)<br></code></pre></td></tr></table></figure><ol><li>在 <code>/router_handler/article.js</code> 模块中的 <code>addArticle</code> 处理函数中，通过 <code>if</code> 判断客户端是否提交了 <code>封面图片</code>：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 发布新文章的处理函数</span><br><span class="hljs-built_in">exports</span>.<span class="hljs-property">addArticle</span> = <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>    <span class="hljs-comment">// 手动判断是否上传了文章封面</span><br>  <span class="hljs-keyword">if</span> (!req.<span class="hljs-property">file</span> || req.<span class="hljs-property">file</span>.<span class="hljs-property">fieldname</span> !== <span class="hljs-string">&#x27;cover_img&#x27;</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(<span class="hljs-string">&#x27;文章封面是必选参数！&#x27;</span>)<br><br>  <span class="hljs-comment">// TODO：表单数据合法，继续后面的处理流程...</span><br>&#125;)<br></code></pre></td></tr></table></figure><h4 id="5-2-5-实现发布文章的功能"><a href="#5-2-5-实现发布文章的功能" class="headerlink" title="5.2.5 实现发布文章的功能"></a>5.2.5 实现发布文章的功能</h4><ol><li>整理要插入数据库的文章信息对象：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 导入处理路径的 path 核心模块</span><br><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>)<br><br><span class="hljs-keyword">const</span> articleInfo = &#123;<br>  <span class="hljs-comment">// 标题、内容、状态、所属的分类Id</span><br>  ...req.<span class="hljs-property">body</span>,<br>  <span class="hljs-comment">// 文章封面在服务器端的存放路径</span><br>  <span class="hljs-attr">cover_img</span>: path.<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;/uploads&#x27;</span>, req.<span class="hljs-property">file</span>.<span class="hljs-property">filename</span>),<br>  <span class="hljs-comment">// 文章发布时间</span><br>  <span class="hljs-attr">pub_date</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(),<br>  <span class="hljs-comment">// 文章作者的Id</span><br>  <span class="hljs-attr">author_id</span>: req.<span class="hljs-property">user</span>.<span class="hljs-property">id</span>,<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>定义发布文章的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> sql = <span class="hljs-string">`insert into ev_articles set ?`</span><br></code></pre></td></tr></table></figure><ol><li>调用 <code>db.query()</code> 执行发布文章的 SQL 语句：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 导入数据库操作模块</span><br><span class="hljs-keyword">const</span> db = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../db/index&#x27;</span>)<br><br><span class="hljs-comment">// 执行 SQL 语句</span><br>db.<span class="hljs-title function_">query</span>(sql, articleInfo, <span class="hljs-function">(<span class="hljs-params">err, results</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// 执行 SQL 语句失败</span><br>  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(err)<br><br>  <span class="hljs-comment">// 执行 SQL 语句成功，但是影响行数不等于 1</span><br>  <span class="hljs-keyword">if</span> (results.<span class="hljs-property">affectedRows</span> !== <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">cc</span>(<span class="hljs-string">&#x27;发布文章失败！&#x27;</span>)<br><br>  <span class="hljs-comment">// 发布文章成功</span><br>  res.<span class="hljs-title function_">cc</span>(<span class="hljs-string">&#x27;发布文章成功&#x27;</span>, <span class="hljs-number">0</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><ol><li>在 <code>app.js</code> 中，使用 <code>express.static()</code> 中间件，将 <code>uploads</code> 目录中的图片托管为静态资源：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 托管静态资源文件</span><br>app.<span class="hljs-title function_">use</span>(<span class="hljs-string">&#x27;/uploads&#x27;</span>, express.<span class="hljs-title function_">static</span>(<span class="hljs-string">&#x27;./uploads&#x27;</span>))<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>nodejs</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>vue3</title>
    <link href="/2023/03/22/%E7%AC%94%E8%AE%B0/vue3/"/>
    <url>/2023/03/22/%E7%AC%94%E8%AE%B0/vue3/</url>
    
    <content type="html"><![CDATA[<h1 id="Vue3"><a href="#Vue3" class="headerlink" title="Vue3"></a>Vue3</h1><blockquote><p>学习：<br><a href="https://www.bilibili.com/video/BV1dS4y1y7vd">B站小满ZS</a><br><a href="https://www.bilibili.com/video/BV1Zy4y1K7SH">B站尚硅谷</a></p></blockquote><h2 id="Vue3快速上手"><a href="#Vue3快速上手" class="headerlink" title="Vue3快速上手"></a>Vue3快速上手</h2><img src="https://user-images.githubusercontent.com/499550/93624428-53932780-f9ae-11ea-8d16-af949e16a09f.png" style="width:200px" /><h3 id="1-Vue3简介"><a href="#1-Vue3简介" class="headerlink" title="1.Vue3简介"></a>1.Vue3简介</h3><ul><li>2020年9月18日，Vue.js发布3.0版本，代号：One Piece（海贼王）</li><li>耗时2年多、<a href="https://github.com/vuejs/vue-next/graphs/commit-activity">2600+次提交</a>、<a href="https://github.com/vuejs/rfcs/tree/master/active-rfcs">30+个RFC</a>、<a href="https://github.com/vuejs/vue-next/pulls?q=is:pr+is:merged+-author:app/dependabot-preview+">600+次PR</a>、<a href="https://github.com/vuejs/vue-next/graphs/contributors">99位贡献者</a> </li><li>github上的tags地址：<a href="https://github.com/vuejs/vue-next/releases/tag/v3.0.0">https://github.com/vuejs/vue-next/releases/tag/v3.0.0</a></li></ul><h3 id="2-Vue3带来了什么"><a href="#2-Vue3带来了什么" class="headerlink" title="2.Vue3带来了什么"></a>2.Vue3带来了什么</h3><h4 id="1-性能的提升"><a href="#1-性能的提升" class="headerlink" title="1.性能的提升"></a>1.性能的提升</h4><ul><li><p>打包大小减少41%</p></li><li><p>初次渲染快55%, 更新渲染快133%</p></li><li><p>内存减少54%</p><p>……</p></li></ul><h4 id="2-源码的升级"><a href="#2-源码的升级" class="headerlink" title="2.源码的升级"></a>2.源码的升级</h4><ul><li><p>使用Proxy代替defineProperty实现响应式</p></li><li><p>重写虚拟DOM的实现和Tree-Shaking</p><p>……</p></li></ul><h4 id="3-拥抱TypeScript"><a href="#3-拥抱TypeScript" class="headerlink" title="3.拥抱TypeScript"></a>3.拥抱TypeScript</h4><ul><li>Vue3可以更好的支持TypeScript</li></ul><h4 id="4-新的特性"><a href="#4-新的特性" class="headerlink" title="4.新的特性"></a>4.新的特性</h4><ol><li><p>Composition API（组合API）</p><ul><li>setup配置</li><li>ref与reactive</li><li>watch与watchEffect</li><li>provide与inject</li><li>……</li></ul></li><li><p>新的内置组件</p><ul><li>Fragment </li><li>Teleport</li><li>Suspense</li></ul></li><li><p>其他改变</p><ul><li>新的生命周期钩子</li><li>data 选项应始终被声明为一个函数</li><li>移除keyCode支持作为 v-on 的修饰符</li><li>……</li></ul></li></ol><h2 id="1、创建Vue3-0工程"><a href="#1、创建Vue3-0工程" class="headerlink" title="1、创建Vue3.0工程"></a>1、创建Vue3.0工程</h2><h3 id="1-使用-vue-cli-创建"><a href="#1-使用-vue-cli-创建" class="headerlink" title="1.使用 vue-cli 创建"></a>1.使用 vue-cli 创建</h3><p>官方文档：<a href="https://cli.vuejs.org/zh/guide/creating-a-project.html#vue-create">https://cli.vuejs.org/zh/guide/creating-a-project.html#vue-create</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">## 查看@vue/cli版本，确保@vue/cli版本在4.5.0以上</span><br>vue --version<br><span class="hljs-comment">## 安装或者升级你的@vue/cli</span><br>npm install -g @vue/cli<br><span class="hljs-comment">## 创建</span><br>vue create vue_test<br><span class="hljs-comment">## 启动</span><br><span class="hljs-built_in">cd</span> vue_test<br>npm run serve<br></code></pre></td></tr></table></figure><h3 id="2-使用-vite-创建"><a href="#2-使用-vite-创建" class="headerlink" title="2.使用 vite 创建"></a>2.使用 vite 创建</h3><p>官方文档：<a href="https://v3.cn.vuejs.org/guide/installation.html#vite">https://v3.cn.vuejs.org/guide/installation.html#vite</a></p><p>vite官网：<a href="https://vitejs.cn/">https://vitejs.cn</a></p><ul><li>什么是vite？—— 新一代前端构建工具。</li><li>优势如下：<ul><li>开发环境中，无需打包操作，可快速的冷启动。</li><li>轻量快速的热重载（HMR）。</li><li>真正的按需编译，不再等待整个应用编译完成。</li></ul></li><li>传统构建 与 vite构建对比图</li></ul><img src="https://kalacloud.com/static/9affcc8711ebfcd3d3cc7269c57ced52/526aa/bundler.png" /><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">## 创建工程</span><br>npm init vite-app &lt;project-name&gt;<br><span class="hljs-comment">## 进入工程目录</span><br><span class="hljs-built_in">cd</span> &lt;project-name&gt;<br><span class="hljs-comment">## 安装依赖</span><br>npm install<br><span class="hljs-comment">## 运行</span><br>npm run dev<br></code></pre></td></tr></table></figure><h3 id="3、Vue3-项目结构"><a href="#3、Vue3-项目结构" class="headerlink" title="3、Vue3 项目结构"></a>3、Vue3 项目结构</h3><p>Vue3 中 <code>main.js</code> 代码有所改变：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 不再引入 Vue 构造函数，而是引入 createApp 工厂函数</span><br><span class="hljs-comment">// createApp函数：创建 vue 的 SPA 实例</span><br><span class="hljs-keyword">import</span> &#123; createApp &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./App.vue&#x27;</span><br><br><span class="hljs-comment">// 创建应用实例对象</span><br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>)<br>app.<span class="hljs-title function_">mount</span>(<span class="hljs-string">&#x27;#app&#x27;</span>)<br></code></pre></td></tr></table></figure><p>Vue3 支持定义多个根节点，组件的 <code>&lt;template&gt;</code> 支持定义多个根节点：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>根节点<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>根节点<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="4、npm-run-dev详解"><a href="#4、npm-run-dev详解" class="headerlink" title="4、npm run dev详解"></a>4、<code>npm run dev</code>详解</h3><p>在我们执行这个命令的时候会去找 package json 的scripts 然后执行对应的dev命令</p><p><img src="/../img/vue/Snipaste_2023-04-16_20-15-44.png"></p><p>其实在我们执行npm install 的时候（包含vite） 会在node_modules&#x2F;.bin&#x2F; 创建好可执行文件</p><p>.bin 目录，这个目录不是任何一个 npm 包。目录下的文件，表示这是一个个软链接，打开文件可以看到文件顶部写着 #!&#x2F;bin&#x2F;sh ，表示这是一个脚本 </p><blockquote><p> 所以npm run xxx 的时候，就会到 node_modules&#x2F;bin中找对应的映射文件，然后再找到相应的js文件来执行</p><p>1.查找规则是先从当前项目的node_modlue &#x2F;bin去找,</p><p>2.找不到去全局的node_module&#x2F;bin 去找</p><p>3.再找不到 去环境变量去找</p></blockquote><h2 id="2、常用-Composition-API组合式api"><a href="#2、常用-Composition-API组合式api" class="headerlink" title="2、常用 Composition API组合式api"></a>2、常用 Composition API组合式api</h2><p>官方文档: <a href="https://v3.cn.vuejs.org/guide/composition-api-introduction.html">https://v3.cn.vuejs.org/guide/composition-api-introduction.html</a></p><h3 id="1-拉开序幕的setup"><a href="#1-拉开序幕的setup" class="headerlink" title="1.拉开序幕的setup"></a>1.拉开序幕的setup</h3><ul><li>setup 是 Vue3 中一个新的配置项，值为函数</li><li>组件中使用的数据、方法等都要配置在 setup 中</li><li>setup 函数两种返回值：<ul><li>返回一个对象，对象中的属性、方法可在模板中直接使用</li><li>返回一个渲染函数，可自定义渲染内容</li></ul></li><li>setup 函数的参数：<ul><li>props：值为对象，包含了组件外部传进来，且组件内部声明接收的属性</li><li>context：上下文对象<ul><li><code>attrs</code>：值为对象，包含了组件外部传进来，且组件内部没有声明接收的属性，相当于 <code>this.$attrs</code></li><li><code>slots</code>：收到的插槽内容，相当于 <code>this.$slots</code></li><li><code>emit</code>：触发自定义事件的函数，相当于 <code>this.$emit</code></li></ul></li></ul></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; h &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;App&#x27;</span>,<br>  <span class="hljs-attr">props</span>: [<span class="hljs-string">&#x27;title&#x27;</span>],<br>  <span class="hljs-comment">// Vue3 需要声明自定义事件，虽然不声明也能运行</span><br>  <span class="hljs-attr">emits</span>: [<span class="hljs-string">&#x27;changeCount&#x27;</span>],<br><br>  <span class="hljs-comment">// 返回函数</span><br>  <span class="hljs-comment">/*</span><br><span class="hljs-comment">  setup() &#123;</span><br><span class="hljs-comment">    return () =&gt; h(&#x27;h1&#x27;, &#x27;Hello&#x27;)</span><br><span class="hljs-comment">  &#125;,</span><br><span class="hljs-comment">  */</span><br><br>  <span class="hljs-comment">// 返回对象</span><br>  <span class="hljs-title function_">setup</span>(<span class="hljs-params">props, context</span>) &#123;<br>    <span class="hljs-keyword">let</span> name = <span class="hljs-string">&#x27;Vue3&#x27;</span><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">sayHello</span>(<span class="hljs-params"></span>) &#123;&#125;<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">test</span>(<span class="hljs-params"></span>) &#123;<br>      context.<span class="hljs-title function_">emit</span>(<span class="hljs-string">&#x27;changeCount&#x27;</span>, <span class="hljs-number">888</span>)<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> &#123;<br>      name,<br>      sayHello,<br>      test,<br>    &#125;<br>  &#125;,<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>setup 在 <code>beforeCreate</code> 钩子之前执行，<code>this</code> 为 <code>undefined</code></li><li>setup 不要和 Vue2 配置混用。Vue2 的配置可以访问到 setup 的属性方法，反过来不行；如有重名，setup 优先</li><li>setup 不能是 async 函数，因为 async 函数返回的是 promise 不是对象，会导致模板无法访问属性方法</li><li>若要返回 promise 实例，需要 <code>Suspense</code> 和异步组件的配合</li></ul><h3 id="2-ref函数"><a href="#2-ref函数" class="headerlink" title="2.ref函数"></a>2.ref函数</h3><ul><li>作用: 定义一个响应式的数据</li><li>语法: <code>const xxx = ref(initValue)</code> <ul><li>创建一个包含响应式数据的<strong style="color:#DD5145">引用对象（reference对象，简称ref对象）</strong>。</li><li>JS中操作数据： <code>xxx.value</code></li><li>模板中读取数据: 不需要.value，直接：<code>&lt;div&gt;&#123;&#123;xxx&#125;&#125;&lt;/div&gt;</code></li></ul></li><li>备注：<ul><li>接收的数据可以是：基本类型、也可以是<strong>对象类型</strong>。</li><li>基本类型的数据：响应式依然是靠<code>Object.defineProperty()</code>的<code>get</code>与<code>set</code>完成的。</li><li>对象类型的数据：内部 <i style="color:gray;font-weight:bold">“ 求助 ”</i> 了Vue3.0中的一个新函数—— <code>reactive</code>函数。</li><li>对象类型数据使用 ES6 的 <code>Proxy</code> 实现响应式，Vue3 把相关操作封装在 <code>reactive</code> 函数中</li><li>按照之前的办法，对于对象数据，应该遍历每一层的属性添加 <code>getter</code> 、<code>setter</code>，但 Vue3 使用 Proxy 把内部数据一口气监测了</li></ul></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>&#123;&#123; name &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>&#123;&#123; jobInfo.type &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; ref &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">let</span> name = <span class="hljs-title function_">ref</span>(<span class="hljs-string">&#x27;Vue3&#x27;</span>)<br>    <span class="hljs-keyword">let</span> jobInfo = <span class="hljs-title function_">ref</span>(&#123;<br>      <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;frontend&#x27;</span>,<br>      <span class="hljs-attr">salary</span>: <span class="hljs-string">&#x27;40w&#x27;</span>,<br>    &#125;)<br><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">changeInfo</span>(<span class="hljs-params"></span>) &#123;<br>      name.<span class="hljs-property">value</span> = <span class="hljs-string">&#x27;鱿鱼丝&#x27;</span><br>      <span class="hljs-comment">// jobInfo 是 RefImpl 实例</span><br>      <span class="hljs-comment">// jobInfo.value 是 Proxy 实例对象</span><br>      jobInfo.<span class="hljs-property">value</span>.<span class="hljs-property">salary</span> = <span class="hljs-string">&#x27;50w&#x27;</span><br>    &#125;<br><br>    <span class="hljs-keyword">return</span> &#123;<br>      name,<br>      jobInfo, <br>      changeInfo,<br>    &#125;<br>  &#125;,<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3-reactive函数"><a href="#3-reactive函数" class="headerlink" title="3.reactive函数"></a>3.reactive函数</h3><ul><li>作用: 定义一个<strong style="color:#DD5145">对象类型</strong>的响应式数据（基本类型不要用它，要用<code>ref</code>函数）</li><li>语法：<code>const 代理对象= reactive(源对象)</code>接收一个对象（或数组），返回一个<strong style="color:#DD5145">代理对象（Proxy的实例对象，简称proxy对象）</strong></li><li>reactive定义的响应式数据是“<strong>深层次的</strong>”。</li><li>内部基于 ES6 的 Proxy 实现，通过<strong>代理对象</strong>操作源对象内部数据进行操作。</li><li><code>reactive</code> <code>proxy</code> 不能直接赋值，否则会破坏响应式对象的<ul><li>解决方法： 数组可以使用push 加上 解构</li><li>添加一个对象，把数组作为一个属性去解决</li></ul></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; reactive &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">let</span> person = <span class="hljs-title function_">reactive</span>(&#123;<br>      <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Vue3&#x27;</span>,<br>      <span class="hljs-attr">sex</span>: <span class="hljs-string">&#x27;unknown&#x27;</span>,<br>      <span class="hljs-attr">info</span>: &#123;<br>        <span class="hljs-attr">school</span>: <span class="hljs-string">&#x27;Oxford&#x27;</span>,<br>        <span class="hljs-attr">major</span>: <span class="hljs-string">&#x27;computer&#x27;</span>,<br>      &#125;,<br>    &#125;)<br><br>    <span class="hljs-keyword">let</span> color = <span class="hljs-title function_">reactive</span>([<span class="hljs-string">&#x27;red&#x27;</span>, <span class="hljs-string">&#x27;green&#x27;</span>, <span class="hljs-string">&#x27;blue&#x27;</span>])<br><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">changeInfo</span>(<span class="hljs-params"></span>) &#123;<br>      person.<span class="hljs-property">info</span>.<span class="hljs-property">major</span> = <span class="hljs-string">&#x27;art&#x27;</span><br>      color[<span class="hljs-number">0</span>] = <span class="hljs-string">&#x27;yellow&#x27;</span><br>    &#125;<br><br>    <span class="hljs-keyword">return</span> &#123;<br>      person,<br>      color,<br>      changeInfo,<br>    &#125;<br>  &#125;,<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="4-Vue3-0中的响应式原理"><a href="#4-Vue3-0中的响应式原理" class="headerlink" title="4.Vue3.0中的响应式原理"></a>4.Vue3.0中的响应式原理</h3><h4 id="vue2-x的响应式"><a href="#vue2-x的响应式" class="headerlink" title="vue2.x的响应式"></a>vue2.x的响应式</h4><ul><li><p>实现原理：</p><ul><li><p>对象类型：通过<code>Object.defineProperty()</code>对属性的读取、修改进行拦截（数据劫持）。</p></li><li><p>数组类型：通过重写更新数组的一系列方法来实现拦截。（对数组的变更方法进行了包裹）。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(data, <span class="hljs-string">&#x27;count&#x27;</span>, &#123;<br>    get () &#123;&#125;, <br>    set () &#123;&#125;<br>&#125;)<br></code></pre></td></tr></table></figure></li></ul></li><li><p>存在问题：</p><ul><li>新增属性、删除属性, 界面不会更新。</li><li>直接通过下标修改数组, 界面不会自动更新。</li></ul></li></ul><h4 id="Vue3-0的响应式"><a href="#Vue3-0的响应式" class="headerlink" title="Vue3.0的响应式"></a>Vue3.0的响应式</h4><ul><li><p>实现原理: </p><ul><li><p>通过<strong>Proxy（代理）</strong>:  <strong>拦截对象中任意属性的变化</strong>, 包括：属性值的读写、属性的添加、属性的删除等。</p></li><li><p>通过<strong>Reflect（反射）</strong>:  对源对象的属性进行操作。</p></li><li><p>MDN文档中描述的Proxy与Reflect：</p><ul><li><p>Proxy：<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy</a></p></li><li><p>Reflect：<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Reflect">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Reflect</a></p></li></ul></li></ul></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">new</span> <span class="hljs-title class_">Proxy</span>(data, &#123;<br><span class="hljs-comment">// 拦截读取属性值target:源对象prop:属性</span><br>    get (target, prop) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">get</span>(target, prop)<br>    &#125;,<br>    <span class="hljs-comment">// 拦截设置属性值或添加新属性</span><br>    set (target, prop, value) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">set</span>(target, prop, value)<br>    &#125;,<br>    <span class="hljs-comment">// 拦截删除属性</span><br>    deleteProperty (target, prop) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">deleteProperty</span>(target, prop)<br>    &#125;<br>&#125;)<br><br>proxy.<span class="hljs-property">name</span> = <span class="hljs-string">&#x27;tom&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="5-reactive对比ref"><a href="#5-reactive对比ref" class="headerlink" title="5.reactive对比ref"></a>5.reactive对比ref</h3><ul><li>从定义数据角度对比：<ul><li>ref用来定义：<strong style="color:#DD5145">基本类型数据</strong>。</li><li>reactive用来定义：<strong style="color:#DD5145">对象（或数组）类型数据</strong>。</li><li>备注：ref也可以用来定义<strong style="color:#DD5145">对象（或数组）类型数据</strong>, 它内部会自动通过<code>reactive</code>转为<strong style="color:#DD5145">代理对象</strong>。</li></ul></li><li>从原理角度对比：<ul><li>ref通过<code>Object.defineProperty()</code>的<code>get</code>与<code>set</code>来实现响应式（数据劫持）。</li><li>reactive通过使用<strong style="color:#DD5145">Proxy</strong>来实现响应式（数据劫持）, 并通过<strong style="color:#DD5145">Reflect</strong>操作<strong style="color:orange">源对象</strong>内部的数据。</li></ul></li><li>从使用角度对比：<ul><li>ref定义的数据：操作数据<strong style="color:#DD5145">需要</strong><code>.value</code>，读取数据时模板中直接读取<strong style="color:#DD5145">不需要</strong><code>.value</code>。</li><li>reactive定义的数据：操作数据与读取数据：<strong style="color:#DD5145">均不需要</strong><code>.value</code>。</li></ul></li></ul><h3 id="6-setup的两个注意点"><a href="#6-setup的两个注意点" class="headerlink" title="6.setup的两个注意点"></a>6.setup的两个注意点</h3><ul><li><p>setup执行的时机</p><ul><li>在beforeCreate之前执行一次，<strong>this是undefined</strong>。</li><li>所以setup拿不到data的数据</li></ul></li><li><p>setup的参数</p><ul><li>props：值为对象，包含：组件外部传递过来，且组件内部声明接收了的属性。</li><li>context：<strong>上下文对象</strong><ul><li>attrs: 值为对象，包含：组件外部传递过来，但没有在props配置中声明的属性, 相当于 <code>this.$attrs</code>。</li><li>slots: 收到的插槽内容, 相当于 <code>this.$slots</code>。</li><li>emit: 分发自定义事件的函数, 相当于 <code>this.$emit</code>。</li></ul></li></ul></li></ul><h3 id="7-计算属性与监视"><a href="#7-计算属性与监视" class="headerlink" title="7.计算属性与监视"></a>7.计算属性与监视</h3><h4 id="1-computed函数"><a href="#1-computed函数" class="headerlink" title="1.computed函数"></a>1.computed函数</h4><ul><li><p>与Vue2.x中computed配置功能一致</p></li><li><p>写法</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123;reavtive,computed&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><br><span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">let</span> person = <span class="hljs-title function_">reavtive</span>(&#123;<br>        <span class="hljs-attr">firstName</span>: <span class="hljs-string">&#x27;张&#x27;</span>,<br>        <span class="hljs-attr">lastName</span>: <span class="hljs-string">&#x27;三&#x27;</span><br>    &#125;)<br><span class="hljs-comment">//计算属性——简写（没有考虑计算属性被修改的情况）</span><br>    <span class="hljs-keyword">let</span> fullName = <span class="hljs-title function_">computed</span>(<span class="hljs-function">()=&gt;</span>&#123;<br>        <span class="hljs-keyword">return</span> person.<span class="hljs-property">firstName</span> + <span class="hljs-string">&#x27;-&#x27;</span> + person.<span class="hljs-property">lastName</span><br>    &#125;)<br>    <br>    <span class="hljs-comment">//也可以作为reactive的一个子项加入</span><br>    <span class="hljs-title class_">Person</span>.<span class="hljs-property">fullName</span> = <span class="hljs-title function_">computed</span>(<span class="hljs-function">()=&gt;</span>&#123;<br>        <span class="hljs-keyword">return</span> person.<span class="hljs-property">firstName</span> + <span class="hljs-string">&#x27;-&#x27;</span> + person.<span class="hljs-property">lastName</span><br>    &#125;)<br>    <span class="hljs-comment">//计算属性——完整（考虑到计算属性被修改的情况）</span><br>    <span class="hljs-keyword">let</span> fullName = <span class="hljs-title function_">computed</span>(&#123;<br>        <span class="hljs-title function_">get</span>(<span class="hljs-params"></span>)&#123;<br>            <span class="hljs-keyword">return</span> person.<span class="hljs-property">firstName</span> + <span class="hljs-string">&#x27;-&#x27;</span> + person.<span class="hljs-property">lastName</span><br>        &#125;,<br>        <span class="hljs-title function_">set</span>(<span class="hljs-params">value</span>)&#123;<br>            <span class="hljs-keyword">const</span> nameArr = value.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;-&#x27;</span>)<br>            person.<span class="hljs-property">firstName</span> = nameArr[<span class="hljs-number">0</span>]<br>            person.<span class="hljs-property">lastName</span> = nameArr[<span class="hljs-number">1</span>]<br>        &#125;<br>    &#125;)<br>&#125;<br></code></pre></td></tr></table></figure></li></ul><h4 id="2-watch函数"><a href="#2-watch函数" class="headerlink" title="2.watch函数"></a>2.watch函数</h4><ul><li><p>与Vue2.x中watch配置功能一致</p></li><li><p>两个小“坑”：</p><ul><li>监视reactive定义的响应式数据时：oldValue无法正确获取、强制开启了深度监视（deep配置失效）。</li><li>监视reactive定义的响应式数据中某个属性时：deep配置有效。</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//情况一：监视ref定义的响应式数据</span><br><span class="hljs-title function_">watch</span>(sum,<span class="hljs-function">(<span class="hljs-params">newValue,oldValue</span>)=&gt;</span>&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;sum变化了&#x27;</span>,newValue,oldValue)<br>&#125;,&#123;<span class="hljs-attr">immediate</span>:<span class="hljs-literal">true</span>&#125;)<br><br><span class="hljs-comment">//情况二：监视多个ref定义的响应式数据</span><br><span class="hljs-title function_">watch</span>([sum,msg],<span class="hljs-function">(<span class="hljs-params">newValue,oldValue</span>)=&gt;</span>&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;sum或msg变化了&#x27;</span>,newValue,oldValue)<br>&#125;) <br><br><span class="hljs-comment">/* 情况三：监视reactive定义的响应式数据</span><br><span class="hljs-comment">若watch监视的是reactive定义的响应式数据，则无法正确获得oldValue！！</span><br><span class="hljs-comment">若watch监视的是reactive定义的响应式数据，则强制开启了深度监视 </span><br><span class="hljs-comment">*/</span><br><span class="hljs-title function_">watch</span>(person,<span class="hljs-function">(<span class="hljs-params">newValue,oldValue</span>)=&gt;</span>&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;person变化了&#x27;</span>,newValue,oldValue)<br>&#125;,&#123;<span class="hljs-attr">immediate</span>:<span class="hljs-literal">true</span>,<span class="hljs-attr">deep</span>:<span class="hljs-literal">false</span>&#125;) <span class="hljs-comment">//此处的deep配置不再奏效</span><br><br><span class="hljs-comment">//情况四：监视reactive定义的响应式数据中的某个属性</span><br><span class="hljs-title function_">watch</span>(<span class="hljs-function">()=&gt;</span>person.<span class="hljs-property">job</span>,<span class="hljs-function">(<span class="hljs-params">newValue,oldValue</span>)=&gt;</span>&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;person的job变化了&#x27;</span>,newValue,oldValue)<br>&#125;,&#123;<span class="hljs-attr">immediate</span>:<span class="hljs-literal">true</span>,<span class="hljs-attr">deep</span>:<span class="hljs-literal">true</span>&#125;) <br><br><span class="hljs-comment">//情况五：监视reactive定义的响应式数据中的某些属性</span><br><span class="hljs-title function_">watch</span>([<span class="hljs-function">()=&gt;</span>person.<span class="hljs-property">job</span>,<span class="hljs-function">()=&gt;</span>person.<span class="hljs-property">name</span>],<span class="hljs-function">(<span class="hljs-params">newValue,oldValue</span>)=&gt;</span>&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;person的job变化了&#x27;</span>,newValue,oldValue)<br>&#125;,&#123;<span class="hljs-attr">immediate</span>:<span class="hljs-literal">true</span>,<span class="hljs-attr">deep</span>:<span class="hljs-literal">true</span>&#125;)<br><br><span class="hljs-comment">//特殊情况</span><br><span class="hljs-title function_">watch</span>(<span class="hljs-function">()=&gt;</span>person.<span class="hljs-property">job</span>,<span class="hljs-function">(<span class="hljs-params">newValue,oldValue</span>)=&gt;</span>&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;person的job变化了&#x27;</span>,newValue,oldValue)<br>&#125;,&#123;<span class="hljs-attr">deep</span>:<span class="hljs-literal">true</span>&#125;) <span class="hljs-comment">//此处由于监视的是reactive所定义的对象中的某个属性，所以deep配置有效</span><br></code></pre></td></tr></table></figure></li></ul><h4 id="3-watchEffect函数"><a href="#3-watchEffect函数" class="headerlink" title="3.watchEffect函数"></a>3.watchEffect函数</h4><ul><li><p>watch的套路是：既要指明监视的属性，也要指明监视的回调。</p></li><li><p>watchEffect的套路是：不用指明监视哪个属性，监视的回调中用到哪个属性，那就监视哪个属性。</p></li><li><p>watchEffect有点像computed：</p><ul><li>但computed注重的计算出来的值（回调函数的返回值），所以必须要写返回值。</li><li>而watchEffect更注重的是过程（回调函数的函数体），所以不用写返回值。</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//watchEffect所指定的回调中用到的数据只要发生变化，则直接重新执行回调。</span><br><span class="hljs-title function_">watchEffect</span>(<span class="hljs-function">()=&gt;</span>&#123;<br>    <span class="hljs-keyword">const</span> x1 = sum.<span class="hljs-property">value</span><br>    <span class="hljs-keyword">const</span> x2 = person.<span class="hljs-property">age</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;watchEffect配置的回调执行了&#x27;</span>)<br>&#125;)<br></code></pre></td></tr></table></figure></li></ul><h3 id="8-生命周期"><a href="#8-生命周期" class="headerlink" title="8.生命周期"></a>8.生命周期</h3><p>vue3的生命周期图:</p><p><img src="/../img/vue/lifecycle.16e4c08e.png" alt="vue3生命周期图"></p><p>vue2生命周期图:</p><p><img src="/../img/vue/shengming.png" alt="vue2生命周期图"></p><ul><li>Vue3.0中可以继续使用Vue2.x中的生命周期钩子，但有有两个被更名：<ul><li><code>beforeDestroy</code>改名为 <code>beforeUnmount</code></li><li><code>destroyed</code>改名为 <code>unmounted</code></li></ul></li><li>Vue3.0也提供了 Composition API 形式的生命周期钩子，与Vue2.x中钩子对应关系如下：<ul><li><code>beforeCreate</code>&#x3D;&#x3D;&#x3D;&gt;<code>setup()</code></li><li><code>created</code>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&gt;<code>setup()</code></li><li><code>beforeMount</code> &#x3D;&#x3D;&#x3D;&gt;<code>onBeforeMount</code></li><li><code>mounted</code>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&gt;<code>onMounted</code></li><li><code>beforeUpdate</code>&#x3D;&#x3D;&#x3D;&gt;<code>onBeforeUpdate</code></li><li><code>updated</code> &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&gt;<code>onUpdated</code></li><li><code>beforeUnmount</code> &#x3D;&#x3D;&gt;<code>onBeforeUnmount</code></li><li><code>unmounted</code> &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&gt;<code>onUnmounted</code></li><li><code>onErrorCaptured</code> &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&gt;注册一个钩子，在捕获了后代组件传递的错误时调用。</li><li><code>onRenderTracked</code> &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&gt; 注册一个调试钩子，当组件渲染过程中追踪到响应式依赖时调用。（仅在开发模式下可用）</li><li><code>onRenderTriggered</code> &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&gt; 注册一个调试钩子，当响应式依赖的变更触发了组件渲染时调用。（仅在开发模式下可用）</li><li><code>onServerPrefetch</code> &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&gt; 注册一个异步函数，在组件实例在服务器上被渲染之前调用。（仅在<strong>服务器端渲染期间</strong>可用）</li></ul></li></ul><h3 id="9-自定义hook函数"><a href="#9-自定义hook函数" class="headerlink" title="9.自定义hook函数"></a>9.自定义hook函数</h3><ul><li><p>什么是hook？—— 本质是一个函数，把setup函数中使用的Composition API进行了封装。</p></li><li><p>类似于vue2.x中的mixin。</p></li><li><p>自定义hook的优势: 复用代码, 让setup中的逻辑更清楚易懂。</p></li><li><p>hook 放在 hooks 文件夹中，一个文件对应一个功能模块，以 <code>useXxx</code> 命名</p></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// hooks/usePoint.js</span><br><span class="hljs-keyword">import</span> &#123; reactive, onMounted, onBeforeUnmount &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-comment">//实现鼠标“打点”相关的数据</span><br>  <span class="hljs-keyword">let</span> point = <span class="hljs-title function_">reactive</span>(&#123;<br>    <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">y</span>: <span class="hljs-number">0</span>,<br>  &#125;)<br><br>  <span class="hljs-comment">//实现鼠标“打点”相关的方法</span><br>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">savePoint</span>(<span class="hljs-params">event</span>) &#123;<br>    point.<span class="hljs-property">x</span> = event.<span class="hljs-property">pageX</span><br>    point.<span class="hljs-property">y</span> = event.<span class="hljs-property">pageY</span><br>  &#125;<br><br>  <span class="hljs-comment">//实现鼠标“打点”相关的生命周期钩子</span><br>  <span class="hljs-title function_">onMounted</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, savePoint)<br>  &#125;)<br><br>  <span class="hljs-title function_">onBeforeUnmount</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, savePoint)<br>  &#125;)<br><br>  <span class="hljs-keyword">return</span> point<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 使用 hook</span><br><span class="hljs-keyword">import</span> usePoint <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../hooks/usePoint.js&#x27;</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">let</span> point = <span class="hljs-title function_">usePoint</span>()<br><br>    <span class="hljs-keyword">return</span> &#123; point &#125;<br>  &#125;,<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> &#123; onMounted &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br> <br> <br><span class="hljs-keyword">type</span> <span class="hljs-title class_">Options</span> = &#123;<br>    <span class="hljs-attr">el</span>: <span class="hljs-built_in">string</span><br>&#125;<br> <br><span class="hljs-keyword">type</span> <span class="hljs-title class_">Return</span> = &#123;<br>    <span class="hljs-title class_">Baseurl</span>: <span class="hljs-built_in">string</span> | <span class="hljs-literal">null</span><br>&#125;<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> (<span class="hljs-params">option: Options</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Return</span>&gt; &#123;<br> <br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> &#123;<br>        <span class="hljs-title function_">onMounted</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>            <span class="hljs-keyword">const</span> <span class="hljs-attr">file</span>: <span class="hljs-title class_">HTMLImageElement</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(option.<span class="hljs-property">el</span>) <span class="hljs-keyword">as</span> <span class="hljs-title class_">HTMLImageElement</span>;<br>            file.<span class="hljs-property">onload</span> = ():<span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> &#123;<br>                <span class="hljs-title function_">resolve</span>(&#123;<br>                    <span class="hljs-title class_">Baseurl</span>: <span class="hljs-title function_">toBase64</span>(file)<br>                &#125;)<br>            &#125;<br> <br>        &#125;)<br> <br> <br>        <span class="hljs-keyword">const</span> toBase64 = (<span class="hljs-attr">el</span>: <span class="hljs-title class_">HTMLImageElement</span>): <span class="hljs-function"><span class="hljs-params">string</span> =&gt;</span> &#123;<br>            <span class="hljs-keyword">const</span> <span class="hljs-attr">canvas</span>: <span class="hljs-title class_">HTMLCanvasElement</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;canvas&#x27;</span>)<br>            <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&#x27;2d&#x27;</span>) <span class="hljs-keyword">as</span> <span class="hljs-title class_">CanvasRenderingContext2D</span><br>            canvas.<span class="hljs-property">width</span> = el.<span class="hljs-property">width</span><br>            canvas.<span class="hljs-property">height</span> = el.<span class="hljs-property">height</span><br>            ctx.<span class="hljs-title function_">drawImage</span>(el, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, canvas.<span class="hljs-property">width</span>,canvas.<span class="hljs-property">height</span>)<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(el.<span class="hljs-property">width</span>);<br>            <br>            <span class="hljs-keyword">return</span> canvas.<span class="hljs-title function_">toDataURL</span>(<span class="hljs-string">&#x27;image/png&#x27;</span>)<br> <br>        &#125;<br>    &#125;)<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="案例二"><a href="#案例二" class="headerlink" title="案例二"></a>案例二</h4><p>自定义指令 + hooks 双管齐下</p><p>实现一个监听元素变化的hook</p><p>主要会用到一个新的API resizeObserver 兼容性一般 可以做polyfill</p><p>但是他可以监听元素的变化 执行回调函数 返回 contentRect 里面有变化之后的宽高。</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">App</span>, defineComponent, onMounted &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br> <br><span class="hljs-keyword">function</span> <span class="hljs-title function_">useResize</span>(<span class="hljs-params">el: HTMLElement, callback: (cr: DOMRectReadOnly,resize:ResizeObserver) =&gt; <span class="hljs-built_in">void</span></span>) &#123;<br>    <span class="hljs-keyword">let</span> <span class="hljs-attr">resize</span>: <span class="hljs-title class_">ResizeObserver</span><br>        resize = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ResizeObserver</span>(<span class="hljs-function">(<span class="hljs-params">entries</span>) =&gt;</span> &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> entry <span class="hljs-keyword">of</span> entries) &#123;<br>                <span class="hljs-keyword">const</span> cr = entry.<span class="hljs-property">contentRect</span>;<br>                <span class="hljs-title function_">callback</span>(cr,resize)<br>            &#125;<br>        &#125;);<br>        resize.<span class="hljs-title function_">observe</span>(el)<br>&#125;<br> <br> <br> <br><span class="hljs-keyword">const</span> <span class="hljs-title function_">install</span> = (<span class="hljs-params">app: App</span>) =&gt; &#123;<br>    app.<span class="hljs-title function_">directive</span>(<span class="hljs-string">&#x27;resize&#x27;</span>, &#123;<br>        <span class="hljs-title function_">mounted</span>(<span class="hljs-params">el, binding</span>) &#123;<br>            <span class="hljs-title function_">useResize</span>(el, binding.<span class="hljs-property">value</span>)<br>        &#125;<br>    &#125;)<br>&#125;<br> <br>useResize.<span class="hljs-property">install</span> = install<br> <br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> useResize<br></code></pre></td></tr></table></figure><h3 id="10-toRef"><a href="#10-toRef" class="headerlink" title="10.toRef"></a>10.toRef</h3><ul><li><p>作用：创建一个 ref 对象，其value值指向另一个对象中的某个属性。</p></li><li><p>语法：<code>const name = toRef(person,&#39;name&#39;)</code></p></li><li><p>应用:   要将响应式对象中的某个属性单独提供给外部使用时。</p></li><li><p>只能修改响应式对象的值</p></li><li><p>使用场景：解构赋值，解构出来的也是响应式数据</p></li><li><p>扩展：<code>toRefs</code> 与<code>toRef</code>功能一致，但可以批量创建多个 ref 对象，语法：<code>toRefs(person)</code>   只能拆开</p></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123;reactive, toRef, toRefs&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br>...<br><br><span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">let</span> person = <span class="hljs-title function_">reactive</span>(&#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Vue3&#x27;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>,<br>    <span class="hljs-attr">info</span>: &#123;<br>      <span class="hljs-attr">job</span>: &#123;<br>        <span class="hljs-attr">salary</span>: <span class="hljs-number">40</span>,<br>      &#125;,<br>    &#125;,<br>  &#125;)<br><br>  <span class="hljs-keyword">return</span> &#123;<br>    <span class="hljs-comment">// 注意不能写成 ref(person.name)，这和源对象是割裂开的</span><br>    <span class="hljs-attr">name</span>: <span class="hljs-title function_">toRef</span>(person, <span class="hljs-string">&#x27;name&#x27;</span>),<br>    <span class="hljs-attr">salary</span>: <span class="hljs-title function_">toRef</span>(person.<span class="hljs-property">info</span>.<span class="hljs-property">job</span>, <span class="hljs-string">&#x27;salary&#x27;</span>)<br>    <span class="hljs-comment">// or</span><br>    ...<span class="hljs-title function_">toRefs</span>(person)<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="3、其它-Composition-API"><a href="#3、其它-Composition-API" class="headerlink" title="3、其它 Composition API"></a>3、其它 Composition API</h2><h3 id="1-shallowReactive-与-shallowRef"><a href="#1-shallowReactive-与-shallowRef" class="headerlink" title="1.shallowReactive 与 shallowRef"></a>1.shallowReactive 与 shallowRef</h3><ul><li><p>shallowReactive：只处理对象最外层属性的响应式（浅响应式）。</p></li><li><p>shallowRef：只处理基本数据类型的响应式, 不进行对象的响应式处理。</p></li><li><p>什么时候使用?</p><ul><li>如果有一个对象数据，结构比较深, 但变化时只是外层属性变化 &#x3D;&#x3D;&#x3D;&gt; shallowReactive。</li><li>如果有一个对象数据，后续功能不会修改该对象中的属性，而是生新的对象来替换 &#x3D;&#x3D;&#x3D;&gt; shallowRef。</li></ul></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; shallowReactive, shallowRef &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><br><span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">let</span> person = <span class="hljs-title function_">shallowReactive</span>(&#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Vue3&#x27;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">21</span>,<br>    <span class="hljs-attr">info</span>: &#123;<br>      <span class="hljs-attr">job</span>: &#123;<br>        <span class="hljs-attr">salary</span>: <span class="hljs-number">22</span><br>      &#125;<br>    &#125;<br>  &#125;)<br>  <span class="hljs-keyword">let</span> x = <span class="hljs-title function_">shallowRef</span>(&#123;<br>    <span class="hljs-attr">y</span>: <span class="hljs-number">0</span><br>  &#125;)<br>  <span class="hljs-keyword">return</span> &#123;<br>    person,<br>    x<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2-readonly-与-shallowReadonly"><a href="#2-readonly-与-shallowReadonly" class="headerlink" title="2.readonly 与 shallowReadonly"></a>2.readonly 与 shallowReadonly</h3><ul><li>readonly: 让一个响应式数据变为只读的（深只读）。</li><li>shallowReadonly：让一个响应式数据变为只读的（浅只读）。浅层的数据不可以被修改，可以修改深层的数据</li><li>应用场景: 不希望数据被修改时。</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">let</span> sum = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>)<br>  <span class="hljs-keyword">let</span> person = <span class="hljs-title function_">reactive</span>(&#123;...&#125;)<br><br>  sum = <span class="hljs-title function_">readonly</span>(sum)<br>  person = <span class="hljs-title function_">shallowReadonly</span>(person)<br><br>  <span class="hljs-keyword">return</span> &#123;<br>    sum,<br>    person<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3-toRaw-与-markRaw"><a href="#3-toRaw-与-markRaw" class="headerlink" title="3.toRaw 与 markRaw"></a>3.toRaw 与 markRaw</h3><ul><li>toRaw：<ul><li>作用：将一个由<code>reactive</code>生成的<strong style="color:orange">响应式对象</strong>转为<strong style="color:orange">普通对象</strong>。</li><li>使用场景：用于读取响应式对象对应的普通对象，对这个普通对象的所有操作，不会引起页面更新。</li></ul></li><li>markRaw：<ul><li>作用：标记一个对象，使其永远不会再成为响应式对象。</li><li>应用场景:<ol><li>有些值不应被设置为响应式的，例如复杂的第三方类库等。</li><li>当渲染具有不可变数据源的大列表时，跳过响应式转换可以提高性能。</li></ol></li></ul></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">showRawPerson</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">const</span> p = <span class="hljs-title function_">toRaw</span>(person);<br>    p.<span class="hljs-property">age</span>++;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(p);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person);<br>  &#125;<br><br>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">addCar</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">let</span> car = &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;奔驰&quot;</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">40</span> &#125;;<br>    person.<span class="hljs-property">car</span> = <span class="hljs-title function_">markRaw</span>(car);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="4-customRef"><a href="#4-customRef" class="headerlink" title="4.customRef"></a>4.customRef</h3><ul><li><p>作用：创建一个自定义的 ref，并对其依赖项跟踪和更新触发进行显式控制。</p></li><li><p>实现防抖效果：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>&lt;input type=&quot;text&quot; v-model=&quot;keyword&quot;&gt;<br>&lt;h3&gt;&#123;&#123;keyword&#125;&#125;&lt;/h3&gt;<br>&lt;/template&gt;<br><br>&lt;script&gt;<br>import &#123;ref,customRef&#125; from &#x27;vue&#x27;<br>export default &#123;<br>name:&#x27;Demo&#x27;,<br>setup()&#123;<br>// let keyword = ref(&#x27;hello&#x27;) //使用Vue准备好的内置ref<br>//自定义一个myRefdelay:延迟时间<br>function myRef(value,delay)&#123;<br>let timer<br>//通过customRef去实现自定义<br>return customRef((track,trigger)=&gt;&#123;<br>return&#123;<br>get()&#123;<br>track() //告诉Vue这个value值是需要被“追踪”的<br>return value<br>&#125;,<br>set(newValue)&#123;<br>clearTimeout(timer)<br>timer = setTimeout(()=&gt;&#123;<br>value = newValue<br>trigger() //告诉Vue去更新界面<br>&#125;,delay)<br>&#125;<br>&#125;<br>&#125;)<br>&#125;<br>let keyword = myRef(&#x27;hello&#x27;,500) //使用程序员自定义的ref<br>return &#123;<br>keyword<br>&#125;<br>&#125;<br>&#125;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure></li></ul><h3 id="5-provide-与-inject"><a href="#5-provide-与-inject" class="headerlink" title="5.provide 与 inject"></a>5.provide 与 inject</h3><p><img src="/../img/vue/provide-inject.840efd40.png" alt="组件通信"></p><ul><li><p>作用：实现<strong style="color:#DD5145">祖与后代组件间</strong>通信</p></li><li><p>套路：父组件有一个 <code>provide</code> 选项来提供数据，后代组件有一个 <code>inject</code> 选项来开始使用这些数据</p></li><li><p>具体写法：</p><ol><li><p>祖组件中：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>)&#123;<br>......<br>    <span class="hljs-keyword">let</span> car = <span class="hljs-title function_">reactive</span>(&#123;<span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;奔驰&#x27;</span>,<span class="hljs-attr">price</span>:<span class="hljs-string">&#x27;40万&#x27;</span>&#125;)<br>    <span class="hljs-title function_">provide</span>(<span class="hljs-string">&#x27;car&#x27;</span>,car)<br>    ......<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>后代组件中：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">setup</span>(<span class="hljs-params">props,context</span>)&#123;<br>......<br>    <span class="hljs-keyword">const</span> car = <span class="hljs-title function_">inject</span>(<span class="hljs-string">&#x27;car&#x27;</span>)<br>    <span class="hljs-keyword">return</span> &#123;car&#125; <br>......<br>&#125;<br></code></pre></td></tr></table></figure></li></ol></li></ul><blockquote><p>你如果传递普通的值 是不具有响应式的 需要通过ref reactive 添加响应式</p></blockquote><h3 id="6-响应式数据的判断"><a href="#6-响应式数据的判断" class="headerlink" title="6.响应式数据的判断"></a>6.响应式数据的判断</h3><ul><li>isRef: 检查一个值是否为一个 ref 对象</li><li>isReactive: 检查一个对象是否是由 <code>reactive</code> 创建的响应式代理</li><li>isReadonly: 检查一个对象是否是由 <code>readonly</code> 创建的只读代理</li><li>isProxy: 检查一个对象是否是由 <code>reactive</code> 或者 <code>readonly</code> 方法创建的代理</li></ul><h3 id="7、父子组件传参"><a href="#7、父子组件传参" class="headerlink" title="7、父子组件传参"></a>7、父子组件传参</h3><h4 id="父组件向子组件传值"><a href="#父组件向子组件传值" class="headerlink" title="父组件向子组件传值"></a>父组件向子组件传值</h4><p>父组件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;children :data=&quot;name&quot;&gt;&lt;/children&gt;<br>&lt;/template&gt;<br><br>&lt;script setup lang=&#x27;ts&#x27;&gt;<br>import &#123; ref &#125; from &#x27;vue&#x27;<br>let name = &#x27;父组件&#x27;<br>&lt;/script&gt;<br><br></code></pre></td></tr></table></figure><p>子组件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;script setup lang=&#x27;ts&#x27;&gt;<br>// 接收父组件传过来的值 defineProps ts<br>const props = defineProps&lt;&#123; data: string &#125;&gt;()<br><br>// 添加默认值 ts<br>withDefaults(defineProps&lt;&#123;<br>  msg: string<br>&#125;&gt;(), &#123;<br>  msg: &#x27;Hello World&#x27;<br>&#125;)<br>    <br>// 接收父组件传过来的值 js<br>const props = defineProps(&#123;<br>  data: &#123;<br>    type: String,<br>    default: &#x27;default&#x27;<br>  &#125;<br>&#125;)<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure><h4 id="子组件向父组件传值"><a href="#子组件向父组件传值" class="headerlink" title="子组件向父组件传值"></a>子组件向父组件传值</h4><p>父组件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;div&gt;父组件&lt;/div&gt;<br>  &lt;HelloWorld ref=&quot;world&quot; @update=&quot;getName&quot;/&gt;<br>&lt;/template&gt;<br>&lt;script setup lang=&#x27;ts&#x27;&gt;<br>import &#123; ref,onMounted &#125; from &#x27;vue&#x27;<br>import HelloWorld from &#x27;./components/HelloWorld.vue&#x27;<br>const world = ref&lt;InstanceType&lt;typeof HelloWorld&gt;&gt;()<br>// 子组件向父组件传值<br>const getName = function(&#123;<br>    <br>&#125;)<br>// 在onMounted中调用子组件的方法<br>onMounted(() =&gt; &#123;<br>  world.value?.open()<br>&#125;)<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure><p>子组件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;script setup lang=&#x27;ts&#x27;&gt;<br>// 给父组件传递数据 js写法<br>const emit = defineEmits([&#x27;update&#x27;])<br><br>// ts写法<br>const emit = defineEmits&lt;&#123;<br> (e: &#x27;update&#x27;, value: string): void<br>&#125;&gt;()<br><br>// 暴露属性和方法<br>defineExpose(&#123;<br>    name: &#x27;HelloWorld&#x27;,<br>    open:() =&gt; &#123;<br>        console.log(&#x27;HelloWorld&#x27;)<br>    &#125;<br>&#125;)<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure><h4 id="案例封装瀑布流组件"><a href="#案例封装瀑布流组件" class="headerlink" title="案例封装瀑布流组件"></a>案例封装瀑布流组件</h4><p>父组件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;waterFallVue :list=&quot;list&quot;&gt;&lt;/waterFallVue&gt;<br>&lt;/template&gt;<br><br>&lt;script setup lang=&#x27;ts&#x27;&gt;<br>import &#123; ref, reactive &#125; from &#x27;vue&#x27;<br>import waterFallVue from &#x27;./components/water-fall.vue&#x27;;<br>const list = [<br>  &#123;<br>      height: 300,<br>      background: &#x27;red&#x27;<br>  &#125;,<br>  &#123;<br>      height: 400,<br>      background: &#x27;pink&#x27;<br>  &#125;,<br>  &#123;<br>      height: 500,<br>      background: &#x27;blue&#x27;<br>  &#125;,<br>  &#123;<br>      height: 200,<br>      background: &#x27;green&#x27;<br>  &#125;,<br>  &#123;<br>      height: 300,<br>      background: &#x27;gray&#x27;<br>  &#125;,<br>  &#123;<br>      height: 400,<br>      background: &#x27;#CC00FF&#x27;<br>  &#125;,<br>  &#123;<br>      height: 200,<br>      background: &#x27;black&#x27;<br>  &#125;,<br>  &#123;<br>      height: 100,<br>      background: &#x27;#996666&#x27;<br>  &#125;,<br>  &#123;<br>      height: 500,<br>      background: &#x27;skyblue&#x27;<br>  &#125;,<br>  &#123;<br>      height: 300,<br>      background: &#x27;#993366&#x27;<br>  &#125;,<br>  &#123;<br>      height: 100,<br>      background: &#x27;#33FF33&#x27;<br>  &#125;,<br>  &#123;<br>      height: 400,<br>      background: &#x27;skyblue&#x27;<br>  &#125;,<br>  &#123;<br>      height: 200,<br>      background: &#x27;#6633CC&#x27;<br>  &#125;,<br>  &#123;<br>      height: 300,<br>      background: &#x27;#666699&#x27;<br>  &#125;,<br>  &#123;<br>      height: 300,<br>      background: &#x27;#66CCFF&#x27;<br>  &#125;,<br>  &#123;<br>      height: 300,<br>      background: &#x27;skyblue&#x27;<br>  &#125;,<br>  &#123;<br>      height: 200,<br>      background: &#x27;#CC3366&#x27;<br>  &#125;,<br>  &#123;<br>      height: 200,<br>      background: &#x27;#CC9966&#x27;<br>  &#125;,<br>  &#123;<br>      height: 200,<br>      background: &#x27;#FF00FF&#x27;<br>  &#125;,<br>  &#123;<br>      height: 500,<br>      background: &#x27;#990000&#x27;<br>  &#125;,<br>  &#123;<br>      height: 400,<br>      background: &#x27;red&#x27;<br>  &#125;,<br>  &#123;<br>      height: 100,<br>      background: &#x27;#999966&#x27;<br>  &#125;,<br>  &#123;<br>      height: 200,<br>      background: &#x27;#CCCC66&#x27;<br>  &#125;,<br>  &#123;<br>      height: 300,<br>      background: &#x27;#FF33FF&#x27;<br>  &#125;,<br>  &#123;<br>      height: 400,<br>      background: &#x27;#FFFF66&#x27;<br>  &#125;,<br>  &#123;<br>      height: 200,<br>      background: &#x27;red&#x27;<br>  &#125;,<br>  &#123;<br>      height: 100,<br>      background: &#x27;skyblue&#x27;<br>  &#125;,<br>  &#123;<br>      height: 200,<br>      background: &#x27;#33CC00&#x27;<br>  &#125;,<br>  &#123;<br>      height: 300,<br>      background: &#x27;#330033&#x27;<br>  &#125;,<br>  &#123;<br>      height: 100,<br>      background: &#x27;#0066CC&#x27;<br>  &#125;,<br>  &#123;<br>      height: 200,<br>      background: &#x27;skyblue&#x27;<br>  &#125;,<br>  &#123;<br>      height: 100,<br>      background: &#x27;#006666&#x27;<br>  &#125;,<br>  &#123;<br>      height: 200,<br>      background: &#x27;yellow&#x27;<br>  &#125;,<br>  &#123;<br>      height: 300,<br>      background: &#x27;yellow&#x27;<br>  &#125;,<br>  &#123;<br>      height: 100,<br>      background: &#x27;#33CCFF&#x27;<br>  &#125;,<br>  &#123;<br>      height: 400,<br>      background: &#x27;yellow&#x27;<br>  &#125;,<br>  &#123;<br>      height: 400,<br>      background: &#x27;yellow&#x27;<br>  &#125;,<br>  &#123;<br>      height: 200,<br>      background: &#x27;#33FF00&#x27;<br>  &#125;,<br>  &#123;<br>      height: 300,<br>      background: &#x27;yellow&#x27;<br>  &#125;,<br>  &#123;<br>      height: 100,<br>      background: &#x27;green&#x27;<br>  &#125;<br><br>]<br>&lt;/script&gt;<br><br>&lt;style  lang=&#x27;less&#x27;&gt;<br>#app,<br>html,<br>body &#123;<br>  height: 100%;<br>&#125;<br><br>* &#123;<br>  padding: 0;<br>  margin: 0;<br>&#125;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure><p>子组件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>    &lt;div class=&quot;wraps&quot;&gt;<br>        &lt;div :style=&quot;&#123;height:item.height+&#x27;px&#x27;,background:item.background,top:item.top+&#x27;px&#x27;,left:item.left + &#x27;px&#x27;&#125;&quot;<br>            v-for=&quot;item in waterList&quot; class=&quot;items&quot;&gt;&lt;/div&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br> <br>&lt;script setup lang=&#x27;ts&#x27;&gt;<br>import &#123; ref, reactive, onMounted &#125; from &#x27;vue&#x27;<br>const props = defineProps&lt;&#123;<br>    list: any[]<br>&#125;&gt;()<br>const waterList = reactive&lt;any[]&gt;([])<br>const init = () =&gt; &#123;<br>    const heightList: any[] = []<br>    const width = 130;<br>    const x = document.body.clientWidth<br>    const column = Math.floor(x / width)<br> <br>    for (let i = 0; i &lt; props.list.length; i++) &#123;<br>        if (i &lt; column) &#123;<br>            props.list[i].top = 10;<br>            props.list[i].left = i * width;<br>            heightList.push(props.list[i].height + 10)<br>            waterList.push(props.list[i])<br>        &#125; else &#123;<br>            let current = heightList[0]<br>            let index = 0;<br>            heightList.forEach((h, inx) =&gt; &#123;<br>                if (current &gt; h) &#123;<br>                    current = h;<br>                    index = inx;<br>                &#125;<br>            &#125;)<br>            console.log(current,&#x27;c&#x27;)<br>            props.list[i].top = (current + 20);<br>            console.log(props.list[i].top,&#x27;top&#x27;,i)<br>            props.list[i].left = index * width;<br>            heightList[index] =  (heightList[index] + props.list[i].height + 20);<br>            waterList.push(props.list[i])<br>        <br>        &#125;<br>    &#125;<br>    console.log(props.list)<br>&#125;<br> <br>onMounted(() =&gt; &#123;<br>    window.onresize = () =&gt; init()<br>    init()<br>&#125;)<br> <br>&lt;/script&gt;<br> <br>&lt;style scoped lang=&#x27;less&#x27;&gt;<br>.wraps &#123;<br>    position: relative;<br>     height: 100%;<br>    .items &#123;<br>        position: absolute;<br>        width: 120px;<br>    &#125;<br>&#125;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure><h3 id="8、兄弟组件传参和bus"><a href="#8、兄弟组件传参和bus" class="headerlink" title="8、兄弟组件传参和bus"></a>8、兄弟组件传参和bus</h3><h4 id="借助父组件传参"><a href="#借助父组件传参" class="headerlink" title="借助父组件传参"></a>借助父组件传参</h4><p>例如父组件为App 子组件为A 和 B他两个是同级的</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>    &lt;div&gt;<br>        &lt;A @on-click=&quot;getFalg&quot;&gt;&lt;/A&gt;<br>        &lt;B :flag=&quot;Flag&quot;&gt;&lt;/B&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br>    <br>&lt;script setup lang=&#x27;ts&#x27;&gt;<br>import A from &#x27;./components/A.vue&#x27;<br>import B from &#x27;./components/B.vue&#x27;<br>import &#123; ref &#125; from &#x27;vue&#x27;<br>let Flag = ref&lt;boolean&gt;(false)<br>const getFalg = (flag: boolean) =&gt; &#123;<br>   Flag.value = flag;<br>&#125;<br>&lt;/script&gt;<br>    <br>&lt;style&gt;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure><p>A 组件派发事件通过App.vue 接受A组件派发的事件然后在Props 传给B组件 也是可以实现的</p><p>缺点就是比较麻烦 ，无法直接通信，只能充当桥梁</p><h4 id="Event-Bus"><a href="#Event-Bus" class="headerlink" title="Event Bus"></a>Event Bus</h4><p>我们在<a href="https://so.csdn.net/so/search?q=Vue2&spm=1001.2101.3001.7020">Vue2</a> 可以使用$emit 传递 $on监听 emit传递过来的事件</p><p>这个原理其实是运用了<a href="https://so.csdn.net/so/search?q=JS%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F&spm=1001.2101.3001.7020">JS设计模式</a>之发布订阅模式</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs vue"> <br>type BusClass&lt;T&gt; = &#123;<br>    emit: (name: T) =&gt; void<br>    on: (name: T, callback: Function) =&gt; void<br>&#125;<br>type BusParams = string | number | symbol <br>type List = &#123;<br>    [key: BusParams]: Array&lt;Function&gt;<br>&#125;<br>class Bus&lt;T extends BusParams&gt; implements BusClass&lt;T&gt; &#123;<br>    list: List<br>    constructor() &#123;<br>        this.list = &#123;&#125;<br>    &#125;<br>    emit(name: T, ...args: Array&lt;any&gt;) &#123;<br>        let eventName: Array&lt;Function&gt; = this.list[name]<br>        eventName.forEach(ev =&gt; &#123;<br>            ev.apply(this, args)<br>        &#125;)<br>    &#125;<br>    on(name: T, callback: Function) &#123;<br>        let fn: Array&lt;Function&gt; = this.list[name] || [];<br>        fn.push(callback)<br>        this.list[name] = fn<br>    &#125;<br>&#125;<br> <br>export default new Bus&lt;number&gt;()<br></code></pre></td></tr></table></figure><p>然后挂载到Vue config 全局就可以使用啦</p><blockquote><p>注：在vue3当中，$on，$off，$once实例方法已被移除，组件实例不再实现事件触发接口，因此EventBus便无法使用</p><p>可以使用Mitt库实现</p></blockquote><h4 id="Mitt"><a href="#Mitt" class="headerlink" title="Mitt"></a>Mitt</h4><p>在vue3中$on，$off 和 $once 实例方法已被移除，组件实例不再实现事件触发接口，因此大家熟悉的EventBus便无法使用了。然而我们习惯了使用EventBus，对于这种情况我们可以使用Mitt库（其实就是我们视频中讲的发布订阅模式的设计）</p><h5 id="1-安装"><a href="#1-安装" class="headerlink" title="1.安装"></a>1.安装</h5><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmake">npm <span class="hljs-keyword">install</span> mitt -S<br></code></pre></td></tr></table></figure><h5 id="2-main-ts-初始化"><a href="#2-main-ts-初始化" class="headerlink" title="2.main.ts 初始化"></a>2.main.ts 初始化</h5><p>全局总线，vue 入口文件 main.js 中挂载全局属性</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> &#123; createApp &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./App.vue&#x27;</span><br><span class="hljs-keyword">import</span> mitt <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;mitt&#x27;</span><br><br><span class="hljs-keyword">const</span> <span class="hljs-title class_">Mit</span> = <span class="hljs-title function_">mitt</span>()<br><br><span class="hljs-comment">//TypeScript注册</span><br><span class="hljs-comment">// 由于必须要拓展ComponentCustomProperties类型才能获得类型提示</span><br><span class="hljs-keyword">declare</span> <span class="hljs-variable language_">module</span> <span class="hljs-string">&quot;vue&quot;</span> &#123;<br>    <span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ComponentCustomProperties</span> &#123;<br>        <span class="hljs-attr">$Bus</span>: <span class="hljs-keyword">typeof</span> <span class="hljs-title class_">Mit</span><br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>)<br><br><span class="hljs-comment">//Vue3挂载全局API</span><br>app.<span class="hljs-property">config</span>.<span class="hljs-property">globalProperties</span>.<span class="hljs-property">$Bus</span> = <span class="hljs-title class_">Mit</span><br><br>app.<span class="hljs-title function_">mount</span>(<span class="hljs-string">&#x27;#app&#x27;</span>)<br></code></pre></td></tr></table></figure><h5 id="3使用方法通过emit派发，-on-方法添加事件，off-方法移除，clear-清空所有"><a href="#3使用方法通过emit派发，-on-方法添加事件，off-方法移除，clear-清空所有" class="headerlink" title="3使用方法通过emit派发， on 方法添加事件，off 方法移除，clear 清空所有"></a>3使用方法通过emit派发， on 方法添加事件，off 方法移除，clear 清空所有</h5><p>A组件派发（emit）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>    &lt;div&gt;<br>        &lt;h1&gt;我是A&lt;/h1&gt;<br>        &lt;button @click=&quot;emit1&quot;&gt;emit1&lt;/button&gt;<br>        &lt;button @click=&quot;emit2&quot;&gt;emit2&lt;/button&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br><br>&lt;script setup lang=&#x27;ts&#x27;&gt;<br>import &#123; getCurrentInstance &#125; from &#x27;vue&#x27;<br>const instance = getCurrentInstance();<br>const emit1 = () =&gt; &#123;<br>    instance?.proxy?.$Bus.emit(&#x27;on-num&#x27;, 100)<br>&#125;<br>const emit2 = () =&gt; &#123;<br>    instance?.proxy?.$Bus.emit(&#x27;*****&#x27;, 500)<br>&#125;<br>&lt;/script&gt;<br><br>&lt;style&gt;<br>&lt;/style&gt; <br></code></pre></td></tr></table></figure><p>B组件监听（on）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>    &lt;div&gt;<br>        &lt;h1&gt;我是B&lt;/h1&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br><br>&lt;script setup lang=&#x27;ts&#x27;&gt;<br>import &#123; getCurrentInstance &#125; from &#x27;vue&#x27;<br>const instance = getCurrentInstance()<br>instance?.proxy?.$Bus.on(&#x27;on-num&#x27;, (num) =&gt; &#123;<br>    console.log(num,&#x27;===========&gt;B&#x27;)<br>&#125;)<br>&lt;/script&gt;<br><br>&lt;style&gt;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure><p>监听所有事件（ on(“*”) ）</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ts">instance?.<span class="hljs-property">proxy</span>?.<span class="hljs-property">$Bus</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;*&#x27;</span>,<span class="hljs-function">(<span class="hljs-params"><span class="hljs-keyword">type</span>,num</span>)=&gt;</span>&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">type</span>,num,<span class="hljs-string">&#x27;===========&gt;B&#x27;</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><p>移除监听事件（off）</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> <span class="hljs-title function_">Fn</span> = (<span class="hljs-params">num: <span class="hljs-built_in">any</span></span>) =&gt; &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num, <span class="hljs-string">&#x27;===========&gt;B&#x27;</span>)<br>&#125;<br>instance?.<span class="hljs-property">proxy</span>?.<span class="hljs-property">$Bus</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;on-num&#x27;</span>,<span class="hljs-title class_">Fn</span>)<span class="hljs-comment">//listen</span><br>instance?.<span class="hljs-property">proxy</span>?.<span class="hljs-property">$Bus</span>.<span class="hljs-title function_">off</span>(<span class="hljs-string">&#x27;on-num&#x27;</span>,<span class="hljs-title class_">Fn</span>)<span class="hljs-comment">//unListen</span><br></code></pre></td></tr></table></figure><p>清空所有监听（clear）</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ts">instance?.<span class="hljs-property">proxy</span>?.<span class="hljs-property">$Bus</span>.<span class="hljs-property">all</span>.<span class="hljs-title function_">clear</span>()<br></code></pre></td></tr></table></figure><h3 id="9、插槽"><a href="#9、插槽" class="headerlink" title="9、插槽"></a>9、插槽</h3><p>插槽就是子组件中的提供给父组件使用的一个占位符，用<slot></slot> 表示，父组件可以在这个占位符中填充任何模板代码，如 HTML、组件等，填充的内容会替换子组件的<slot></slot>标签。</p><h4 id="匿名插槽"><a href="#匿名插槽" class="headerlink" title="匿名插槽"></a>匿名插槽</h4><p>1.在子组件放置一个插槽</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>    &lt;div&gt;<br>       &lt;slot&gt;&lt;/slot&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br></code></pre></td></tr></table></figure><p>父组件使用插槽</p><p>在父组件给这个插槽填充内容</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;Dialog&gt;<br>   &lt;template v-slot&gt;<br>       &lt;div&gt;2132&lt;/div&gt;<br>   &lt;/template&gt;<br>&lt;/Dialog&gt;<br></code></pre></td></tr></table></figure><h4 id="具名插槽"><a href="#具名插槽" class="headerlink" title="具名插槽"></a>具名插槽</h4><p>具名插槽其实就是给插槽取个名字。一个子组件可以放多个插槽，而且可以放在不同的地方，而父组件填充内容时，可以根据这个名字把内容填充到对应插槽中</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;div&gt;<br>    &lt;slot name=&quot;header&quot;&gt;&lt;/slot&gt;<br>    &lt;slot&gt;&lt;/slot&gt;<br> <br>    &lt;slot name=&quot;footer&quot;&gt;&lt;/slot&gt;<br>&lt;/div&gt;<br></code></pre></td></tr></table></figure><p>父组件使用需对应名称</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;Dialog&gt;<br>    &lt;template v-slot:header&gt;<br>       &lt;div&gt;1&lt;/div&gt;<br>   &lt;/template&gt;<br>   &lt;template v-slot&gt;<br>       &lt;div&gt;2&lt;/div&gt;<br>   &lt;/template&gt;<br>   &lt;template v-slot:footer&gt;<br>       &lt;div&gt;3&lt;/div&gt;<br>   &lt;/template&gt;<br>&lt;/Dialog&gt;<br></code></pre></td></tr></table></figure><p> 插槽简写</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;Dialog&gt;<br>    &lt;template #header&gt;<br>       &lt;div&gt;1&lt;/div&gt;<br>   &lt;/template&gt;<br>   &lt;template #default&gt;<br>       &lt;div&gt;2&lt;/div&gt;<br>   &lt;/template&gt;<br>   &lt;template #footer&gt;<br>       &lt;div&gt;3&lt;/div&gt;<br>   &lt;/template&gt;<br>&lt;/Dialog&gt;<br></code></pre></td></tr></table></figure><h4 id="作用域插槽"><a href="#作用域插槽" class="headerlink" title="作用域插槽"></a>作用域插槽</h4><p>在子组件动态绑定参数 派发给父组件的slot去使用</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;div&gt;<br>    &lt;slot name=&quot;header&quot;&gt;&lt;/slot&gt;<br>    &lt;div&gt;<br>        &lt;div v-for=&quot;item in 100&quot;&gt;<br>            &lt;slot :data=&quot;item&quot;&gt;&lt;/slot&gt;<br>        &lt;/div&gt;<br>    &lt;/div&gt;<br> <br>    &lt;slot name=&quot;footer&quot;&gt;&lt;/slot&gt;<br>&lt;/div&gt;<br></code></pre></td></tr></table></figure><p>通过结构方式取值</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs vue"> &lt;Dialog&gt;<br>    &lt;template #header&gt;<br>        &lt;div&gt;1&lt;/div&gt;<br>    &lt;/template&gt;<br>    &lt;template #default=&quot;&#123; data &#125;&quot;&gt;<br>        &lt;div&gt;&#123;&#123; data &#125;&#125;&lt;/div&gt;<br>    &lt;/template&gt;<br>    &lt;template #footer&gt;<br>        &lt;div&gt;3&lt;/div&gt;<br>    &lt;/template&gt;<br>&lt;/Dialog&gt;<br></code></pre></td></tr></table></figure><h4 id="动态插槽"><a href="#动态插槽" class="headerlink" title="动态插槽"></a>动态插槽</h4><p>插槽可以是一个变量名</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;Dialog&gt;<br>    &lt;template #[name]&gt;<br>        &lt;div&gt;<br>            23<br>        &lt;/div&gt;<br>    &lt;/template&gt;<br>&lt;/Dialog&gt;<br></code></pre></td></tr></table></figure><h3 id="10、v-model"><a href="#10、v-model" class="headerlink" title="10、v-model"></a>10、v-model</h3><p>在Vue3 v-model 是破坏性更新的</p><p>v-model在组件里面也是很重要的</p><p>v-model 其实是一个语法糖 通过props 和 emit组合而成的</p><p>1.默认值的改变</p><ul><li><p>prop：value -&gt; modelValue；</p></li><li><p>事件：input -&gt; update:modelValue；</p></li><li><p>v-bind 的 .sync 修饰符和组件的 model 选项已移除</p></li><li><p>新增 支持多个v-model</p></li><li><p>新增 支持自定义 修饰符 Modifiers</p></li></ul><h4 id="案例-1"><a href="#案例-1" class="headerlink" title="案例"></a>案例</h4><p>子组件 </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>     &lt;div v-if=&#x27;propData.modelValue &#x27; class=&quot;dialog&quot;&gt;<br>         &lt;div class=&quot;dialog-header&quot;&gt;<br>             &lt;div&gt;标题&lt;/div&gt;&lt;div @click=&quot;close&quot;&gt;x&lt;/div&gt;<br>         &lt;/div&gt;<br>         &lt;div class=&quot;dialog-content&quot;&gt;<br>            内容<br>         &lt;/div&gt;<br>         <br>     &lt;/div&gt;<br>&lt;/template&gt;<br> <br>&lt;script setup lang=&#x27;ts&#x27;&gt;<br> <br>type Props = &#123;<br>   modelValue:boolean<br>&#125;<br> <br>const propData = defineProps&lt;Props&gt;()<br> <br>const emit = defineEmits([&#x27;update:modelValue&#x27;])<br> <br>const close = () =&gt; &#123;<br>     emit(&#x27;update:modelValue&#x27;,false)<br>&#125;<br> <br>&lt;/script&gt;<br> <br>&lt;style lang=&#x27;less&#x27;&gt;<br>.dialog&#123;<br>    width: 300px;<br>    height: 300px;<br>    border: 1px solid #ccc;<br>    position: fixed;<br>    left:50%;<br>    top:50%;<br>    transform: translate(-50%,-50%);<br>    &amp;-header&#123;<br>        border-bottom: 1px solid #ccc;<br>        display: flex;<br>        justify-content: space-between;<br>        padding: 10px;<br>    &#125;<br>    &amp;-content&#123;<br>        padding: 10px;<br>    &#125;<br>&#125;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure><p>父组件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;button @click=&quot;show = !show&quot;&gt;开关&#123;&#123;show&#125;&#125;&lt;/button&gt;<br>  &lt;Dialog v-model=&quot;show&quot;&gt;&lt;/Dialog&gt;<br>&lt;/template&gt;<br> <br>&lt;script setup lang=&#x27;ts&#x27;&gt;<br>import Dialog from &quot;./components/Dialog/index.vue&quot;;<br>import &#123;ref&#125; from &#x27;vue&#x27;<br>const show = ref(false)<br>&lt;/script&gt;<br> <br>&lt;style&gt;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure><h4 id="绑定多个案例"><a href="#绑定多个案例" class="headerlink" title="绑定多个案例"></a>绑定多个案例</h4><p> 子组件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>     &lt;div v-if=&#x27;modelValue &#x27; class=&quot;dialog&quot;&gt;<br>         &lt;div class=&quot;dialog-header&quot;&gt;<br>             &lt;div&gt;标题---&#123;&#123;title&#125;&#125;&lt;/div&gt;&lt;div @click=&quot;close&quot;&gt;x&lt;/div&gt;<br>         &lt;/div&gt;<br>         &lt;div class=&quot;dialog-content&quot;&gt;<br>            内容<br>         &lt;/div&gt;<br>         <br>     &lt;/div&gt;<br>&lt;/template&gt;<br> <br>&lt;script setup lang=&#x27;ts&#x27;&gt;<br> <br>type Props = &#123;<br>   modelValue:boolean,<br>   title:string<br>&#125;<br> <br>const propData = defineProps&lt;Props&gt;()<br> <br>const emit = defineEmits([&#x27;update:modelValue&#x27;,&#x27;update:title&#x27;])<br> <br>const close = () =&gt; &#123;<br>     emit(&#x27;update:modelValue&#x27;,false)<br>     emit(&#x27;update:title&#x27;,&#x27;我要改变&#x27;)<br>&#125;<br> <br>&lt;/script&gt;<br> <br>&lt;style lang=&#x27;less&#x27;&gt;<br>.dialog&#123;<br>    width: 300px;<br>    height: 300px;<br>    border: 1px solid #ccc;<br>    position: fixed;<br>    left:50%;<br>    top:50%;<br>    transform: translate(-50%,-50%);<br>    &amp;-header&#123;<br>        border-bottom: 1px solid #ccc;<br>        display: flex;<br>        justify-content: space-between;<br>        padding: 10px;<br>    &#125;<br>    &amp;-content&#123;<br>        padding: 10px;<br>    &#125;<br>&#125;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure><p>父组件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;button @click=&quot;show = !show&quot;&gt;开关&#123;&#123;show&#125;&#125; ----- &#123;&#123;title&#125;&#125;&lt;/button&gt;<br>  &lt;Dialog v-model:title=&#x27;title&#x27; v-model=&quot;show&quot;&gt;&lt;/Dialog&gt;<br>&lt;/template&gt;<br> <br>&lt;script setup lang=&#x27;ts&#x27;&gt;<br>import Dialog from &quot;./components/Dialog/index.vue&quot;;<br>import &#123;ref&#125; from &#x27;vue&#x27;<br>const show = ref(false)<br>const title = ref(&#x27;我是标题&#x27;)<br>&lt;/script&gt;<br> <br>&lt;style&gt;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure><h4 id="自定义修饰符"><a href="#自定义修饰符" class="headerlink" title="自定义修饰符"></a>自定义修饰符</h4><p>添加到组件 <code>v-model</code> 的修饰符将通过 <code>modelModifiers</code> prop 提供给组件。在下面的示例中，我们创建了一个组件，其中包含默认为空对象的 <code>modelModifiers</code> prop</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;script setup lang=&#x27;ts&#x27;&gt;<br> <br>type Props = &#123;<br>    modelValue: boolean,<br>    title?: string,<br>    modelModifiers?: &#123;<br>        default: () =&gt; &#123;&#125;<br>    &#125;<br>    titleModifiers?: &#123;<br>        default: () =&gt; &#123;&#125;<br>    &#125;<br> <br>&#125;<br> <br>const propData = defineProps&lt;Props&gt;()<br> <br>const emit = defineEmits([&#x27;update:modelValue&#x27;, &#x27;update:title&#x27;])<br> <br>const close = () =&gt; &#123;<br>    console.log(propData.modelModifiers);<br> <br>    emit(&#x27;update:modelValue&#x27;, false)<br>    emit(&#x27;update:title&#x27;, &#x27;我要改变&#x27;)<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="11、自定义指令directive"><a href="#11、自定义指令directive" class="headerlink" title="11、自定义指令directive"></a>11、自定义指令directive</h3><blockquote><p>属于破坏性更新</p></blockquote><h4 id="1-Vue3指令的钩子函数"><a href="#1-Vue3指令的钩子函数" class="headerlink" title="1.Vue3指令的钩子函数"></a>1.Vue3指令的钩子函数</h4><ul><li>created 元素初始化的时候</li><li>beforeMount 指令绑定到元素后调用 只调用一次</li><li>mounted 元素插入父级dom调用</li><li>beforeUpdate 元素被更新之前调用</li><li>update 这个周期方法被移除 改用updated</li><li>beforeUnmount 在元素被移除前调用</li><li>unmounted 指令被移除后调用 只调用一次</li></ul><p>Vue2 指令 bind inserted update componentUpdated unbind</p><h4 id="2-在setup内定义局部指令"><a href="#2-在setup内定义局部指令" class="headerlink" title="2.在setup内定义局部指令"></a>2.在setup内定义局部指令</h4><p>但这里有一个需要注意的限制：必须以 <code>vNameOfDirective</code> 的形式来命名本地自定义指令，以使得它们可以直接在模板中使用。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;button @click=&quot;show = !show&quot;&gt;开关&#123;&#123;show&#125;&#125; ----- &#123;&#123;title&#125;&#125;&lt;/button&gt;<br>  &lt;Dialog  v-move-directive=&quot;&#123;background:&#x27;green&#x27;,flag:show&#125;&quot;&gt;&lt;/Dialog&gt;<br>&lt;/template&gt;<br></code></pre></td></tr></table></figure><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs ts"> <br><span class="hljs-keyword">const</span> <span class="hljs-attr">vMoveDirective</span>: <span class="hljs-title class_">Directive</span> = &#123;<br>  <span class="hljs-attr">created</span>: <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;初始化====&gt;&quot;</span>);<br>  &#125;,<br>  <span class="hljs-title function_">beforeMount</span>(<span class="hljs-params">...args: <span class="hljs-built_in">Array</span>&lt;<span class="hljs-built_in">any</span>&gt;</span>) &#123;<br>    <span class="hljs-comment">// 在元素上做些操作</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;初始化一次=======&gt;&quot;</span>);<br>  &#125;,<br>  <span class="hljs-title function_">mounted</span>(<span class="hljs-params">el: <span class="hljs-built_in">any</span>, dir: DirectiveBinding&lt;Value&gt;</span>) &#123;<br>    el.<span class="hljs-property">style</span>.<span class="hljs-property">background</span> = dir.<span class="hljs-property">value</span>.<span class="hljs-property">background</span>;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;初始化========&gt;&quot;</span>);<br>  &#125;,<br>  <span class="hljs-title function_">beforeUpdate</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;更新之前&quot;</span>);<br>  &#125;,<br>  <span class="hljs-title function_">updated</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;更新结束&quot;</span>);<br>  &#125;,<br>  <span class="hljs-title function_">beforeUnmount</span>(<span class="hljs-params">...args: <span class="hljs-built_in">Array</span>&lt;<span class="hljs-built_in">any</span>&gt;</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(args);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;======&gt;卸载之前&quot;</span>);<br>  &#125;,<br>  <span class="hljs-title function_">unmounted</span>(<span class="hljs-params">...args: <span class="hljs-built_in">Array</span>&lt;<span class="hljs-built_in">any</span>&gt;</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(args);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;======&gt;卸载完成&quot;</span>);<br>  &#125;,<br>&#125;;<br></code></pre></td></tr></table></figure><h4 id="3-生命周期钩子参数详解"><a href="#3-生命周期钩子参数详解" class="headerlink" title="3.生命周期钩子参数详解"></a>3.生命周期钩子参数详解</h4><p>第一个 el  当前绑定的DOM 元素</p><p>第二个 binding</p><ul><li>instance：使用指令的组件实例。</li><li>value：传递给指令的值。例如，在 v-my-directive&#x3D;”1 + 1” 中，该值为 2。</li><li>oldValue：先前的值，仅在 beforeUpdate 和 updated 中可用。无论值是否有更改都可用。</li><li>arg：传递给指令的参数(如果有的话)。例如在 v-my-directive:foo 中，arg 为 “foo”。</li><li>modifiers：包含修饰符(如果有的话) 的对象。例如在 v-my-directive.foo.bar 中，修饰符对象为 {foo: true，bar: true}。</li><li>dir：一个对象，在注册指令时作为参数传递。例如，在以下指令中</li></ul><p><img src="/../img/vue/f9e5558801104f81ac32c54d6cf5f587.png" alt="img"></p><p>第三个 当前元素的虚拟DOM 也就是Vnode</p><p>第四个 prevNode 上一个虚拟节点，仅在 beforeUpdate 和 updated 钩子中可用 </p><h4 id="4-函数简写"><a href="#4-函数简写" class="headerlink" title="4.函数简写"></a>4.函数简写</h4><p>你可能想在 <code>mounted</code> 和 <code>updated</code> 时触发相同行为，而不关心其他的钩子函数。那么你可以通过将这个函数模式实现</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>   &lt;div&gt;<br>      &lt;input v-model=&quot;value&quot; type=&quot;text&quot; /&gt;<br>      &lt;A v-move=&quot;&#123; background: value &#125;&quot;&gt;&lt;/A&gt;<br>   &lt;/div&gt;<br>&lt;/template&gt;<br>   <br>&lt;script setup lang=&#x27;ts&#x27;&gt;<br>import A from &#x27;./components/A.vue&#x27;<br>import &#123; ref, Directive, DirectiveBinding &#125; from &#x27;vue&#x27;<br>let value = ref&lt;string&gt;(&#x27;&#x27;)<br>type Dir = &#123;<br>   background: string<br>&#125;<br>const vMove: Directive = (el, binding: DirectiveBinding&lt;Dir&gt;) =&gt; &#123;<br>   el.style.background = binding.value.background<br>&#125;<br>&lt;/script&gt;<br> <br>&lt;style&gt;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure><h5 id="1-案例自定义拖拽指令"><a href="#1-案例自定义拖拽指令" class="headerlink" title="1.案例自定义拖拽指令"></a>1.案例自定义拖拽指令</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;div v-move class=&quot;box&quot;&gt;<br>    &lt;div class=&quot;header&quot;&gt;&lt;/div&gt;<br>    &lt;div&gt;<br>      内容<br>    &lt;/div&gt;<br>  &lt;/div&gt;<br>&lt;/template&gt;<br> <br>&lt;script setup lang=&#x27;ts&#x27;&gt;<br>import &#123; Directive &#125; from &quot;vue&quot;;<br>const vMove: Directive = &#123;<br>  mounted(el: HTMLElement) &#123;<br>    let moveEl = el.firstElementChild as HTMLElement;<br>    const mouseDown = (e: MouseEvent) =&gt; &#123;<br>      //鼠标点击物体那一刻相对于物体左侧边框的距离=点击时的位置相对于浏览器最左边的距离-物体左边框相对于浏览器最左边的距离<br>      console.log(e.clientX, e.clientY, &quot;-----起始&quot;, el.offsetLeft);<br>      let X = e.clientX - el.offsetLeft;<br>      let Y = e.clientY - el.offsetTop;<br>      const move = (e: MouseEvent) =&gt; &#123;<br>        el.style.left = e.clientX - X + &quot;px&quot;;<br>        el.style.top = e.clientY - Y + &quot;px&quot;;<br>        console.log(e.clientX, e.clientY, &quot;---改变&quot;);<br>      &#125;;<br>      document.addEventListener(&quot;mousemove&quot;, move);<br>      document.addEventListener(&quot;mouseup&quot;, () =&gt; &#123;<br>        document.removeEventListener(&quot;mousemove&quot;, move);<br>      &#125;);<br>    &#125;;<br>    moveEl.addEventListener(&quot;mousedown&quot;, mouseDown);<br>  &#125;,<br>&#125;;<br>&lt;/script&gt;<br> <br>&lt;style lang=&#x27;less&#x27;&gt;<br>.box &#123;<br>  position: fixed;<br>  left: 50%;<br>  top: 50%;<br>  transform: translate(-50%, -50%);<br>  width: 200px;<br>  height: 200px;<br>  border: 1px solid #ccc;<br>  .header &#123;<br>    height: 20px;<br>    background: black;<br>    cursor: move;<br>  &#125;<br>&#125;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure><h5 id="2-案例权限按钮"><a href="#2-案例权限按钮" class="headerlink" title="2.案例权限按钮"></a>2.案例权限按钮</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>   &lt;div class=&quot;btns&quot;&gt;<br>       &lt;button v-has-show=&quot;&#x27;shop:create&#x27;&quot;&gt;创建&lt;/button&gt;<br> <br>       &lt;button v-has-show=&quot;&#x27;shop:edit&#x27;&quot;&gt;编辑&lt;/button&gt;<br> <br>       &lt;button v-has-show=&quot;&#x27;shop:delete&#x27;&quot;&gt;删除&lt;/button&gt;<br>   &lt;/div&gt;<br>&lt;/template&gt;<br> <br>&lt;script setup lang=&#x27;ts&#x27;&gt;<br>import &#123; ref, reactive,  &#125; from &#x27;vue&#x27;<br>import type &#123;Directive&#125; from &#x27;vue&#x27;<br>//permission<br>localStorage.setItem(&#x27;userId&#x27;,&#x27;xiaoman-zs&#x27;)<br> <br>//mock后台返回的数据<br>const permission = [<br>    &#x27;xiaoman-zs:shop:edit&#x27;,<br>    &#x27;xiaoman-zs:shop:create&#x27;,<br>    &#x27;xiaoman-zs:shop:delete&#x27;<br>]<br>const userId = localStorage.getItem(&#x27;userId&#x27;) as string<br>const vHasShow:Directive&lt;HTMLElement,string&gt; = (el,bingding) =&gt; &#123;<br>   if(!permission.includes(userId+&#x27;:&#x27;+ bingding.value))&#123;<br>       el.style.display = &#x27;none&#x27;<br>   &#125;<br>&#125;<br> <br>&lt;/script&gt;<br> <br>&lt;style scoped lang=&#x27;less&#x27;&gt;<br>.btns&#123;<br>    button&#123;<br>        margin: 10px;<br>    &#125;<br>&#125;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure><h5 id="3-图片懒加载"><a href="#3-图片懒加载" class="headerlink" title="3.图片懒加载"></a>3.图片懒加载</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>    &lt;div&gt;<br>        &lt;div v-for=&quot;item in arr&quot;&gt;<br>            &lt;img height=&quot;500&quot; :data-index=&quot;item&quot; v-lazy=&quot;item&quot; width=&quot;360&quot; alt=&quot;&quot;&gt;<br>        &lt;/div&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br> <br>&lt;script setup lang=&#x27;ts&#x27;&gt;<br>import &#123; ref, reactive &#125; from &#x27;vue&#x27;<br>import type &#123; Directive &#125; from &#x27;vue&#x27;<br>const images: Record&lt;string, &#123; default: string &#125;&gt; = import.meta.globEager(&#x27;./assets/images/*.*&#x27;)<br>let arr = Object.values(images).map(v =&gt; v.default)<br> <br>let vLazy: Directive&lt;HTMLImageElement, string&gt; = async (el, binding) =&gt; &#123;<br>    let url = await import(&#x27;./assets/vue.svg&#x27;)<br>    el.src = url.default;<br>    let observer = new IntersectionObserver((entries) =&gt; &#123;<br>        console.log(entries[0], el)<br>        if (entries[0].intersectionRatio &gt; 0 &amp;&amp; entries[0].isIntersecting) &#123;<br>            setTimeout(() =&gt; &#123;<br>                el.src = binding.value;<br>                observer.unobserve(el)<br>            &#125;, 2000)<br>        &#125;<br>    &#125;)<br>    observer.observe(el)<br>&#125;<br> <br>&lt;/script&gt;<br> <br>&lt;style scoped lang=&#x27;less&#x27;&gt;&lt;/style&gt;<br></code></pre></td></tr></table></figure><h2 id="4、Composition-API-的优势"><a href="#4、Composition-API-的优势" class="headerlink" title="4、Composition API 的优势"></a>4、Composition API 的优势</h2><h3 id="1-Options-API-存在的问题"><a href="#1-Options-API-存在的问题" class="headerlink" title="1.Options API 存在的问题"></a>1.Options API 存在的问题</h3><p>使用传统OptionsAPI中，新增或者修改一个需求，就需要分别在data，methods，computed里修改 。</p><div style="width:600px;height:370px;overflow:hidden;float:left">    <img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f84e4e2c02424d9a99862ade0a2e4114~tplv-k3u1fbpfcp-watermark.image" style="width:600px;float:left" /></div><div style="width:300px;height:370px;overflow:hidden;float:left">    <img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e5ac7e20d1784887a826f6360768a368~tplv-k3u1fbpfcp-watermark.image" style="zoom:50%;width:560px;left" /> </div><h3 id="2-Composition-API-的优势"><a href="#2-Composition-API-的优势" class="headerlink" title="2.Composition API 的优势"></a>2.Composition API 的优势</h3><p>我们可以更加优雅的组织我们的代码，函数。让相关功能的代码更加有序的组织在一起。</p><div style="width:400px;height:300px;overflow:hidden;float:left">    <img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bc0be8211fc54b6c941c036791ba4efe~tplv-k3u1fbpfcp-watermark.image"style="height:360px"/></div><div style="width:430px;height:340px;overflow:hidden;float:left">    <img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6cc55165c0e34069a75fe36f8712eb80~tplv-k3u1fbpfcp-watermark.image"style="height:360px"/></div><h2 id="5、新的组件"><a href="#5、新的组件" class="headerlink" title="5、新的组件"></a>5、新的组件</h2><h3 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h3><h4 id="全局组件"><a href="#全局组件" class="headerlink" title="全局组件"></a>全局组件</h4><p>在main.ts文件中</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Card</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./components/Card.vue&#x27;</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> app = <span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>)<br>app.<span class="hljs-title function_">component</span>(<span class="hljs-string">&#x27;Card&#x27;</span>, <span class="hljs-title class_">Card</span>)<br></code></pre></td></tr></table></figure><h4 id="局部组件"><a href="#局部组件" class="headerlink" title="局部组件"></a>局部组件</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;div&gt;&lt;/div&gt;<br>  &lt;Card content=&#x27;123&#x27;&gt;&lt;/Card&gt;<br>&lt;/template&gt;<br><br>&lt;script setup lang=&#x27;ts&#x27;&gt;<br>import &#123; ref &#125; from &#x27;vue&#x27;<br>import Card from &#x27;./components/Card.vue&#x27;<br>&lt;/script&gt;<br><br>&lt;style scoped&gt;<br><br>&lt;/style&gt;<br></code></pre></td></tr></table></figure><h4 id="递归组件"><a href="#递归组件" class="headerlink" title="递归组件"></a>递归组件</h4><p>父组件</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">TreeList</span> = &#123;<br>  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;<br>  icon?: <span class="hljs-built_in">string</span>;<br>  children?: <span class="hljs-title class_">TreeList</span>[] | [];<br>&#125;;<br><span class="hljs-keyword">const</span> data = reactive&lt;<span class="hljs-title class_">TreeList</span>[]&gt;([<br>  &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;no.1&quot;</span>,<br>    <span class="hljs-attr">children</span>: [<br>      &#123;<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;no.1-1&quot;</span>,<br>        <span class="hljs-attr">children</span>: [<br>          &#123;<br>            <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;no.1-1-1&quot;</span>,<br>          &#125;,<br>        ],<br>      &#125;,<br>    ],<br>  &#125;,<br>  &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;no.2&quot;</span>,<br>    <span class="hljs-attr">children</span>: [<br>      &#123;<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;no.2-1&quot;</span>,<br>      &#125;,<br>    ],<br>  &#125;,<br>  &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;no.3&quot;</span>,<br>  &#125;,<br>]);<br></code></pre></td></tr></table></figure><p>子组件</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">TreeList</span> = &#123;<br>  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;<br>  icon?: <span class="hljs-built_in">string</span>;<br>  children?: <span class="hljs-title class_">TreeList</span>[] | [];<br>&#125;;<br> <br><span class="hljs-keyword">type</span> <span class="hljs-title class_">Props</span>&lt;T&gt; = &#123;<br>  data?: T[] | [];<br>&#125;;<br> <br>defineProps&lt;<span class="hljs-title class_">Props</span>&lt;<span class="hljs-title class_">TreeList</span>&gt;&gt;();<br><span class="hljs-keyword">const</span> <span class="hljs-title function_">clickItem</span> = (<span class="hljs-params">item: TreeList</span>) =&gt; &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(item)<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>子组件增加一个script 定义组件名称为了 递归用</strong> </p><p><strong>给我们的组件定义名称有好几种方式</strong></p><h5 id="1、在增加一个script-通过-export-添加name"><a href="#1、在增加一个script-通过-export-添加name" class="headerlink" title="1、在增加一个script 通过 export 添加name"></a>1、在增加一个script 通过 export 添加name</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;script lang=&quot;ts&quot;&gt;<br>export default &#123;<br>  name:&quot;TreeItem&quot;<br>&#125;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure><h5 id="2、直接使用文件名当组件名"><a href="#2、直接使用文件名当组件名" class="headerlink" title="2、直接使用文件名当组件名"></a>2、直接使用文件名当组件名</h5><p>3、在script加上name</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;script lang=&quot;ts&quot; name=&quot;TreeItem&quot;&gt;<br><br>&lt;/script&gt;<br></code></pre></td></tr></table></figure><h3 id="动态组件"><a href="#动态组件" class="headerlink" title="动态组件"></a>动态组件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;component :is=&quot;A&quot;&gt;&lt;/component&gt;<br><br>import A from &#x27;./A.vue&#x27;<br>import B from &#x27;./B.vue&#x27;<br></code></pre></td></tr></table></figure><h3 id="插件"><a href="#插件" class="headerlink" title="插件"></a>插件</h3><p>插件是自包含的代码，通常向 Vue 添加全局级功能。你如果是一个对象需要有install方法Vue会帮你自动注入到install 方法 你如果是function 就直接当install 方法去使用</p><h4 id="使用插件"><a href="#使用插件" class="headerlink" title="使用插件"></a>使用插件</h4><p>在使用 <code>createApp()</code> 初始化 Vue 应用程序后，你可以通过调用 <code>use()</code> 方法将插件添加到你的应用程序中。</p><p><strong>实现一个Loading</strong></p><h5 id="Loading-Vue"><a href="#Loading-Vue" class="headerlink" title="Loading.Vue"></a>Loading.Vue</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>    &lt;div v-if=&quot;isShow&quot; class=&quot;loading&quot;&gt;<br>        &lt;div class=&quot;loading-content&quot;&gt;Loading...&lt;/div&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br>    <br>&lt;script setup lang=&#x27;ts&#x27;&gt;<br>import &#123; ref &#125; from &#x27;vue&#x27;;<br>const isShow = ref(false)//定位loading 的开关<br> <br>const show = () =&gt; &#123;<br>    isShow.value = true<br>&#125;<br>const hide = () =&gt; &#123;<br>    isShow.value = false<br>&#125;<br>//对外暴露 当前组件的属性和方法<br>defineExpose(&#123;<br>    isShow,<br>    show,<br>    hide<br>&#125;)<br>&lt;/script&gt;<br> <br> <br>    <br>&lt;style scoped lang=&quot;less&quot;&gt;<br>.loading &#123;<br>    position: fixed;<br>    inset: 0;<br>    background: rgba(0, 0, 0, 0.8);<br>    display: flex;<br>    justify-content: center;<br>    align-items: center;<br>    &amp;-content &#123;<br>        font-size: 30px;<br>        color: #fff;<br>    &#125;<br>&#125;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure><h5 id="Loading-ts"><a href="#Loading-ts" class="headerlink" title="Loading.ts"></a>Loading.ts</h5><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> &#123;  createVNode, render, <span class="hljs-title class_">VNode</span>, <span class="hljs-title class_">App</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Loading</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./index.vue&#x27;</span><br> <br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>    <span class="hljs-title function_">install</span>(<span class="hljs-params">app: App</span>) &#123;<br>        <span class="hljs-comment">//createVNode vue提供的底层方法 可以给我们组件创建一个虚拟DOM 也就是Vnode</span><br>        <span class="hljs-keyword">const</span> <span class="hljs-attr">vnode</span>: <span class="hljs-title class_">VNode</span> = <span class="hljs-title function_">createVNode</span>(<span class="hljs-title class_">Loading</span>)<br>        <span class="hljs-comment">//render 把我们的Vnode 生成真实DOM 并且挂载到指定节点</span><br>        <span class="hljs-title function_">render</span>(vnode, <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>)<br>        <span class="hljs-comment">// Vue 提供的全局配置 可以自定义</span><br>        app.<span class="hljs-property">config</span>.<span class="hljs-property">globalProperties</span>.<span class="hljs-property">$loading</span> = &#123;<br>            <span class="hljs-attr">show</span>: <span class="hljs-function">() =&gt;</span> vnode.<span class="hljs-property">component</span>?.<span class="hljs-property">exposed</span>?.<span class="hljs-title function_">show</span>(),<br>            <span class="hljs-attr">hide</span>: <span class="hljs-function">() =&gt;</span> vnode.<span class="hljs-property">component</span>?.<span class="hljs-property">exposed</span>?.<span class="hljs-title function_">hide</span>()<br>        &#125;<br> <br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="Main-ts"><a href="#Main-ts" class="headerlink" title="Main.ts"></a>Main.ts</h5><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Loading</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./components/loading&#x27;</span><br> <br> <br><span class="hljs-keyword">let</span> app = <span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>)<br> <br>app.<span class="hljs-title function_">use</span>(<span class="hljs-title class_">Loading</span>)<br> <br> <br><span class="hljs-keyword">type</span> <span class="hljs-title class_">Lod</span> = &#123;<br>    <span class="hljs-attr">show</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>,<br>    <span class="hljs-attr">hide</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span><br>&#125;<br><span class="hljs-comment">//编写ts loading 声明文件放置报错 和 智能提示</span><br><span class="hljs-keyword">declare</span> <span class="hljs-variable language_">module</span> <span class="hljs-string">&#x27;@vue/runtime-core&#x27;</span> &#123;<br>    <span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ComponentCustomProperties</span> &#123;<br>        <span class="hljs-attr">$loading</span>: <span class="hljs-title class_">Lod</span><br>    &#125;<br>&#125;<br> <br>app.<span class="hljs-title function_">mount</span>(<span class="hljs-string">&#x27;#app&#x27;</span>)<br></code></pre></td></tr></table></figure><h5 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br> <br>  &lt;div&gt;&lt;/div&gt;<br> <br>&lt;/template&gt;<br> <br>&lt;script setup lang=&#x27;ts&#x27;&gt;<br>import &#123; ref,reactive,getCurrentInstance&#125; from &#x27;vue&#x27;<br>const  instance = getCurrentInstance()  <br>instance?.proxy?.$Loading.show()<br>setTimeout(()=&gt;&#123;<br>  instance?.proxy?.$Loading.hide()<br>&#125;,5000)<br> <br> <br>// console.log(instance)<br>&lt;/script&gt;<br>&lt;style&gt;<br>*&#123;<br>  padding: 0;<br>  margin: 0;<br>&#125;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure><h4 id="Vue-use-源码手写"><a href="#Vue-use-源码手写" class="headerlink" title="Vue use 源码手写"></a>Vue use 源码手写</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> &#123; <span class="hljs-title class_">App</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><span class="hljs-keyword">import</span> &#123; app &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./main&#x27;</span><br> <br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Use</span> &#123;<br>    <span class="hljs-attr">install</span>: <span class="hljs-function">(<span class="hljs-params">app: App, ...options: <span class="hljs-built_in">any</span>[]</span>) =&gt;</span> <span class="hljs-built_in">void</span><br>&#125;<br> <br><span class="hljs-keyword">const</span> installedList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>()<br> <br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title class_">MyUse</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Use</span>&gt;(<span class="hljs-attr">plugin</span>: T, ...<span class="hljs-attr">options</span>: <span class="hljs-built_in">any</span>[]) &#123;<br>    <span class="hljs-keyword">if</span>(installedList.<span class="hljs-title function_">has</span>(plugin))&#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">&#x27;重复添加插件&#x27;</span>,plugin)<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        plugin.<span class="hljs-title function_">install</span>(app, ...options)<br>        installedList.<span class="hljs-title function_">add</span>(plugin)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="1-Fragment"><a href="#1-Fragment" class="headerlink" title="1.Fragment"></a>1.Fragment</h3><ul><li>在Vue2中: 组件必须有一个根标签</li><li>在Vue3中: 组件可以没有根标签, 内部会将多个标签包含在一个Fragment虚拟元素中</li><li>好处: 减少标签层级, 减小内存占用</li></ul><h3 id="2-Teleport"><a href="#2-Teleport" class="headerlink" title="2.Teleport"></a>2.Teleport</h3><ul><li><p>什么是Teleport？—— <code>Teleport</code> 是一种能够将我们的<strong style="color:#DD5145">组件html结构</strong>移动到指定位置的技术。</p></li><li><p>这里把当前组件html结构移动到body位置，不会在组件位置显示</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;teleport to=&quot;body&quot;&gt;<br>  &lt;div v-if=&quot;isShow&quot; class=&quot;mask&quot;&gt;<br>    &lt;div class=&quot;dialog&quot;&gt;<br>      &lt;h3&gt;我是一个弹窗&lt;/h3&gt;<br>      &lt;button @click=&quot;isShow = false&quot;&gt;关闭弹窗&lt;/button&gt;<br>    &lt;/div&gt;<br>  &lt;/div&gt;<br>&lt;/teleport&gt;<br></code></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.mask</span> &#123;<br>  <span class="hljs-comment">/* 遮罩层铺满窗口 */</span><br>  <span class="hljs-attribute">position</span>: absolute;<br>  <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;<br>  <span class="hljs-attribute">bottom</span>: <span class="hljs-number">0</span>;<br>  <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;<br>  <span class="hljs-attribute">right</span>: <span class="hljs-number">0</span>;<br>  <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.5</span>);<br>&#125;<br><span class="hljs-selector-class">.dialog</span> &#123;<br>  <span class="hljs-attribute">position</span>: absolute;<br>  <span class="hljs-attribute">top</span>: <span class="hljs-number">50%</span>;<br>  <span class="hljs-attribute">left</span>: <span class="hljs-number">50%</span>;<br>  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translate</span>(-<span class="hljs-number">50%</span>, -<span class="hljs-number">50%</span>);<br>  <span class="hljs-attribute">text-align</span>: center;<br>  <span class="hljs-attribute">width</span>: <span class="hljs-number">300px</span>;<br>  <span class="hljs-attribute">height</span>: <span class="hljs-number">300px</span>;<br>  <span class="hljs-attribute">background-color</span>: green;<br>&#125;<br></code></pre></td></tr></table></figure></li></ul><h3 id="3-Suspense"><a href="#3-Suspense" class="headerlink" title="3.Suspense"></a>3.Suspense</h3><ul><li><p>等待异步组件时渲染一些额外内容，让应用有更好的用户体验</p></li><li><p>使用步骤：</p><ul><li><p>异步引入组件</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123;defineAsyncComponent&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><span class="hljs-comment">//静态引入</span><br><span class="hljs-keyword">const</span> <span class="hljs-title class_">Child</span> = <span class="hljs-title function_">defineAsyncComponent</span>(<span class="hljs-function">()=&gt;</span><span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;./components/Child.vue&#x27;</span>))<br></code></pre></td></tr></table></figure></li><li><p>使用<code>Suspense</code>包裹组件，并配置好<code>default</code> 与 <code>fallback</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>&lt;div class=&quot;app&quot;&gt;<br>&lt;h3&gt;我是App组件&lt;/h3&gt;<br>&lt;Suspense&gt;<br>            &lt;!-- 本应加载的 --&gt;<br>&lt;template v-slot:default&gt;<br>&lt;Child/&gt;<br>&lt;/template&gt;<br>&lt;!-- 本应加载的没有加载,这时就加载这个 --&gt;<br>&lt;template v-slot:fallback&gt;<br>&lt;h3&gt;加载中.....&lt;/h3&gt;<br>&lt;/template&gt;<br>&lt;/Suspense&gt;<br>&lt;/div&gt;<br>&lt;/template&gt;<br></code></pre></td></tr></table></figure></li><li><p>另外，若 <code>Child</code> 组件的 <code>setup</code> 函数返回一个 Promise 对象，也能渲染 <code>fallback</code> 里的内容：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">async</span> <span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">let</span> sum = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>)<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>      <span class="hljs-title function_">resolve</span>(&#123;sum&#125;)<br>    &#125;, <span class="hljs-number">3000</span>)<br>  &#125;)<br>&#125;<br></code></pre></td></tr></table></figure></li></ul></li></ul><h3 id="4-keep-alive"><a href="#4-keep-alive" class="headerlink" title="4.keep-alive"></a>4.keep-alive</h3><p>内置组件keep-alive<br>有时候我们不希望组件被重新渲染影响使用体验；或者处于性能考虑，避免多次重复渲染降低性能。而是希望组件可以缓存下来,维持当前的状态。这时候就需要用到keep-alive组件。</p><p>开启keep-alive 生命周期的变化</p><p>初次进入时： onMounted &gt; onActivated<br>退出后触发 onDeactivated<br>再次进入：<br>只会触发 onActivated<br>事件挂载的方法等，只执行一次的放在 onMounted中；组件每次进去执行的方法放在 onActivated中</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;!-- 基本 --&gt;<br>&lt;keep-alive&gt;<br>  &lt;component :is=&quot;view&quot;&gt;&lt;/component&gt;<br>&lt;/keep-alive&gt;<br> <br>&lt;!-- 多个条件判断的子组件 --&gt;<br>&lt;keep-alive&gt;<br>  &lt;comp-a v-if=&quot;a &gt; 1&quot;&gt;&lt;/comp-a&gt;<br>  &lt;comp-b v-else&gt;&lt;/comp-b&gt;<br>&lt;/keep-alive&gt;<br> <br>&lt;!-- 和 `&lt;transition&gt;` 一起使用 --&gt;<br>&lt;transition&gt;<br>  &lt;keep-alive&gt;<br>    &lt;component :is=&quot;view&quot;&gt;&lt;/component&gt;<br>  &lt;/keep-alive&gt;<br>&lt;/transition&gt;<br></code></pre></td></tr></table></figure><p>include 和 exclude</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;keep-alive :include=&quot;&quot; :exclude=&quot;&quot; :max=&quot;&quot;&gt;&lt;/keep-alive&gt;<br></code></pre></td></tr></table></figure><p>include 和 exclude 允许组件有条件地缓存。二者都可以用逗号分隔字符串、正则表达式或一个数组来表示：</p><p>max</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;keep-alive :max=&quot;10&quot;&gt;<br>  &lt;component :is=&quot;view&quot;&gt;&lt;/component&gt;<br>&lt;/keep-alive&gt;<br></code></pre></td></tr></table></figure><h3 id="5-transition动画组件"><a href="#5-transition动画组件" class="headerlink" title="5.transition动画组件"></a>5.transition动画组件</h3><p>Vue 提供了 transition 的封装组件，在下列情形中，可以给任何元素和组件添加进入&#x2F;离开过渡:</p><ul><li><p>条件渲染 (使用 v-if)</p></li><li><p>条件展示 (使用 v-show)</p></li><li><p>动态组件</p></li><li><p>组件根节点</p></li></ul><p>自定义 transition 过度效果，你需要对transition组件的name属性自定义。并在css中写入对应的样式</p><h4 id="1-过渡的类名"><a href="#1-过渡的类名" class="headerlink" title="1.过渡的类名"></a>1.过渡的类名</h4><p>在进入&#x2F;离开的过渡中，会有 6 个 class 切换。</p><ol><li><p>#过渡 class<br>在进入&#x2F;离开的过渡中，会有 6 个 class 切换。</p></li><li><p>v-enter-from：定义进入过渡的开始状态。在元素被插入之前生效，在元素被插入之后的下一帧移除。</p></li><li><p>v-enter-active：定义进入过渡生效时的状态。在整个进入过渡的阶段中应用，在元素被插入之前生效，在过渡&#x2F;动画完成之后移除。这个类可以被用来定义进入过渡的过程时间，延迟和曲线函数。</p></li><li><p>v-enter-to：定义进入过渡的结束状态。在元素被插入之后下一帧生效 (与此同时 v-enter-from 被移除)，在过渡&#x2F;动画完成之后移除。</p></li><li><p>v-leave-from：定义离开过渡的开始状态。在离开过渡被触发时立刻生效，下一帧被移除。</p></li><li><p>v-leave-active：定义离开过渡生效时的状态。在整个离开过渡的阶段中应用，在离开过渡被触发时立刻生效，在过渡&#x2F;动画完成之后移除。这个类可以被用来定义离开过渡的过程时间，延迟和曲线函数。</p></li><li><p>v-leave-to：离开过渡的结束状态。在离开过渡被触发之后下一帧生效 (与此同时 v-leave-from 被移除)，在过渡&#x2F;动画完成之后移除。</p></li></ol><p>如下</p><pre><code class="hljs">   &lt;button @click=&#39;flag = !flag&#39;&gt;切换&lt;/button&gt;   &lt;transition name=&#39;fade&#39;&gt;     &lt;div v-if=&#39;flag&#39; class=&quot;box&quot;&gt;&lt;/div&gt;   &lt;/transition&gt;</code></pre><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs css">//开始过度<br><span class="hljs-selector-class">.fade-enter-from</span>&#123;<br>   <span class="hljs-attribute">background</span>:red;<br>   <span class="hljs-attribute">width</span>:<span class="hljs-number">0px</span>;<br>   <span class="hljs-attribute">height</span>:<span class="hljs-number">0px</span>;<br>   <span class="hljs-attribute">transform</span>:<span class="hljs-built_in">rotate</span>(<span class="hljs-number">360deg</span>)<br>&#125;<br>//开始过度了<br><span class="hljs-selector-class">.fade-enter-active</span>&#123;<br>  <span class="hljs-attribute">transition</span>: all <span class="hljs-number">2.5s</span> linear;<br>&#125;<br>//过度完成<br><span class="hljs-selector-class">.fade-enter-to</span>&#123;<br>   <span class="hljs-attribute">background</span>:yellow;<br>   <span class="hljs-attribute">width</span>:<span class="hljs-number">200px</span>;<br>   <span class="hljs-attribute">height</span>:<span class="hljs-number">200px</span>;<br>&#125;<br>//离开的过度<br><span class="hljs-selector-class">.fade-leave-from</span>&#123;<br>  <span class="hljs-attribute">width</span>:<span class="hljs-number">200px</span>;<br>  <span class="hljs-attribute">height</span>:<span class="hljs-number">200px</span>;<br>  <span class="hljs-attribute">transform</span>:<span class="hljs-built_in">rotate</span>(<span class="hljs-number">360deg</span>)<br>&#125;<br>//离开中过度<br><span class="hljs-selector-class">.fade-leave-active</span>&#123;<br>  <span class="hljs-attribute">transition</span>: all <span class="hljs-number">1s</span> linear;<br>&#125;<br>//离开完成<br><span class="hljs-selector-class">.fade-leave-to</span>&#123;<br>  <span class="hljs-attribute">width</span>:<span class="hljs-number">0px</span>;<br>   <span class="hljs-attribute">height</span>:<span class="hljs-number">0px</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="2-自定义过渡-class-类名"><a href="#2-自定义过渡-class-类名" class="headerlink" title="2.自定义过渡 class 类名"></a>2.自定义过渡 class 类名</h4><p>trasnsition props</p><ul><li><p>enter-from-class</p></li><li><p>enter-active-class</p></li><li><p>enter-to-class</p></li><li><p>leave-from-class</p></li><li><p>leave-active-class</p></li><li><p>leave-to-class</p></li></ul><p>自定义过度时间 单位毫秒</p><p>你也可以分别指定进入和离开的持续时间：</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">transition</span> <span class="hljs-attr">:duration</span>=<span class="hljs-string">&quot;1000&quot;</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">transition</span>&gt;</span></span><br><span class="language-xml"></span><br><span class="language-xml"></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">transition</span> <span class="hljs-attr">:duration</span>=<span class="hljs-string">&quot;</span></span></span><span class="hljs-template-variable">&#123; enter: 500, leave: 800 &#125;</span><span class="language-xml"><span class="hljs-tag"><span class="hljs-string">&quot;</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">transition</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p>通过自定义class 结合css动画库animate css</p><p>安装库 npm install animate.css</p><p>引入 import ‘animate.css’</p><p>使用方法</p><p>官方文档 Animate.css | A cross-browser library of CSS animations.</p><pre><code class="hljs">    &lt;transition        leave-active-class=&quot;animate__animated animate__bounceInLeft&quot;        enter-active-class=&quot;animate__animated animate__bounceInRight&quot;    &gt;        &lt;div v-if=&quot;flag&quot; class=&quot;box&quot;&gt;&lt;/div&gt;    &lt;/transition&gt;</code></pre><h4 id="3-transition-生命周期8个"><a href="#3-transition-生命周期8个" class="headerlink" title="3.transition 生命周期8个"></a>3.transition 生命周期8个</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-meta">@before</span>-enter=<span class="hljs-string">&quot;beforeEnter&quot;</span> <span class="hljs-comment">//对应enter-from</span><br><span class="hljs-meta">@enter</span>=<span class="hljs-string">&quot;enter&quot;</span><span class="hljs-comment">//对应enter-active</span><br><span class="hljs-meta">@after</span>-enter=<span class="hljs-string">&quot;afterEnter&quot;</span><span class="hljs-comment">//对应enter-to</span><br><span class="hljs-meta">@enter</span>-cancelled=<span class="hljs-string">&quot;enterCancelled&quot;</span><span class="hljs-comment">//显示过度打断</span><br><span class="hljs-meta">@before</span>-leave=<span class="hljs-string">&quot;beforeLeave&quot;</span><span class="hljs-comment">//对应leave-from</span><br><span class="hljs-meta">@leave</span>=<span class="hljs-string">&quot;leave&quot;</span><span class="hljs-comment">//对应enter-active</span><br><span class="hljs-meta">@after</span>-leave=<span class="hljs-string">&quot;afterLeave&quot;</span><span class="hljs-comment">//对应leave-to</span><br><span class="hljs-meta">@leave</span>-cancelled=<span class="hljs-string">&quot;leaveCancelled&quot;</span><span class="hljs-comment">//离开过度打断</span><br></code></pre></td></tr></table></figure><p>当只用 JavaScript 过渡的时候，在 enter 和 leave 钩子中必须使用 done 进行回调</p><p>结合gsap 动画库使用 GreenSock</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> <span class="hljs-title function_">beforeEnter</span> = (<span class="hljs-params">el: Element</span>) =&gt; &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;进入之前from&#x27;</span>, el);<br>&#125;<br><span class="hljs-keyword">const</span> <span class="hljs-title function_">Enter</span> = (<span class="hljs-params">el: Element,done:<span class="hljs-built_in">Function</span></span>) =&gt; &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;过度曲线&#x27;</span>);<br>    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">()=&gt;</span>&#123;<br>       <span class="hljs-title function_">done</span>()<br>    &#125;,<span class="hljs-number">3000</span>)<br>&#125;<br><span class="hljs-keyword">const</span> <span class="hljs-title function_">AfterEnter</span> = (<span class="hljs-params">el: Element</span>) =&gt; &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;to&#x27;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="4-appear"><a href="#4-appear" class="headerlink" title="4.appear"></a>4.appear</h4><p>通过这个属性可以设置初始节点过度 就是页面加载完成就开始动画 对应三个状态</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">appear-active-class</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;&quot;</span><br><span class="hljs-attribute">appear-from-class</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;&quot;</span><br><span class="hljs-attribute">appear-to-class</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;&quot;</span><br>appear<br></code></pre></td></tr></table></figure><h3 id="6-transition-group过度列表"><a href="#6-transition-group过度列表" class="headerlink" title="6.transition-group过度列表"></a>6.transition-group过度列表</h3><blockquote><p>一般配合v-for使用</p></blockquote><ul><li><p>单个节点</p></li><li><p>多个节点，每次只渲染一个</p></li></ul><p>那么怎么同时渲染整个列表，比如使用 v-for？在这种场景下，我们会使用 <transition-group> 组件。在我们深入例子之前，先了解关于这个组件的几个特点：</p><ul><li>默认情况下，它不会渲染一个包裹元素，但是你可以通过 tag attribute 指定渲染一个元素。</li><li>过渡模式不可用，因为我们不再相互切换特有的元素。</li><li>内部元素总是需要提供唯一的 key attribute 值。</li><li>CSS 过渡的类将会应用在内部的元素中，而不是这个组&#x2F;容器本身。</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;transition-group&gt;<br>     &lt;div style=&quot;margin: 10px;&quot; :key=&quot;item&quot; v-for=&quot;item in list&quot;&gt;&#123;&#123; item &#125;&lt;/div&gt;<br>&lt;/transition-group&gt;<br></code></pre></td></tr></table></figure><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> list = reactive&lt;<span class="hljs-built_in">number</span>[]&gt;([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>])<br><span class="hljs-keyword">const</span> <span class="hljs-title function_">Push</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>    list.<span class="hljs-title function_">push</span>(<span class="hljs-number">123</span>)<br>&#125;<br><span class="hljs-keyword">const</span> <span class="hljs-title function_">Pop</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>    list.<span class="hljs-title function_">pop</span>()<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="2-列表的移动过渡"><a href="#2-列表的移动过渡" class="headerlink" title="2.列表的移动过渡"></a>2.列表的移动过渡</h4><p><code>&lt;transition-group&gt;</code> 组件还有一个特殊之处。除了进入和离开，它还可以为定位的改变添加动画。只需了解新增的 v-move 类就可以使用这个新功能，它会应用在元素改变定位的过程中。像之前的类名一样，它的前缀可以通过 name attribute 来自定义，也可以通过 move-class attribute 手动设置</p><p>下面代码很酷炫</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>    &lt;div&gt;<br>        &lt;button @click=&quot;shuffle&quot;&gt;Shuffle&lt;/button&gt;<br>        &lt;transition-group class=&quot;wraps&quot; name=&quot;mmm&quot; tag=&quot;ul&quot;&gt;<br>            &lt;li class=&quot;cell&quot; v-for=&quot;item in items&quot; :key=&quot;item.id&quot;&gt;&#123;&#123; item.number &#125;&#125;&lt;/li&gt;<br>        &lt;/transition-group&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br>  <br>&lt;script setup  lang=&#x27;ts&#x27;&gt;<br>import _ from &#x27;lodash&#x27;<br>import &#123; ref &#125; from &#x27;vue&#x27;<br>let items = ref(Array.apply(null, &#123; length: 81 &#125; as number[]).map((_, index) =&gt; &#123;<br>    return &#123;<br>        id: index,<br>        number: (index % 9) + 1<br>    &#125;<br>&#125;))<br>const shuffle = () =&gt; &#123;<br>    items.value = _.shuffle(items.value)<br>&#125;<br>&lt;/script&gt;<br>  <br>&lt;style scoped lang=&quot;less&quot;&gt;<br>.wraps &#123;<br>    display: flex;<br>    flex-wrap: wrap;<br>    width: calc(25px * 10 + 9px);<br>    .cell &#123;<br>        width: 25px;<br>        height: 25px;<br>        border: 1px solid #ccc;<br>        list-style-type: none;<br>        display: flex;<br>        justify-content: center;<br>        align-items: center;<br>    &#125;<br>&#125;<br> <br>.mmm-move &#123;<br>    transition: transform 0.8s ease;<br>&#125;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure><h4 id="3-状态过渡"><a href="#3-状态过渡" class="headerlink" title="3.状态过渡"></a>3.状态过渡</h4><p>Vue 也同样可以给数字 Svg 背景颜色等添加过度动画 今天演示数字变化</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>    &lt;div&gt;<br>        &lt;input step=&quot;20&quot; v-model=&quot;num.current&quot; type=&quot;number&quot; /&gt;<br>        &lt;div&gt;&#123;&#123; num.tweenedNumber.toFixed(0) &#125;&#125;&lt;/div&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br>    <br>&lt;script setup lang=&#x27;ts&#x27;&gt;<br>import &#123; reactive, watch &#125; from &#x27;vue&#x27;<br>import gsap from &#x27;gsap&#x27;<br>const num = reactive(&#123;<br>    tweenedNumber: 0,<br>    current:0<br>&#125;)<br> <br>watch(()=&gt;num.current, (newVal) =&gt; &#123;<br>    gsap.to(num, &#123;<br>        duration: 1,<br>        tweenedNumber: newVal<br>    &#125;)<br>&#125;)<br> <br>&lt;/script&gt;<br>    <br>&lt;style&gt;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure><h2 id="6、其他"><a href="#6、其他" class="headerlink" title="6、其他"></a>6、其他</h2><h3 id="1-全局API的转移"><a href="#1-全局API的转移" class="headerlink" title="1.全局API的转移"></a>1.全局API的转移</h3><ul><li><p>Vue 2.x 有许多全局 API 和配置。</p><ul><li><p>例如：注册全局组件、注册全局指令等。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//注册全局组件</span><br><span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">component</span>(<span class="hljs-string">&#x27;MyButton&#x27;</span>, &#123;<br>  <span class="hljs-attr">data</span>: <span class="hljs-function">() =&gt;</span> (&#123;<br>    <span class="hljs-attr">count</span>: <span class="hljs-number">0</span><br>  &#125;),<br>  <span class="hljs-attr">template</span>: <span class="hljs-string">&#x27;&lt;button @click=&quot;count++&quot;&gt;Clicked &#123;&#123; count &#125;&#125; times.&lt;/button&gt;&#x27;</span><br>&#125;)<br><br><span class="hljs-comment">//注册全局指令</span><br><span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">directive</span>(<span class="hljs-string">&#x27;focus&#x27;</span>, &#123;<br>  <span class="hljs-attr">inserted</span>: <span class="hljs-function"><span class="hljs-params">el</span> =&gt;</span> el.<span class="hljs-title function_">focus</span>()<br>&#125;<br></code></pre></td></tr></table></figure></li></ul></li><li><p>Vue3.0中对这些API做出了调整：</p><ul><li><p>将全局的API，即：<code>Vue.xxx</code>调整到应用实例（<code>app</code>）上</p><table><thead><tr><th>2.x 全局 API（<code>Vue</code>）</th><th>3.x 实例 API (<code>app</code>)</th></tr></thead><tbody><tr><td>Vue.config.xxxx</td><td>app.config.xxxx</td></tr><tr><td>Vue.config.productionTip</td><td><strong style="color:#DD5145">移除</strong></td></tr><tr><td>Vue.component</td><td>app.component</td></tr><tr><td>Vue.directive</td><td>app.directive</td></tr><tr><td>Vue.mixin</td><td>app.mixin</td></tr><tr><td>Vue.use</td><td>app.use</td></tr><tr><td>Vue.prototype</td><td>app.config.globalProperties</td></tr></tbody></table></li></ul></li></ul><h3 id="2-其他改变"><a href="#2-其他改变" class="headerlink" title="2.其他改变"></a>2.其他改变</h3><ul><li><p>data选项应始终被声明为一个<strong>函数</strong>。</p></li><li><p>过度类名的更改：</p><ul><li><p>Vue2.x写法</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.v-enter</span>,<br><span class="hljs-selector-class">.v-leave-to</span> &#123;<br>  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-selector-class">.v-leave</span>,<br><span class="hljs-selector-class">.v-enter-to</span> &#123;<br>  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>Vue3.x写法</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.v-enter-from</span>,<br><span class="hljs-selector-class">.v-leave-to</span> &#123;<br>  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-selector-class">.v-leave-from</span>,<br><span class="hljs-selector-class">.v-enter-to</span> &#123;<br>  <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li></ul></li><li><p><strong style="color:#DD5145">移除</strong>keyCode作为 v-on 的修饰符，同时也不再支持<code>config.keyCodes</code></p></li><li><p><strong style="color:#DD5145">移除</strong><code>v-on.native</code>修饰符</p><ul><li><p>父组件中绑定事件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;my-component<br>  v-on:close=&quot;handleComponentEvent&quot;<br>  v-on:click=&quot;handleNativeClickEvent&quot;<br>/&gt;<br></code></pre></td></tr></table></figure></li><li><p>子组件中声明自定义事件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;script&gt;<br>  export default &#123;<br>    emits: [&#x27;close&#x27;]<br>  &#125;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure></li></ul></li><li><p><strong style="color:#DD5145">移除</strong>过滤器（filter）</p><blockquote><p>过滤器虽然这看起来很方便，但它需要一个自定义语法，打破大括号内表达式是 “只是 JavaScript” 的假设，这不仅有学习成本，而且有实现成本！建议用方法调用或计算属性去替换过滤器。</p></blockquote></li><li><p>……</p></li></ul><h3 id="可选链操作符双问号表达式"><a href="#可选链操作符双问号表达式" class="headerlink" title="可选链操作符双问号表达式"></a>可选链操作符双问号表达式</h3><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs arcade">?<br>a.children?.<span class="hljs-built_in">length</span><br>返回的是 <span class="hljs-literal">undefined</span>不会报错<br><br>??<br>a.children?.<span class="hljs-built_in">length</span> ?? []<br>返回的是[]<br>这个只能是<span class="hljs-literal">null</span>和<span class="hljs-literal">undefined</span>，然后返回 ?? 后面的数据<br></code></pre></td></tr></table></figure><h3 id="Scoped和样式穿透"><a href="#Scoped和样式穿透" class="headerlink" title="Scoped和样式穿透"></a>Scoped和样式穿透</h3><p>主要是用于修改很多vue常用的组件库（element, vant, AntDesigin），虽然配好了样式但是还是需要更改其他的样式</p><p>就需要用到样式穿透</p><ul><li>scoped的原理</li></ul><p>vue中的scoped 通过在DOM结构以及css样式上加唯一不重复的标记:data-v-hash的方式，以保证唯一（而这个工作是由过PostCSS转译实现的），达到样式私有化模块化的目的。</p><p>总结一下scoped三条渲染规则：</p><ol><li><p>给HTML的DOM节点加一个不重复data属性(形如：data-v-123)来表示他的唯一性</p></li><li><p>在每句css选择器的末尾（编译后的生成的css语句）加一个当前组件的data属性选择器（如[data-v-123]）来私有化样式</p></li><li><p>如果组件内部包含有其他组件，只会给其他组件的最外层标签加上当前组件的data属性</p></li></ol><p>PostCSS会给一个组件中的所有dom添加了一个独一无二的动态属性data-v-xxxx，然后，给CSS选择器额外添加一个对应的属性选择器来选择该组件中dom，这种做法使得样式只作用于含有该属性的dom——组件内部dom, 从而达到了’样式模块化’的效果.</p><p>案例修改Element ui Input样式</p><p>发现没有生效<br><img src="/../img/vue/566e8a5d6e5349638615ff65771896a0.png" alt="img"></p><p> 如果不写Scoped 就没问题</p><p>原因就是Scoped 搞的鬼 他在进行PostCss转化的时候把元素选择器默认放在了最后</p><p><img src="/../img/vue/c896c971d3ce407989d3439101a180ad.png" alt="img"></p><p> Vue 提供了样式穿透:deep() 他的作用就是用来改变 属性选择器的位置</p><p><img src="/../img/vue/100a1402669844c2a0da76d7959c978e.png" alt="img"></p><p><img src="/../img/vue/185233f9afe8422fa815be3a22249e4a.png" alt="img"></p><h3 id="css-style"><a href="#css-style" class="headerlink" title="css style"></a>css style</h3><h4 id="1-插槽选择器"><a href="#1-插槽选择器" class="headerlink" title="1.插槽选择器"></a>1.插槽选择器</h4><p>A 组件定义一个插槽</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>    &lt;div&gt;<br>        我是插槽<br>        &lt;slot&gt;&lt;/slot&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br> <br>&lt;script&gt;<br>export default &#123;&#125;<br>&lt;/script&gt;<br> <br>&lt;style scoped&gt;<br> <br>&lt;/style&gt;<br></code></pre></td></tr></table></figure><p>在App.vue 引入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>    &lt;div&gt;<br>        &lt;A&gt;<br>            &lt;div class=&quot;a&quot;&gt;私人定制div&lt;/div&gt;<br>        &lt;/A&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br> <br>&lt;script setup&gt;<br>import A from &quot;@/components/A.vue&quot;<br>&lt;/script&gt;<br> <br> <br>&lt;style lang=&quot;less&quot; scoped&gt;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure><p>在A组件修改class a 的颜色</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.a</span>&#123;</span><br><span class="language-css">    <span class="hljs-attribute">color</span>:red</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure><p>默认情况下，作用域样式不会影响到 <code>&lt;slot/&gt;</code> 渲染出来的内容，因为它们被认为是父组件所持有并传递进来的。</p><p>解决方案 slotted</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs css">&lt;style scoped&gt;<br> <span class="hljs-selector-pseudo">:slotted</span>(<span class="hljs-selector-class">.a</span>) &#123;<br>    <span class="hljs-attribute">color</span>:red<br>&#125;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure><h4 id="2-全局选择器"><a href="#2-全局选择器" class="headerlink" title="2.全局选择器"></a>2.全局选择器</h4><p>在之前我们想加入全局 样式 通常都是新建一个style 标签 不加<a href="https://so.csdn.net/so/search?q=scoped&spm=1001.2101.3001.7020">scoped</a> 现在有更优雅的解决方案</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;style&gt;<br> div&#123;<br>     color:red<br> &#125;<br>&lt;/style&gt;<br> <br>&lt;style lang=&quot;less&quot; scoped&gt;<br> <br>&lt;/style&gt;<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;style lang=&quot;less&quot; scoped&gt;<br>:global(div)&#123;<br>    color:red<br>&#125;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure><p>效果等同于上面 </p><h4 id="3-动态-CSS"><a href="#3-动态-CSS" class="headerlink" title="3.动态 CSS"></a>3.动态 CSS</h4><p>单文件组件的 <code>&lt;style&gt;</code> 标签可以通过 <code>v-bind</code> 这一 CSS 函数将 CSS 的值关联到动态的组件状态上：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>    &lt;div class=&quot;div&quot;&gt;<br>       小满是个弟弟<br>    &lt;/div&gt;<br>&lt;/template&gt;<br> <br>&lt;script lang=&quot;ts&quot; setup&gt;<br>import &#123; ref &#125; from &#x27;vue&#x27;<br>const red = ref&lt;string&gt;(&#x27;red&#x27;)<br>&lt;/script&gt;<br> <br>&lt;style lang=&quot;less&quot; scoped&gt;<br>.div&#123;<br>   color:v-bind(red)<br>&#125;<br> <br>&lt;/style&gt;<br></code></pre></td></tr></table></figure><p>如果是对象 <a href="https://so.csdn.net/so/search?q=v-bind&spm=1001.2101.3001.7020">v-bind</a> 请加引号</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs vue"> &lt;template&gt;<br>    &lt;div class=&quot;div&quot;&gt;<br>        小满是个弟弟<br>    &lt;/div&gt;<br>&lt;/template&gt;<br> <br>&lt;script lang=&quot;ts&quot; setup&gt;<br>import &#123; ref &#125; from &quot;vue&quot;<br>const red = ref(&#123;<br>    color:&#x27;pink&#x27;<br>&#125;)<br>&lt;/script&gt;<br> <br>    &lt;style lang=&quot;less&quot; scoped&gt;<br>.div &#123;<br>    color: v-bind(&#x27;red.color&#x27;);<br>&#125;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure><h4 id="4-css-module"><a href="#4-css-module" class="headerlink" title="4.css module"></a>4.css module</h4><p><code>&lt;style module&gt;</code> 标签会被编译为 CSS Modules 并且将生成的 CSS 类作为 $style 对象的键暴露给组件</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">&quot;$style.red&quot;</span>&gt;</span><br>        小满是个弟弟<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br> <br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">module</span>&gt;</span><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.red</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">color</span>: red;</span><br><span class="language-css">    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">20px</span>;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure><p>自定义注入名称（多个可以用数组）</p><p>你可以通过给 module attribute 一个值来自定义注入的类对象的 property 键</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>    &lt;div :class=&quot;[zs.red,zs.border]&quot;&gt;<br>        小满是个弟弟<br>    &lt;/div&gt;<br>&lt;/template&gt;<br> <br>&lt;style module=&quot;zs&quot;&gt;<br>.red &#123;<br>    color: red;<br>    font-size: 20px;<br>&#125;<br>.border&#123;<br>    border: 1px solid #ccc;<br>&#125;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure><p>与组合式 API 一同使用</p><p>注入的类可以通过 useCssModule API 在 <code>setup() </code>和 <code>&lt;script setup&gt;</code> 中使用。对于使用了自定义注入名称的<code> &lt;style module&gt;</code> 模块，useCssModule 接收一个对应的 module attribute 值作为第一个参数</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>    &lt;div :class=&quot;[zs.red,zs.border]&quot;&gt;<br>        小满是个弟弟<br>    &lt;/div&gt;<br>&lt;/template&gt;<br> <br> <br>&lt;script setup lang=&quot;ts&quot;&gt;<br>import &#123; useCssModule &#125; from &#x27;vue&#x27;<br>const css = useCssModule(&#x27;zs&#x27;)<br>&lt;/script&gt;<br> <br>&lt;style module=&quot;zs&quot;&gt;<br>.red &#123;<br>    color: red;<br>    font-size: 20px;<br>&#125;<br>.border&#123;<br>    border: 1px solid #ccc;<br>&#125;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure><h2 id="tsx"><a href="#tsx" class="headerlink" title="tsx"></a>tsx</h2><p>我们之前呢是使用Template去写我们模板。现在可以扩展另一种风格<a href="https://so.csdn.net/so/search?q=TSX&spm=1001.2101.3001.7020">TSX</a>风格</p><p>vue2 的时候就已经支持<a href="https://so.csdn.net/so/search?q=jsx&spm=1001.2101.3001.7020">jsx</a>写法，只不过不是很友好，随着vue3对typescript的支持度，tsx写法越来越被接受</p><h3 id="1-安装插件"><a href="#1-安装插件" class="headerlink" title="1.安装插件"></a>1.安装插件</h3><p>npm install @vitejs&#x2F;plugin-vue-jsx -D</p><p>vite.config.ts 配置</p><p><img src="/../img/vue/35486eb0bd1a4dabac0035384f877cbe.png" alt="img"></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> &#123; defineConfig &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vite&#x27;</span><br><span class="hljs-keyword">import</span> vue <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@vitejs/plugin-vue&#x27;</span><br><span class="hljs-keyword">import</span> vueJsx <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@vitejs/plugin-vue-jsx&#x27;</span>;<br><span class="hljs-comment">// https://vitejs.dev/config/</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>(&#123;<br>  <span class="hljs-attr">plugins</span>: [<span class="hljs-title function_">vue</span>(),<span class="hljs-title function_">vueJsx</span>()]<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="2-修改tsconfig-json-配置文件"><a href="#2-修改tsconfig-json-配置文件" class="headerlink" title="2.修改tsconfig.json 配置文件"></a>2.修改tsconfig.json 配置文件</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-attr">&quot;jsx&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;preserve&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;jsxFactory&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;h&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;jsxFragmentFactory&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Fragment&quot;</span><span class="hljs-punctuation">,</span><br></code></pre></td></tr></table></figure><p><img src="/../img/vue/e6d0ae1a4c254f13bde802f408fed4b3.png" alt="img"></p><p>配置完成就可以使用啦</p><p>在目录新建一个xxxxxx.tsx文件</p><h3 id="3-使用TSX"><a href="#3-使用TSX" class="headerlink" title="3.使用TSX"></a>3.使用TSX</h3><p>TIPS tsx不会自动解包使用ref加.vlaue ! ! !</p><h4 id="tsx支持-v-model-的使用"><a href="#tsx支持-v-model-的使用" class="headerlink" title="tsx支持 v-model 的使用"></a>tsx支持 v-model 的使用</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs ts"> <br><span class="hljs-keyword">import</span> &#123; ref &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br> <br><span class="hljs-keyword">let</span> v = ref&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-string">&#x27;&#x27;</span>)<br> <br><span class="hljs-keyword">const</span> <span class="hljs-title function_">renderDom</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;&gt;</span></span><br><span class="language-xml">           <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&#123;v.value&#125;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> /&gt;</span></span><br><span class="language-xml">           <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">               &#123;v.value&#125;</span><br><span class="language-xml">           <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/&gt;</span></span><br>    )<br>&#125;<br> <br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> renderDom<br></code></pre></td></tr></table></figure><h4 id="v-show"><a href="#v-show" class="headerlink" title="v-show"></a>v-show</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs ts"> <br><span class="hljs-keyword">import</span> &#123; ref &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br> <br><span class="hljs-keyword">let</span> flag = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">false</span>)<br> <br><span class="hljs-keyword">const</span> <span class="hljs-title function_">renderDom</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;&gt;</span></span><br><span class="language-xml">           <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-show</span>=<span class="hljs-string">&#123;flag.value&#125;</span>&gt;</span>景天<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">           <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-show</span>=<span class="hljs-string">&#123;!flag.value&#125;</span>&gt;</span>雪见<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/&gt;</span></span><br>    )<br>&#125;<br> <br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> renderDom<br></code></pre></td></tr></table></figure><h4 id="v-if是不支持的"><a href="#v-if是不支持的" class="headerlink" title="v-if是不支持的"></a>v-if是不支持的</h4><p>所以需要改变风格</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> &#123; ref &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br> <br><span class="hljs-keyword">let</span> flag = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">false</span>)<br> <br><span class="hljs-keyword">const</span> <span class="hljs-title function_">renderDom</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;&gt;</span></span><br><span class="language-xml">            &#123;</span><br><span class="language-xml">                flag.value ? <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>景天<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span> : <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>雪见<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">            &#125;</span><br><span class="language-xml">        <span class="hljs-tag">&lt;/&gt;</span></span><br>    )<br>&#125;<br> <br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> renderDom<br></code></pre></td></tr></table></figure><h4 id="v-for也是不支持的"><a href="#v-for也是不支持的" class="headerlink" title="v-for也是不支持的"></a>v-for也是不支持的</h4><p>需要使用Map</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> &#123; ref &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br> <br><span class="hljs-keyword">let</span> arr = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>]<br> <br><span class="hljs-keyword">const</span> <span class="hljs-title function_">renderDom</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;&gt;</span></span><br><span class="language-xml">            &#123;</span><br><span class="language-xml">              arr.map(v=&gt;&#123;</span><br><span class="language-xml">                  return <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>$&#123;v&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">              &#125;)</span><br><span class="language-xml">            &#125;</span><br><span class="language-xml">        <span class="hljs-tag">&lt;/&gt;</span></span><br>    )<br>&#125;<br> <br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> renderDom<br></code></pre></td></tr></table></figure><h4 id="v-bind使用"><a href="#v-bind使用" class="headerlink" title="v-bind使用"></a>v-bind使用</h4><p>直接赋值就可以</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> &#123; ref &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br> <br><span class="hljs-keyword">let</span> arr = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]<br> <br><span class="hljs-keyword">const</span> <span class="hljs-title function_">renderDom</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">data-arr</span>=<span class="hljs-string">&#123;arr&#125;</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/&gt;</span></span><br>    )<br>&#125;<br> <br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> renderDom<br></code></pre></td></tr></table></figure><h4 id="v-on绑定事件-所有的事件都按照react风格来"><a href="#v-on绑定事件-所有的事件都按照react风格来" class="headerlink" title="v-on绑定事件 所有的事件都按照react风格来"></a>v-on绑定事件 所有的事件都按照react风格来</h4><ul><li>所有事件有on开头</li><li>所有事件名称首字母大写</li></ul><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs ts"> <br><span class="hljs-keyword">const</span> <span class="hljs-title function_">renderDom</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;clickTap&#125;</span>&gt;</span>点击<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/&gt;</span></span><br>    )<br>&#125;<br> <br><span class="hljs-keyword">const</span> <span class="hljs-title function_">clickTap</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;click&#x27;</span>);<br>&#125;<br> <br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> renderDom<br></code></pre></td></tr></table></figure><h4 id="Props-接受值"><a href="#Props-接受值" class="headerlink" title="Props 接受值"></a>Props 接受值</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs ts"> <br><span class="hljs-keyword">import</span> &#123; ref &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br> <br><span class="hljs-keyword">type</span> <span class="hljs-title class_">Props</span> = &#123;<br>    <span class="hljs-attr">title</span>:<span class="hljs-built_in">string</span><br>&#125;<br> <br><span class="hljs-keyword">const</span> <span class="hljs-title function_">renderDom</span> = (<span class="hljs-params">props:Props</span>) =&gt; &#123;<br>    <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>&#123;props.title&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;clickTap&#125;</span>&gt;</span>点击<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/&gt;</span></span><br>    )<br>&#125;<br> <br><span class="hljs-keyword">const</span> <span class="hljs-title function_">clickTap</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;click&#x27;</span>);<br>&#125;<br> <br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> renderDom<br></code></pre></td></tr></table></figure><h4 id="Emit派发"><a href="#Emit派发" class="headerlink" title="Emit派发"></a>Emit派发</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Props</span> = &#123;<br>    <span class="hljs-attr">title</span>: <span class="hljs-built_in">string</span><br>&#125;<br> <br><span class="hljs-keyword">const</span> <span class="hljs-title function_">renderDom</span> = (<span class="hljs-params">props: Props,content:<span class="hljs-built_in">any</span></span>) =&gt; &#123;<br>    <span class="hljs-keyword">return</span> (<br>        <span class="language-xml"><span class="hljs-tag">&lt;&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>&#123;props.title&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;clickTap.bind(this,content)&#125;</span>&gt;</span>点击<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/&gt;</span></span><br>    )<br>&#125;<br> <br><span class="hljs-keyword">const</span> <span class="hljs-title function_">clickTap</span> = (<span class="hljs-params">ctx:<span class="hljs-built_in">any</span></span>) =&gt; &#123;<br> <br>    ctx.<span class="hljs-title function_">emit</span>(<span class="hljs-string">&#x27;on-click&#x27;</span>,<span class="hljs-number">1</span>)<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="Slot"><a href="#Slot" class="headerlink" title="Slot"></a>Slot</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> <span class="hljs-title function_">A</span> = (<span class="hljs-params">props, &#123; slots &#125;</span>) =&gt; (<br>  <span class="language-xml"><span class="hljs-tag">&lt;&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>&#123; slots.default ? slots.default() : &#x27;foo&#x27; &#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>&#123; slots.bar?.() &#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;/&gt;</span></span><br>);<br> <br><span class="hljs-keyword">const</span> <span class="hljs-title class_">App</span> = &#123;<br>  <span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">const</span> slots = &#123;<br>      <span class="hljs-attr">bar</span>: <span class="hljs-function">() =&gt;</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>B<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>,<br>    &#125;;<br>    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> (<br>      <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">A</span> <span class="hljs-attr">v-slots</span>=<span class="hljs-string">&#123;slots&#125;</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>A<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">A</span>&gt;</span></span><br>    );<br>  &#125;,<br>&#125;;<br> <br><span class="hljs-comment">// or</span><br> <br><span class="hljs-keyword">const</span> <span class="hljs-title class_">App</span> = &#123;<br>  <span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">const</span> slots = &#123;<br>      <span class="hljs-attr">default</span>: <span class="hljs-function">() =&gt;</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>A<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>,<br>      <span class="hljs-attr">bar</span>: <span class="hljs-function">() =&gt;</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>B<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>,<br>    &#125;;<br>    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">A</span> <span class="hljs-attr">v-slots</span>=<span class="hljs-string">&#123;slots&#125;</span> /&gt;</span></span>;<br>  &#125;,<br>&#125;;<br> <br><span class="hljs-comment">// or you can use object slots when `enableObjectSlots` is not false.</span><br><span class="hljs-keyword">const</span> <span class="hljs-title class_">App</span> = &#123;<br>  <span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> (<br>      <span class="language-xml"><span class="hljs-tag">&lt;&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">A</span>&gt;</span></span><br><span class="language-xml">          &#123;&#123;</span><br><span class="language-xml">            default: () =&gt; <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>A<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>,</span><br><span class="language-xml">            bar: () =&gt; <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>B<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>,</span><br><span class="language-xml">          &#125;&#125;</span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">A</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">B</span>&gt;</span>&#123;() =&gt; &quot;foo&quot;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">B</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;/&gt;</span></span><br>    );<br>  &#125;,<br>&#125;;<br></code></pre></td></tr></table></figure><h2 id="Event-Loop-和-nextTick"><a href="#Event-Loop-和-nextTick" class="headerlink" title="Event Loop 和 nextTick"></a>Event Loop 和 nextTick</h2><h3 id="JS-执行机制"><a href="#JS-执行机制" class="headerlink" title="JS 执行机制"></a>JS 执行机制</h3><p>在我们学js 的时候都知道js 是单线程的如果是多线程的话会引发一个问题在同一时间同时操作DOM 一个增加一个删除JS就不知道到底要干嘛了，所以这个语言是单线程的但是随着HTML5到来js也支持了多线程webWorker 但是也是不允许操作DOM</p><p>单线程就意味着所有的任务都需要排队，后面的任务需要等前面的任务执行完才能执行，如果前面的任务耗时过长，后面的任务就需要一直等，一些从用户角度上不需要等待的任务就会一直等待，这个从体验角度上来讲是不可接受的，所以JS中就出现了异步的概念。</p><h3 id="同步任务"><a href="#同步任务" class="headerlink" title="同步任务"></a>同步任务</h3><p>代码从上到下按顺序执行</p><h3 id="异步任务"><a href="#异步任务" class="headerlink" title="异步任务"></a>异步任务</h3><h4 id="1-宏任务"><a href="#1-宏任务" class="headerlink" title="1.宏任务"></a>1.宏任务</h4><p>script(整体代码)、setTimeout、setInterval、UI交互事件、postMessage、Ajax</p><h4 id="2-微任务"><a href="#2-微任务" class="headerlink" title="2.微任务"></a>2.微任务</h4><p>Promise.then catch finally、MutaionObserver、process.nextTick(Node.js 环境)</p><h4 id="运行机制"><a href="#运行机制" class="headerlink" title="运行机制"></a>运行机制</h4><p>所有的同步任务都是在主进程执行的形成一个执行栈，主线程之外，还存在一个”任务队列”，异步任务执行队列中先执行宏任务，然后清空当次宏任务中的所有微任务，然后进行下一个tick如此形成循环。</p><p>nextTick 就是创建一个异步任务，那么它自然要等到同步任务执行完成后才执行。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>   &lt;div ref=&quot;xiaoman&quot;&gt;<br>      &#123;&#123; text &#125;&#125;<br>   &lt;/div&gt;<br>   &lt;button @click=&quot;change&quot;&gt;change div&lt;/button&gt;<br>&lt;/template&gt;<br>   <br>&lt;script setup lang=&#x27;ts&#x27;&gt;<br>import &#123; ref,nextTick &#125; from &#x27;vue&#x27;;<br> <br>const text = ref(&#x27;小满开飞机&#x27;)<br>const xiaoman = ref&lt;HTMLElement&gt;()<br> <br>const change = async () =&gt; &#123;<br>   text.value = &#x27;小满不开飞机&#x27;<br>   console.log(xiaoman.value?.innerText) //小满开飞机<br>   await nextTick();<br>   console.log(xiaoman.value?.innerText) //小满不开飞机<br>&#125;<br> <br> <br>&lt;/script&gt;<br> <br> <br>&lt;style  scoped&gt;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure><p>nextTick 接受一个参数fn（函数）定义了一个变量P 这个P最终返回都是Promise，最后是return 如果传了fn 就使用变量P.then执行一个微任务去执行fn函数，then里面this 如果有值就调用bind改变this指向返回新的函数，否则直接调用fn，如果没传fn，就返回一个promise，最终结果都会返回一个promise</p><p>在我们之前讲过的ref源码中有一段 triggerRefValue  他会去调用 triggerEffects</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">triggerRefValue</span>(<span class="hljs-params">ref: RefBase&lt;<span class="hljs-built_in">any</span>&gt;, newVal?: <span class="hljs-built_in">any</span></span>) &#123;<br>  ref = <span class="hljs-title function_">toRaw</span>(ref)<br>  <span class="hljs-keyword">if</span> (ref.<span class="hljs-property">dep</span>) &#123;<br>    <span class="hljs-keyword">if</span> (__DEV__) &#123;<br>      <span class="hljs-title function_">triggerEffects</span>(ref.<span class="hljs-property">dep</span>, &#123;<br>        <span class="hljs-attr">target</span>: ref,<br>        <span class="hljs-attr">type</span>: <span class="hljs-title class_">TriggerOpTypes</span>.<span class="hljs-property">SET</span>,<br>        <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;value&#x27;</span>,<br>        <span class="hljs-attr">newValue</span>: newVal<br>      &#125;)<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-title function_">triggerEffects</span>(ref.<span class="hljs-property">dep</span>)<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">triggerEffects</span>(<span class="hljs-params"></span><br><span class="hljs-params">  dep: Dep | ReactiveEffect[],</span><br><span class="hljs-params">  debuggerEventExtraInfo?: DebuggerEventExtraInfo</span><br><span class="hljs-params"></span>) &#123;<br>  <span class="hljs-comment">// spread into array for stabilization</span><br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> effect <span class="hljs-keyword">of</span> <span class="hljs-title function_">isArray</span>(dep) ? dep : [...dep]) &#123;<br>    <span class="hljs-keyword">if</span> (effect !== activeEffect || effect.<span class="hljs-property">allowRecurse</span>) &#123;<br>      <span class="hljs-keyword">if</span> (__DEV__ &amp;&amp; effect.<span class="hljs-property">onTrigger</span>) &#123;<br>        effect.<span class="hljs-title function_">onTrigger</span>(<span class="hljs-title function_">extend</span>(&#123; effect &#125;, debuggerEventExtraInfo))<br>      &#125;<br>      <span class="hljs-comment">//当响应式对象发生改变后，执行 effect 如果有 scheduler 这个参数，会执行这个 scheduler 函数</span><br>      <span class="hljs-keyword">if</span> (effect.<span class="hljs-property">scheduler</span>) &#123;<br>        effect.<span class="hljs-title function_">scheduler</span>()<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>        effect.<span class="hljs-title function_">run</span>()<br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>那么scheduler 这个函数从哪儿来的 我们看这个类 ReactiveEffect</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ReactiveEffect</span>&lt;T = <span class="hljs-built_in">any</span>&gt; &#123;<br>  active = <span class="hljs-literal">true</span><br>  <span class="hljs-attr">deps</span>: <span class="hljs-title class_">Dep</span>[] = []<br>  <span class="hljs-attr">parent</span>: <span class="hljs-title class_">ReactiveEffect</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span><br> <br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * Can be attached after creation</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@internal</span></span><br><span class="hljs-comment">   */</span><br>  computed?: <span class="hljs-title class_">ComputedRefImpl</span>&lt;T&gt;<br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@internal</span></span><br><span class="hljs-comment">   */</span><br>  allowRecurse?: <span class="hljs-built_in">boolean</span><br> <br>  onStop?: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span><br>  <span class="hljs-comment">// dev only</span><br>  onTrack?: <span class="hljs-function">(<span class="hljs-params">event: DebuggerEvent</span>) =&gt;</span> <span class="hljs-built_in">void</span><br>  <span class="hljs-comment">// dev only</span><br>  onTrigger?: <span class="hljs-function">(<span class="hljs-params">event: DebuggerEvent</span>) =&gt;</span> <span class="hljs-built_in">void</span><br> <br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span><br><span class="hljs-params">    <span class="hljs-keyword">public</span> fn: () =&gt; T,</span><br><span class="hljs-params">    <span class="hljs-keyword">public</span> scheduler: EffectScheduler | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>, <span class="hljs-comment">//我在这儿 </span></span><br><span class="hljs-params">    scope?: EffectScope</span><br><span class="hljs-params">  </span>) &#123;<br>    <span class="hljs-title function_">recordEffectScope</span>(<span class="hljs-variable language_">this</span>, scope)<br>  &#125;<br></code></pre></td></tr></table></figure><p>那么scheduler 这个函数从哪儿来的 我们看这个类 ReactiveEffect</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ReactiveEffect</span>&lt;T = <span class="hljs-built_in">any</span>&gt; &#123;<br>  active = <span class="hljs-literal">true</span><br>  <span class="hljs-attr">deps</span>: <span class="hljs-title class_">Dep</span>[] = []<br>  <span class="hljs-attr">parent</span>: <span class="hljs-title class_">ReactiveEffect</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span><br> <br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * Can be attached after creation</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@internal</span></span><br><span class="hljs-comment">   */</span><br>  computed?: <span class="hljs-title class_">ComputedRefImpl</span>&lt;T&gt;<br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@internal</span></span><br><span class="hljs-comment">   */</span><br>  allowRecurse?: <span class="hljs-built_in">boolean</span><br> <br>  onStop?: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span><br>  <span class="hljs-comment">// dev only</span><br>  onTrack?: <span class="hljs-function">(<span class="hljs-params">event: DebuggerEvent</span>) =&gt;</span> <span class="hljs-built_in">void</span><br>  <span class="hljs-comment">// dev only</span><br>  onTrigger?: <span class="hljs-function">(<span class="hljs-params">event: DebuggerEvent</span>) =&gt;</span> <span class="hljs-built_in">void</span><br> <br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span><br><span class="hljs-params">    <span class="hljs-keyword">public</span> fn: () =&gt; T,</span><br><span class="hljs-params">    <span class="hljs-keyword">public</span> scheduler: EffectScheduler | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>, <span class="hljs-comment">//我在这儿 </span></span><br><span class="hljs-params">    scope?: EffectScope</span><br><span class="hljs-params">  </span>) &#123;<br>    <span class="hljs-title function_">recordEffectScope</span>(<span class="hljs-variable language_">this</span>, scope)<br>  &#125;<br></code></pre></td></tr></table></figure><p>scheduler 作为一个参数传进来的</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">const</span> effect = (instance.<span class="hljs-property">effect</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReactiveEffect</span>(<br>   componentUpdateFn,<br>   <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">queueJob</span>(instance.<span class="hljs-property">update</span>),<br>   instance.<span class="hljs-property">scope</span> <span class="hljs-comment">// track it in component&#x27;s effect scope</span><br> ))<br></code></pre></td></tr></table></figure><p>他是在初始化 effect 通过 queueJob 传进来的</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">//queueJob 维护job列队，有去重逻辑，保证任务的唯一性，每次调用去执行，被调用的时候去重，每次调用去执行 queueFlush</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">queueJob</span>(<span class="hljs-params">job: SchedulerJob</span>) &#123;<br>  <span class="hljs-comment">// 判断条件：主任务队列为空 或者 有正在执行的任务且没有在主任务队列中  &amp;&amp; job 不能和当前正在执行任务及后面待执行任务相同</span><br>  <span class="hljs-comment">// 重复数据删除：</span><br>  <span class="hljs-comment">// - 使用Array.includes(Obj, startIndex) 的 起始索引参数：startIndex</span><br>  <span class="hljs-comment">// - startIndex默认为包含当前正在运行job的index，此时，它不能再次递归触发自身</span><br>  <span class="hljs-comment">// - 如果job是一个watch()回调函数或者当前job允许递归触发，则搜索索引将+1，以允许他递归触发自身-用户需要确保回调函数不会死循环</span><br>  <span class="hljs-keyword">if</span> (<br>    (!queue.<span class="hljs-property">length</span> ||<br>      !queue.<span class="hljs-title function_">includes</span>(<br>        job,<br>        isFlushing &amp;&amp; job.<span class="hljs-property">allowRecurse</span> ? flushIndex + <span class="hljs-number">1</span> : flushIndex<br>      )) &amp;&amp;<br>    job !== currentPreFlushParentJob<br>  ) &#123;<br>    <span class="hljs-keyword">if</span> (job.<span class="hljs-property">id</span> == <span class="hljs-literal">null</span>) &#123;<br>      queue.<span class="hljs-title function_">push</span>(job)<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      queue.<span class="hljs-title function_">splice</span>(<span class="hljs-title function_">findInsertionIndex</span>(job.<span class="hljs-property">id</span>), <span class="hljs-number">0</span>, job)<br>    &#125;<br>    <span class="hljs-title function_">queueFlush</span>()<br>  &#125;<br>&#125;<br><br> queueJob 维护job列队 并且调用  queueFlush<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">queueFlush</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-comment">// 避免重复调用flushJobs</span><br>  <span class="hljs-keyword">if</span> (!isFlushing &amp;&amp; !isFlushPending) &#123;<br>    isFlushPending = <span class="hljs-literal">true</span><br>     <span class="hljs-comment">//开启异步任务处理flushJobs</span><br>    currentFlushPromise = resolvedPromise.<span class="hljs-title function_">then</span>(flushJobs)<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>queueFlush 给每一个队列创建了微任务</p><h3 id="如何去理解Tick"><a href="#如何去理解Tick" class="headerlink" title="如何去理解Tick"></a>如何去理解Tick</h3><blockquote><p>vue更新dom是异步的，数据更新是同步的</p><p>当我们操作dom的时候发现数据获取的是上次的，就需要使用nextTick</p></blockquote><p>例如我们显示器是60FPS</p><p>那浏览器绘制一帧就是1000 &#x2F; 60  ≈ 16.6ms</p><p>那浏览器这一帧率做了什么</p><p>1.处理用户的事件，就是event 例如 click，input change 等。</p><p>2.执行定时器任务</p><p>3.执行 requestAnimationFrame 动画</p><p>4.执行dom 的回流与重绘</p><p>5.计算更新图层的绘制指令</p><p>6.绘制指令合并主线程 如果有空余时间会执行 requestidlecallback</p><p>所以 一个Tick 就是去做了这些事</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;div ref=&quot;box&quot; class=&quot;wraps&quot;&gt;<br>    &lt;div&gt;<br>      &lt;div class=&quot;item&quot; v-for=&quot;item in chatList&quot;&gt;<br>        &lt;div&gt;&#123;&#123; item.name &#125;&#125;:&lt;/div&gt;<br>        &lt;div&gt;&#123;&#123; item.message &#125;&#125;&lt;/div&gt;<br>      &lt;/div&gt;<br>    &lt;/div&gt;<br>  &lt;/div&gt;<br>  &lt;div class=&quot;ipt&quot;&gt;<br>    &lt;div&gt;<br>      &lt;textarea v-model=&quot;ipt&quot; type=&quot;text&quot; /&gt;<br>    &lt;/div&gt;<br>    &lt;div&gt;<br>      &lt;button @click=&quot;send&quot;&gt;send&lt;/button&gt;<br>    &lt;/div&gt;<br>  &lt;/div&gt;<br>&lt;HelloWorld&gt;&lt;/HelloWorld&gt;<br>&lt;/template&gt;<br> <br>&lt;script setup lang=&#x27;ts&#x27;&gt;<br>import &#123; reactive,ref,nextTick,getCurrentInstance, watch &#125; from &#x27;vue&#x27;<br>import HelloWorld from &#x27;./components/HelloWorld.vue&#x27;;<br>// let instance = getCurrentInstance()<br>// console.log(instance);<br>let current = ref(0)<br>watch(current,(newVal,oldVal)=&gt;&#123;<br>  console.log(newVal);<br>&#125;)<br>//next Tick<br>//60FPS 1000/60 = 16.7ms<br>// 1.处理用户的事件，就是event 例如 click，input change 等。<br> <br>// 2.执行定时器任务<br> <br>// 3.执行 requestAnimationFrame<br> <br>// 4.执行dom 的回流与重绘<br> <br>// 5.计算更新图层的绘制指令<br> <br>// 6.绘制指令合并主线程 如果有空余时间会执行 requestidlecallback<br> <br>// for (let i =0;i&lt;1000;i++) &#123;<br>//   current.value = i<br>// &#125;<br> <br>let chatList = reactive([<br>  &#123; name: &#x27;张三&#x27;, message: &quot;xxxxxxxxx&quot; &#125;,<br>])<br>let box = ref&lt;HTMLDivElement&gt;()<br>let ipt = ref(&#x27;&#x27;)<br>//Vue 更新dom是异步的 数据更新是同步<br>//我们本次执行的代码是同步代码<br>//当我们操作dom 的时候发现数据读取的是上次的 就需要使用nextIick<br>const send = async () =&gt; &#123;<br>  chatList.push(&#123;<br>     name:&quot;小满&quot;,<br>     message:ipt.value<br>  &#125;)<br>  //1.回调函数模式<br>  //2.async await 写法<br>  await nextTick()<br>  box.value!.scrollTop = 99999999<br> <br>  //ipt.value = &#x27;&#x27;<br>&#125;<br>&lt;/script&gt;<br> <br>&lt;style scoped lang=&#x27;less&#x27;&gt;<br>.wraps &#123;<br>  margin: 10px auto;<br>  width: 500px;<br>  height: 400px;<br>  overflow: auto;<br>  overflow-x: hidden;<br>  background: #fff;<br>  border: 1px solid #ccc;<br> <br>  .item &#123;<br>    width: 100%;<br>    height: 50px;<br>    background: #ccc;<br>    display: flex;<br>    align-items: center;<br>    padding: 0 10px;<br>    border-bottom: 1px solid #fff;<br>  &#125;<br>&#125;<br> <br>.ipt &#123;<br>  margin: 10px auto;<br>  width: 500px;<br>  height: 40px;<br>  background: #fff;<br>  border: 1px solid #ccc;<br> <br>  textarea &#123;<br>    width: 100%;<br>    height: 100%;<br>    border: none;<br>    outline: none;<br>  &#125;<br>  button &#123;<br>    width: 100px;<br>    margin: 10px 0;<br>    float: right;<br>  &#125;<br>&#125;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure><h2 id="vue开发移动-amp-打包APP"><a href="#vue开发移动-amp-打包APP" class="headerlink" title="vue开发移动&amp;打包APP"></a>vue开发移动&amp;打包APP</h2><h2 id="unocss原子化"><a href="#unocss原子化" class="headerlink" title="unocss原子化"></a>unocss原子化</h2><p>什么是css原子化？<br>CSS原子化的优缺点</p><p>1.减少了css体积，提高了css复用</p><p>2.减少起名的复杂度</p><p>3.增加了记忆成本 将css拆分为原子之后，你势必要记住一些class才能书写，哪怕tailwindcss提供了完善的工具链，你写background，也要记住开头是bg</p><h2 id="常见库"><a href="#常见库" class="headerlink" title="常见库"></a>常见库</h2><ul><li>lodash</li><li>gsap</li><li>Mitt — Bus</li><li>unplugin-auto-import — 自动引入ref之类的</li><li>vueuse</li><li>Tailwind CSS</li></ul>]]></content>
    
    
    <categories>
      
      <category>笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>vue2</title>
    <link href="/2023/03/22/%E7%AC%94%E8%AE%B0/vue2/"/>
    <url>/2023/03/22/%E7%AC%94%E8%AE%B0/vue2/</url>
    
    <content type="html"><![CDATA[<p>学习资源</p><p><a href="https://www.bilibili.com/video/BV1Zy4y1K7SH/">尚硅谷Vue2+3</a></p><h1 id="Vue核心"><a href="#Vue核心" class="headerlink" title="Vue核心"></a>Vue核心</h1><h2 id="vue简介"><a href="#vue简介" class="headerlink" title="vue简介"></a>vue简介</h2><ul><li>一套用于构建用户界面的<strong>渐进式</strong>JavaScript框架</li></ul><p><img src="/img/vue/image-20221107092117653.png" alt="image-20221107092117653"></p><h3 id="vue的特点"><a href="#vue的特点" class="headerlink" title="vue的特点"></a>vue的特点</h3><ul><li>采用组件化模式，提高代码复用率，且让代码更好维护</li><li>声明式编码，让编码人员无需直接操作DOM，提高开发效率</li></ul><p><img src="/img/vue/image-20221107092559052.png" alt="image-20221107092559052"></p><ul><li>使用虚拟DOM+优秀的Diff算法，尽量复用DOM节点</li></ul><h3 id="与其他JS框架的关联"><a href="#与其他JS框架的关联" class="headerlink" title="与其他JS框架的关联"></a>与其他JS框架的关联</h3><ul><li>借鉴 Angular 的模板和数据绑定技术</li><li>借鉴 React 的组件化和虚拟 DOM 技术</li></ul><h3 id="周边库"><a href="#周边库" class="headerlink" title="周边库"></a>周边库</h3><ul><li>vue-cli: vue 脚手架</li><li>vue-resource</li><li>axios </li><li>vue-router: 路由 </li><li>vuex: 状态管理 </li><li>element-ui: 基于 vue 的 UI 组件库(PC 端）</li></ul><h2 id="初体验Vue"><a href="#初体验Vue" class="headerlink" title="初体验Vue"></a>初体验Vue</h2><ul><li>想让Vue工作，就必须创建一个Vue实例，且要传入一个配置对象；</li><li>root容器里的代码依然符合html规范，只不过混入了一些特殊的Vue语法；</li><li>root容器里的代码被称为【Vue模板】；</li><li><strong>Vue实例和容器是一一对应的</strong>；</li><li>真实开发中只有一个Vue实例，并且会配合着组件一起使用；</li><li><code>&#123;&#123;xxx&#125;&#125;</code>中的xxx要写<strong>js表达式</strong>，且xxx可以自动读取到data中的所有属性；</li><li>一旦data中的数据发生改变，那么<strong>页面</strong>中用到该数据的地方也会自动更新；</li></ul><p>注意区分：<strong>js表达式 和 js代码</strong><strong>(语句)</strong></p><p>1.表达式：<strong>一个表达式会产生一个值</strong>，可以放在任何一个需要值的地方：</p><ul><li>(1). a</li><li>(2). a+b</li><li>(3). demo(1)</li><li>(4). x &#x3D;&#x3D;&#x3D; y ? ‘a’ : ‘b’</li></ul><p>2.js代码(语句)</p><ul><li>(1). if(){}</li><li>(2). for(){}</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- 准备好一个容器 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;demo&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Hello，&#123;&#123;name.toUpperCase()&#125;&#125;，&#123;&#123;address&#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span> &gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-title class_">Vue</span>.<span class="hljs-property">config</span>.<span class="hljs-property">productionTip</span> = <span class="hljs-literal">false</span> <span class="hljs-comment">//阻止 vue 在启动时生成生产提示。</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">//创建Vue实例</span></span><br><span class="language-javascript">        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;</span><br><span class="language-javascript">            <span class="hljs-attr">el</span>:<span class="hljs-string">&#x27;#demo&#x27;</span>, <span class="hljs-comment">//el用于指定当前Vue实例为哪个容器服务，值通常为css选择器字符串。</span></span><br><span class="language-javascript">            <span class="hljs-attr">data</span>:&#123; <span class="hljs-comment">//data中用于存储数据，数据供el所指定的容器去使用，值我们暂时先写成一个对象。</span></span><br><span class="language-javascript">                <span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;atguigu&#x27;</span>,</span><br><span class="language-javascript">                <span class="hljs-attr">address</span>:<span class="hljs-string">&#x27;广州&#x27;</span></span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;)</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="模板语法"><a href="#模板语法" class="headerlink" title="模板语法"></a>模板语法</h2><p>Vue模板语法有2大类：</p><h3 id="1、插值语法"><a href="#1、插值语法" class="headerlink" title="1、插值语法"></a>1、插值语法</h3><ul><li>功能：用于解析标签体内容</li><li>写法：<code>&#123;&#123;xxx&#125;&#125;</code>，xxx是js表达式，且可以直接读取到data中的所有属性</li></ul><h3 id="2、指令语法"><a href="#2、指令语法" class="headerlink" title="2、指令语法"></a>2、指令语法</h3><ul><li>功能：用于解析标签（包括：标签属性、标签体内容、绑定事件…..）</li><li>*举例：v-bind:href&#x3D;”xxx” 或  简写为 :href&#x3D;”xxx”，xxx同样要写js表达式，且可以直接读取到data中的所有属性</li><li>v-bind 可以简写为 ：</li><li>备注：Vue中有很多的指令，且形式都是：v-????，此处我们只是拿v-bind举个例子</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- 准备好一个容器--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;root&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>插值语法<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>你好，&#123;&#123;name&#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">hr</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>指令语法<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>        <span class="hljs-comment">&lt;!-- 大写--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">v-bind:href</span>=<span class="hljs-string">&quot;school.url.toUpperCase()&quot;</span> <span class="hljs-attr">x</span>=<span class="hljs-string">&quot;hello&quot;</span>&gt;</span>点我去&#123;&#123;school.name&#125;&#125;学习1<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">:href</span>=<span class="hljs-string">&quot;school.url&quot;</span> <span class="hljs-attr">x</span>=<span class="hljs-string">&quot;hello&quot;</span>&gt;</span>点我去&#123;&#123;school.name&#125;&#125;学习2<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-title class_">Vue</span>.<span class="hljs-property">config</span>.<span class="hljs-property">productionTip</span> = <span class="hljs-literal">false</span> <span class="hljs-comment">//阻止 vue 在启动时生成生产提示。</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;</span><br><span class="language-javascript">        <span class="hljs-attr">el</span>:<span class="hljs-string">&#x27;#root&#x27;</span>,</span><br><span class="language-javascript">        <span class="hljs-attr">data</span>:&#123;</span><br><span class="language-javascript">            <span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;jack&#x27;</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">school</span>:&#123;</span><br><span class="language-javascript">                <span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;尚硅谷&#x27;</span>,</span><br><span class="language-javascript">                <span class="hljs-attr">url</span>:<span class="hljs-string">&#x27;http://www.atguigu.com&#x27;</span>,</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    &#125;)</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="数据绑定"><a href="#数据绑定" class="headerlink" title="数据绑定"></a>数据绑定</h2><p>Vue中有2种数据绑定的方式：</p><h3 id="1、单向绑定-v-bind"><a href="#1、单向绑定-v-bind" class="headerlink" title="1、单向绑定(v-bind)"></a>1、单向绑定(v-bind)</h3><ul><li><p>语法：<code>v-bind:href =&quot;xxx&quot;</code> 或简写为 <code>:hre = &quot;xxx&quot;</code></p></li><li><p>数据只能从data流向页面</p></li></ul><h3 id="2、双向绑定-v-model"><a href="#2、双向绑定-v-model" class="headerlink" title="2、双向绑定(v-model)"></a>2、双向绑定(v-model)</h3><ul><li><p>语法：<code>v-mode:value=&quot;xxx&quot;</code> 或简写为 <code>v-model=&quot;xxx&quot;</code></p></li><li><p>数据不仅能从data流向页面，还可以从页面流向data</p></li><li><p><code>v-model</code>只能应用在<strong>表单类元素（输入类元素）</strong></p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- 准备好一个容器--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;root&quot;</span>&gt;</span><br>        <span class="hljs-comment">&lt;!-- 普通写法 --&gt;</span><br>        <span class="hljs-comment">&lt;!-- 单向数据绑定：&lt;input type=&quot;text&quot; v-bind:value=&quot;name&quot;&gt;&lt;br/&gt;</span><br><span class="hljs-comment">        双向数据绑定：&lt;input type=&quot;text&quot; v-model:value=&quot;name&quot;&gt;&lt;br/&gt; --&gt;</span><br><br>        <span class="hljs-comment">&lt;!-- 简写 --&gt;</span><br>        单向数据绑定：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">:value</span>=<span class="hljs-string">&quot;name&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br>        双向数据绑定：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;name&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br><br>        <span class="hljs-comment">&lt;!-- 如下代码是错误的，因为v-model只能应用在表单类元素（输入类元素）上 --&gt;</span><br>        <span class="hljs-comment">&lt;!-- &lt;h2 v-model:x=&quot;name&quot;&gt;你好啊&lt;/h2&gt; --&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-title class_">Vue</span>.<span class="hljs-property">config</span>.<span class="hljs-property">productionTip</span> = <span class="hljs-literal">false</span> <span class="hljs-comment">//阻止 vue 在启动时生成生产提示。</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;</span><br><span class="language-javascript">        <span class="hljs-attr">el</span>:<span class="hljs-string">&#x27;#root&#x27;</span>,</span><br><span class="language-javascript">        <span class="hljs-attr">data</span>:&#123;</span><br><span class="language-javascript">            <span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;尚硅谷&#x27;</span></span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    &#125;)</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="data与el的2种写法"><a href="#data与el的2种写法" class="headerlink" title="data与el的2种写法"></a>data与el的2种写法</h3><h4 id="1、el有2种写法"><a href="#1、el有2种写法" class="headerlink" title="1、el有2种写法"></a>1、el有2种写法</h4><p>(1).new Vue时候配置el属性。</p><p>(2).先创建Vue实例，随后再通过vm.$mount(‘#root’)指定el的值</p><h4 id="2、data有2种写法"><a href="#2、data有2种写法" class="headerlink" title="2、data有2种写法"></a>2、data有2种写法</h4><p>(1).对象式</p><p>(2).函数式后面学到组件时，必须使用函数式</p><blockquote><p>重要的原则：由Vue管理的函数，一定不要写<strong>箭头函数</strong>，一旦写了箭头函数，this就不再是Vue实例了。</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-comment">//el的两种写法</span></span><br><span class="language-javascript">    <span class="hljs-comment">/* const v = new Vue(&#123;</span></span><br><span class="hljs-comment"><span class="language-javascript">        //el:&#x27;#root&#x27;, //第一种写法</span></span><br><span class="hljs-comment"><span class="language-javascript">        data:&#123;</span></span><br><span class="hljs-comment"><span class="language-javascript">            name:&#x27;尚硅谷&#x27;</span></span><br><span class="hljs-comment"><span class="language-javascript">        &#125;</span></span><br><span class="hljs-comment"><span class="language-javascript">    &#125;)</span></span><br><span class="hljs-comment"><span class="language-javascript">    console.log(v)</span></span><br><span class="hljs-comment"><span class="language-javascript">    v.$mount(&#x27;#root&#x27;) //第二种写法 */</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-comment">//data的两种写法</span></span><br><span class="language-javascript">    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;</span><br><span class="language-javascript">        <span class="hljs-attr">el</span>:<span class="hljs-string">&#x27;#root&#x27;</span>,</span><br><span class="language-javascript">        <span class="hljs-comment">//data的第一种写法：对象式</span></span><br><span class="language-javascript">        <span class="hljs-comment">/* data:&#123;</span></span><br><span class="hljs-comment"><span class="language-javascript">            name:&#x27;尚硅谷&#x27;</span></span><br><span class="hljs-comment"><span class="language-javascript">        &#125; */</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">//data的第二种写法：函数式</span></span><br><span class="language-javascript">        <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>)&#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;@@@&#x27;</span>,<span class="hljs-variable language_">this</span>) <span class="hljs-comment">//此处的this是Vue实例对象</span></span><br><span class="language-javascript">            <span class="hljs-keyword">return</span>&#123;</span><br><span class="language-javascript">                <span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;尚硅谷&#x27;</span></span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    &#125;)</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="MVVM模型"><a href="#MVVM模型" class="headerlink" title="MVVM模型"></a>MVVM模型</h3><ul><li>M：模型(Model) ：对应 data 中的数据 </li><li>V：视图(View) ：模板 </li><li>VM：视图模型(ViewModel) ： Vue 实例对象</li></ul><p><img src="/img/vue/Snipaste_2022-11-12_00-08-03.png" alt="image"></p><ul><li>data中所有的属性，最后都出现在了vm身上(创建Vue实例时用wm接收)</li><li><strong>vm身上所有的属性 及 Vue原型上所有属性，在Vue模板中都可以直接使用</strong></li></ul><h2 id="数据代理"><a href="#数据代理" class="headerlink" title="数据代理"></a>数据代理</h2><h4 id="Object-defineProperty-的使用"><a href="#Object-defineProperty-的使用" class="headerlink" title="Object.defineProperty() 的使用"></a><code>Object.defineProperty()</code> 的使用</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> person = &#123;<br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Vue&#x27;</span>,<br>  <span class="hljs-attr">sex</span>: <span class="hljs-string">&#x27;none&#x27;</span>,<br>&#125;<br><span class="hljs-keyword">let</span> number = <span class="hljs-number">19</span><br><br><span class="hljs-comment">// 配置一</span><br><span class="hljs-comment">// 参数：对象、属性名、配置</span><br><span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(person, <span class="hljs-string">&#x27;age&#x27;</span>, &#123;<br>  <span class="hljs-comment">// 属性值</span><br>  <span class="hljs-attr">value</span>: <span class="hljs-number">21</span>,<br>  <span class="hljs-comment">// 属性是否可修改</span><br>  <span class="hljs-attr">writable</span>: <span class="hljs-literal">true</span>,<br>  <span class="hljs-comment">// 属性是否可枚举（遍历）</span><br>  <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,<br>  <span class="hljs-comment">// 属性是否可删除</span><br>  <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,<br>&#125;)<br><br><span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(person)<br><br><span class="hljs-comment">// 配置二</span><br><span class="hljs-comment">// getter、setter 不能和 value、writable 同时指定</span><br><span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(person, <span class="hljs-string">&#x27;age&#x27;</span>, &#123;<br>  <span class="hljs-attr">enumberable</span>: <span class="hljs-literal">true</span>,<br>  <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,<br><br>  <span class="hljs-comment">//当有人读取person的age属性时，get函数(getter)就会被调用，且返回值就是age的值</span><br>  <span class="hljs-title function_">get</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;age 属性被读取&#x27;</span>)<br>    <span class="hljs-keyword">return</span> number<br>  &#125;<br>  <span class="hljs-comment">//当有人修改person的age属性时，set函数(setter)就会被调用，且会收到修改的具体值</span><br>  <span class="hljs-title function_">set</span>(<span class="hljs-params">value</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;age 属性被修改&#x27;</span>, value)<br>    number = value<br>  &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="何为数据代理"><a href="#何为数据代理" class="headerlink" title="何为数据代理"></a>何为数据代理</h3><ul><li>数据代理：通过一个对象对另一个对象的属性进行操作</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> obj = &#123; <span class="hljs-attr">a</span>: <span class="hljs-number">21</span> &#125;<br><span class="hljs-keyword">let</span> obj2 = &#123; <span class="hljs-attr">b</span>: <span class="hljs-number">10</span> &#125;<br><br><span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(obj2, <span class="hljs-string">&#x27;a&#x27;</span>, &#123;<br>  <span class="hljs-title function_">get</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> obj.<span class="hljs-property">a</span><br>  &#125;<br>  <span class="hljs-title function_">set</span>(<span class="hljs-params">value</span>) &#123;<br>    obj.<span class="hljs-property">a</span> = value<br>  &#125;<br>&#125;)<br><br>obj2.<span class="hljs-property">a</span> <span class="hljs-comment">// 21</span><br>obj2.<span class="hljs-property">a</span> = <span class="hljs-number">1000</span><br>obj.<span class="hljs-property">a</span> <span class="hljs-comment">// 1000</span><br></code></pre></td></tr></table></figure><h3 id="Vue-中的数据代理"><a href="#Vue-中的数据代理" class="headerlink" title="Vue 中的数据代理"></a>Vue 中的数据代理</h3><h4 id="1-Vue中的数据代理："><a href="#1-Vue中的数据代理：" class="headerlink" title="1.Vue中的数据代理："></a>1.Vue中的数据代理：</h4><ul><li>通过vm对象来代理data对象中属性的操作（读&#x2F;写）</li></ul><h4 id="2-Vue中数据代理的好处："><a href="#2-Vue中数据代理的好处：" class="headerlink" title="2.Vue中数据代理的好处："></a>2.Vue中数据代理的好处：</h4><ul><li>更加方便的操作data中的数据</li></ul><h4 id="3-基本原理："><a href="#3-基本原理：" class="headerlink" title="3.基本原理："></a>3.基本原理：</h4><ul><li><p>通过Object.defineProperty()把data对象中所有属性添加到vm上。</p></li><li><p>为每一个添加到vm上的属性，都指定一个getter&#x2F;setter。</p></li><li><p>在getter&#x2F;setter内部去操作（读&#x2F;写）data中对应的属性。</p></li></ul><p><img src="/img/vue/Snipaste_2022-11-12_09-58-53.png" alt="image"></p><ul><li><p>Vue 中通过 vm 实例对象代理对 data 对象属性的操作，让我们更方便操作 data 中的数据。</p></li><li><p>data 中的数据实际上被存在 <code>vm._data</code> 属性上，如果不进行代理，使用起来很不方便。</p></li><li><p>通过 <code>Object.defineProperty()</code> 给 vm 添加属性，并且指定 getter 和 setter，通过 getter 和 setter 访问和修改 data 对应是属性。</p></li></ul><h2 id="事件处理"><a href="#事件处理" class="headerlink" title="事件处理"></a>事件处理</h2><h3 id="事件的基本使用"><a href="#事件的基本使用" class="headerlink" title="事件的基本使用"></a>事件的基本使用</h3><ul><li><p>使用v-on:xxx 或 @xxx 绑定事件，其中xxx是事件名；</p></li><li><p>事件的回调需要配置在methods对象中，最终会在vm上；</p></li><li><p>methods中配置的函数，不要用箭头函数！否则this就不是vm了；</p></li><li><p>methods中配置的函数，都是被Vue所管理的函数，this的指向是vm 或 组件实例对象；</p></li><li><p>@click&#x3D;”demo” 和 @click&#x3D;”demo($event)” 效果一致，但后者可以传参；</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- 准备好一个容器--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;root&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>欢迎来到&#123;&#123;name&#125;&#125;学习<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br>        <span class="hljs-comment">&lt;!-- &lt;button v-on:click=&quot;showInfo&quot;&gt;点我提示信息&lt;/button&gt; --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;showInfo1&quot;</span>&gt;</span>点我提示信息1（不传参）<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>        // 默认事件形参: event隐含属性对象: $event  占位，否则传参的时候会把event搞丢<br>        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;showInfo2($event,66)&quot;</span>&gt;</span>点我提示信息2（传参）<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-title class_">Vue</span>.<span class="hljs-property">config</span>.<span class="hljs-property">productionTip</span> = <span class="hljs-literal">false</span> <span class="hljs-comment">//阻止 vue 在启动时生成生产提示。</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-keyword">const</span> vm = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;</span><br><span class="language-javascript">        <span class="hljs-attr">el</span>:<span class="hljs-string">&#x27;#root&#x27;</span>,</span><br><span class="language-javascript">        <span class="hljs-attr">data</span>:&#123;</span><br><span class="language-javascript">            <span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;尚硅谷&#x27;</span>,</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-attr">methods</span>:&#123;</span><br><span class="language-javascript">            <span class="hljs-title function_">showInfo1</span>(<span class="hljs-params">event</span>)&#123;</span><br><span class="language-javascript">                <span class="hljs-comment">// console.log(event.target.innerText)</span></span><br><span class="language-javascript">                <span class="hljs-comment">// console.log(this) //此处的this是vm</span></span><br><span class="language-javascript">                <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;同学你好！&#x27;</span>)</span><br><span class="language-javascript">            &#125;,</span><br><span class="language-javascript">            <span class="hljs-title function_">showInfo2</span>(<span class="hljs-params">event,number</span>)&#123;</span><br><span class="language-javascript">                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(event,number)</span><br><span class="language-javascript">                <span class="hljs-comment">// console.log(event.target.innerText)</span></span><br><span class="language-javascript">                <span class="hljs-comment">// console.log(this) //此处的this是vm</span></span><br><span class="language-javascript">                <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;同学你好！！&#x27;</span>)</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    &#125;)</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><ul><li><p>如果事件处理函数没有传参，则默认会传一个时间参数对象 <code>$event</code> ，通过它可以获取触发事件的元素，并进行相关操作。</p></li><li><p>如果事件处理函数传递参数了，则默认的 <code>$event</code> 会被覆盖，需要手动进行传递。</p></li></ul><h3 id="事件修饰符"><a href="#事件修饰符" class="headerlink" title="事件修饰符"></a>事件修饰符</h3><table><thead><tr><th>事件修饰符</th><th>说明</th></tr></thead><tbody><tr><td><strong>.prevent</strong></td><td>阻止默认行为，如 a 链接跳转、表单提交</td></tr><tr><td><strong>.stop</strong></td><td>阻止事件冒泡</td></tr><tr><td>.once</td><td>绑定的事件只触发 1 次</td></tr><tr><td>.capture</td><td>以捕获模式触发事件处理函数</td></tr><tr><td>.self</td><td>只有在 <code>event.target</code> 是当前元素自身时触发事件处理函数</td></tr><tr><td>.passive</td><td>事件的默认行为立即执行，无需等待事件回调执行完毕</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- 准备好一个容器--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;root&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>欢迎来到&#123;&#123;name&#125;&#125;学习<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br>        <span class="hljs-comment">&lt;!-- 阻止默认事件（常用） --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;http://www.atguigu.com&quot;</span> @<span class="hljs-attr">click.prevent</span>=<span class="hljs-string">&quot;showInfo&quot;</span>&gt;</span>点我提示信息<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><br>        <span class="hljs-comment">&lt;!-- 阻止事件冒泡（常用） --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;demo1&quot;</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;showInfo&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click.stop</span>=<span class="hljs-string">&quot;showInfo&quot;</span>&gt;</span>点我提示信息<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>            <span class="hljs-comment">&lt;!-- 修饰符可以连续写 --&gt;</span><br>            <span class="hljs-comment">&lt;!-- &lt;a href=&quot;http://www.atguigu.com&quot; @click.prevent.stop=&quot;showInfo&quot;&gt;点我提示信息&lt;/a&gt; --&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>        <span class="hljs-comment">&lt;!-- 事件只触发一次（常用） --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click.once</span>=<span class="hljs-string">&quot;showInfo&quot;</span>&gt;</span>点我提示信息<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br><br>        <span class="hljs-comment">&lt;!-- 使用事件的捕获模式 --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;box1&quot;</span> @<span class="hljs-attr">click.capture</span>=<span class="hljs-string">&quot;showMsg(1)&quot;</span>&gt;</span><br>            div1<br>            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;box2&quot;</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;showMsg(2)&quot;</span>&gt;</span><br>                div2<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>        <span class="hljs-comment">&lt;!-- 只有event.target是当前操作的元素时才触发事件； --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;demo1&quot;</span> @<span class="hljs-attr">click.self</span>=<span class="hljs-string">&quot;showInfo&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;showInfo&quot;</span>&gt;</span>点我提示信息<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br> <span class="hljs-comment">&lt;!-- .passive ：如 `onwheel` 鼠标滚轮事件，是先执行事件的回调再进行滚动。 --&gt;</span><br><span class="hljs-comment">&lt;!-- 如果回调比较耗时，那么会等一段时间才发生滚动。 添加 .passive 后，则先进行滚动再执行回调。--&gt;</span><br>        <span class="hljs-comment">&lt;!-- 事件的默认行为立即执行，无需等待事件回调执行完毕； --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">ul</span> @<span class="hljs-attr">wheel.passive</span>=<span class="hljs-string">&quot;demo&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;list&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>2<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>3<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>4<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><br><br></code></pre></td></tr></table></figure><h3 id="按键修饰符"><a href="#按键修饰符" class="headerlink" title="按键修饰符"></a>按键修饰符</h3><h4 id="1、Vue中常用的按键别名："><a href="#1、Vue中常用的按键别名：" class="headerlink" title="1、Vue中常用的按键别名："></a>1、Vue中常用的按键别名：</h4><ul><li><p>回车 &#x3D;&gt; enter</p></li><li><p>删除 &#x3D;&gt; delete (捕获“删除”和“退格”键)</p></li><li><p>退出 &#x3D;&gt; esc</p></li><li><p>空格 &#x3D;&gt; space</p></li><li><p>换行 &#x3D;&gt; tab (特殊，必须配合keydown去使用)</p></li><li><p>上 &#x3D;&gt; up</p></li><li><p>下 &#x3D;&gt; down</p></li><li><p>左 &#x3D;&gt; left</p></li><li><p>右 &#x3D;&gt; right</p></li></ul><h4 id="2、-Vue未提供别名的按键"><a href="#2、-Vue未提供别名的按键" class="headerlink" title="2、 Vue未提供别名的按键"></a>2、 Vue未提供别名的按键</h4><ul><li>可以使用按键原始的key值去绑定，但注意要转为kebab-case（短横线命名）</li></ul><h4 id="3、系统修饰键（用法特殊）：ctrl、alt、shift、meta"><a href="#3、系统修饰键（用法特殊）：ctrl、alt、shift、meta" class="headerlink" title="3、系统修饰键（用法特殊）：ctrl、alt、shift、meta"></a>3、系统修饰键（用法特殊）：ctrl、alt、shift、meta</h4><ul><li><p>配合keyup使用：按下修饰键的同时，再按下其他键，随后释放其他键，事件才被触发。</p></li><li><p>配合keydown使用：正常触发事件。</p></li></ul><h4 id="4、也可以使用keyCode去指定具体的按键（不推荐）"><a href="#4、也可以使用keyCode去指定具体的按键（不推荐）" class="headerlink" title="4、也可以使用keyCode去指定具体的按键（不推荐）"></a>4、也可以使用keyCode去指定具体的按键（不推荐）</h4><h4 id="5、Vue-config-keyCodes-自定义键名-x3D-键码"><a href="#5、Vue-config-keyCodes-自定义键名-x3D-键码" class="headerlink" title="5、Vue.config.keyCodes.自定义键名 &#x3D; 键码"></a>5、Vue.config.keyCodes.自定义键名 &#x3D; 键码</h4><ul><li>可以去定制按键别名</li></ul><h4 id="6、修饰符可以连续写"><a href="#6、修饰符可以连续写" class="headerlink" title="6、修饰符可以连续写"></a>6、修饰符可以连续写</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> @<span class="hljs-attr">keyup.enter</span>=<span class="hljs-string">&quot;submit&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> @<span class="hljs-attr">keyup.esc</span>=<span class="hljs-string">&quot;back&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> @<span class="hljs-attr">keydown.tab</span>=<span class="hljs-string">&quot;showInfo&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> @<span class="hljs-attr">keyup.caps-lock</span>=<span class="hljs-string">&quot;showInfo&quot;</span> /&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> @<span class="hljs-attr">keyup.huiche</span>=<span class="hljs-string">&quot;showInfo&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> @<span class="hljs-attr">keyup.13</span>=<span class="hljs-string">&quot;showInfo&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><br>  Vue.config.keyCodes.huiche = 13<br><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="计算属性"><a href="#计算属性" class="headerlink" title="计算属性"></a>计算属性</h2><h3 id="插值语法实现"><a href="#插值语法实现" class="headerlink" title="插值语法实现"></a>插值语法实现</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- 准备好一个容器--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;root&quot;</span>&gt;</span><br>        姓：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;firstName&quot;</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br>        名：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;lastName&quot;</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br>        全名：<span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>&#123;&#123;firstName&#125;&#125;-&#123;&#123;lastName&#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;</span><br><span class="language-javascript">        <span class="hljs-attr">el</span>:<span class="hljs-string">&#x27;#root&#x27;</span>,</span><br><span class="language-javascript">        <span class="hljs-attr">data</span>:&#123;</span><br><span class="language-javascript">            <span class="hljs-attr">firstName</span>:<span class="hljs-string">&#x27;张&#x27;</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">lastName</span>:<span class="hljs-string">&#x27;三&#x27;</span></span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    &#125;)</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="methods实现"><a href="#methods实现" class="headerlink" title="methods实现"></a>methods实现</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- 准备好一个容器--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;root&quot;</span>&gt;</span><br>        姓：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;firstName&quot;</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br>        名：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;lastName&quot;</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br>        全名：<span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>&#123;&#123;fullName()&#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;</span><br><span class="language-javascript">        <span class="hljs-attr">el</span>:<span class="hljs-string">&#x27;#root&#x27;</span>,</span><br><span class="language-javascript">        <span class="hljs-attr">data</span>:&#123;</span><br><span class="language-javascript">            <span class="hljs-attr">firstName</span>:<span class="hljs-string">&#x27;张&#x27;</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">lastName</span>:<span class="hljs-string">&#x27;三&#x27;</span></span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-attr">methods</span>: &#123;</span><br><span class="language-javascript">            <span class="hljs-title function_">fullName</span>(<span class="hljs-params"></span>)&#123;</span><br><span class="language-javascript">                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;@---fullName&#x27;</span>)</span><br><span class="language-javascript">                <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">firstName</span> + <span class="hljs-string">&#x27;-&#x27;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">lastName</span></span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">    &#125;)</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="计算属性computed实现"><a href="#计算属性computed实现" class="headerlink" title="计算属性computed实现"></a>计算属性computed实现</h3><p><strong>计算属性：</strong></p><h4 id="1-定义"><a href="#1-定义" class="headerlink" title="1.定义"></a>1.定义</h4><ul><li>要用的属性不存在，要通过已有属性计算得来。</li></ul><h4 id="2-原理"><a href="#2-原理" class="headerlink" title="2.原理"></a>2.原理</h4><ul><li>底层借助了Objcet.defineproperty方法提供的getter和setter。</li></ul><h4 id="3-get函数什么时候执行？"><a href="#3-get函数什么时候执行？" class="headerlink" title="3.get函数什么时候执行？"></a>3.get函数什么时候执行？</h4><ul><li><p>初次读取时会执行一次。</p></li><li><p>当<strong>依赖的数据</strong>发生改变时会被再次调用。</p></li></ul><h4 id="4-优势"><a href="#4-优势" class="headerlink" title="4.优势"></a>4.优势</h4><ul><li>与methods实现相比，内部有缓存机制（复用），效率更高，调试方便。</li></ul><h4 id="5-备注"><a href="#5-备注" class="headerlink" title="5.备注"></a>5.备注</h4><ul><li><p>计算属性最终会出现在<strong>vm</strong>上，直接读取使用即可。</p></li><li><p>如果计算属性要被修改，那必须写<strong>set函数去响应修改</strong>，且set中要引起计算时依赖的数据发生改变。</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- 准备好一个容器--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;root&quot;</span>&gt;</span><br>        姓：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;firstName&quot;</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br>        名：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;lastName&quot;</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br>        全名：<span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>&#123;&#123;fullName&#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-title class_">Vue</span>.<span class="hljs-property">config</span>.<span class="hljs-property">productionTip</span> = <span class="hljs-literal">false</span> <span class="hljs-comment">//阻止 vue 在启动时生成生产提示。</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-keyword">const</span> vm = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;</span><br><span class="language-javascript">        <span class="hljs-attr">el</span>:<span class="hljs-string">&#x27;#root&#x27;</span>,</span><br><span class="language-javascript">        <span class="hljs-attr">data</span>:&#123;</span><br><span class="language-javascript">            <span class="hljs-attr">firstName</span>:<span class="hljs-string">&#x27;张&#x27;</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">lastName</span>:<span class="hljs-string">&#x27;三&#x27;</span>,</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-attr">computed</span>:&#123;</span><br><span class="language-javascript">            <span class="hljs-attr">fullName</span>:&#123;</span><br><span class="language-javascript">                <span class="hljs-comment">//get有什么作用？当有人读取fullName时，get就会被调用，且返回值就作为fullName的值</span></span><br><span class="language-javascript">                <span class="hljs-comment">//get什么时候调用？1.初次读取fullName时。2.所依赖的数据发生变化时。</span></span><br><span class="language-javascript">                <span class="hljs-title function_">get</span>(<span class="hljs-params"></span>)&#123;</span><br><span class="language-javascript">                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;get被调用了&#x27;</span>)</span><br><span class="language-javascript">                    <span class="hljs-comment">// console.log(this) //此处的this是vm</span></span><br><span class="language-javascript">                    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">firstName</span> + <span class="hljs-string">&#x27;-&#x27;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">lastName</span></span><br><span class="language-javascript">                &#125;,</span><br><span class="language-javascript">                <span class="hljs-comment">//set什么时候调用? 当fullName被修改时。</span></span><br><span class="language-javascript">                <span class="hljs-title function_">set</span>(<span class="hljs-params">value</span>)&#123;</span><br><span class="language-javascript">                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;set&#x27;</span>,value)</span><br><span class="language-javascript">                    <span class="hljs-keyword">const</span> arr = value.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;-&#x27;</span>)</span><br><span class="language-javascript">                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">firstName</span> = arr[<span class="hljs-number">0</span>]</span><br><span class="language-javascript">                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">lastName</span> = arr[<span class="hljs-number">1</span>]</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    &#125;)</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="简写"><a href="#简写" class="headerlink" title="简写"></a><strong>简写</strong></h4><ul><li>只读不修改</li><li>对象格式变成了函数格式，但fullName依旧是一个属性值</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//简写</span><br><span class="hljs-title function_">fullName</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;get被调用了&#x27;</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">firstName</span> + <span class="hljs-string">&#x27;-&#x27;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">lastName</span><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="侦听器watch"><a href="#侦听器watch" class="headerlink" title="侦听器watch"></a>侦听器watch</h2><p><code>watch</code> 侦听器允许开发者监视数据的变化，针对数据的变化做特定的操作</p><h3 id="侦听器watch-1"><a href="#侦听器watch-1" class="headerlink" title="侦听器watch"></a>侦听器watch</h3><p>1、当被监视的属性变化时, 回调函数自动调用, 进行相关操作</p><p>2、监视的属性必须存在，才能进行监视！！</p><p>3、监视的两种写法：</p><ul><li><p>new Vue时传入watch配置（明确要监视哪个）</p></li><li><p>通过vm.$watch监视（未明确要监视哪个，用户自己添加）</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-comment">&lt;!-- 准备好一个容器--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;root&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>今天天气很&#123;&#123;info&#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;changeWeather&quot;</span>&gt;</span>切换天气<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-title class_">Vue</span>.<span class="hljs-property">config</span>.<span class="hljs-property">productionTip</span> = <span class="hljs-literal">false</span> <span class="hljs-comment">//阻止 vue 在启动时生成生产提示。</span></span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">const</span> vm = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;</span><br><span class="language-javascript"><span class="hljs-attr">el</span>: <span class="hljs-string">&#x27;#root&#x27;</span>,</span><br><span class="language-javascript"><span class="hljs-attr">data</span>: &#123;</span><br><span class="language-javascript"><span class="hljs-attr">isHot</span>: <span class="hljs-literal">true</span>,</span><br><span class="language-javascript">&#125;,</span><br><span class="language-javascript"><span class="hljs-attr">computed</span>: &#123;</span><br><span class="language-javascript"><span class="hljs-title function_">info</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript"><span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">isHot</span> ? <span class="hljs-string">&#x27;炎热&#x27;</span> : <span class="hljs-string">&#x27;凉爽&#x27;</span></span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript">&#125;,</span><br><span class="language-javascript"><span class="hljs-attr">methods</span>: &#123;</span><br><span class="language-javascript"><span class="hljs-title function_">changeWeather</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript"><span class="hljs-variable language_">this</span>.<span class="hljs-property">isHot</span> = !<span class="hljs-variable language_">this</span>.<span class="hljs-property">isHot</span></span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript">&#125;,</span><br><span class="language-javascript"><span class="hljs-attr">watch</span>: &#123;</span><br><span class="language-javascript"><span class="hljs-attr">isHot</span>: &#123;</span><br><span class="language-javascript"><span class="hljs-attr">immediate</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">//初始化时让handler调用一下</span></span><br><span class="language-javascript"><span class="hljs-comment">//handler什么时候调用？当isHot发生改变时。</span></span><br><span class="language-javascript"><span class="hljs-title function_">handler</span>(<span class="hljs-params">newValue, oldValue</span>) &#123;</span><br><span class="language-javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;isHot被修改了&#x27;</span>, newValue, oldValue)</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript">&#125;)</span><br><span class="language-javascript"></span><br><span class="language-javascript">vm.$watch(<span class="hljs-string">&#x27;isHot&#x27;</span>, &#123;</span><br><span class="language-javascript"><span class="hljs-attr">immediate</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">//初始化时让handler调用一下</span></span><br><span class="language-javascript"><span class="hljs-comment">//handler什么时候调用？当isHot发生改变时。</span></span><br><span class="language-javascript"><span class="hljs-title function_">handler</span>(<span class="hljs-params">newValue, oldValue</span>) &#123;</span><br><span class="language-javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;isHot被修改了&#x27;</span>, newValue, oldValue)</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript">&#125;)</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><ul><li>默认情况下，组件在初次加载完毕后不会调用 <code>watch</code> 侦听器。如果想让 <code>watch</code> 侦听器立即被调用，需要使用 <code>immediate</code> 选项</li></ul><h3 id="深度监视"><a href="#深度监视" class="headerlink" title="深度监视"></a>深度监视</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> vm = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;<br><span class="hljs-attr">el</span>:<span class="hljs-string">&#x27;#root&#x27;</span>,<br><span class="hljs-attr">data</span>:&#123;<br><span class="hljs-attr">isHot</span>:<span class="hljs-literal">true</span>,<br><span class="hljs-attr">numbers</span>:&#123;<br><span class="hljs-attr">a</span>:<span class="hljs-number">1</span>,<br><span class="hljs-attr">b</span>:<span class="hljs-number">1</span>,<br>&#125;<br>&#125;,<br><span class="hljs-attr">computed</span>:&#123;<br><span class="hljs-title function_">info</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">isHot</span> ? <span class="hljs-string">&#x27;炎热&#x27;</span> : <span class="hljs-string">&#x27;凉爽&#x27;</span><br>&#125;<br>&#125;,<br><span class="hljs-attr">methods</span>: &#123;<br><span class="hljs-title function_">changeWeather</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">isHot</span> = !<span class="hljs-variable language_">this</span>.<span class="hljs-property">isHot</span><br>&#125;<br>&#125;,<br><span class="hljs-attr">watch</span>:&#123;<br><span class="hljs-attr">isHot</span>:&#123;<br><span class="hljs-comment">// immediate:true, //初始化时让handler调用一下</span><br><span class="hljs-comment">//handler什么时候调用？当isHot发生改变时。</span><br><span class="hljs-title function_">handler</span>(<span class="hljs-params">newValue,oldValue</span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;isHot被修改了&#x27;</span>,newValue,oldValue)<br>&#125;<br>&#125;,<br><span class="hljs-comment">//监视多级结构中某个属性的变化</span><br><span class="hljs-string">&#x27;numbers.a&#x27;</span>:&#123;<span class="hljs-comment">// 这里一定要加引号，否则会报错，因为a不属于wm的属性，number才算</span><br><span class="hljs-title function_">handler</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;a被改变了&#x27;</span>)<br>&#125;<br>&#125; <br><span class="hljs-comment">//监视多级结构中所有属性的变化</span><br><span class="hljs-attr">numbers</span>:&#123;<br><span class="hljs-attr">deep</span>:<span class="hljs-literal">true</span>,<span class="hljs-comment">// 默认为false，需要修改才能运用</span><br><span class="hljs-title function_">handler</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;numbers改变了&#x27;</span>)<br>&#125;<br>&#125;<br>&#125;<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="简写-1"><a href="#简写-1" class="headerlink" title="简写"></a>简写</h3><p>只有hadler() 才能简写</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">watch</span>:&#123;<br><span class="hljs-comment">//正常写法</span><br><span class="hljs-comment">/* isHot:&#123;</span><br><span class="hljs-comment">// immediate:true, //初始化时让handler调用一下</span><br><span class="hljs-comment">// deep:true,//深度监视</span><br><span class="hljs-comment">handler(newValue,oldValue)&#123;</span><br><span class="hljs-comment">console.log(&#x27;isHot被修改了&#x27;,newValue,oldValue)</span><br><span class="hljs-comment">&#125;</span><br><span class="hljs-comment">&#125;, */</span><br><span class="hljs-comment">//简写</span><br><span class="hljs-title function_">isHot</span>(<span class="hljs-params">newValue,oldValue</span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;isHot被修改了&#x27;</span>,newValue,oldValue,<span class="hljs-variable language_">this</span>)<br>&#125;<br>&#125;<br><br><span class="hljs-comment">//正常写法</span><br>vm.$watch(<span class="hljs-string">&#x27;isHot&#x27;</span>,&#123;<br><span class="hljs-attr">immediate</span>:<span class="hljs-literal">true</span>, <span class="hljs-comment">//初始化时让handler调用一下</span><br><span class="hljs-attr">deep</span>:<span class="hljs-literal">true</span>,<span class="hljs-comment">//深度监视</span><br><span class="hljs-title function_">handler</span>(<span class="hljs-params">newValue,oldValue</span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;isHot被修改了&#x27;</span>,newValue,oldValue)<br>&#125;<br>&#125;)<br><br><span class="hljs-comment">//简写</span><br>vm.$watch(<span class="hljs-string">&#x27;isHot&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">newValue,oldValue</span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;isHot被修改了&#x27;</span>,newValue,oldValue,<span class="hljs-variable language_">this</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="watch和computed区别"><a href="#watch和computed区别" class="headerlink" title="watch和computed区别"></a>watch和computed区别</h3><p>1.computed能完成的功能，watch都可以完成。</p><p>2.watch能完成的功能，computed不一定能完成，例如：watch可以进行异步操作。</p><p><strong>两个重要的小原则</strong>：</p><p>1.所有被Vue管理的函数，最好写成普通函数，这样<strong>this的指向才是vm 或 组件实例对象</strong>。</p><p>2.所有<strong>不被Vue所管理的函数</strong>（定时器的回调函数、<code>ajax</code>的回调函数等、<code>Promise</code>的回调函数），最好写成箭头函数，这样<strong>this的指向才是vm 或 组件实例对象</strong>。</p><h2 id="class与style绑定"><a href="#class与style绑定" class="headerlink" title="class与style绑定"></a>class与style绑定</h2><p>通过动态绑定 <code>class</code> 属性和行内 <code>style</code> 样式，可动态操作元素样式。</p><h3 id="动态绑定-class-类名"><a href="#动态绑定-class-类名" class="headerlink" title="动态绑定 class 类名"></a>动态绑定 class 类名</h3><p>写法——:class&#x3D;”xxx” xxx可以是字符串、对象、数组</p><ul><li>字符串写法：类名不确定，要动态获取</li><li>对象写法：要绑定多个样式，个数不确定，名字也不确定</li><li>数组写法：要绑定多个样式，个数确定，名字也确定，但不确定用不用</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs css">&lt;style&gt;<br>  <span class="hljs-selector-class">.happy</span> &#123;<br>    ...;<br>  &#125;<br>  <span class="hljs-selector-class">.sad</span> &#123;<br>    ...;<br>  &#125;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;basic&quot;</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">&quot;mood&quot;</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;changeMood&quot;</span>&gt;</span>字符串写法<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;basic&quot;</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">&quot;arr&quot;</span>&gt;</span>数组写法<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;basic&quot;</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">&quot;classObj&quot;</span>&gt;</span>对象写法<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> &#123;<br>      <span class="hljs-attr">mood</span>: <span class="hljs-string">&#x27;happy&#x27;</span>,<br>      <span class="hljs-attr">arr</span>: [<span class="hljs-string">&#x27;happy&#x27;</span>, <span class="hljs-string">&#x27;sad&#x27;</span>],<br>      <span class="hljs-attr">classObj</span>: &#123;<br>        <span class="hljs-attr">happy</span>: <span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">sad</span>: <span class="hljs-literal">false</span>,<br>      &#125;,<br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">methods</span>: &#123;<br>    <span class="hljs-title function_">changeMood</span>(<span class="hljs-params"></span>) &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">mood</span> = <span class="hljs-string">&#x27;sad&#x27;</span><br>    &#125;,<br>  &#125;,<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="动态绑定-style-样式"><a href="#动态绑定-style-样式" class="headerlink" title="动态绑定 style 样式"></a>动态绑定 style 样式</h3><ul><li><code>css</code> 属性名既可以用驼峰形式，也能用短横线形式（需要使用引号括起来）</li><li>:style&#x3D;”{fontSize: xxx}”其中xxx是动态值</li><li>:style&#x3D;”[a,b]”其中a、b是样式对象</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">:style</span>=<span class="hljs-string">&quot;&#123;color: active, fontSize: fsize + &#x27;px&#x27;, &#x27;background-color&#x27;: bgcolor&#125;&quot;</span>&gt;</span>对象写法<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">:style</span>=<span class="hljs-string">&quot;styleObj&quot;</span>&gt;</span>对象写法<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">:style</span>=<span class="hljs-string">&quot;[styleObj, styleObj2]&quot;</span>&gt;</span>数组写法（用得少）<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">return</span> &#123;<br>    <span class="hljs-attr">active</span>: <span class="hljs-string">&#x27;red&#x27;</span>,<br>    <span class="hljs-attr">fsize</span>: <span class="hljs-number">30</span>,<br>    <span class="hljs-attr">bgcolor</span>: <span class="hljs-string">&#x27;yellow&#x27;</span>,<br>    <span class="hljs-attr">styleObj</span>: &#123;<br>      <span class="hljs-attr">color</span>: <span class="hljs-string">&#x27;active&#x27;</span>,<br>      <span class="hljs-string">&#x27;font-size&#x27;</span>: <span class="hljs-string">&#x27;20px&#x27;</span><br>    &#125;,<br>    <span class="hljs-attr">styleObj2</span>: &#123;<br>      <span class="hljs-attr">backgroundColor</span>: <span class="hljs-string">&#x27;yellow&#x27;</span><br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="条件渲染"><a href="#条件渲染" class="headerlink" title="条件渲染"></a>条件渲染</h2><h3 id="基础用法"><a href="#基础用法" class="headerlink" title="基础用法"></a>基础用法</h3><ul><li>v-if可以和:v-else-if、v-else一起使用，但要求结构不能被“打断”</li><li>使用v-if的时，元素可能无法获取到，而使用v-show一定可以获取到</li><li><code>template</code>模板 不会破坏结构</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">&quot;status === 200&quot;</span>&gt;</span>success<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">v-else-if</span>=<span class="hljs-string">&quot;status === 201&quot;</span>&gt;</span>xxx<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">v-else</span>&gt;</span>yyy<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">v-show</span>=<span class="hljs-string">&quot;status === 404&quot;</span>&gt;</span>error<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><br><span class="hljs-comment">&lt;!-- template 只能和 v-if 搭配使用 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">&quot;status === 200&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>111<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>222<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>333<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="v-if-和-v-show-的区别"><a href="#v-if-和-v-show-的区别" class="headerlink" title="v-if 和 v-show 的区别"></a>v-if 和 v-show 的区别</h3><p>实现原理不同：</p><ul><li><code>v-if</code> 通过创建或删除 DOM 元素来控制元素的显示与隐藏</li><li><code>v-show</code> 通过添加或删除元素的 <code>style=&quot;display: none&quot;</code> 样式来控制元素的显示与隐藏</li></ul><p>性能消耗不同：</p><ul><li><code>v-if</code> 切换开销更高，如果运行时条件很少改变，使用 <code>v-if</code> 更好</li><li><code>v-show</code> 初始渲染开销更高，如果切换频繁，使用 <code>v-show</code> 更好</li></ul><h2 id="列表渲染"><a href="#列表渲染" class="headerlink" title="列表渲染"></a>列表渲染</h2><h3 id="v-for指令"><a href="#v-for指令" class="headerlink" title="v-for指令"></a>v-for指令</h3><ul><li><p>用于展示列表数据</p></li><li><p>语法：v-for&#x3D;”(item, index) in xxx” :key&#x3D;”yyy”</p></li><li><p>可遍历：数组、对象、字符串（用的很少）、指定次数（用的很少）</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-comment">&lt;!-- 遍历数组 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>人员列表（遍历数组）<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">&quot;(p,index) of persons&quot;</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">&quot;index&quot;</span>&gt;</span><br>&#123;&#123;p.name&#125;&#125;-&#123;&#123;p.age&#125;&#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br><span class="hljs-comment">&lt;!-- 遍历对象 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>汽车信息（遍历对象）<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">&quot;(value,k) of car&quot;</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">&quot;k&quot;</span>&gt;</span><br>&#123;&#123;k&#125;&#125;-&#123;&#123;value&#125;&#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br><br><span class="hljs-comment">&lt;!-- 遍历字符串 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>测试遍历字符串（用得少）<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">&quot;(char,index) of str&quot;</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">&quot;index&quot;</span>&gt;</span><br>&#123;&#123;char&#125;&#125;-&#123;&#123;index&#125;&#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br><br><span class="hljs-comment">&lt;!-- 遍历指定次数 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>测试遍历指定次数（用得少）<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">&quot;(number,index) of 5&quot;</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">&quot;index&quot;</span>&gt;</span><br>&#123;&#123;index&#125;&#125;-&#123;&#123;number&#125;&#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="key的作用和原理"><a href="#key的作用和原理" class="headerlink" title="key的作用和原理"></a>key的作用和原理</h3><h4 id="1、-key-的作用："><a href="#1、-key-的作用：" class="headerlink" title="1、**key 的作用：**"></a>1、**<code>key</code> 的作用：**</h4><ul><li>当列表的数据变化时，默认情况下，vue 会尽可能的<strong>复用已存在的 DOM 元素</strong>，从而提升渲染的性能。但这种默认的性能优化策略，会导致有状态的列表无法被正确更新。</li><li>为了给 vue 一个提示，以便它能<strong>跟踪每个节点的身份</strong>，从而在保证有状态的列表被正确更新的前提下，提升渲染的性能。此时，<code>key</code> 的作用：<ul><li>当列表的数据变化时，默认情况下，vue 会尽可能的复用已存在的 DOM 元素，从而提升渲染的性能。但这种默认的性能优化策略，会导致有状态的列表无法被正确更新。</li><li>为了给 vue 一个提示，以便它能跟踪每个节点的身份，从而在保证有状态的列表被正确更新的前提下，提升渲染的性能。此时，需要为每项提供一个唯一的 key 属性。</li><li><code>key</code> 是虚拟 DOM 对象的标识，可提高页面更新渲染的效率。当数据变化时，Vue 会根据新数据生成新的虚拟 DOM，随后进行新旧虚拟 DOM 的差异比较</li></ul></li></ul><h4 id="2、比较规则diff"><a href="#2、比较规则diff" class="headerlink" title="2、比较规则diff"></a>2、<strong>比较规则diff</strong></h4><ul><li>旧虚拟 DOM 找到和新虚拟 DOM <strong>相同的 key</strong>：<ul><li>若内容没变，直接复用真实 DOM</li><li>若内容改变，生成新的真实 DOM，替换旧的真实 DOM</li></ul></li><li>旧虚拟 DOM 未找到和新虚拟 DOM <strong>相同的 key</strong>：<ul><li>创建新的真实 DOM，渲染到页面</li></ul></li></ul><h4 id="3、index作为key可能会引发的问题"><a href="#3、index作为key可能会引发的问题" class="headerlink" title="3、index作为key可能会引发的问题"></a>3、index作为key可能会引发的问题</h4><p>1、若对数据进行：逆序添加、逆序删除等破坏顺序操作</p><ul><li>会产生没有必要的真实DOM更新 &#x3D;&#x3D;&gt; 界面效果没问题, 但效率低。</li></ul><p>2、如果结构中还包含输入类的DOM</p><ul><li>会产生错误DOM更新 &#x3D;&#x3D;&gt; 界面有问题。</li></ul><h4 id="4、-key-的注意事项："><a href="#4、-key-的注意事项：" class="headerlink" title="4、**key 的注意事项：**"></a>4、**<code>key</code> 的注意事项：**</h4><ul><li>key 的值只能是<strong>字符串</strong>或<strong>数字</strong>类型</li><li>key 的值必须具有唯一性（即：key 的值不能重复）</li><li>建议把<strong>数据项 id 属性</strong>的值作为 key 的值（因为 id 属性的值具<strong>有唯一性</strong>）</li><li>使用 i<strong>ndex 的值</strong>当作 key 的值没有意义（因为 index 的值不具有<strong>唯一性</strong>）</li><li>建议使用 v-for 指令时一定要<strong>指定 key 的值</strong>（既提升性能、又防止列表状态紊乱）</li></ul><p><img src="/img/vue/Snipaste_2022-11-12_15-49-32.png" alt="image"></p><h2 id="列表过滤"><a href="#列表过滤" class="headerlink" title="列表过滤"></a>列表过滤</h2><h3 id="wacth实现"><a href="#wacth实现" class="headerlink" title="wacth实现"></a>wacth实现</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;<br>    <span class="hljs-attr">el</span>:<span class="hljs-string">&#x27;#root&#x27;</span>,<br>    <span class="hljs-attr">data</span>:&#123;<br>        <span class="hljs-attr">keyWord</span>:<span class="hljs-string">&#x27;&#x27;</span>,<br>        <span class="hljs-attr">persons</span>:[<br>            &#123;<span class="hljs-attr">id</span>:<span class="hljs-string">&#x27;001&#x27;</span>,<span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;马冬梅&#x27;</span>,<span class="hljs-attr">age</span>:<span class="hljs-number">19</span>,<span class="hljs-attr">sex</span>:<span class="hljs-string">&#x27;女&#x27;</span>&#125;,<br>            &#123;<span class="hljs-attr">id</span>:<span class="hljs-string">&#x27;002&#x27;</span>,<span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;周冬雨&#x27;</span>,<span class="hljs-attr">age</span>:<span class="hljs-number">20</span>,<span class="hljs-attr">sex</span>:<span class="hljs-string">&#x27;女&#x27;</span>&#125;,<br>            &#123;<span class="hljs-attr">id</span>:<span class="hljs-string">&#x27;003&#x27;</span>,<span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;周杰伦&#x27;</span>,<span class="hljs-attr">age</span>:<span class="hljs-number">21</span>,<span class="hljs-attr">sex</span>:<span class="hljs-string">&#x27;男&#x27;</span>&#125;,<br>            &#123;<span class="hljs-attr">id</span>:<span class="hljs-string">&#x27;004&#x27;</span>,<span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;温兆伦&#x27;</span>,<span class="hljs-attr">age</span>:<span class="hljs-number">22</span>,<span class="hljs-attr">sex</span>:<span class="hljs-string">&#x27;男&#x27;</span>&#125;<br>        ],<br>        <span class="hljs-attr">filPerons</span>:[]<br>    &#125;,<br>    <span class="hljs-attr">watch</span>:&#123;<br>        <span class="hljs-attr">keyWord</span>:&#123;<br>            <span class="hljs-attr">immediate</span>:<span class="hljs-literal">true</span>,<br>            <span class="hljs-title function_">handler</span>(<span class="hljs-params">val</span>)&#123;<br>                <span class="hljs-variable language_">this</span>.<span class="hljs-property">filPerons</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">persons</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">p</span>)=&gt;</span>&#123;<br>                    <span class="hljs-keyword">return</span> p.<span class="hljs-property">name</span>.<span class="hljs-title function_">indexOf</span>(val) !== -<span class="hljs-number">1</span><br>                &#125;)<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="computed实现"><a href="#computed实现" class="headerlink" title="computed实现"></a>computed实现</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;<br>    <span class="hljs-attr">el</span>:<span class="hljs-string">&#x27;#root&#x27;</span>,<br>    <span class="hljs-attr">data</span>:&#123;<br>        <span class="hljs-attr">keyWord</span>:<span class="hljs-string">&#x27;&#x27;</span>,<br>        <span class="hljs-attr">persons</span>:[<br>            &#123;<span class="hljs-attr">id</span>:<span class="hljs-string">&#x27;001&#x27;</span>,<span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;马冬梅&#x27;</span>,<span class="hljs-attr">age</span>:<span class="hljs-number">19</span>,<span class="hljs-attr">sex</span>:<span class="hljs-string">&#x27;女&#x27;</span>&#125;,<br>            &#123;<span class="hljs-attr">id</span>:<span class="hljs-string">&#x27;002&#x27;</span>,<span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;周冬雨&#x27;</span>,<span class="hljs-attr">age</span>:<span class="hljs-number">20</span>,<span class="hljs-attr">sex</span>:<span class="hljs-string">&#x27;女&#x27;</span>&#125;,<br>            &#123;<span class="hljs-attr">id</span>:<span class="hljs-string">&#x27;003&#x27;</span>,<span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;周杰伦&#x27;</span>,<span class="hljs-attr">age</span>:<span class="hljs-number">21</span>,<span class="hljs-attr">sex</span>:<span class="hljs-string">&#x27;男&#x27;</span>&#125;,<br>            &#123;<span class="hljs-attr">id</span>:<span class="hljs-string">&#x27;004&#x27;</span>,<span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;温兆伦&#x27;</span>,<span class="hljs-attr">age</span>:<span class="hljs-number">22</span>,<span class="hljs-attr">sex</span>:<span class="hljs-string">&#x27;男&#x27;</span>&#125;<br>        ]<br>    &#125;,<br>    <span class="hljs-attr">computed</span>:&#123;<br>        <span class="hljs-title function_">filPerons</span>(<span class="hljs-params"></span>)&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">persons</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">p</span>)=&gt;</span>&#123;<br>                <span class="hljs-keyword">return</span> p.<span class="hljs-property">name</span>.<span class="hljs-title function_">indexOf</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">keyWord</span>) !== -<span class="hljs-number">1</span><br>            &#125;)<br>        &#125;<br>    &#125;<br>&#125;) <br></code></pre></td></tr></table></figure><h3 id="列表排序"><a href="#列表排序" class="headerlink" title="列表排序"></a>列表排序</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;<br>    <span class="hljs-attr">el</span>:<span class="hljs-string">&#x27;#root&#x27;</span>,<br>    <span class="hljs-attr">data</span>:&#123;<br>        <span class="hljs-attr">keyWord</span>:<span class="hljs-string">&#x27;&#x27;</span>,<br>        <span class="hljs-attr">sortType</span>:<span class="hljs-number">0</span>, <span class="hljs-comment">//0原顺序 1降序 2升序</span><br>        <span class="hljs-attr">persons</span>:[<br>            &#123;<span class="hljs-attr">id</span>:<span class="hljs-string">&#x27;001&#x27;</span>,<span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;马冬梅&#x27;</span>,<span class="hljs-attr">age</span>:<span class="hljs-number">30</span>,<span class="hljs-attr">sex</span>:<span class="hljs-string">&#x27;女&#x27;</span>&#125;,<br>            &#123;<span class="hljs-attr">id</span>:<span class="hljs-string">&#x27;002&#x27;</span>,<span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;周冬雨&#x27;</span>,<span class="hljs-attr">age</span>:<span class="hljs-number">31</span>,<span class="hljs-attr">sex</span>:<span class="hljs-string">&#x27;女&#x27;</span>&#125;,<br>            &#123;<span class="hljs-attr">id</span>:<span class="hljs-string">&#x27;003&#x27;</span>,<span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;周杰伦&#x27;</span>,<span class="hljs-attr">age</span>:<span class="hljs-number">18</span>,<span class="hljs-attr">sex</span>:<span class="hljs-string">&#x27;男&#x27;</span>&#125;,<br>            &#123;<span class="hljs-attr">id</span>:<span class="hljs-string">&#x27;004&#x27;</span>,<span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;温兆伦&#x27;</span>,<span class="hljs-attr">age</span>:<span class="hljs-number">19</span>,<span class="hljs-attr">sex</span>:<span class="hljs-string">&#x27;男&#x27;</span>&#125;<br>        ]<br>    &#125;,<br>    <span class="hljs-attr">computed</span>:&#123;<br>        <span class="hljs-title function_">filPerons</span>(<span class="hljs-params"></span>)&#123;<br>            <span class="hljs-keyword">const</span> arr = <span class="hljs-variable language_">this</span>.<span class="hljs-property">persons</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">p</span>)=&gt;</span>&#123;<br>                <span class="hljs-keyword">return</span> p.<span class="hljs-property">name</span>.<span class="hljs-title function_">indexOf</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">keyWord</span>) !== -<span class="hljs-number">1</span><br>            &#125;)<br>            <span class="hljs-comment">//判断一下是否需要排序</span><br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">sortType</span>)&#123;<br>                arr.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">p1,p2</span>)=&gt;</span>&#123;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">sortType</span> === <span class="hljs-number">1</span> ? p2.<span class="hljs-property">age</span>-p1.<span class="hljs-property">age</span> : p1.<span class="hljs-property">age</span>-p2.<span class="hljs-property">age</span><br>                &#125;)<br>            &#125;<br>            <span class="hljs-keyword">return</span> arr<br>        &#125;<br>    &#125;<br>&#125;) <br></code></pre></td></tr></table></figure><h2 id="Vue-监测数据的原理"><a href="#Vue-监测数据的原理" class="headerlink" title="Vue 监测数据的原理"></a>Vue 监测数据的原理</h2><ul><li>监测数据，即 Vue 是如何监听数据发生变化，从而重新解析模板渲染页面的。Vue 会监测 data 中所有层级的数据。</li></ul><h3 id="Vue-监测对象数据"><a href="#Vue-监测对象数据" class="headerlink" title="Vue 监测对象数据"></a>Vue 监测对象数据</h3><ul><li>原理：通过 <code>Object.defineProperty()</code> 为属性添加 <code>getter</code>、<code>setter</code> ，对属性的读取、修改进行拦截，即<strong>数据劫持</strong>   </li><li>存在问题：<ul><li>对象新增加的属性，默认不做响应式处理</li><li>对象删除属性，也不是响应式的</li></ul></li><li>解决办法，使用如下API<ul><li><code>Vue.set(target, propertyName/index, value)</code></li><li><code>vm.$set(target, propertyName/index, value)</code></li><li><code>Vue.delete(target, propertyName/index)</code></li><li><code>vm.$delete(target, propertyName/index)</code></li></ul></li><li><code>Vue.set()</code> 和 <code>vm.$set()</code> 不能给 vm 或 vm 的根数据对象添加属性（即 data）</li></ul><h3 id="模拟数据监测"><a href="#模拟数据监测" class="headerlink" title="模拟数据监测"></a>模拟数据监测</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> data = &#123;<br>    <span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;尚硅谷&#x27;</span>,<br>    <span class="hljs-attr">address</span>:<span class="hljs-string">&#x27;北京&#x27;</span>,<br>&#125;<br><br><span class="hljs-comment">//创建一个监视的实例对象，用于监视data中属性的变化</span><br><span class="hljs-keyword">const</span> obs = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Observer</span>(data)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obs)<br><br><span class="hljs-comment">//准备一个vm实例对象</span><br><span class="hljs-keyword">let</span> vm = &#123;&#125;<br>vm.<span class="hljs-property">_data</span> = data = obs<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Observer</span>(<span class="hljs-params">obj</span>)&#123;<br>    <span class="hljs-comment">//汇总对象中所有的属性形成一个数组</span><br>    <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(obj)<br>    <span class="hljs-comment">//遍历</span><br>    keys.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">k</span>)=&gt;</span>&#123;<br>        <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-variable language_">this</span>,k,&#123;<br>            <span class="hljs-title function_">get</span>(<span class="hljs-params"></span>)&#123;<br>                <span class="hljs-keyword">return</span> obj[k]<br>            &#125;,<br>            <span class="hljs-title function_">set</span>(<span class="hljs-params">val</span>)&#123;<br>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">$&#123;k&#125;</span>被改了，我要去解析模板，生成虚拟DOM.....我要开始忙了`</span>)<br>                obj[k] = val<br>            &#125;<br>        &#125;)<br>    &#125;)<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="Vue-监测数组"><a href="#Vue-监测数组" class="headerlink" title="Vue 监测数组"></a>Vue 监测数组</h3><ul><li>原理：通过重写数组的 API 实现拦截：<code>push()、pop()、shift()、unshift()、splice()、sort()、reverse()</code></li><li>7 个 API 之所以是响应式的，是因为 Vue 对这些方法进行了包裹 ，即二次封装。做了两件事：调用对应的原生方法更新数组 、重新解析模板更新页面</li><li>存在问题：<ul><li>直接通过数组下标修改是非响应式的</li></ul></li><li>解决办法：<ul><li>使用 7 个 API 修改数组</li><li><code>Vue.set()</code>、<code>vm.$set()</code></li><li><code>Vue.delete()</code>、<code>vm.$delete()</code></li></ul></li></ul><h2 id="收集表单数据"><a href="#收集表单数据" class="headerlink" title="收集表单数据"></a>收集表单数据</h2><h3 id="文本框"><a href="#文本框" class="headerlink" title="文本框"></a>文本框</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;account&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure><ul><li>则v-model收集的是value值，用户输入的就是value值</li></ul><h3 id="密码框"><a href="#密码框" class="headerlink" title="密码框"></a>密码框</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;userInfo.password&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure><ul><li>则v-model收集的是value值，用户输入的就是value值</li></ul><h3 id="单选按钮"><a href="#单选按钮" class="headerlink" title="单选按钮"></a>单选按钮</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;sex&quot;</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;userInfo.sex&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;male&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;sex&quot;</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;userInfo.sex&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;female&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure><ul><li>则v-model收集的是value值，且要给标签配置value值，不然传给vm的是一个布尔类型数据</li></ul><h3 id="复选框"><a href="#复选框" class="headerlink" title="复选框"></a>复选框</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;userInfo.hobby&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;study&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;userInfo.hobby&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;game&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;userInfo.hobby&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;eat&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure><ul><li><p>没有配置input的value属性，那么收集的就是checked（勾选 or 未勾选，是布尔值）</p></li><li><p>配置input的value属性:</p><ul><li>v-model的初始值是非数组，那么收集的就是checked（勾选 or 未勾选，是布尔值）</li><li>v-model的初始值是数组，那么收集的的就是value组成的数组</li></ul></li></ul><h3 id="v-model的三个修饰符"><a href="#v-model的三个修饰符" class="headerlink" title="v-model的三个修饰符"></a>v-model的三个修饰符</h3><ul><li>lazy：失去焦点再收集数据</li><li>number：输入字符串转为有效的数字</li><li>trim：输入首尾空格过滤</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- 准备好一个容器--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;root&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">form</span> @<span class="hljs-attr">submit.prevent</span>=<span class="hljs-string">&quot;demo&quot;</span>&gt;</span><br>            // 输入首尾空格过滤<br>            账号：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">v-model.trim</span>=<span class="hljs-string">&quot;userInfo.account&quot;</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br>            密码：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;userInfo.password&quot;</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br>            // 输入字符串转为有效的数字 type 也要写成 number<br>            年龄：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;number&quot;</span> <span class="hljs-attr">v-model.number</span>=<span class="hljs-string">&quot;userInfo.age&quot;</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br>            性别：<br>            男<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;sex&quot;</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;userInfo.sex&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;male&quot;</span>&gt;</span><br>            女<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;sex&quot;</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;userInfo.sex&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;female&quot;</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br>            爱好：<br>            学习<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;userInfo.hobby&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;study&quot;</span>&gt;</span><br>            打游戏<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;userInfo.hobby&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;game&quot;</span>&gt;</span><br>            吃饭<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;userInfo.hobby&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;eat&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br>            所属校区<br>            <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;userInfo.city&quot;</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span>请选择校区<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;beijing&quot;</span>&gt;</span>北京<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;shanghai&quot;</span>&gt;</span>上海<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;shenzhen&quot;</span>&gt;</span>深圳<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;wuhan&quot;</span>&gt;</span>武汉<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br>            其他信息：<br>            // 失去焦点再收集数据<br>            <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span> <span class="hljs-attr">v-model.lazy</span>=<span class="hljs-string">&quot;userInfo.other&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;userInfo.agree&quot;</span>&gt;</span>阅读并接受<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;http://www.atguigu.com&quot;</span>&gt;</span>《用户协议》<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>提交<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;</span><br><span class="language-javascript">        <span class="hljs-attr">el</span>:<span class="hljs-string">&#x27;#root&#x27;</span>,</span><br><span class="language-javascript">        <span class="hljs-attr">data</span>:&#123;</span><br><span class="language-javascript">            <span class="hljs-attr">userInfo</span>:&#123;</span><br><span class="language-javascript">                <span class="hljs-attr">account</span>:<span class="hljs-string">&#x27;&#x27;</span>,</span><br><span class="language-javascript">                <span class="hljs-attr">password</span>:<span class="hljs-string">&#x27;&#x27;</span>,</span><br><span class="language-javascript">                <span class="hljs-attr">age</span>:<span class="hljs-number">18</span>,</span><br><span class="language-javascript">                <span class="hljs-attr">sex</span>:<span class="hljs-string">&#x27;female&#x27;</span>,</span><br><span class="language-javascript">                <span class="hljs-attr">hobby</span>:[],</span><br><span class="language-javascript">                <span class="hljs-attr">city</span>:<span class="hljs-string">&#x27;beijing&#x27;</span>,</span><br><span class="language-javascript">                <span class="hljs-attr">other</span>:<span class="hljs-string">&#x27;&#x27;</span>,</span><br><span class="language-javascript">                <span class="hljs-attr">agree</span>:<span class="hljs-string">&#x27;&#x27;</span></span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-attr">methods</span>: &#123;</span><br><span class="language-javascript">            <span class="hljs-title function_">demo</span>(<span class="hljs-params"></span>)&#123;</span><br><span class="language-javascript">                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">userInfo</span>))</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    &#125;)</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="过滤器"><a href="#过滤器" class="headerlink" title="过滤器"></a>过滤器</h2><ul><li>过滤器常用于文本的格式化，可用在插值表达式和 <code>v-bind</code> 属性绑定。</li><li>过滤器只在 <code>vue 2.x</code> 和 <code>vue 1.x</code> 中支持，<code>vue 3.x</code> 废弃了过滤器，官方建议使用计算属性或方法代替过滤器。</li></ul><h4 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h4><ul><li>对要显示的数据进行特定格式化后再显示（适用于一些简单逻辑的处理）。</li></ul><h4 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h4><ul><li><p>注册过滤器：Vue.filter(name,callback) 或 new Vue{filters:{}}</p></li><li><p>使用过滤器：<code>&#123;&#123; xxx | 过滤器名&#125;&#125;</code>  或  v-bind:属性 &#x3D; “xxx | 过滤器名”</p></li></ul><h4 id="备注"><a href="#备注" class="headerlink" title="备注"></a>备注</h4><ul><li><p>过滤器也可以接收额外参数、多个过滤器也可以串联</p></li><li><p>并没有改变原本的数据, 是产生新的对应的数据</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-comment">&lt;!-- 在 JS 表达式尾部通过管道符进行调用--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>&#123;&#123; message | capitalize &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">:id</span>=<span class="hljs-string">&quot;rawId | formatId&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 定义私有过滤器局部</span><br><span class="hljs-attr">filters</span>: &#123;<br>  <span class="hljs-title function_">capitalize</span>(<span class="hljs-params">str</span>) &#123;<br>    <span class="hljs-keyword">return</span> str.<span class="hljs-title function_">charAt</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">toUpperCase</span>() + str.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>)<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 在 main.js 中定义全局过滤器</span><br><span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-string">&#x27;capitalize&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">str</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">return</span> str.<span class="hljs-title function_">charAt</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">toUpperCase</span>() + str.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>)<br>&#125;)<br></code></pre></td></tr></table></figure><p>如果私有过滤器和全局过滤器冲突，按照就近原则调用私有过滤器。</p><h3 id="连续调用多个过滤器"><a href="#连续调用多个过滤器" class="headerlink" title="连续调用多个过滤器"></a>连续调用多个过滤器</h3><p>过滤器从左往右调用，前一个过滤器的结果交给下一个过滤器继续处理。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>&#123;&#123; text | capitalize | maxLength &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="过滤器传参"><a href="#过滤器传参" class="headerlink" title="过滤器传参"></a>过滤器传参</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>&#123;&#123; message | myFilter(arg1, arg2) &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 第一个参数永远都是管道符前的值</span><br><span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-string">&#x27;myFilter&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">value, arg1, arg2</span>) =&gt;</span> &#123;<br>  ...<br>&#125;)<br></code></pre></td></tr></table></figure><h2 id="内置指令与自定义指令"><a href="#内置指令与自定义指令" class="headerlink" title="内置指令与自定义指令"></a>内置指令与自定义指令</h2><h3 id="内置指令"><a href="#内置指令" class="headerlink" title="内置指令"></a>内置指令</h3><ul><li><p>v-bind   : 单向绑定解析表达式, 可简写为 :xxx</p></li><li><p>v-model : 双向数据绑定</p></li><li><p>v-for  : 遍历数组&#x2F;对象&#x2F;字符串</p></li><li><p>v-on   : 绑定事件监听, 可简写为@</p></li><li><p>v-if     : 条件渲染（动态控制节点是否存存在）</p></li><li><p>v-else  : 条件渲染（动态控制节点是否存存在）</p></li><li><p>v-show  : 条件渲染 (动态控制节点是否展示)</p></li></ul><h4 id="v-text"><a href="#v-text" class="headerlink" title="v-text"></a>v-text</h4><ul><li><code>v-text</code> 指令会覆盖元素默认值</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">v-text</span>=<span class="hljs-string">&quot;username&quot;</span>&gt;</span>这段内容会被覆盖<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123; <span class="hljs-keyword">return</span> &#123; <span class="hljs-attr">username</span>: <span class="hljs-string">&quot;Bruce&quot;</span> &#125; &#125;<br></code></pre></td></tr></table></figure><h4 id="v-html"><a href="#v-html" class="headerlink" title="v-html"></a>v-html</h4><blockquote><p>v-html 存在安全问题</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">v-html</span>=<span class="hljs-string">&quot;desc&quot;</span>&gt;</span>原本内容被覆盖<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">return</span> &#123;<br>    <span class="hljs-attr">desc</span>: <span class="hljs-string">&#x27;&lt;h1 style=&quot;color: red&quot;&gt;红色标题&lt;/h1&gt;&#x27;</span>，<br>    <span class="hljs-attr">str</span>: <span class="hljs-string">&#x27;&lt;a href=&quot;http://www.baidu.com?&quot;+document.cookie&gt;兄弟我找到你想要的资源了，快来！&lt;/a&gt;&#x27;</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="v-cloak"><a href="#v-cloak" class="headerlink" title="v-cloak"></a>v-cloak</h4><ul><li>本质是一个特殊属性，Vue 实例创建完毕并接管容器后，会删除 <code>v-cloak</code> 属性</li><li>使用 CSS 配合 <code>v-cloak</code> 可解决网速慢时页面展示的问题</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-attr">[v-cloak]</span> &#123;<br>    <span class="hljs-attribute">display</span>: none;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">v-cloak</span>&gt;</span>&#123;&#123; username &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="v-once"><a href="#v-once" class="headerlink" title="v-once"></a>v-once</h4><ul><li><code>v-once</code> 所在节点初次渲染后就成为静态内容</li><li>即数据变化不会引起 <code>v-once</code> 所在节点内容的更新，可用于优化性能</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">v-once</span>&gt;</span>初次的内容：&#123;&#123; content &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>最新的内容：&#123;&#123; content &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="v-pre"><a href="#v-pre" class="headerlink" title="v-pre"></a>v-pre</h4><ul><li>跳过所在节点的编译过程</li><li>没有使用插值语法等特殊语法的节点，可用其跳过编译过程，加快编译</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">v-pre</span>&gt;</span>Vue 内置指令<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>用户名：&#123;&#123; username &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="自定义指令"><a href="#自定义指令" class="headerlink" title="自定义指令"></a>自定义指令</h3><ul><li><p>需求1：定义一个v-big指令，和v-text功能类似，但会把绑定的数值放大10倍。</p></li><li><p>需求2：定义一个v-fbind指令，和v-bind功能类似，但可以让其所绑定的input元素默认获取焦点。</p></li></ul><h3 id="1、定义语法"><a href="#1、定义语法" class="headerlink" title="1、定义语法"></a>1、定义语法</h3><h4 id="1、局部指令"><a href="#1、局部指令" class="headerlink" title="1、局部指令"></a>1、局部指令</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;<br><span class="hljs-attr">directives</span>:&#123;指令名:配置对象&#125; <br>或 <br>directives&#123;指令名:回调函数&#125;<br>&#125;)&#125;)<br></code></pre></td></tr></table></figure><h4 id="2、全局指令"><a href="#2、全局指令" class="headerlink" title="2、全局指令"></a>2、全局指令</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">directive</span>(指令名,配置对象) 或 <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">directive</span>(指令名,回调函数)<br></code></pre></td></tr></table></figure><h3 id="2、配置对象中常用的3个回调"><a href="#2、配置对象中常用的3个回调" class="headerlink" title="2、配置对象中常用的3个回调"></a>2、配置对象中常用的3个回调</h3><ul><li><p>bind：指令与元素成功绑定时调用。</p></li><li><p>inserted：指令所在元素被插入页面时调用。</p></li><li><p>update：指令所在模板结构被重新解析时调用。</p></li></ul><h3 id="3、备注："><a href="#3、备注：" class="headerlink" title="3、备注："></a>3、备注：</h3><ol><li>指令定义时不加v-，但使用时要加v-</li><li>指令名如果是多个单词，要使用kebab-case命名方式，不要用camelCase命名</li><li><code>this </code> 指向是window</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//定义全局指令</span><br><span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">directive</span>(<span class="hljs-string">&#x27;fbind&#x27;</span>,&#123;<br>    <span class="hljs-comment">//指令与元素成功绑定时（一上来）</span><br>    <span class="hljs-title function_">bind</span>(<span class="hljs-params">element,binding</span>)&#123;<br>        element.<span class="hljs-property">value</span> = binding.<span class="hljs-property">value</span><br>    &#125;,<br>    <span class="hljs-comment">//指令所在元素被插入页面时</span><br>    <span class="hljs-title function_">inserted</span>(<span class="hljs-params">element,binding</span>)&#123;<br>        element.<span class="hljs-title function_">focus</span>()<br>    &#125;,<br>    <span class="hljs-comment">//指令所在的模板被重新解析时</span><br>    <span class="hljs-title function_">update</span>(<span class="hljs-params">element,binding</span>)&#123;<br>        element.<span class="hljs-property">value</span> = binding.<span class="hljs-property">value</span><br>    &#125;<br>&#125;)<br><br><span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;<br>    <span class="hljs-attr">el</span>:<span class="hljs-string">&#x27;#root&#x27;</span>,<br>    <span class="hljs-attr">data</span>:&#123;<br>        <span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;尚硅谷&#x27;</span>,<br>        <span class="hljs-attr">n</span>:<span class="hljs-number">1</span><br>    &#125;,<br>    <span class="hljs-attr">directives</span>:&#123;<br>        <span class="hljs-comment">//big函数何时会被调用？1.指令与元素成功绑定时（一上来）。2.指令所在的模板被重新解析时。</span><br>        <span class="hljs-comment">/* &#x27;big-number&#x27;(element,binding)&#123;</span><br><span class="hljs-comment">            // console.log(&#x27;big&#x27;)</span><br><span class="hljs-comment">            element.innerText = binding.value * 10</span><br><span class="hljs-comment">        &#125;, */</span><br>        <span class="hljs-title function_">big</span>(<span class="hljs-params">element,binding</span>)&#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;big&#x27;</span>,<span class="hljs-variable language_">this</span>) <span class="hljs-comment">//注意此处的this是window</span><br>            <span class="hljs-comment">// console.log(&#x27;big&#x27;)</span><br>            element.<span class="hljs-property">innerText</span> = binding.<span class="hljs-property">value</span> * <span class="hljs-number">10</span><br>        &#125;,<br>        <span class="hljs-attr">fbind</span>:&#123;<br>            <span class="hljs-comment">//指令与元素成功绑定时（一上来）</span><br>            <span class="hljs-title function_">bind</span>(<span class="hljs-params">element,binding</span>)&#123;<br>                element.<span class="hljs-property">value</span> = binding.<span class="hljs-property">value</span><br>            &#125;,<br>            <span class="hljs-comment">//指令所在元素被插入页面时</span><br>            <span class="hljs-title function_">inserted</span>(<span class="hljs-params">element,binding</span>)&#123;<br>                element.<span class="hljs-title function_">focus</span>()<br>            &#125;,<br>            <span class="hljs-comment">//指令所在的模板被重新解析时</span><br>            <span class="hljs-title function_">update</span>(<span class="hljs-params">element,binding</span>)&#123;<br>                element.<span class="hljs-property">value</span> = binding.<span class="hljs-property">value</span><br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><h2 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h2><h3 id="生命周期-1"><a href="#生命周期-1" class="headerlink" title="生命周期"></a>生命周期</h3><p>1.又名：生命周期回调函数、生命周期函数、生命周期钩子。</p><p>2.是什么：Vue在关键时刻帮我们调用的一些特殊名称的函数。</p><p>3.生命周期函数的名字不可更改，但函数的具体内容是程序员根据需求编写的。</p><p>4.生命周期函数中的this指向是vm 或 组件实例对象。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Vue</span>.<span class="hljs-property">config</span>.<span class="hljs-property">productionTip</span> = <span class="hljs-literal">false</span> <span class="hljs-comment">//阻止 vue 在启动时生成生产提示。</span><br><br><span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;<br>   <span class="hljs-attr">el</span>:<span class="hljs-string">&#x27;#root&#x27;</span>,<br>   <span class="hljs-attr">data</span>:&#123;<br>       <span class="hljs-attr">a</span>:<span class="hljs-literal">false</span>,<br>       <span class="hljs-attr">opacity</span>:<span class="hljs-number">1</span><br>   &#125;,<br>   <span class="hljs-attr">methods</span>: &#123;<br>       <br>   &#125;,<br>   <span class="hljs-comment">//Vue完成模板的解析并把初始的真实DOM元素放入页面后（挂载完毕）调用mounted</span><br>   <span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>)&#123;<br>       <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;mounted&#x27;</span>,<span class="hljs-variable language_">this</span>)<br>       <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>           <span class="hljs-variable language_">this</span>.<span class="hljs-property">opacity</span> -= <span class="hljs-number">0.01</span><br>           <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">opacity</span> &lt;= <span class="hljs-number">0</span>) <span class="hljs-variable language_">this</span>.<span class="hljs-property">opacity</span> = <span class="hljs-number">1</span><br>       &#125;,<span class="hljs-number">16</span>)<br>   &#125;,<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="生命周期图示"><a href="#生命周期图示" class="headerlink" title="生命周期图示"></a>生命周期图示</h3><ul><li>除了图中 8 个钩子，还有 <code>nextTick</code>，<code>activated</code>，<code>deactivated</code></li></ul><p><img src="/img/vue/shengming.png" alt="image"></p><h3 id="生命周期流程"><a href="#生命周期流程" class="headerlink" title="生命周期流程"></a>生命周期流程</h3><ul><li>创建</li><li>挂载</li><li>更新</li><li>销毁</li></ul><h3 id="关于销毁过程"><a href="#关于销毁过程" class="headerlink" title="关于销毁过程"></a>关于销毁过程</h3><ul><li>销毁后借助 Vue 开发者工具看不到任何信息。</li><li>销毁后自定义事件会失效，但原生 DOM 事件依然有效。</li><li>一般不在 <code>beforeDestroy</code> 操作数据，因为即便操作数据，也不会再触发更新流程</li></ul><h1 id="Vue组件"><a href="#Vue组件" class="headerlink" title="Vue组件"></a>Vue组件</h1><h2 id="模块与组件、模块化与组件化"><a href="#模块与组件、模块化与组件化" class="headerlink" title="模块与组件、模块化与组件化"></a>模块与组件、模块化与组件化</h2><h3 id="模块"><a href="#模块" class="headerlink" title="模块"></a>模块</h3><ul><li>向外提供特定功能的 js 程序, 一般就是一个 js 文件</li><li>复用 js, 简化 js 的编写, 提高 js 运行效率</li></ul><h3 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h3><ul><li>用来实现局部(特定)功能效果的代码集合(html&#x2F;css&#x2F;js&#x2F;image…..)</li><li>复用编码, 简化项目编码, 提高运行效率</li></ul><h3 id="模块化"><a href="#模块化" class="headerlink" title="模块化"></a>模块化</h3><ul><li>当应用中的 js 都以模块来编写的, 那这个应用就是一个模块化的应用</li></ul><h3 id="组件化"><a href="#组件化" class="headerlink" title="组件化"></a>组件化</h3><ul><li>当应用中的功能都是多组件的方式来编写的, 那这个应用就是一个组件化的应用</li></ul><h2 id="非单文件组件"><a href="#非单文件组件" class="headerlink" title="非单文件组件"></a>非单文件组件</h2><ul><li>非单文件组件即有n个组件</li></ul><h3 id="使用步骤"><a href="#使用步骤" class="headerlink" title="使用步骤"></a>使用步骤</h3><ul><li><p>定义组件：创建组件</p><ul><li>使用 <code>Vue.extend(options)</code> 创建，和 <code>new Vue(options)</code> 的区别<ul><li><code>el</code> 不写，最终所有的组件都要经过 vm 的管理，由 vm 的 <code>el</code> 决定服务哪个容器</li><li><code>data</code> 必须写成函数，避免组件被复用时，数据存在引用关系</li><li>使用 <code>template</code> 节点可配置组件结构</li></ul></li></ul></li><li><p>注册组件</p><ul><li>局部注册：<code>components</code> 选项</li><li>全局注册：<code>Vue.component(&#39;组件名&#39;,组件)</code></li></ul></li><li><p>使用组件：写组件标签</p><ul><li><code>&lt;school&gt;&lt;/school&gt;</code></li></ul></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;root&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">hello</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">hello</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">hr</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>&#123;&#123;msg&#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">hr</span>&gt;</span><br><span class="hljs-comment">&lt;!-- 第三步：编写组件标签 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">school</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">school</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">hr</span>&gt;</span><br><span class="hljs-comment">&lt;!-- 第三步：编写组件标签 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">student</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">student</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;root2&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">hello</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">hello</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-title class_">Vue</span>.<span class="hljs-property">config</span>.<span class="hljs-property">productionTip</span> = <span class="hljs-literal">false</span></span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-comment">//第一步：创建school组件</span></span><br><span class="language-javascript"><span class="hljs-keyword">const</span> school = <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">extend</span>(&#123;</span><br><span class="language-javascript"><span class="hljs-attr">template</span>: <span class="hljs-string">`</span></span><br><span class="hljs-string"><span class="language-javascript">&lt;div class=&quot;demo&quot;&gt;</span></span><br><span class="hljs-string"><span class="language-javascript">&lt;h2&gt;学校名称：&#123;&#123;schoolName&#125;&#125;&lt;/h2&gt;</span></span><br><span class="hljs-string"><span class="language-javascript">&lt;h2&gt;学校地址：&#123;&#123;address&#125;&#125;&lt;/h2&gt;</span></span><br><span class="hljs-string"><span class="language-javascript">&lt;button @click=&quot;showName&quot;&gt;点我提示学校名&lt;/button&gt;</span></span><br><span class="hljs-string"><span class="language-javascript">&lt;/div&gt;</span></span><br><span class="hljs-string"><span class="language-javascript">`</span>,</span><br><span class="language-javascript"><span class="hljs-comment">//组件定义时，一定不要写el配置项，因为最终所有的组件都要被一个vm管理，由vm决定服务于哪个容器。</span></span><br><span class="language-javascript"><span class="hljs-comment">// el:&#x27;#root&#x27;, </span></span><br><span class="language-javascript"><span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript"><span class="hljs-keyword">return</span> &#123;</span><br><span class="language-javascript"><span class="hljs-attr">schoolName</span>: <span class="hljs-string">&#x27;尚硅谷&#x27;</span>,</span><br><span class="language-javascript"><span class="hljs-attr">address</span>: <span class="hljs-string">&#x27;北京昌平&#x27;</span></span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript">&#125;,</span><br><span class="language-javascript"><span class="hljs-attr">methods</span>: &#123;</span><br><span class="language-javascript"><span class="hljs-title function_">showName</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript"><span class="hljs-title function_">alert</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">schoolName</span>)</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript">&#125;,</span><br><span class="language-javascript">&#125;)</span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-comment">//第一步：创建student组件</span></span><br><span class="language-javascript"><span class="hljs-keyword">const</span> student = <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">extend</span>(&#123;</span><br><span class="language-javascript"><span class="hljs-attr">template</span>: <span class="hljs-string">`</span></span><br><span class="hljs-string"><span class="language-javascript">&lt;div&gt;</span></span><br><span class="hljs-string"><span class="language-javascript">&lt;h2&gt;学生姓名：&#123;&#123;studentName&#125;&#125;&lt;/h2&gt;</span></span><br><span class="hljs-string"><span class="language-javascript">&lt;h2&gt;学生年龄：&#123;&#123;age&#125;&#125;&lt;/h2&gt;</span></span><br><span class="hljs-string"><span class="language-javascript">&lt;/div&gt;</span></span><br><span class="hljs-string"><span class="language-javascript">`</span>,</span><br><span class="language-javascript"><span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript"><span class="hljs-keyword">return</span> &#123;</span><br><span class="language-javascript"><span class="hljs-attr">studentName</span>: <span class="hljs-string">&#x27;张三&#x27;</span>,</span><br><span class="language-javascript"><span class="hljs-attr">age</span>: <span class="hljs-number">18</span></span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript">&#125;)</span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-comment">//第一步：创建hello组件</span></span><br><span class="language-javascript"><span class="hljs-keyword">const</span> hello = <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">extend</span>(&#123;</span><br><span class="language-javascript"><span class="hljs-attr">template</span>: <span class="hljs-string">`</span></span><br><span class="hljs-string"><span class="language-javascript">&lt;div&gt;</span></span><br><span class="hljs-string"><span class="language-javascript">&lt;h2&gt;你好啊！&#123;&#123;name&#125;&#125;&lt;/h2&gt;</span></span><br><span class="hljs-string"><span class="language-javascript">&lt;/div&gt;</span></span><br><span class="hljs-string"><span class="language-javascript">`</span>,</span><br><span class="language-javascript"><span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript"><span class="hljs-keyword">return</span> &#123;</span><br><span class="language-javascript"><span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Tom&#x27;</span></span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript">&#125;)</span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-comment">//第二步：全局注册组件</span></span><br><span class="language-javascript"><span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">component</span>(<span class="hljs-string">&#x27;hello&#x27;</span>, hello)</span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-comment">//创建vm</span></span><br><span class="language-javascript"><span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;</span><br><span class="language-javascript"><span class="hljs-attr">el</span>: <span class="hljs-string">&#x27;#root&#x27;</span>,</span><br><span class="language-javascript"><span class="hljs-attr">data</span>: &#123;</span><br><span class="language-javascript"><span class="hljs-attr">msg</span>: <span class="hljs-string">&#x27;你好啊！&#x27;</span></span><br><span class="language-javascript">&#125;,</span><br><span class="language-javascript"><span class="hljs-comment">//第二步：注册组件（局部注册）</span></span><br><span class="language-javascript"><span class="hljs-attr">components</span>: &#123;</span><br><span class="language-javascript">school,</span><br><span class="language-javascript">student</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript">&#125;)</span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;</span><br><span class="language-javascript"><span class="hljs-attr">el</span>: <span class="hljs-string">&#x27;#root2&#x27;</span>,</span><br><span class="language-javascript">&#125;)</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><h4 id="1、组件名"><a href="#1、组件名" class="headerlink" title="1、组件名"></a>1、组件名</h4><ul><li>一个单词：school, School</li><li>多个单词：my-school, MySchool(需要 vue-cli 支持)</li><li>组件名尽可能回避HTML中已有的元素名称，例如：h2、H2都不行</li><li>可以使用name配置项指定组件在开发者工具中呈现的名字</li></ul><h4 id="2、使用组件"><a href="#2、使用组件" class="headerlink" title="2、使用组件"></a>2、使用组件</h4><ul><li><code>&lt;school&gt;&lt;/school&gt;</code></li><li><code>&lt;school /&gt;</code> (需要 vue-cli 支持)</li></ul><p>3、<code>const school = Vue.extend(options)</code> 可简写为 <code>const school = options</code>。这是脚手架里 <code>&lt;script&gt;</code> 代码的简写来源。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 完整写法</span><br><span class="hljs-keyword">const</span> vc = <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">extend</span>(&#123;<br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;App&#x27;</span>,<br>  <span class="hljs-attr">components</span>: &#123;<br>    <span class="hljs-title class_">HelloWorld</span><br>  &#125;<br>&#125;)<br><br><span class="hljs-keyword">const</span> vs = &#123;<br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;App&#x27;</span>,<br>  <span class="hljs-attr">components</span>: &#123;<br>    <span class="hljs-title class_">HelloWorld</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="组件的嵌套"><a href="#组件的嵌套" class="headerlink" title="组件的嵌套"></a>组件的嵌套</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//定义student组件</span><br><span class="hljs-keyword">const</span> student = <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">extend</span>(&#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;student&#x27;</span>,<br>    <span class="hljs-attr">template</span>: <span class="hljs-string">`</span><br><span class="hljs-string">        &lt;div&gt;</span><br><span class="hljs-string">            &lt;h2&gt;学生姓名：&#123;&#123;name&#125;&#125;&lt;/h2&gt;</span><br><span class="hljs-string">            &lt;h2&gt;学生年龄：&#123;&#123;age&#125;&#125;&lt;/h2&gt;</span><br><span class="hljs-string">        &lt;/div&gt;</span><br><span class="hljs-string">    `</span>,<br>    <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> &#123;<br>            <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;尚硅谷&#x27;</span>,<br>            <span class="hljs-attr">age</span>: <span class="hljs-number">18</span><br>        &#125;<br>    &#125;<br>&#125;)<br><br><span class="hljs-comment">//定义school组件</span><br><span class="hljs-keyword">const</span> school = <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">extend</span>(&#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;school&#x27;</span>,<br>    <span class="hljs-attr">template</span>: <span class="hljs-string">`</span><br><span class="hljs-string">        &lt;div&gt;</span><br><span class="hljs-string">            &lt;h2&gt;学校名称：&#123;&#123;name&#125;&#125;&lt;/h2&gt;</span><br><span class="hljs-string">            &lt;h2&gt;学校地址：&#123;&#123;address&#125;&#125;&lt;/h2&gt;</span><br><span class="hljs-string">            &lt;student&gt;&lt;/student&gt;</span><br><span class="hljs-string">        &lt;/div&gt;</span><br><span class="hljs-string">    `</span>,<br>    <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> &#123;<br>            <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;尚硅谷&#x27;</span>,<br>            <span class="hljs-attr">address</span>: <span class="hljs-string">&#x27;北京&#x27;</span><br>        &#125;<br>    &#125;,<br>    <span class="hljs-comment">//注册组件（局部）</span><br>    <span class="hljs-attr">components</span>: &#123;<br>        student<br>    &#125;<br>&#125;)<br><br><span class="hljs-comment">//定义hello组件</span><br><span class="hljs-keyword">const</span> hello = <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">extend</span>(&#123;<br>    <span class="hljs-attr">template</span>: <span class="hljs-string">`&lt;h1&gt;&#123;&#123;msg&#125;&#125;&lt;/h1&gt;`</span>,<br>    <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> &#123;<br>            <span class="hljs-attr">msg</span>: <span class="hljs-string">&#x27;欢迎来到尚硅谷学习！&#x27;</span><br>        &#125;<br>    &#125;<br>&#125;)<br><br><span class="hljs-comment">//定义app组件 app管理所有的组件，这样vm就只用管理app即可</span><br><span class="hljs-keyword">const</span> app = <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">extend</span>(&#123;<br>    <span class="hljs-attr">template</span>: <span class="hljs-string">`</span><br><span class="hljs-string">        &lt;div&gt;</span><br><span class="hljs-string">            &lt;hello&gt;&lt;/hello&gt;</span><br><span class="hljs-string">            &lt;school&gt;&lt;/school&gt;</span><br><span class="hljs-string">        &lt;/div&gt;</span><br><span class="hljs-string">    `</span>,<br>    <span class="hljs-attr">components</span>: &#123;<br>        school,<br>        hello<br>    &#125;<br>&#125;)<br><br><span class="hljs-comment">//创建vm</span><br><span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;<br>    <span class="hljs-attr">template</span>: <span class="hljs-string">&#x27;&lt;app&gt;&lt;/app&gt;&#x27;</span>,<br>    <span class="hljs-attr">el</span>: <span class="hljs-string">&#x27;#root&#x27;</span>,<br>    <span class="hljs-comment">//注册组件（局部）</span><br>    <span class="hljs-attr">components</span>: &#123; app &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="VueComponent-构造函数"><a href="#VueComponent-构造函数" class="headerlink" title="VueComponent 构造函数"></a>VueComponent 构造函数</h3><p>1、组件本质是一个名为 <code>VueComponent</code> 的<strong>构造函数</strong>，不是程序员定义的，是 <code>Vue.extend</code> 生成的</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> school = <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">extend</span>(&#123;...&#125;)<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">dir</span>(school) <span class="hljs-comment">//ƒ VueComponent (options)</span><br></code></pre></td></tr></table></figure><p>2、使用组件时，Vue 自动创建组件实例对象，即 <code>new VueComponent(options)</code> 是 Vue 做的</p><p>3、每次调用 <code>Vue.extend</code>，返回的都是一个全新的 <code>VueComponent</code> 构造函数</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> school = <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">extend</span>(&#123;...&#125;)<br><span class="hljs-keyword">const</span> student = <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">extend</span>(&#123;...&#125;)<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(school === student) <span class="hljs-comment">// false</span><br></code></pre></td></tr></table></figure><p>4、组件的 <code>this</code> 指向 <strong><code>VueComponent</code> 实例对象</strong>，而非 <strong>Vue 实例对象</strong></p><p>5、重要的内置关系：<code>VueComponent.prototype.__proto__ === Vue.prototype</code> ，这个改动使得<strong>组件实例对象得以访问 Vue 原型上的属性方法</strong></p><p><img src="/img/vue/VueComponent.66788a9c.png" alt="image"></p><p>6、<strong>Vue的实例对象——vm</strong><strong>VueComponent的实例对象——vc</strong></p><h2 id="单文件组件"><a href="#单文件组件" class="headerlink" title="单文件组件"></a>单文件组件</h2><ul><li>单文件组件即只有一个组件，即<code>.vue</code> 文件</li></ul><h1 id="Vue-CLI脚手架"><a href="#Vue-CLI脚手架" class="headerlink" title="Vue-CLI脚手架"></a>Vue-CLI脚手架</h1><h2 id="初始化脚手架"><a href="#初始化脚手架" class="headerlink" title="初始化脚手架"></a>初始化脚手架</h2><h3 id="创建Vue项目"><a href="#创建Vue项目" class="headerlink" title="创建Vue项目"></a>创建Vue项目</h3><ul><li>全局安装 vue 脚手架：<code>npm i -g @vue/cli</code></li><li>创建项目：<code>vue create project-name</code></li><li>运行项目：<code>npm run serve</code></li><li>暴露 webpack 配置：<code>vue inspect &gt; output.js</code></li></ul><h3 id="Vue-脚手架项目结构"><a href="#Vue-脚手架项目结构" class="headerlink" title="Vue 脚手架项目结构"></a>Vue 脚手架项目结构</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs stylus">├── node_modules<br>├── public<br>│ ├── favicon<span class="hljs-selector-class">.ico</span>: 页签图标<br>│ └── index<span class="hljs-selector-class">.html</span>: 主页面<br>├── <span class="hljs-attribute">src</span><br>│ ├── assets: 存放静态资源<br>│ │ └── logo<span class="hljs-selector-class">.png</span><br>│ │── component: 存放组件<br>│ │ └── HelloWorld<span class="hljs-selector-class">.vue</span><br>│ │── App<span class="hljs-selector-class">.vue</span>: 汇总所有组件<br>│ │── <span class="hljs-selector-tag">main</span><span class="hljs-selector-class">.js</span>: 入口文件<br>├── <span class="hljs-selector-class">.gitignore</span>: git 版本管制忽略的配置<br>├── babel<span class="hljs-selector-class">.config</span><span class="hljs-selector-class">.js</span>: babel 的配置文件<br>├── package<span class="hljs-selector-class">.json</span>: 应用包配置文件<br>├── README<span class="hljs-selector-class">.md</span>: 应用描述文件<br>├── package-lock.json：包版本控制文件<br></code></pre></td></tr></table></figure><p><img src="/img/vue/vue-cli.4f118ba8.png" alt="image"></p><p><code>index.html</code> 代码分析：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;utf-8&quot;</span> /&gt;</span><br>    <span class="hljs-comment">&lt;!-- 针对IE浏览器的一个特殊配置，含义是让IE浏览器以最高的渲染级别渲染页面 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span> /&gt;</span><br>    <span class="hljs-comment">&lt;!-- 开启移动端的理想视口 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width,initial-scale=1.0&quot;</span> /&gt;</span><br>    <span class="hljs-comment">&lt;!-- &lt;%= BASE_URL %&gt; 表示 public 文件夹路径 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;icon&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;&lt;%= BASE_URL %&gt;favicon.ico&quot;</span> /&gt;</span><br>    <span class="hljs-comment">&lt;!-- 拿 package-lock.json 的 name 作为标题 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>&lt;%= htmlWebpackPlugin.options.title %&gt;<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- 当浏览器不支持js时noscript中的元素就会被渲染 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">noscript</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>We&#x27;re sorry but &lt;%= htmlWebpackPlugin.options.title %&gt; doesn&#x27;t work properly without JavaScript enabled. Please enable it to continue.<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">noscript</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- 容器 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;app&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- built files will be auto injected --&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="不同版本的-Vue-与-render-函数"><a href="#不同版本的-Vue-与-render-函数" class="headerlink" title="不同版本的 Vue 与 render 函数"></a>不同版本的 Vue 与 <code>render</code> 函数</h3><p>1、<code>vue.js</code> 与 <code>vue.runtime.xxx.js</code> 的区别：</p><ul><li><code>import Vue from &#39;vue&#39;</code> 默认导入 <code>vue.runtime.esm.js</code></li><li><code>vue.js</code> 是完整版的 Vue，包含：核心功能 + 模板解析器</li><li><code>vue.runtime.xxx.js</code> 是<strong>运行版的 Vue</strong>，只包含核心功能，没有模板解析器</li></ul><p>2、<code>vue.runtime.xxx.js</code> 没有模板解析器，故不能使用 <code>template</code> 配置项，需使用 <code>render</code> 函数接收到的 <code>createElement</code> 函数去指定具体内容</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Vue</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./App.js&#x27;</span><br><span class="hljs-title class_">Vue</span>.<span class="hljs-property">config</span>.<span class="hljs-property">productionTip</span> = <span class="hljs-literal">false</span><br><br><span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;<br>  <span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-params">h</span> =&gt;</span> <span class="hljs-title function_">h</span>(<span class="hljs-title class_">App</span>),<br>&#125;).$mount(<span class="hljs-string">&#x27;#app&#x27;</span>)<br><br><span class="hljs-comment">// render()</span><br><span class="hljs-attr">render</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">createElement</span>) &#123;<br>  <span class="hljs-comment">// 创建元素</span><br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;h1&#x27;</span>, <span class="hljs-string">&#x27;Hello Vue&#x27;</span>)<br>&#125;<br><span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-params">createElement</span> =&gt;</span> <span class="hljs-title function_">createElement</span>(<span class="hljs-title class_">App</span>)<br></code></pre></td></tr></table></figure><h3 id="vue-config-js-配置文件"><a href="#vue-config-js-配置文件" class="headerlink" title="vue.config.js 配置文件"></a>vue.config.js 配置文件</h3><ol><li>使用 <code>vue inspect &gt; output.js</code> 可以查看到 Vue 脚手架的默认配置。</li><li>使用 <code>vue.config.js</code> 可以对脚手架进行个性化定制</li></ol><h2 id="ref-与-props"><a href="#ref-与-props" class="headerlink" title="ref 与 props"></a>ref 与 props</h2><h3 id="ref属性"><a href="#ref属性" class="headerlink" title="ref属性"></a>ref属性</h3><ol><li>被用来给元素或子组件<strong>注册引用信息</strong>（id的替代者）</li><li>应用在html标签上获取的是真实DOM元素，应用在组件标签上是组件实例对象（vc）</li><li>每个 vue 实例都有 <code>$refs</code> 对象，里面存储着 DOM 元素或子组件的引用。通过该方式可以获取到 DOM 元素或子组件实例。</li><li>使用方式：<ol><li>打标识：<code>&lt;h1 ref=&quot;xxx&quot;&gt;.....&lt;/h1&gt;</code> 或 <code>&lt;School ref=&quot;xxx&quot;&gt;&lt;/School&gt;</code></li><li>获取：<code>this.$refs.xxx</code></li></ol></li></ol><h3 id="props配置项"><a href="#props配置项" class="headerlink" title="props配置项"></a>props配置项</h3><ol><li><p>功能：让组件接收外部传过来的数据</p></li><li><p>传递数据：<code>&lt;Demo name=&quot;xxx&quot;/&gt;</code></p></li><li><p>接收数据：</p><ol><li>第一种方式（只接收）：<code>props:[&#39;name&#39;] </code></li><li>第二种方式（限制类型）：<code>props:&#123;name:String&#125;</code></li><li>第三种方式（限制类型、限制必要性、指定默认值）：</li></ol></li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//简单声明接收</span><br><span class="hljs-attr">props</span>: [<span class="hljs-string">&#x27;name&#x27;</span>, <span class="hljs-string">&#x27;age&#x27;</span>, <span class="hljs-string">&#x27;sex&#x27;</span>]<br><br><span class="hljs-comment">//接收的同时对数据进行类型限制</span><br><span class="hljs-attr">props</span>: &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-title class_">String</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-title class_">Number</span>,<br>    <span class="hljs-attr">sex</span>: <span class="hljs-title class_">String</span><br>&#125;<br><br><span class="hljs-comment">//接收的同时对数据：进行类型限制+默认值的指定+必要性的限制</span><br><span class="hljs-attr">props</span>: &#123;<br>    <span class="hljs-attr">name</span>: &#123;<br>    <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>, <span class="hljs-comment">//name的类型是字符串</span><br>        <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">//name是必要的</span><br>&#125;,<br>    <span class="hljs-attr">age</span>: &#123;<br>        <span class="hljs-attr">type</span>: <span class="hljs-title class_">Number</span>,<br><span class="hljs-attr">default</span>: <span class="hljs-number">99</span> <span class="hljs-comment">//默认值</span><br>    &#125;,<br>    <span class="hljs-attr">sex</span>: &#123;<br>        <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>,<br>        <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>备注：props是只读的，Vue底层会监测你对props的修改，如果进行了修改，就会发出警告，若业务需求确实需要修改，那么请复制props的内容到data中一份，然后去修改data中的数据。</p></blockquote><h2 id="mixin-混入"><a href="#mixin-混入" class="headerlink" title="mixin(混入)"></a>mixin(混入)</h2><ol><li><p>功能：可以把多个组件<strong>共用的配置</strong>提取成一个混入对象</p></li><li><p>使用方式：</p><p> 第一步定义混合：</p> <figure class="highlight nim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs nim">&#123;<br>    data()<span class="hljs-meta">&#123;....&#125;</span>,<br>    methods:<span class="hljs-meta">&#123;....&#125;</span><br>    ....<br>&#125;<br></code></pre></td></tr></table></figure><p> 第二步使用混入：</p><p>  全局混入：<code>Vue.mixin(xxx)</code><br>  局部混入：<code>mixins:[&#39;xxx&#39;]  </code></p></li></ol><h2 id="插件"><a href="#插件" class="headerlink" title="插件"></a>插件</h2><ol><li><p>功能：用于<strong>增强Vue</strong></p></li><li><p>本质：包含install方法的一个对象，install的第一个参数是Vue，第二个以后的参数是插件使用者传递的数据。</p></li><li><p>定义插件：</p> <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js">对象.<span class="hljs-property">install</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">Vue, options</span>) &#123;<br>    <span class="hljs-comment">// 1. 添加全局过滤器</span><br>    <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">filter</span>(....)<br><br>    <span class="hljs-comment">// 2. 添加全局指令</span><br>    <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">directive</span>(....)<br><br>    <span class="hljs-comment">// 3. 配置全局混入(合)</span><br>    <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">mixin</span>(....)<br><br>    <span class="hljs-comment">// 4. 添加实例方法 </span><br>    <span class="hljs-title class_">Vue</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">$myMethod</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;...&#125;<br>    <span class="hljs-title class_">Vue</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">$myProperty</span> = xxxx<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>使用插件：<code>Vue.use()</code></p></li></ol><h2 id="scoped样式"><a href="#scoped样式" class="headerlink" title="scoped样式"></a>scoped样式</h2><ol><li>作用：让样式在<strong>局部生效</strong>，防止冲突。</li><li>写法：<code>&lt;style scoped&gt;</code></li></ol><h2 id="TodoList案例"><a href="#TodoList案例" class="headerlink" title="TodoList案例"></a>TodoList案例</h2><p>1、组件化编码流程 </p><p>(1).拆分静态组件：组件要按照<strong>功能点</strong>拆分，命名不要与html元素冲突。</p><p>(2).实现动态组件：考虑好数据的存放位置，数据是一个组件在用，还是一些组件在用：</p><p>​      1).一个组件在用：放在组件自身即可。</p><p>​      2). 一些组件在用：放在他们共同的父组件上（<span style="color:red">状态提升</span>）。</p><p>(3).实现交互：从绑定事件开始。</p><p>2、props适用于</p><p>(1).父组件 &#x3D;&#x3D;&gt; 子组件 通信</p><p>(2).子组件 &#x3D;&#x3D;&gt; 父组件 通信（要求父先给子<strong>一个函数</strong>）</p><p>3、使用v-model时要切记：v-model绑定的值不能是props传过来的值，因为props是不可以修改的！</p><p>4、props传过来的若是对象类型的值，修改对象中的属性时Vue不会报错，但不推荐这样做。</p><h2 id="webStorage-浏览器本地存储"><a href="#webStorage-浏览器本地存储" class="headerlink" title="webStorage 浏览器本地存储"></a>webStorage 浏览器本地存储</h2><ol><li><p>存储内容大小一般支持5MB左右（不同浏览器可能还不一样）</p></li><li><p>浏览器端通过 <code>Window.sessionStorage</code> 和 <code>Window.localStorage</code> 属性来实现本地存储机制。</p></li><li><p>相关API：</p><ol><li><p><code>xxxxxStorage.setItem(&#39;key&#39;, &#39;value&#39;);</code><br>       该方法接受一个键和值作为参数，会把键值对添加到存储中，如果键名存在，则更新其对应的值。</p></li><li><p><code>xxxxxStorage.getItem(&#39;person&#39;);</code></p><p>   ​    该方法接受一个键名作为参数，返回键名对应的值。</p></li><li><p><code>xxxxxStorage.removeItem(&#39;key&#39;);</code></p><p>   ​    该方法接受一个键名作为参数，并把该键名从存储中删除。</p></li><li><p><code> xxxxxStorage.clear()</code></p><p>   ​    该方法会清空存储中的所有数据。</p></li></ol></li><li><p>备注：</p><ol><li>SessionStorage存储的内容会<strong>随着浏览器窗口关闭而消失</strong>。</li><li>LocalStorage存储的内容，<strong>需要手动清除才会消失</strong>。</li><li><code>xxxxxStorage.getItem(xxx)</code>如果xxx对应的value获取不到，那么getItem的返回值是null。</li><li><code>JSON.parse(null)</code>的结果依然是null。</li></ol></li></ol><h2 id="组件的自定义事件"><a href="#组件的自定义事件" class="headerlink" title="组件的自定义事件"></a>组件的自定义事件</h2><ol><li><p>一种<strong>组件间通信</strong>的方式，适用于：<strong style="color:red">子组件 &#x3D;&#x3D;&#x3D;&gt; 父组件</strong></p></li><li><p>使用场景：A是父组件，B是子组件，B想给A传数据，那么就要在A中给B绑定自定义事件（<span style="color:red">事件的回调在A中</span>）。</p></li><li><p>绑定自定义事件：</p><ol><li><p>第一种方式，在父组件中：<code>&lt;Demo @atguigu=&quot;test&quot;/&gt;</code> 或 <code>&lt;Demo v-on:atguigu=&quot;test&quot;/&gt;</code></p></li><li><p>第二种方式，在父组件中：</p> <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;<span class="hljs-title class_">Demo</span> ref=<span class="hljs-string">&quot;demo&quot;</span>/&gt;<br>......<br><span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>)&#123;<br>   <span class="hljs-variable language_">this</span>.<span class="hljs-property">$refs</span>.<span class="hljs-property">xxx</span>.$on(<span class="hljs-string">&#x27;atguigu&#x27;</span>,<span class="hljs-variable language_">this</span>.<span class="hljs-property">test</span>)<br>&#125;<br></code></pre></td></tr></table></figure> <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// App.vue</span><br><span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>) &#123;<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">$refs</span>.<span class="hljs-property">student</span>.$on(<span class="hljs-string">&#x27;atguigu&#x27;</span>,<span class="hljs-variable language_">this</span>.<span class="hljs-property">getStudentName</span>) <span class="hljs-comment">//绑定自定义事件</span><br> <span class="hljs-variable language_">this</span>.<span class="hljs-property">$refs</span>.<span class="hljs-property">student</span>.$once(<span class="hljs-string">&#x27;atguigu&#x27;</span>,<span class="hljs-variable language_">this</span>.<span class="hljs-property">getStudentName</span>) <span class="hljs-comment">//绑定自定义事件（一次性）</span><br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>若想让自定义事件只能触发一次，可以使用<code>once</code>修饰符，或<code>$once</code>方法。</p></li></ol></li><li><p>触发自定义事件：<code>this.$emit(&#39;atguigu&#39;,数据)</code>    </p></li><li><p>解绑自定义事件<code>this.$off(&#39;atguigu&#39;)</code></p></li><li><p>组件上也可以绑定原生DOM事件，需要使用<code>native</code>修饰符。</p></li><li><p>注意：通过<code>this.$refs.xxx.$on(&#39;atguigu&#39;,回调)</code>绑定自定义事件时，回调<span style="color:red">要么配置在methods中</span>，<span style="color:red">要么用箭头函数</span>，否则this指向会出问题！this会指向调用这个事件的对象vc</p></li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">methods</span>: &#123;<br>    <span class="hljs-title function_">add</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;add回调被调用了&#x27;</span>)<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">number</span>++<br>    &#125;,<br>    <span class="hljs-title function_">sendStudentlName</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-comment">//触发Student组件实例身上的atguigu事件</span><br>        <span class="hljs-variable language_">this</span>.$emit(<span class="hljs-string">&#x27;atguigu&#x27;</span>,<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>,<span class="hljs-number">666</span>,<span class="hljs-number">888</span>,<span class="hljs-number">900</span>)<br>        <span class="hljs-comment">// this.$emit(&#x27;demo&#x27;)</span><br>        <span class="hljs-comment">// this.$emit(&#x27;click&#x27;)</span><br>    &#125;,<br>    <span class="hljs-title function_">unbind</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-variable language_">this</span>.$off(<span class="hljs-string">&#x27;atguigu&#x27;</span>) <span class="hljs-comment">//解绑一个自定义事件</span><br>        <span class="hljs-comment">// this.$off([&#x27;atguigu&#x27;,&#x27;demo&#x27;]) //解绑多个自定义事件</span><br>        <span class="hljs-comment">// this.$off() //解绑所有的自定义事件</span><br>    &#125;,<br>    <span class="hljs-title function_">death</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-variable language_">this</span>.$destroy() <span class="hljs-comment">//销毁了当前Student组件的实例，销毁后所有Student实例的自定义事件全都不奏效。</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="全局事件总线（GlobalEventBus）"><a href="#全局事件总线（GlobalEventBus）" class="headerlink" title="全局事件总线（GlobalEventBus）"></a>全局事件总线（GlobalEventBus）</h2><ul><li>一种组件间通信的方式，适用于<span style="color:red">任意组件间通信</span>。</li></ul><h3 id="1、方法一"><a href="#1、方法一" class="headerlink" title="1、方法一"></a>1、方法一</h3><ol><li><p>安装全局事件总线：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;<br>   ......<br>   <span class="hljs-title function_">beforeCreate</span>(<span class="hljs-params"></span>) &#123;<br>      <span class="hljs-title class_">Vue</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">$bus</span> = <span class="hljs-variable language_">this</span> <span class="hljs-comment">//安装全局事件总线，$bus就是当前应用的vm</span><br>   &#125;,<br>    ......<br>&#125;) <br></code></pre></td></tr></table></figure></li><li><p>使用事件总线：</p><ol><li><p>接收数据：A组件想接收数据，则在A组件中给$bus绑定自定义事件，事件的<span style="color:red">回调留在A组件自身。</span></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">methods</span>(<span class="hljs-params"></span>)&#123;<br>  <span class="hljs-title function_">demo</span>(<span class="hljs-params">data</span>)&#123;......&#125;<br>&#125;<br>......<br><span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">$bus</span>.$on(<span class="hljs-string">&#x27;xxxx&#x27;</span>,<span class="hljs-variable language_">this</span>.<span class="hljs-property">demo</span>)<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>提供数据：<code>this.$bus.$emit(&#39;xxxx&#39;,数据)</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-attr">methods</span>: &#123;<br>    <span class="hljs-title function_">sendData</span>(<span class="hljs-params"></span>) &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">$bus</span>.$emit(<span class="hljs-string">&#x27;share&#x27;</span>, <span class="hljs-number">666</span>)<br>    &#125;,<br>  &#125;,<br>&#125;<br></code></pre></td></tr></table></figure></li></ol></li><li><p>最好在<code>beforeDestroy</code>钩子中，用$off去解绑<span style="color:red">当前组件所用到的</span>事件。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>) &#123;<br>&#125;,<br>  <span class="hljs-title function_">beforeDestroy</span>(<span class="hljs-params"></span>) &#123;<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">$bus</span>.$off(<span class="hljs-string">&#x27;hello&#x27;</span>)<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure></li></ol><h3 id="2、方法二"><a href="#2、方法二" class="headerlink" title="2、方法二"></a>2、方法二</h3><ol><li><p>创建 eventBus.js 模块，并向外共享一个 Vue 的实例对象。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// eventBus.js</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Vue</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>()<br></code></pre></td></tr></table></figure></li><li><p>在数据发送方，调用 <code>bus.$emit(&#39;事件名称&#39;, 要发送的数据)</code> 方法触发自定义事件</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 数据发送方</span><br><span class="hljs-keyword">import</span> bus <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./eventBus.js&#x27;</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> &#123;<br>      <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;hello&#x27;</span>,<br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">methods</span>: &#123;<br>    <span class="hljs-title function_">sendData</span>(<span class="hljs-params"></span>) &#123;<br>      bus.$emit(<span class="hljs-string">&#x27;share&#x27;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>)<br>    &#125;,<br>  &#125;,<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>在数据接收方，通过 <code>bus.$on(&#39;事件名称&#39;, 事件处理函数)</code> 为自定义事件注册事件处理函数。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 数据接收方</span><br><span class="hljs-keyword">import</span> bus <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./eventBus.js&#x27;</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> &#123;<br>      <span class="hljs-attr">msg</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br>    &#125;<br>  &#125;,<br>  <span class="hljs-comment">// 细节1：在 created 钩子中注册函数</span><br>  <span class="hljs-title function_">created</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">// 细节2：使用箭头函数，则 this 指向该组件而非 bus</span><br>    bus.$on(<span class="hljs-string">&#x27;share&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">val</span>) =&gt;</span> &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">msg</span> = val<br>    &#125;)<br>  &#125;,<br>&#125;<br></code></pre></td></tr></table></figure></li></ol><h2 id="消息订阅与发布（pubsub）"><a href="#消息订阅与发布（pubsub）" class="headerlink" title="消息订阅与发布（pubsub）"></a>消息订阅与发布（pubsub）</h2><ol><li><p>一种组件间通信的方式，适用于<span style="color:red">任意组件间通信</span>。</p></li><li><p>使用步骤：</p><ol><li><p>安装pubsub：<code>npm i pubsub-js</code></p></li><li><p>引入: <code>import pubsub from &#39;pubsub-js&#39;</code></p></li><li><p>接收数据：A组件想接收数据，则在A组件中订阅消息，订阅的<span style="color:red">回调留在A组件自身。</span></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> pubsub <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;pubsub-js&#x27;</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-attr">methods</span>: &#123;<br>    <span class="hljs-title function_">handleData</span>(<span class="hljs-params">messageName, data</span>) &#123;...&#125;<br>  &#125;,<br>  <span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">pubId</span> = pubsub.<span class="hljs-title function_">subscribe</span>(<span class="hljs-string">&#x27;share&#x27;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleData</span>)<br>    <span class="hljs-comment">// or</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">pubId</span> = pubsub.<span class="hljs-title function_">subscribe</span>(<span class="hljs-string">&#x27;share&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">messageName, data</span>) =&gt;</span> &#123;<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data)<br>    &#125;)<br>  &#125;,<br>  <span class="hljs-title function_">beforeDestroy</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">// 组件销毁，取消订阅</span><br>    pubsub.<span class="hljs-title function_">unsubscribe</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">pubId</span>)<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>提供数据：<code>pubsub.publish(&#39;xxx&#39;,数据)</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> pubsub <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;pubsub-js&#x27;</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-attr">methods</span>: &#123;<br>    <span class="hljs-title function_">handleData</span>(<span class="hljs-params">messageName, data</span>) &#123;...&#125;<br>  &#125;,<br>  <span class="hljs-title function_">created</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">pubId</span> = pubsub.<span class="hljs-title function_">subscribe</span>(<span class="hljs-string">&#x27;share&#x27;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleData</span>)<br>    <span class="hljs-comment">// or</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">pubId</span> = pubsub.<span class="hljs-title function_">subscribe</span>(<span class="hljs-string">&#x27;share&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">messageName, data</span>) =&gt;</span> &#123;<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data)<br>    &#125;)<br>  &#125;,<br>  <span class="hljs-title function_">beforeDestroy</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">// 组件销毁，取消订阅</span><br>    pubsub.<span class="hljs-title function_">unsubscribe</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">pubId</span>)<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>最好在beforeDestroy钩子中，用<code>PubSub.unsubscribe(pid)</code>去<span style="color:red">取消订阅。</span></p></li></ol></li></ol><h2 id="nextTick"><a href="#nextTick" class="headerlink" title="nextTick"></a>nextTick</h2><ol><li>语法：<code>this.$nextTick(回调函数)</code><strong>生命周期钩子</strong></li><li>作用：在下一次 DOM 更新结束后执行其指定的回调。</li><li>什么时候用：当改变数据后，要基于更新后的新DOM进行某些操作时，要在nextTick所指定的回调函数中执行。</li><li>组件的 <code>$nextTick(cb)</code> 方法，会把 cb 回调推迟到下一个 DOM 更新周期之后执行，即在 DOM 更新完成后再执行回调，从而保证 cb 回调可以获取最新的 DOM 元素</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">methods</span>: &#123;<br>  <span class="hljs-title function_">showInput</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">inputVisible</span> = <span class="hljs-literal">true</span><br>    <span class="hljs-comment">// 对输入框的操作推迟到 DOM 更新完成之后</span><br>    <span class="hljs-variable language_">this</span>.$nextTick(<span class="hljs-function">() =&gt;</span> &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">$refs</span>.<span class="hljs-property">input</span>.<span class="hljs-title function_">focus</span>()<br>    &#125;)<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="Vue封装的过度与动画"><a href="#Vue封装的过度与动画" class="headerlink" title="Vue封装的过度与动画"></a>Vue封装的过度与动画</h2><h3 id="1、作用"><a href="#1、作用" class="headerlink" title="1、作用"></a>1、作用</h3><ul><li>在插入、更新或移除 DOM元素时，在合适的时候给元素添加样式类名。</li></ul><p><img src="/img/vue/Snipaste_2022-11-15_14-08-24.png" alt="image"></p><h3 id="2、写法"><a href="#2、写法" class="headerlink" title="2、写法"></a>2、写法</h3><ol><li><p>准备好样式：</p><ul><li>元素进入的样式：<ol><li>v-enter：进入的起点</li><li>v-enter-active：进入过程中</li><li>v-enter-to：进入的终点</li></ol></li><li>元素离开的样式：<ol><li>v-leave：离开的起点</li><li>v-leave-active：离开过程中</li><li>v-leave-to：离开的终点</li></ol></li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.hello-enter-active</span> &#123;<br>    <span class="hljs-attribute">animation</span>: atguigu <span class="hljs-number">0.5s</span> linear;<br>&#125;<br><br><span class="hljs-selector-class">.hello-leave-active</span> &#123;<br>    <span class="hljs-attribute">animation</span>: atguigu <span class="hljs-number">0.5s</span> linear reverse;<br>&#125;<br><br><span class="hljs-comment">/* 动画 */</span><br><span class="hljs-keyword">@keyframes</span> atguigu &#123;<br>    <span class="hljs-selector-tag">from</span> &#123;<br>        <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(-<span class="hljs-number">100%</span>);<br>    &#125;<br><br>    <span class="hljs-selector-tag">to</span> &#123;<br>        <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(<span class="hljs-number">0px</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>使用<code>&lt;transition&gt;</code>包裹要过度的元素，并配置name属性：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;transition name=&quot;hello&quot;&gt;<br>   &lt;h1 v-show=&quot;isShow&quot;&gt;你好啊！&lt;/h1&gt;<br>&lt;/transition&gt;<br></code></pre></td></tr></table></figure></li><li><p>备注：若有多个元素需要过度，则需要使用：<code>&lt;transition-group&gt;</code>，且每个元素都要指定<code>key</code>值。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">transition-group</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;hello&quot;</span> <span class="hljs-attr">appear</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">v-show</span>=<span class="hljs-string">&quot;!isShow&quot;</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;1&quot;</span>&gt;</span>你好啊！<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">v-show</span>=<span class="hljs-string">&quot;isShow&quot;</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;2&quot;</span>&gt;</span>尚硅谷！<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">transition-group</span>&gt;</span><br></code></pre></td></tr></table></figure></li></ol><h3 id="3、第三方库-Animate-css"><a href="#3、第三方库-Animate-css" class="headerlink" title="3、第三方库 Animate.css"></a>3、第三方库 Animate.css</h3><ul><li>借助第三方库，可以简单实现动画效果</li></ul><p>安装：<code>npm install animate.css --save</code></p><p>引入：<code>import &#39;animate.css&#39;</code></p><p>使用：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">transition-group</span> </span><br><span class="hljs-tag">    <span class="hljs-attr">appear</span></span><br><span class="hljs-tag">    <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;animate__animated animate__bounce&quot;</span> </span><br><span class="hljs-tag">    <span class="hljs-attr">enter-active-class</span>=<span class="hljs-string">&quot;animate__swing&quot;</span></span><br><span class="hljs-tag">    <span class="hljs-attr">leave-active-class</span>=<span class="hljs-string">&quot;animate__backOutUp&quot;</span></span><br><span class="hljs-tag">&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">v-show</span>=<span class="hljs-string">&quot;!isShow&quot;</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;1&quot;</span>&gt;</span>你好啊！<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">v-show</span>=<span class="hljs-string">&quot;isShow&quot;</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;2&quot;</span>&gt;</span>尚硅谷！<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">transition-group</span>&gt;</span><br></code></pre></td></tr></table></figure><h1 id="Vue中的ajax"><a href="#Vue中的ajax" class="headerlink" title="Vue中的ajax"></a>Vue中的ajax</h1><h2 id="vue脚手架配置代理"><a href="#vue脚手架配置代理" class="headerlink" title="vue脚手架配置代理"></a>vue脚手架配置代理</h2><h3 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h3><p>  在vue.config.js中添加如下配置：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">devServer</span>:&#123;<br>  <span class="hljs-attr">proxy</span>:<span class="hljs-string">&quot;http://localhost:5000&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>说明：</p><ol><li>优点：配置简单，请求资源时直接发给前端（8080）即可。</li><li>缺点：不能配置多个代理，不能灵活的控制请求是否走代理。</li><li>工作方式：若按照上述配置代理，当请求了前端不存在的资源时，那么该请求会转发给服务器 （优先匹配前端资源）</li></ol><h3 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h3><p>  编写vue.config.js配置具体代理规则：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>   <span class="hljs-attr">devServer</span>: &#123;<br>      <span class="hljs-attr">proxy</span>: &#123;<br>      <span class="hljs-string">&#x27;/api1&#x27;</span>: &#123;<span class="hljs-comment">// 匹配所有以 &#x27;/api1&#x27;开头的请求路径</span><br>        <span class="hljs-attr">target</span>: <span class="hljs-string">&#x27;http://localhost:5000&#x27;</span>,<span class="hljs-comment">// 代理目标的基础路径</span><br>        <span class="hljs-attr">changeOrigin</span>: <span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">pathRewrite</span>: &#123;<span class="hljs-string">&#x27;^/api1&#x27;</span>: <span class="hljs-string">&#x27;&#x27;</span>&#125;<span class="hljs-comment">// 将以api1开头的路径变为空</span><br>      &#125;,<br>      <span class="hljs-string">&#x27;/api2&#x27;</span>: &#123;<span class="hljs-comment">// 匹配所有以 &#x27;/api2&#x27;开头的请求路径</span><br>        <span class="hljs-attr">target</span>: <span class="hljs-string">&#x27;http://localhost:5001&#x27;</span>,<span class="hljs-comment">// 代理目标的基础路径</span><br>        <span class="hljs-attr">changeOrigin</span>: <span class="hljs-literal">true</span>,<span class="hljs-comment">//用于控制请求头中的host值</span><br>        <span class="hljs-attr">pathRewrite</span>: &#123;<span class="hljs-string">&#x27;^/api2&#x27;</span>: <span class="hljs-string">&#x27;&#x27;</span>&#125;<br>        <span class="hljs-comment">// ws: true, //用于支持websocket</span><br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br><span class="hljs-comment">/*</span><br><span class="hljs-comment">   changeOrigin设置为true时，服务器收到的请求头中的host为：localhost:5000</span><br><span class="hljs-comment">   changeOrigin设置为false时，服务器收到的请求头中的host为：localhost:8080</span><br><span class="hljs-comment">   changeOrigin默认值为true</span><br><span class="hljs-comment">*/</span><br></code></pre></td></tr></table></figure><p>说明：</p><ol><li>优点：可以配置多个代理，且可以灵活的控制请求是否走代理。</li><li>缺点：配置略微繁琐，请求资源时必须加前缀。</li></ol><h2 id="插槽"><a href="#插槽" class="headerlink" title="插槽"></a>插槽</h2><ul><li>插槽可以理解为组件封装期间，为用户预留的<strong>内容占位符</strong>。它是 vue 为组件封装者提供的能力，允许开发者在封装组件时，把<strong>不确定的、希望由用户指定的部分</strong>定义为插槽。</li></ul><h3 id="1、作用-1"><a href="#1、作用-1" class="headerlink" title="1、作用"></a>1、作用</h3><ul><li>让父组件可以向子组件指定位置插入html结构，也是一种组件间通信的方式，适用于 <strong style="color:red">父组件 &#x3D;&#x3D;&#x3D;&gt; 子组件</strong> 。</li></ul><h3 id="2、分类"><a href="#2、分类" class="headerlink" title="2、分类"></a>2、分类</h3><ul><li>默认插槽、具名插槽、作用域插槽</li></ul><h3 id="3、使用方式"><a href="#3、使用方式" class="headerlink" title="3、使用方式"></a>3、使用方式</h3><h4 id="1、默认插槽"><a href="#1、默认插槽" class="headerlink" title="1、默认插槽"></a>1、默认插槽</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-comment">&lt;!-- 子组件中预留插槽 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;contianer&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>这是子组件<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">slot</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br><span class="hljs-comment">&lt;!-- 父组件使用子组件时，向插槽填充内容 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">child-comp</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>填充到插槽的内容<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">child-comp</span>&gt;</span><br></code></pre></td></tr></table></figure><p>如果子组件没有预留插槽，那么父组件填充给子组件的自定义内容会被丢弃：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-comment">&lt;!-- 子组件没有预留插槽 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;contianer&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>这是子组件<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br><span class="hljs-comment">&lt;!-- 父组件的自定义内容会被丢弃 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">child-comp</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>这段自定义内容会被丢弃<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">child-comp</span>&gt;</span><br></code></pre></td></tr></table></figure><p>子组件可以为插槽提供<strong>后备内容</strong>，当父组件没有提供自定义内容时，后备内容就会生效。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-comment">&lt;!-- 子组件提供后备内容 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;contianer&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>这是子组件<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">slot</span>&gt;</span>这是后备内容，父组件没有提供自定义内容就会生效<span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br><span class="hljs-comment">&lt;!-- 父组件没有提供自定义内容 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">child-comp</span>&gt;</span> <span class="hljs-tag">&lt;/<span class="hljs-name">child-comp</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="2、具名插槽"><a href="#2、具名插槽" class="headerlink" title="2、具名插槽"></a>2、具名插槽</h4><p>组件在预留插槽时可以设置 <code>name</code> 属性，为插槽指定名称，这种有具体名称的插槽就叫具名插槽。 没有设置 <code>name</code> 名称的插槽默认名称为 <code>default</code> 。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-comment">&lt;!-- 子组件预留多个具名插槽 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;contianer&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>这是子组件<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;title&quot;</span>&gt;</span>title 具名插槽<span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">hr</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;content&quot;</span>&gt;</span>content 具名插槽<span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span>&gt;<br>    <span class="hljs-tag">&lt;<span class="hljs-name">hr</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">slot</span>&gt;</span>没有设置 name 名称则默认为 default<span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;default&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br></code></pre></td></tr></table></figure><p>父组件向具名插槽提供自定义内容</p><ul><li>新的写法：包裹一个 <code>&lt;template&gt;</code> 标签，同时在 <code>&lt;template&gt;</code> 中通过 <code>v-slot:名称</code> 指明插槽的名称。简写形式为 <code>#名称</code> ，且 <code>v-slot</code> 只能使用在 <code>&lt;template&gt;</code> 和组件标签上，普通 HTML 标签不行</li><li>旧的写法：<code>slot=&quot;名称&quot;</code> 指明插槽名称</li><li>如果不指定插槽名称，那么自定义内容会被填充到所有的 <code>default</code> 插槽当中</li><li>同一插槽填充多个内容，是追加不是覆盖</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-comment">&lt;!-- 父组件向具名插槽提供自定义内容 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">child-comp</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">slot</span>=<span class="hljs-string">&quot;title&quot;</span>&gt;</span>《赠汪伦》<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><br>  <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">v-slot:title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>《静夜思》<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br>  <span class="hljs-comment">&lt;!-- 简写形式 --&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">content</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>床前明月光，疑是地上霜。<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>举头望明月，低头思故乡。<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br>  <span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>这段内容没有指定名称，会被填充到所有 default 插槽中。<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">child-comp</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="3、作用域插槽"><a href="#3、作用域插槽" class="headerlink" title="3、作用域插槽"></a>3、作用域插槽</h4><p>1、理解：<span style="color:red">数据在组件的自身，但根据数据生成的结构需要组件的使用者来决定。</span>（games数据在Category组件中，但使用数据所遍历出来的结构由App组件决定）</p><p>2、具体编码</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-comment">&lt;!-- 子组件为插槽绑定 props 数据 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">&quot;item in list&quot;</span> <span class="hljs-attr">:user</span>=<span class="hljs-string">&quot;item&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">slot</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> &#123;<br>      <span class="hljs-attr">list</span>: [<br>        &#123;<br>          <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,<br>          <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Lily&#x27;</span>,<br>          <span class="hljs-attr">state</span>: <span class="hljs-literal">true</span>,<br>        &#125;,<br>        &#123;<br>          <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>,<br>          <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Ben&#x27;</span>,<br>          <span class="hljs-attr">state</span>: <span class="hljs-literal">false</span>,<br>        &#125;,<br>        &#123;<br>          <span class="hljs-attr">id</span>: <span class="hljs-number">3</span>,<br>          <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Water&#x27;</span>,<br>          <span class="hljs-attr">state</span>: <span class="hljs-literal">true</span>,<br>        &#125;,<br>      ],<br>    &#125;<br>  &#125;,<br>&#125;<br></code></pre></td></tr></table></figure><p>父组件向插槽提供自定义内容时，可以接收作用域插槽提供的数据：</p><ul><li>旧写法：<code>scope=&quot;scope&quot;</code> 、<code>slot-scope=&quot;scope&quot;</code></li><li>新写法：<code>v-slot:default=&quot;scope&quot;</code></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">child-comp</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">default</span>=<span class="hljs-string">&quot;scope&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>作用域插槽提供的数据：&#123;&#123; scope &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br>  <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">slot-scope</span>=<span class="hljs-string">&quot;scope&quot;</span> <span class="hljs-attr">slot</span>=<span class="hljs-string">&quot;default&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>&#123;&#123; scope &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">child-comp</span>&gt;</span><br></code></pre></td></tr></table></figure><p>其中接收到的数据 <code>scope</code> 是一个对象。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// scope 的内容</span><br>&#123;<br>  <span class="hljs-string">&#x27;user&#x27;</span>: &#123;<br>    <span class="hljs-string">&#x27;id&#x27;</span>: <span class="hljs-number">1</span>,<br>    <span class="hljs-string">&#x27;name&#x27;</span>: <span class="hljs-string">&#x27;Lily&#x27;</span>,<br>    <span class="hljs-string">&#x27;state&#x27;</span>: <span class="hljs-literal">true</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>在接收作用域插槽提供的数据时可以使用解构赋值。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">child-comp</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">default</span>=<span class="hljs-string">&quot;&#123;user&#125;&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>id：&#123;&#123; user.id &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>name：&#123;&#123; user.name &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>state：&#123;&#123; user.state &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">child-comp</span>&gt;</span><br></code></pre></td></tr></table></figure><h1 id="Vuex"><a href="#Vuex" class="headerlink" title="Vuex"></a>Vuex</h1><h2 id="1-概念"><a href="#1-概念" class="headerlink" title="1.概念"></a>1.概念</h2><p>​     在Vue中实现<strong>集中式</strong>状态（数据）管理的一个Vue插件，对vue应用中多个组件的共享状态进行集中式的管理（读&#x2F;写），也是一种组件间通信的方式，且适用于任意组件间通信。</p><p><img src="/img/vue/vuex.png" alt="vuex原理图"></p><h3 id="state"><a href="#state" class="headerlink" title="state"></a>state</h3><ul><li>Vuex 管理的状态对象</li><li>唯一的</li></ul><h3 id="actions"><a href="#actions" class="headerlink" title="actions"></a>actions</h3><ul><li>值为一个对象，包含多个响应用户动作的回调函数</li><li>通过 <code>commit()</code>触发 mutation 中函数的调用，间接更新 state</li><li>可包含异步代码</li></ul><h3 id="mutations"><a href="#mutations" class="headerlink" title="mutations"></a>mutations</h3><ul><li>值为一个对象，包含多个直接更新 state 的方法</li><li>不能写异步代码，只能单纯地操作 state</li></ul><h3 id="getters"><a href="#getters" class="headerlink" title="getters"></a>getters</h3><ul><li>值为一个对象，包含多个用于返回数据的函数</li><li>类似于计算属性，getters 返回的数据依赖于 state 的数据</li></ul><h3 id="modules"><a href="#modules" class="headerlink" title="modules"></a>modules</h3><ul><li>一个 module 是一个 store 的配置对象，与一个组件对应</li></ul><h2 id="2-何时使用？"><a href="#2-何时使用？" class="headerlink" title="2.何时使用？"></a>2.何时使用？</h2><ul><li>多个组件需要共享数据时</li></ul><h2 id="3-搭建vuex环境"><a href="#3-搭建vuex环境" class="headerlink" title="3.搭建vuex环境"></a>3.搭建vuex环境</h2><ul><li>安装 Vuex：<code>npm install vuex@3 --save</code></li></ul><blockquote><p>注意：Vue2 安装 Vuex3，Vue3 安装 Vuex4，版本需对应。</p></blockquote><ol><li><p>创建文件：<code>src/store/index.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//引入Vue核心库</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Vue</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><span class="hljs-comment">//引入Vuex</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Vuex</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vuex&#x27;</span><br><span class="hljs-comment">//应用Vuex插件</span><br><span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">use</span>(<span class="hljs-title class_">Vuex</span>)<br><br><span class="hljs-comment">//准备actions对象——响应组件中用户的动作</span><br><span class="hljs-keyword">const</span> actions = &#123;&#125;<br><span class="hljs-comment">//准备mutations对象——修改state中的数据</span><br><span class="hljs-keyword">const</span> mutations = &#123;&#125;<br><span class="hljs-comment">//准备state对象——保存具体的数据</span><br><span class="hljs-keyword">const</span> state = &#123;&#125;<br><br><span class="hljs-comment">//创建并暴露store</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vuex</span>.<span class="hljs-title class_">Store</span>(&#123;<br>   actions,<br>   mutations,<br>   state<br>&#125;)<br></code></pre></td></tr></table></figure></li><li><p>在<code>main.js</code>中创建vm时传入<code>store</code>配置项</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js">......<br><span class="hljs-comment">//引入store</span><br><span class="hljs-keyword">import</span> store <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./store&#x27;</span><br>......<br><br><span class="hljs-comment">//创建vm</span><br><span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;<br>   <span class="hljs-attr">el</span>:<span class="hljs-string">&#x27;#app&#x27;</span>,<br>   <span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-params">h</span> =&gt;</span> <span class="hljs-title function_">h</span>(<span class="hljs-title class_">App</span>),<br>   store<br>&#125;)<br></code></pre></td></tr></table></figure></li></ol><h2 id="4-基本使用"><a href="#4-基本使用" class="headerlink" title="4.基本使用"></a>4.基本使用</h2><ol><li><p>初始化数据、配置<code>actions</code>、配置<code>mutations</code>，操作文件<code>store.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//引入Vue核心库</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Vue</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><span class="hljs-comment">//引入Vuex</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Vuex</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vuex&#x27;</span><br><span class="hljs-comment">//引用Vuex</span><br><span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">use</span>(<span class="hljs-title class_">Vuex</span>)<br><br><span class="hljs-keyword">const</span> actions = &#123;<br>    <span class="hljs-comment">//响应组件中加的动作</span><br>   <span class="hljs-title function_">jia</span>(<span class="hljs-params">context,value</span>)&#123;<br>      <span class="hljs-comment">// console.log(&#x27;actions中的jia被调用了&#x27;,miniStore,value)</span><br>      context.<span class="hljs-title function_">commit</span>(<span class="hljs-string">&#x27;JIA&#x27;</span>,value)<br>   &#125;,<br>&#125;<br><br><span class="hljs-keyword">const</span> mutations = &#123;<br>    <span class="hljs-comment">//执行加</span><br>   <span class="hljs-title function_">JIA</span>(<span class="hljs-params">state,value</span>)&#123;<br>      <span class="hljs-comment">// console.log(&#x27;mutations中的JIA被调用了&#x27;,state,value)</span><br>      state.<span class="hljs-property">sum</span> += value<br>   &#125;<br>&#125;<br><br><span class="hljs-comment">//初始化数据</span><br><span class="hljs-keyword">const</span> state = &#123;<br>   <span class="hljs-attr">sum</span>:<span class="hljs-number">0</span><br>&#125;<br><br><span class="hljs-comment">//创建并暴露store</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vuex</span>.<span class="hljs-title class_">Store</span>(&#123;<br>   actions,<br>   mutations,<br>   state,<br>&#125;)<br></code></pre></td></tr></table></figure></li><li><p>组件中读取vuex中的数据：<code>$store.state.sum</code></p></li><li><p>组件中修改vuex中的数据：<code>$store.dispatch(&#39;action中的方法名&#39;,数据)</code> 或 <code>$store.commit(&#39;mutations中的方法名&#39;,数据)</code></p><blockquote><p> 备注：若没有网络请求或其他业务逻辑，组件中也可以越过actions，即不写<code>dispatch</code>，直接编写<code>commit</code></p></blockquote></li></ol><h2 id="5-getters的使用"><a href="#5-getters的使用" class="headerlink" title="5.getters的使用"></a>5.getters的使用</h2><ol><li><p>概念：当<code>state</code>中的数据需要经过加工后再使用时，可以使用getters加工。</p></li><li><p>它不是必须的，当加工逻辑复杂且需要复用时，可以考虑使用</p></li><li><p>在<code>store.js</code>中追加<code>getters</code>配置</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js">......<br><br><span class="hljs-keyword">const</span> getters = &#123;<br>   <span class="hljs-title function_">bigSum</span>(<span class="hljs-params">state</span>)&#123;<br>      <span class="hljs-keyword">return</span> state.<span class="hljs-property">sum</span> * <span class="hljs-number">10</span><br>   &#125;<br>&#125;<br><br><span class="hljs-comment">//创建并暴露store</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vuex</span>.<span class="hljs-title class_">Store</span>(&#123;<br>   ......<br>   getters<br>&#125;)<br></code></pre></td></tr></table></figure></li><li><p>组件中读取数据：<code>$store.getters.bigSum</code></p></li></ol><h2 id="6-四个map方法的使用"><a href="#6-四个map方法的使用" class="headerlink" title="6.四个map方法的使用"></a>6.四个map方法的使用</h2><ol><li><p><strong>mapState方法</strong>：用于帮助我们映射<code>state</code>中的数据为计算属性</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">computed</span>: &#123;<br>    <span class="hljs-comment">//借助mapState生成计算属性：sum、school、subject（对象写法）</span><br>     ...<span class="hljs-title function_">mapState</span>(&#123;<span class="hljs-attr">sum</span>:<span class="hljs-string">&#x27;sum&#x27;</span>,<span class="hljs-attr">school</span>:<span class="hljs-string">&#x27;school&#x27;</span>,<span class="hljs-attr">subject</span>:<span class="hljs-string">&#x27;subject&#x27;</span>&#125;),<br>         <br>    <span class="hljs-comment">//借助mapState生成计算属性：sum、school、subject（数组写法）</span><br>    ...<span class="hljs-title function_">mapState</span>([<span class="hljs-string">&#x27;sum&#x27;</span>,<span class="hljs-string">&#x27;school&#x27;</span>,<span class="hljs-string">&#x27;subject&#x27;</span>]),<br>&#125;,<br></code></pre></td></tr></table></figure></li><li><p><strong>mapGetters方法</strong>：帮助我们映射<code>getters</code>中的数据为计算属性</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">computed</span>: &#123;<br>    <span class="hljs-comment">//借助mapGetters生成计算属性：bigSum（对象写法）</span><br>    ...<span class="hljs-title function_">mapGetters</span>(&#123;<span class="hljs-attr">bigSum</span>:<span class="hljs-string">&#x27;bigSum&#x27;</span>&#125;),<br><br>    <span class="hljs-comment">//借助mapGetters生成计算属性：bigSum（数组写法）</span><br>    ...<span class="hljs-title function_">mapGetters</span>([<span class="hljs-string">&#x27;bigSum&#x27;</span>])<br>&#125;,<br></code></pre></td></tr></table></figure></li><li><p><strong>mapActions方法：</strong>用于帮助我们生成与<code>actions</code>对话的方法，即：包含<code>$store.dispatch(xxx)</code>的函数</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">methods</span>:&#123;<br>    <span class="hljs-comment">//靠mapActions生成：incrementOdd、incrementWait（对象形式）</span><br>    ...<span class="hljs-title function_">mapActions</span>(&#123;<span class="hljs-attr">incrementOdd</span>:<span class="hljs-string">&#x27;jiaOdd&#x27;</span>,<span class="hljs-attr">incrementWait</span>:<span class="hljs-string">&#x27;jiaWait&#x27;</span>&#125;)<br><br>    <span class="hljs-comment">//靠mapActions生成：incrementOdd、incrementWait（数组形式）</span><br>    ...<span class="hljs-title function_">mapActions</span>([<span class="hljs-string">&#x27;jiaOdd&#x27;</span>,<span class="hljs-string">&#x27;jiaWait&#x27;</span>])<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p><strong>mapMutations方法：</strong>用于帮助我们生成与<code>mutations</code>对话的方法，即：包含<code>$store.commit(xxx)</code>的函数</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">methods</span>:&#123;<br>    <span class="hljs-comment">//靠mapActions生成：increment、decrement（对象形式）</span><br>    ...<span class="hljs-title function_">mapMutations</span>(&#123;<span class="hljs-attr">increment</span>:<span class="hljs-string">&#x27;JIA&#x27;</span>,<span class="hljs-attr">decrement</span>:<span class="hljs-string">&#x27;JIAN&#x27;</span>&#125;),<br>    <br>    <span class="hljs-comment">//靠mapMutations生成：JIA、JIAN（对象形式）</span><br>    ...<span class="hljs-title function_">mapMutations</span>([<span class="hljs-string">&#x27;JIA&#x27;</span>,<span class="hljs-string">&#x27;JIAN&#x27;</span>]),<br>&#125;<br></code></pre></td></tr></table></figure></li></ol><blockquote><p>备注：mapActions与mapMutations使用时，若需要传递参数需要：在模板中绑定事件时传递好参数，否则参数是事件对象。</p></blockquote><h2 id="7、模块化-命名空间"><a href="#7、模块化-命名空间" class="headerlink" title="7、模块化+命名空间"></a>7、模块化+命名空间</h2><ol><li><p>目的：让代码更好维护，让多种数据分类更加明确，每一类数据及其相关操作对应一个 <code>store</code> 。</p></li><li><p>修改<code>store.js</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> countAbout = &#123;<br>  <span class="hljs-attr">namespaced</span>:<span class="hljs-literal">true</span>,<span class="hljs-comment">//开启命名空间</span><br>  <span class="hljs-attr">state</span>:&#123;<span class="hljs-attr">x</span>:<span class="hljs-number">1</span>&#125;,<br>  <span class="hljs-attr">mutations</span>: &#123; ... &#125;,<br>  <span class="hljs-attr">actions</span>: &#123; ... &#125;,<br>  <span class="hljs-attr">getters</span>: &#123;<br>    <span class="hljs-title function_">bigSum</span>(<span class="hljs-params">state</span>)&#123;<br>       <span class="hljs-keyword">return</span> state.<span class="hljs-property">sum</span> * <span class="hljs-number">10</span><br>    &#125;<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> personAbout = &#123;<br>  <span class="hljs-attr">namespaced</span>:<span class="hljs-literal">true</span>,<span class="hljs-comment">//开启命名空间</span><br>  <span class="hljs-attr">state</span>:&#123; ... &#125;,<br>  <span class="hljs-attr">mutations</span>: &#123; ... &#125;,<br>  <span class="hljs-attr">actions</span>: &#123; ... &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> store = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vuex</span>.<span class="hljs-title class_">Store</span>(&#123;<br>  <span class="hljs-attr">modules</span>: &#123;<br>    countAbout,<br>    personAbout<br>  &#125;<br>&#125;)<br></code></pre></td></tr></table></figure></li><li><p>开启命名空间后，组件中读取state数据：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//方式一：自己直接读取</span><br><span class="hljs-variable language_">this</span>.<span class="hljs-property">$store</span>.<span class="hljs-property">state</span>.<span class="hljs-property">personAbout</span>.<span class="hljs-property">list</span><br><span class="hljs-comment">//方式二：借助mapState读取：</span><br>...<span class="hljs-title function_">mapState</span>(<span class="hljs-string">&#x27;countAbout&#x27;</span>,[<span class="hljs-string">&#x27;sum&#x27;</span>,<span class="hljs-string">&#x27;school&#x27;</span>,<span class="hljs-string">&#x27;subject&#x27;</span>]),<br></code></pre></td></tr></table></figure></li><li><p>开启命名空间后，组件中读取getters数据：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//方式一：自己直接读取</span><br><span class="hljs-variable language_">this</span>.<span class="hljs-property">$store</span>.<span class="hljs-property">getters</span>[<span class="hljs-string">&#x27;personAbout/firstPersonName&#x27;</span>]<br><span class="hljs-comment">//方式二：借助mapGetters读取：</span><br>...<span class="hljs-title function_">mapGetters</span>(<span class="hljs-string">&#x27;countAbout&#x27;</span>,[<span class="hljs-string">&#x27;bigSum&#x27;</span>])<br></code></pre></td></tr></table></figure></li><li><p>开启命名空间后，组件中调用dispatch</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//方式一：自己直接dispatch</span><br><span class="hljs-variable language_">this</span>.<span class="hljs-property">$store</span>.<span class="hljs-title function_">dispatch</span>(<span class="hljs-string">&#x27;personAbout/addPersonWang&#x27;</span>,person)<br><span class="hljs-comment">//方式二：借助mapActions：</span><br>...<span class="hljs-title function_">mapActions</span>(<span class="hljs-string">&#x27;countAbout&#x27;</span>,&#123;<span class="hljs-attr">incrementOdd</span>:<span class="hljs-string">&#x27;jiaOdd&#x27;</span>,<span class="hljs-attr">incrementWait</span>:<span class="hljs-string">&#x27;jiaWait&#x27;</span>&#125;)<br></code></pre></td></tr></table></figure></li><li><p>开启命名空间后，组件中调用commit</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//方式一：自己直接commit</span><br><span class="hljs-variable language_">this</span>.<span class="hljs-property">$store</span>.<span class="hljs-title function_">commit</span>(<span class="hljs-string">&#x27;personAbout/ADD_PERSON&#x27;</span>,person)<br><span class="hljs-comment">//方式二：借助mapMutations：</span><br>...<span class="hljs-title function_">mapMutations</span>(<span class="hljs-string">&#x27;countAbout&#x27;</span>,&#123;<span class="hljs-attr">increment</span>:<span class="hljs-string">&#x27;JIA&#x27;</span>,<span class="hljs-attr">decrement</span>:<span class="hljs-string">&#x27;JIAN&#x27;</span>&#125;),<br></code></pre></td></tr></table></figure></li></ol><h1 id="vue-router-路由"><a href="#vue-router-路由" class="headerlink" title="vue-router 路由"></a>vue-router 路由</h1><h2 id="1、路由概念"><a href="#1、路由概念" class="headerlink" title="1、路由概念"></a>1、路由概念</h2><h3 id="1、何为路由"><a href="#1、何为路由" class="headerlink" title="1、何为路由"></a>1、何为路由</h3><ol><li>理解： 一个路由（route）就是一组映射关系（key - value），多个路由需要路由器（router）进行管理。</li><li>key 为路径，value 可能是 function 或 component</li></ol><h3 id="2、前端路由"><a href="#2、前端路由" class="headerlink" title="2、前端路由"></a>2、前端路由</h3><p>前端路由即地址和组件之间的对应关系（以下已哈希模式为例）。</p><p>前端路由简易工作方式：</p><ol><li>用户点击了页面上的路由链接</li><li>URL 地址的 Hash 值发生变化</li><li>前端路由监听到 Hash 值的变化</li><li>前端路由渲染 Hash 地址对应的组件</li></ol><p>实现简易的前端路由：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-comment">&lt;!-- a 链接添加对应 Hash 值 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;#/home&quot;</span>&gt;</span>Home<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;#/movie&quot;</span>&gt;</span>Movie<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;#/about&quot;</span>&gt;</span>About<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><br><span class="hljs-comment">&lt;!-- 动态渲染组件 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">component</span> <span class="hljs-attr">:is</span>=<span class="hljs-string">&quot;compName&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">component</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;App&#x27;</span>,<br>  <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> &#123;<br>      <span class="hljs-attr">compName</span>: <span class="hljs-string">&#x27;Home&#x27;</span><br>    &#125;<br>  &#125;,<br>  <span class="hljs-title function_">created</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">// 监听 Hash 地址改变，切换组件</span><br>    <span class="hljs-variable language_">window</span>.<span class="hljs-property">onhashchange</span> = <span class="hljs-function">() =&gt;</span> &#123;<br>      <span class="hljs-keyword">switch</span>(location.<span class="hljs-property">hash</span>) &#123;<br>        <span class="hljs-attr">case</span>: <span class="hljs-string">&#x27;#/home&#x27;</span>:<br>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">compName</span> = <span class="hljs-string">&#x27;Home&#x27;</span><br>          <span class="hljs-keyword">break</span><br>        <span class="hljs-attr">case</span>: <span class="hljs-string">&#x27;#/movie&#x27;</span>:<br>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">compName</span> = <span class="hljs-string">&#x27;Movie&#x27;</span><br>          <span class="hljs-keyword">break</span><br>        <span class="hljs-attr">case</span>: <span class="hljs-string">&#x27;#/about&#x27;</span>:<br>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">compName</span> = <span class="hljs-string">&#x27;About&#x27;</span><br>          <span class="hljs-keyword">break</span><br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3、后端路由"><a href="#3、后端路由" class="headerlink" title="3、后端路由"></a>3、后端路由</h3><ul><li>后端路由是指请求方式、请求地址与 <code>function</code> 处理函数之间的对应关系</li><li>服务器收到一个请求，根据请求方式、路径匹配对应的函数处理请求，返回响应数据</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-keyword">const</span> router = express.<span class="hljs-title class_">Router</span>()<br><br>router.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/userlist&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) &#123;...&#125;)<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = router<br></code></pre></td></tr></table></figure><h3 id="4、单页面应用程序-SPA"><a href="#4、单页面应用程序-SPA" class="headerlink" title="4、单页面应用程序 SPA"></a>4、单页面应用程序 SPA</h3><p>单页面应用程序将所有的功能局限于一个 web 页面中，仅在该 web 页面初始化时加载相应的资源（ HTML、JavaScript 和 CSS）。 一旦页面加载完成了，SPA 不会因为用户的操作而进行页面的重新加载或跳转。而是利用 JavaScript 动态地变换 HTML 的内容，从而实现页面与用户的交互。</p><p>SPA 的优点：</p><ul><li>良好的交互体验<ul><li>内容的改变不需要重新加载整个页面</li><li><strong>数据通过 <code>Ajax</code> 异步获取</strong></li><li>没有页面跳转，不会出现白屏现象</li></ul></li><li>良好的前后盾工作分离模式<ul><li>后端专注于提供 API 接口，更易实现接口复用</li><li>前端专注页面渲染，更利于前端工程化发展</li></ul></li><li>减轻服务器压力<ul><li>服务器只提供数据，不负责页面的合成与逻辑处理，吞吐能力会提高</li></ul></li></ul><p>SPA 的缺点：</p><ul><li>首屏加载慢：可使用路由<strong>懒加载、代码压缩、CDN 加速、网络传输压缩</strong></li><li>不利于 SEO ：<strong>SSR 服务器端渲染</strong></li></ul><h2 id="2、基本使用"><a href="#2、基本使用" class="headerlink" title="2、基本使用"></a>2、基本使用</h2><ol><li><p>安装vue-router，命令：<code>npm i vue-router</code></p><ul><li>这个要看版本，vue3要4，vue要3，所以下载指定版本</li></ul></li><li><p>应用插件：<code>Vue.use(VueRouter)</code></p></li><li><p>创建路由模块，在 <code>src</code> 源代码目录下，新建 <code>router/index.js</code> 路由模块，初始化代码：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//引入VueRouter</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">VueRouter</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue-router&#x27;</span><br><span class="hljs-comment">//引入Luyou 组件</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">About</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../components/About&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Home</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../components/Home&#x27;</span><br><br><span class="hljs-comment">//创建router实例对象，去管理一组一组的路由规则</span><br><span class="hljs-keyword">const</span> router = <span class="hljs-keyword">new</span> <span class="hljs-title class_">VueRouter</span>(&#123;<br>   <span class="hljs-attr">routes</span>:[<br>      &#123;<br>         <span class="hljs-attr">path</span>:<span class="hljs-string">&#x27;/about&#x27;</span>,<br>         <span class="hljs-attr">component</span>:<span class="hljs-title class_">About</span><br>      &#125;,<br>      &#123;<br>         <span class="hljs-attr">path</span>:<span class="hljs-string">&#x27;/home&#x27;</span>,<br>         <span class="hljs-attr">component</span>:<span class="hljs-title class_">Home</span><br>      &#125;<br>   ]<br>&#125;)<br><br><span class="hljs-comment">//暴露router</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> router<br></code></pre></td></tr></table></figure></li><li><p>在 <code>main.js</code> 文件中导入并挂载路由模块：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Vue</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./App.vue&#x27;</span><br><span class="hljs-keyword">import</span> router <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./router/index.js&#x27;</span><br><br><span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;<br>  router,<br>  <span class="hljs-attr">render</span>: <span class="hljs-function">(<span class="hljs-params">h</span>) =&gt;</span> <span class="hljs-title function_">h</span>(<span class="hljs-title class_">App</span>),<br>&#125;).$mount(<span class="hljs-string">&#x27;#app&#x27;</span>)<br></code></pre></td></tr></table></figure></li><li><p>实现切换（active-class可配置高亮样式）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;router-link active-class=&quot;active&quot; to=&quot;/about&quot;&gt;About&lt;/router-link&gt;<br></code></pre></td></tr></table></figure></li><li><p>指定展示位置</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;router-view&gt;&lt;/router-view&gt;<br></code></pre></td></tr></table></figure></li></ol><h3 id="几个注意点"><a href="#几个注意点" class="headerlink" title="几个注意点"></a>几个注意点</h3><ol><li>路由组件通常存放在<code>pages</code>文件夹，一般组件通常存放在<code>components</code>文件夹。</li><li>通过切换，“隐藏”了的路由组件，默认是被销毁掉的，需要的时候再去挂载。</li><li>每个组件都有自己的<code>$route</code>属性，里面存储着自己的路由信息。</li><li>整个应用只有一个<code>router</code>，可以通过组件的<code>$router</code>属性获取到。</li></ol><h2 id="3-多级路由（多级路由）"><a href="#3-多级路由（多级路由）" class="headerlink" title="3.多级路由（多级路由）"></a>3.多级路由（多级路由）</h2><ol><li><p>配置路由规则，使用children配置项：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">routes</span>:[<br>   &#123;<br>      <span class="hljs-attr">path</span>:<span class="hljs-string">&#x27;/about&#x27;</span>,<br>      <span class="hljs-attr">component</span>:<span class="hljs-title class_">About</span>,<br>   &#125;,<br>   &#123;<br>      <span class="hljs-attr">path</span>:<span class="hljs-string">&#x27;/home&#x27;</span>,<br>      <span class="hljs-attr">component</span>:<span class="hljs-title class_">Home</span>,<br>      <span class="hljs-attr">children</span>:[ <span class="hljs-comment">//通过children配置子级路由</span><br>         &#123;<br>            <span class="hljs-attr">path</span>:<span class="hljs-string">&#x27;news&#x27;</span>, <span class="hljs-comment">//此处一定不要写：/news</span><br>            <span class="hljs-attr">component</span>:<span class="hljs-title class_">News</span><br>         &#125;,<br>         &#123;<br>            <span class="hljs-attr">path</span>:<span class="hljs-string">&#x27;message&#x27;</span>,<span class="hljs-comment">//此处一定不要写：/message</span><br>            <span class="hljs-attr">component</span>:<span class="hljs-title class_">Message</span><br>         &#125;<br>      ]<br>   &#125;<br>]<br></code></pre></td></tr></table></figure></li><li><p>跳转（要写完整路径）：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;router-link to=&quot;/home/news&quot;&gt;News&lt;/router-link&gt;<br></code></pre></td></tr></table></figure></li></ol><h2 id="4、路由传参"><a href="#4、路由传参" class="headerlink" title="4、路由传参"></a>4、路由传参</h2><h3 id="1、路由的query参数"><a href="#1、路由的query参数" class="headerlink" title="1、路由的query参数"></a>1、路由的query参数</h3><h4 id="1、传递参数"><a href="#1、传递参数" class="headerlink" title="1、传递参数"></a>1、传递参数</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;!-- 跳转并携带query参数，to的字符串写法 --&gt;<br>&lt;router-link :to=&quot;/home/message/detail?id=666&amp;title=你好&quot;&gt;跳转&lt;/router-link&gt;<br>            <br>&lt;!-- 跳转并携带query参数，to的对象写法 --&gt;<br>&lt;router-link <br>   :to=&quot;&#123;<br>      path:&#x27;/home/message/detail&#x27;,<br>      query:&#123;<br>         id:666,<br>            title:&#x27;你好&#x27;<br>      &#125;<br>   &#125;&quot;<br>&gt;跳转&lt;/router-link&gt;<br></code></pre></td></tr></table></figure><h4 id="2、接收参数"><a href="#2、接收参数" class="headerlink" title="2、接收参数"></a>2、接收参数</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js">$route.<span class="hljs-property">query</span>.<span class="hljs-property">id</span><br>$route.<span class="hljs-property">query</span>.<span class="hljs-property">title</span><br></code></pre></td></tr></table></figure><h3 id="2、命名路由"><a href="#2、命名路由" class="headerlink" title="2、命名路由"></a>2、命名路由</h3><h4 id="1、作用："><a href="#1、作用：" class="headerlink" title="1、作用："></a>1、作用：</h4><ul><li>可以简化路由的跳转。</li></ul><h4 id="2、如何使用"><a href="#2、如何使用" class="headerlink" title="2、如何使用"></a>2、如何使用</h4><h5 id="1、给路由命名"><a href="#1、给路由命名" class="headerlink" title="1、给路由命名"></a>1、给路由命名</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js">&#123;<br>   <span class="hljs-attr">path</span>:<span class="hljs-string">&#x27;/demo&#x27;</span>,<br>   <span class="hljs-attr">component</span>:<span class="hljs-title class_">Demo</span>,<br>   <span class="hljs-attr">children</span>:[<br>      &#123;<br>         <span class="hljs-attr">path</span>:<span class="hljs-string">&#x27;test&#x27;</span>,<br>         <span class="hljs-attr">component</span>:<span class="hljs-title class_">Test</span>,<br>         <span class="hljs-attr">children</span>:[<br>            &#123;<br>               <span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;hello&#x27;</span> <span class="hljs-comment">//给路由命名</span><br>               <span class="hljs-attr">path</span>:<span class="hljs-string">&#x27;welcome&#x27;</span>,<br>               <span class="hljs-attr">component</span>:<span class="hljs-title class_">Hello</span>,<br>            &#125;<br>         ]<br>      &#125;<br>   ]<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="2、简化跳转"><a href="#2、简化跳转" class="headerlink" title="2、简化跳转"></a>2、简化跳转</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;!--简化前，需要写完整的路径 --&gt;<br>&lt;router-link to=&quot;/demo/test/welcome&quot;&gt;跳转&lt;/router-link&gt;<br><br>&lt;!--简化后，直接通过名字跳转 --&gt;<br>&lt;router-link :to=&quot;&#123;name:&#x27;hello&#x27;&#125;&quot;&gt;跳转&lt;/router-link&gt;<br><br>&lt;!--简化写法配合传递参数 --&gt;<br>&lt;router-link <br>   :to=&quot;&#123;<br>      name:&#x27;hello&#x27;,<br>      query:&#123;<br>         id:666,<br>            title:&#x27;你好&#x27;<br>      &#125;<br>   &#125;&quot;<br>&gt;跳转&lt;/router-link&gt;<br></code></pre></td></tr></table></figure><h3 id="3、路由的params参数"><a href="#3、路由的params参数" class="headerlink" title="3、路由的params参数"></a>3、路由的params参数</h3><h4 id="1、配置路由，声明接收params参数"><a href="#1、配置路由，声明接收params参数" class="headerlink" title="1、配置路由，声明接收params参数"></a>1、配置路由，声明接收params参数</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js">&#123;<br>   <span class="hljs-attr">path</span>:<span class="hljs-string">&#x27;/home&#x27;</span>,<br>   <span class="hljs-attr">component</span>:<span class="hljs-title class_">Home</span>,<br>   <span class="hljs-attr">children</span>:[<br>      &#123;<br>         <span class="hljs-attr">path</span>:<span class="hljs-string">&#x27;news&#x27;</span>,<br>         <span class="hljs-attr">component</span>:<span class="hljs-title class_">News</span><br>      &#125;,<br>      &#123;<br>         <span class="hljs-attr">component</span>:<span class="hljs-title class_">Message</span>,<br>         <span class="hljs-attr">children</span>:[<br>            &#123;<br>               <span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;xiangqing&#x27;</span>,<br>               <span class="hljs-attr">path</span>:<span class="hljs-string">&#x27;detail/:id/:title&#x27;</span>, <span class="hljs-comment">//使用占位符声明接收params参数</span><br>               <span class="hljs-attr">component</span>:<span class="hljs-title class_">Detail</span><br>            &#125;<br>         ]<br>      &#125;<br>   ]<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="2、传递参数"><a href="#2、传递参数" class="headerlink" title="2、传递参数"></a>2、传递参数</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;!-- 跳转并携带params参数，to的字符串写法 --&gt;<br>&lt;router-link :to=&quot;/home/message/detail/666/你好&quot;&gt;跳转&lt;/router-link&gt;<br>            <br>&lt;!-- 跳转并携带params参数，to的对象写法 --&gt;<br>&lt;router-link <br>   :to=&quot;&#123;<br>      name:&#x27;xiangqing&#x27;,<br>      params:&#123;<br>         id:666,<br>         title:&#x27;你好&#x27;<br>      &#125;<br>   &#125;&quot;<br>&gt;跳转&lt;/router-link&gt;<br></code></pre></td></tr></table></figure><blockquote><p>特别注意：路由携带params参数时，若使用to的对象写法，则不能使用path配置项，必须<strong>使用name配置</strong>！</p></blockquote><h4 id="3、接收参数"><a href="#3、接收参数" class="headerlink" title="3、接收参数"></a>3、接收参数</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js">$route.<span class="hljs-property">params</span>.<span class="hljs-property">id</span><br>$route.<span class="hljs-property">params</span>.<span class="hljs-property">title</span><br></code></pre></td></tr></table></figure><h3 id="4、路由的props配置"><a href="#4、路由的props配置" class="headerlink" title="4、路由的props配置"></a>4、路由的props配置</h3><p>  作用：让路由组件更方便的收到参数</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs js">&#123;<br>   <span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;xiangqing&#x27;</span>,<br>   <span class="hljs-attr">path</span>:<span class="hljs-string">&#x27;detail/:id&#x27;</span>,<br>   <span class="hljs-attr">component</span>:<span class="hljs-title class_">Detail</span>,<br><br>   <span class="hljs-comment">//第一种写法：props值为对象，该对象中所有的key-value的组合最终都会通过props传给Detail组件</span><br>   <span class="hljs-comment">// props:&#123;a:900&#125;</span><br><br>   <span class="hljs-comment">//第二种写法：props值为布尔值，布尔值为true，则把路由收到的所有params参数通过props传给Detail组件</span><br>   <span class="hljs-comment">// props:true</span><br>   <br>   <span class="hljs-comment">//第三种写法：props值为函数，该函数返回的对象中每一组key-value都会通过props传给Detail组件</span><br>   <span class="hljs-title function_">props</span>(<span class="hljs-params">route</span>)&#123;<br>      <span class="hljs-keyword">return</span> &#123;<br>         <span class="hljs-attr">id</span>:route.<span class="hljs-property">query</span>.<span class="hljs-property">id</span>,<br>         <span class="hljs-attr">title</span>:route.<span class="hljs-property">query</span>.<span class="hljs-property">title</span><br>      &#125;<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="5、-lt-router-link-gt-的replace属性"><a href="#5、-lt-router-link-gt-的replace属性" class="headerlink" title="5、&lt;router-link&gt;的replace属性"></a>5、<code>&lt;router-link&gt;</code>的replace属性</h3><ol><li>作用：控制路由跳转时操作浏览器历史记录的模式</li><li>浏览器的历史记录有两种写入方式：分别为<code>push</code>和<code>replace</code>，<code>push</code>是追加历史记录，<code>replace</code>是替换当前记录。路由跳转时候默认为<code>push</code></li><li>如何开启<code>replace</code>模式：<code>&lt;router-link replace .......&gt;News&lt;/router-link&gt;</code></li></ol><h2 id="5、编程式路由导航"><a href="#5、编程式路由导航" class="headerlink" title="5、编程式路由导航"></a>5、编程式路由导航</h2><p>声明式导航：</p><ul><li>通过点击链接实现导航</li><li>如普通网页点击 <code>a</code> 链接，<code>vue</code> 点击 <code>&lt;router-link&gt;</code></li></ul><p>编程式导航：</p><ul><li>通过调用 API 实现导航</li><li>普通网页通过 <code>location.href</code> 的方式跳转页面也是编程式导航</li></ul><p><code>vue-router</code> 中实现编程式导航的 API ：</p><ul><li><code>this.$router.push(&#39;hash地址&#39;)</code> ：跳转到指定页面，并增加一条历史记录</li><li><code>this.$router.replace(&#39;hash地址&#39;)</code> ：跳转页面，但不会新增历史记录，而是替换当前的历史记录</li><li><code>this.$router.go(数值)</code> ：历史记录前进或后退，相当于点击浏览器前进后退箭头</li><li><code>this.$router.forward()</code> ：前进一步</li><li><code>this.$router.back()</code> ：后退一步</li></ul><h3 id="1、作用-2"><a href="#1、作用-2" class="headerlink" title="1、作用"></a>1、作用</h3><ul><li>不借助<code>&lt;router-link&gt; </code>实现路由跳转，让路由跳转更加灵活</li></ul><h3 id="2、具体编码"><a href="#2、具体编码" class="headerlink" title="2、具体编码"></a>2、具体编码</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//$router的两个API</span><br><span class="hljs-variable language_">this</span>.<span class="hljs-property">$router</span>.<span class="hljs-title function_">push</span>(&#123;<br>   <span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;xiangqing&#x27;</span>,<br>      <span class="hljs-attr">params</span>:&#123;<br>         <span class="hljs-attr">id</span>:xxx,<br>         <span class="hljs-attr">title</span>:xxx<br>      &#125;<br>&#125;)<br><br><span class="hljs-variable language_">this</span>.<span class="hljs-property">$router</span>.<span class="hljs-title function_">replace</span>(&#123;<br>   <span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;xiangqing&#x27;</span>,<br>      <span class="hljs-attr">params</span>:&#123;<br>         <span class="hljs-attr">id</span>:xxx,<br>         <span class="hljs-attr">title</span>:xxx<br>      &#125;<br>&#125;)<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">$router</span>.<span class="hljs-title function_">forward</span>() <span class="hljs-comment">//前进</span><br><span class="hljs-variable language_">this</span>.<span class="hljs-property">$router</span>.<span class="hljs-title function_">back</span>() <span class="hljs-comment">//后退</span><br><span class="hljs-variable language_">this</span>.<span class="hljs-property">$router</span>.<span class="hljs-title function_">go</span>() <span class="hljs-comment">//可前进也可后退</span><br></code></pre></td></tr></table></figure><h2 id="6、缓存路由组件"><a href="#6、缓存路由组件" class="headerlink" title="6、缓存路由组件"></a>6、缓存路由组件</h2><ol><li><p>作用：让不展示的路由组件保持挂载，不被销毁。</p></li><li><p>具体编码： <code>include</code>   是组件名</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;keep-alive include=&quot;News&quot;&gt; <br>    &lt;router-view&gt;&lt;/router-view&gt;<br>&lt;/keep-alive&gt;<br></code></pre></td></tr></table></figure></li></ol><h2 id="7、两个新的生命周期钩子"><a href="#7、两个新的生命周期钩子" class="headerlink" title="7、两个新的生命周期钩子"></a>7、两个新的生命周期钩子</h2><ol><li>作用：路由组件所独有的两个钩子，用于捕获路由组件的激活状态。</li><li>具体名字：<ol><li><code>activated</code>路由组件被激活时触发。</li><li><code>deactivated</code>路由组件失活时触发。</li></ol></li></ol><h2 id="8、路由元信息-meta"><a href="#8、路由元信息-meta" class="headerlink" title="8、路由元信息 meta"></a>8、路由元信息 meta</h2><p>在 <code>meta</code> 中可以为路由添加自定义信息：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> routes = [<br>  &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;about&#x27;</span>,<br>    <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/about&#x27;</span>,<br>    <span class="hljs-attr">component</span>: <span class="hljs-title class_">About</span>,<br>    <span class="hljs-attr">meta</span>: &#123; <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;hello&#x27;</span>, <span class="hljs-attr">isAuth</span>: <span class="hljs-literal">true</span> &#125;,<br>  &#125;,<br>]<br></code></pre></td></tr></table></figure><h2 id="9、路由守卫"><a href="#9、路由守卫" class="headerlink" title="9、路由守卫"></a>9、路由守卫</h2><h3 id="1、作用-3"><a href="#1、作用-3" class="headerlink" title="1、作用"></a>1、作用</h3><ul><li>对路由进行权限控制</li></ul><h3 id="2、分类："><a href="#2、分类：" class="headerlink" title="2、分类："></a>2、分类：</h3><p><strong>全局守卫、独享守卫、组件内守卫</strong></p><h3 id="3、全局守卫"><a href="#3、全局守卫" class="headerlink" title="3、全局守卫"></a>3、全局守卫</h3><ul><li>全局前置守卫：<code>beforeEach()</code></li><li>全局后置守卫：<code>afterEach()</code></li></ul><p>守卫回调函数 3 个形参：</p><ul><li><code>to</code> ：将要访问的路由的信息对象，即 <code>$route</code></li><li><code>from</code> ：将要离开的路由的信息对象</li><li><code>next</code> ：放行函数（后置守卫没有）</li></ul><p><code>next</code> 函数 3 种调用方式：</p><ul><li>直接放行：<code>next()</code></li><li>强制跳转到其他路由：<code>next(/login)</code></li><li>阻止本次跳转：<code>next(false)</code></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//全局前置守卫：初始化时执行、每次路由切换前执行</span><br>router.<span class="hljs-title function_">beforeEach</span>(<span class="hljs-function">(<span class="hljs-params">to,<span class="hljs-keyword">from</span>,next</span>)=&gt;</span>&#123;<br>   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;beforeEach&#x27;</span>,to,<span class="hljs-keyword">from</span>)<br>   <span class="hljs-keyword">if</span>(to.<span class="hljs-property">meta</span>.<span class="hljs-property">isAuth</span>)&#123; <span class="hljs-comment">//判断当前路由是否需要进行权限控制</span><br>      <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">&#x27;school&#x27;</span>) === <span class="hljs-string">&#x27;atguigu&#x27;</span>)&#123; <span class="hljs-comment">//权限控制的具体规则</span><br>         <span class="hljs-title function_">next</span>() <span class="hljs-comment">//放行</span><br>      &#125;<span class="hljs-keyword">else</span>&#123;<br>         <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;暂无权限查看&#x27;</span>)<br>         <span class="hljs-comment">// next(&#123;name:&#x27;guanyu&#x27;&#125;)</span><br>      &#125;<br>   &#125;<span class="hljs-keyword">else</span>&#123;<br>      <span class="hljs-title function_">next</span>() <span class="hljs-comment">//放行</span><br>   &#125;<br>&#125;)<br><br><span class="hljs-comment">//全局后置守卫：初始化时执行、每次路由切换后执行</span><br>router.<span class="hljs-title function_">afterEach</span>(<span class="hljs-function">(<span class="hljs-params">to,<span class="hljs-keyword">from</span></span>)=&gt;</span>&#123;<br>   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;afterEach&#x27;</span>,to,<span class="hljs-keyword">from</span>)<br>   <span class="hljs-keyword">if</span>(to.<span class="hljs-property">meta</span>.<span class="hljs-property">title</span>)&#123; <br>      <span class="hljs-variable language_">document</span>.<span class="hljs-property">title</span> = to.<span class="hljs-property">meta</span>.<span class="hljs-property">title</span> <span class="hljs-comment">//修改网页的title</span><br>   &#125;<span class="hljs-keyword">else</span>&#123;<br>      <span class="hljs-variable language_">document</span>.<span class="hljs-property">title</span> = <span class="hljs-string">&#x27;vue_test&#x27;</span><br>   &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="4、独享守卫"><a href="#4、独享守卫" class="headerlink" title="4、独享守卫"></a>4、独享守卫</h3><ul><li>某一条路由规则独享的守卫</li><li>独享守卫只一个，没有后置守卫</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js">&#123;<br>    <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;about&#x27;</span>,<br>    <span class="hljs-attr">component</span>: <span class="hljs-title class_">About</span>,<br>    <span class="hljs-title function_">beforeEnter</span>(<span class="hljs-params">to,<span class="hljs-keyword">from</span>,next</span>)&#123;<br>       <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;beforeEnter&#x27;</span>,to,<span class="hljs-keyword">from</span>)<br>       <span class="hljs-keyword">if</span>(to.<span class="hljs-property">meta</span>.<span class="hljs-property">isAuth</span>)&#123; <span class="hljs-comment">//判断当前路由是否需要进行权限控制</span><br>          <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">&#x27;school&#x27;</span>) === <span class="hljs-string">&#x27;atguigu&#x27;</span>)&#123;<br>             <span class="hljs-title function_">next</span>()<br>          &#125;<span class="hljs-keyword">else</span>&#123;<br>             <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;暂无权限查看&#x27;</span>)<br>             <span class="hljs-comment">// next(&#123;name:&#x27;guanyu&#x27;&#125;)</span><br>          &#125;<br>       &#125;<span class="hljs-keyword">else</span>&#123;<br>          <span class="hljs-title function_">next</span>()<br>       &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="5、组件内守卫："><a href="#5、组件内守卫：" class="headerlink" title="5、组件内守卫："></a>5、组件内守卫：</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//进入守卫：通过路由规则，进入该组件时被调用</span><br>beforeRouteEnter (to, <span class="hljs-keyword">from</span>, next) &#123;<br>&#125;,<br><span class="hljs-comment">//离开守卫：通过路由规则，离开该组件时被调用</span><br>beforeRouteLeave (to, <span class="hljs-keyword">from</span>, next) &#123;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="6、各个守卫执行顺序"><a href="#6、各个守卫执行顺序" class="headerlink" title="6、各个守卫执行顺序"></a>6、各个守卫执行顺序</h3><p>从 <code>About</code> 组件通过路由规则进入 <code>Home</code> 组件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">About-beforeRouteLeave<br>beforeEach<br>Home-beforeEnter<br>Home-beforeRouteEnter<br>afterEach<br>Home组件生命周期开始<br></code></pre></td></tr></table></figure><h3 id="7、路由器的两种工作模式"><a href="#7、路由器的两种工作模式" class="headerlink" title="7、路由器的两种工作模式"></a>7、路由器的两种工作模式</h3><ol><li>对于一个url来说，什么是hash值？—— #及其后面的内容就是hash值。</li><li>hash值不会包含在 HTTP 请求中，即：hash值不会带给服务器。</li><li><strong>hash模式</strong>：<ol><li>地址中永远带着#号，不美观 。</li><li>若以后将地址通过第三方手机app分享，若app校验严格，则地址会被标记为不合法。</li><li>兼容性较好。</li></ol></li><li><strong>history模式</strong>：<ol><li>地址干净，美观 。</li><li>兼容性和hash模式相比略差。</li><li>应用部署上线时需要后端人员支持，解决刷新页面服务端404的问题。</li></ol></li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs vue">const router = new VueRouter &#123;<br>mode:&#x27;history&#x27;,<br>rote:[<br>...<br>]<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="10、vue-router-4-x"><a href="#10、vue-router-4-x" class="headerlink" title="10、vue-router 4.x"></a>10、vue-router 4.x</h2><p>目前 <code>vue-router</code> 有 <code>3.x</code> 和 <code>4.x</code> 两个版本，前者只能在 <code>vue2.x</code> 中使用，后者只能在 <code>vue3.x</code> 中使用。</p><p>下面是 <code>vue-router 4.x</code> 初体验：</p><p>安装 <code>vue-router 4.x</code> ：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">npm install vue-router@next -S<br></code></pre></td></tr></table></figure><p>创建路由模块：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 从 vue-router 按需导入两个方法</span><br><span class="hljs-comment">// createRouter：创建路由实例对象</span><br><span class="hljs-comment">// createWebHashHistory：指定路由工作模式为 hash 模式</span><br><span class="hljs-keyword">import</span> &#123; createRouter, createWebHashHistory &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue-router&#x27;</span><br><br><span class="hljs-keyword">const</span> router = <span class="hljs-title function_">createRouter</span>(&#123;<br>  <span class="hljs-attr">history</span>: <span class="hljs-title function_">createWebHashHistory</span>(),<br>  <span class="hljs-attr">routes</span>: [&#123; <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/home&#x27;</span>, <span class="hljs-attr">component</span>: <span class="hljs-title class_">Home</span> &#125;],<br>&#125;)<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> router<br></code></pre></td></tr></table></figure><p><code>main.js</code> 导入并挂载路由模块：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; createApp &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./App.vue&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;./index.css&#x27;</span><br><br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>)<br><br>app.<span class="hljs-title function_">use</span>(router)<br>app.<span class="hljs-title function_">mount</span>(<span class="hljs-string">&#x27;#app&#x27;</span>)<br></code></pre></td></tr></table></figure><h1 id="Vue-UI组件库"><a href="#Vue-UI组件库" class="headerlink" title="Vue UI组件库"></a>Vue UI组件库</h1><h3 id="移动端常用-UI-组件库"><a href="#移动端常用-UI-组件库" class="headerlink" title="移动端常用 UI 组件库"></a>移动端常用 UI 组件库</h3><p>1、Vant <a href="https://youzan.github.io/vant">https://youzan.github.io/vant</a> </p><p>2、Cube UI <a href="https://didi.github.io/cube-ui">https://didi.github.io/cube-ui</a> </p><p>3、Mint UI <a href="http://mint-ui.github.io/">http://mint-ui.github.io</a><br>rr</p><h3 id="PC-端常用-UI-组"><a href="#PC-端常用-UI-组" class="headerlink" title="PC 端常用 UI 组"></a>PC 端常用 UI 组</h3><p>1、Element UI <a href="https://element.eleme.cn/">https://element.eleme.cn</a> </p><p>2、IView UI <a href="https://www.iviewui.co/">https://www.iviewui.co</a></p>]]></content>
    
    
    <categories>
      
      <category>笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>webpack5</title>
    <link href="/2023/03/22/%E7%AC%94%E8%AE%B0/webpack5/"/>
    <url>/2023/03/22/%E7%AC%94%E8%AE%B0/webpack5/</url>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://www.bilibili.com/video/BV14T4y1z7sw/">尚硅谷Webpack5学习视频</a></p></blockquote><h1 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h1><h2 id="基本配置"><a href="#基本配置" class="headerlink" title="基本配置"></a>基本配置</h2><p>webpack 五个核心概念</p><ul><li>Entry</li></ul><p>入口(Entry)指示 webpack 以哪个文件为入口起点开始打包，分析构建内部依赖图</p><ul><li>Output</li></ul><p>输出(Output)指示 webpack 打包后的资源 bundles 输出到哪里去，以及如何命名</p><ul><li>Loader</li></ul><p>Loader 让 webpack 能 够 去 处 理 那 些 非 JavaScript 文 件 (webpack 自 身 只 理 解 JavaScript)</p><ul><li>Plugins</li></ul><p>插件(Plugins)可以用于执行范围更广的任务。插件的范围包括，从打包优化和压缩， 一直到重新定义环境中的变量等</p><ul><li>Mode</li></ul><p><strong>development</strong></p><ul><li>会将 DefinePlugin 中 process.env.NODE_ENV 的值设置 为 development。启用 NamedChunksPlugin 和 NamedModulesPlugin</li><li>特点：能让代码本地调试 运行的环境</li></ul><p></p><p><strong>production</strong></p><ul><li>会将 DefinePlugin 中 process.env.NODE_ENV 的值设置 为 production。启用FlagDependencyUsagePlugin, FlagIncludedChunksPlugin,ModuleConcatenationPlugin, NoEmitOnErrorsPlugin, OccurrenceOrderPlugin, SideEffectsFlagPlugin 和 TerserPlugin</li><li>能让代码优化上线 运行的环境</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;path&quot;</span>);   <span class="hljs-comment">// nodejs核心模块，专门用来处理路径问题</span><br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-comment">// 入口</span><br>    <span class="hljs-attr">entry</span>:<span class="hljs-string">&quot;./src/main.js&quot;</span>,  <span class="hljs-comment">// 相对路径</span><br>    <span class="hljs-comment">// 输出</span><br>    <span class="hljs-attr">output</span>: &#123;<br>        <span class="hljs-comment">// 文件的输出路径</span><br>        <span class="hljs-comment">// __dirname nodejs的变量，代表当前文件的文件夹目录</span><br>        <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname,<span class="hljs-string">&quot;dist&quot;</span>),  <span class="hljs-comment">// 绝对路径</span><br>        <span class="hljs-comment">// 文件名</span><br>        <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;main.js&quot;</span>,<br>    &#125;,<br>    <span class="hljs-comment">// 加载器</span><br>    <span class="hljs-attr">module</span>: &#123;<br>        <span class="hljs-attr">rules</span>: [<br>            <span class="hljs-comment">// loader的配置</span><br>        ],<br>    &#125;,<br>    <span class="hljs-comment">// 插件</span><br>    <span class="hljs-attr">plugins</span>: [<br>        <span class="hljs-comment">// plugin的配置</span><br>    ],<br>    <span class="hljs-comment">// 模式</span><br>    <span class="hljs-attr">mode</span>: <span class="hljs-string">&quot;development&quot;</span>,<br>&#125;;<br></code></pre></td></tr></table></figure><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">npm install webpack webpack-cli -D<br></code></pre></td></tr></table></figure><p>编译</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">npx webpack<br></code></pre></td></tr></table></figure><h2 id="开发模式"><a href="#开发模式" class="headerlink" title="开发模式"></a>开发模式</h2><ul><li>就是写代码</li></ul><h2 id="处理样式资源"><a href="#处理样式资源" class="headerlink" title="处理样式资源"></a>处理样式资源</h2><h3 id="处理css资源"><a href="#处理css资源" class="headerlink" title="处理css资源"></a>处理css资源</h3><p>安装<code>css-loader</code>和<code>style-loader</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">npm install --save-dev css-loader style-loader<br></code></pre></td></tr></table></figure><p>使用</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> css <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;file.css&quot;</span>;<br></code></pre></td></tr></table></figure><p><strong>webpack.config.js</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">module</span>: &#123;<br>    <span class="hljs-attr">rules</span>: [<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.css$/i</span>,<br>        <span class="hljs-attr">use</span>: [<br>            <span class="hljs-string">&quot;style-loader&quot;</span>, <br>            <span class="hljs-string">&quot;css-loader&quot;</span><br>        ],<br>      &#125;,<br>    ],<br>  &#125;,<br>&#125;;<br></code></pre></td></tr></table></figure><h3 id="处理less资源"><a href="#处理less资源" class="headerlink" title="处理less资源"></a>处理less资源</h3><p>安装<code>less</code>和<code>less-loader</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">npm install less less-loader --save-dev<br></code></pre></td></tr></table></figure><p><strong>webpack.config.js</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">module</span>: &#123;<br>    <span class="hljs-attr">rules</span>: [<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.less$/i</span>,<br>        <span class="hljs-attr">use</span>: [<br>          <span class="hljs-string">&#x27;style-loader&#x27;</span>,<br>          <span class="hljs-string">&#x27;css-loader&#x27;</span>,<br>          <span class="hljs-string">&#x27;less-loader&#x27;</span>,<br>        ],<br>      &#125;,<br>    ],<br>  &#125;,<br>&#125;;<br></code></pre></td></tr></table></figure><h3 id="处理sass资源"><a href="#处理sass资源" class="headerlink" title="处理sass资源"></a>处理sass资源</h3><p>安装<code>sass</code>和<code>sass-loader</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">npm install sass-loader sass webpack --save-dev<br></code></pre></td></tr></table></figure><p><strong>webpack.config.js</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">module</span>: &#123;<br>    <span class="hljs-attr">rules</span>: [<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.s[ac]ss$/i</span>,<br>        <span class="hljs-attr">use</span>: [<br>          <span class="hljs-comment">// 将 JS 字符串生成为 style 节点</span><br>          <span class="hljs-string">&#x27;style-loader&#x27;</span>,<br>          <span class="hljs-comment">// 将 CSS 转化成 CommonJS 模块</span><br>          <span class="hljs-string">&#x27;css-loader&#x27;</span>,<br>          <span class="hljs-comment">// 将 Sass 编译成 CSS</span><br>          <span class="hljs-string">&#x27;sass-loader&#x27;</span>,<br>        ],<br>      &#125;,<br>    ],<br>  &#125;,<br>&#125;;<br></code></pre></td></tr></table></figure><h2 id="处理图片资源"><a href="#处理图片资源" class="headerlink" title="处理图片资源"></a>处理图片资源</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">module</span>: &#123;<br>    <span class="hljs-attr">rules</span>: [<br>      &#123;<br><span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(png|jpe?g|gif|webp|svg)$/</span>,<br><span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;asset&#x27;</span>,<br><span class="hljs-attr">parser</span>: &#123;<br><span class="hljs-attr">dataUrlCondition</span>: &#123;<br>                <span class="hljs-comment">// 小于10kb的图片转base64</span><br>                <span class="hljs-comment">// 优点：减少请求数量   缺点：体积会更大</span><br><span class="hljs-attr">maxSize</span>: <span class="hljs-number">10</span> * <span class="hljs-number">1024</span> <span class="hljs-comment">// 10</span><br>&#125;<br>&#125;<br>  &#125;，<br>      <span class="hljs-attr">generator</span>: &#123;<br>    <span class="hljs-comment">// 输出图片名称</span><br>        <span class="hljs-comment">// [hash10] hash值取10位</span><br>      <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;static/images/[hash:10][ext][query]&quot;</span>,<br>      &#125;  <br>    ],<br>  &#125;,<br>&#125;;<br></code></pre></td></tr></table></figure><h2 id="处理字体图标资源"><a href="#处理字体图标资源" class="headerlink" title="处理字体图标资源"></a>处理字体图标资源</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">module</span>: &#123;<br>    <span class="hljs-attr">rules</span>: [<br> &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(ttf|woff2?)$/</span>,<br>            <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;asset/resource&#x27;</span>,<br>            <span class="hljs-attr">generator</span>: &#123;<br>                <span class="hljs-comment">// 输出名称</span><br>                <span class="hljs-comment">// [hash10] hash值取10位</span><br>                <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;static/media/[hash:10][ext][query]&quot;</span>,<br>            &#125;<br>        &#125;,<br>    ],<br>  &#125;,<br>&#125;;<br></code></pre></td></tr></table></figure><h2 id="处理其他资源"><a href="#处理其他资源" class="headerlink" title="处理其他资源"></a>处理其他资源</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">module</span>: &#123;<br>    <span class="hljs-attr">rules</span>: [<br> &#123;<br>            <span class="hljs-comment">// 在这里直接加就行</span><br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(ttf|woff2?|mp3|mp4)$/</span>,<br>            <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;asset/resource&#x27;</span>,<br>            <span class="hljs-attr">generator</span>: &#123;<br>                <span class="hljs-comment">// 输出名称</span><br>                <span class="hljs-comment">// [hash10] hash值取10位</span><br>                <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;static/media/[hash:10][ext][query]&quot;</span>,<br>            &#125;<br>        &#125;,<br>    ],<br>  &#125;,<br>&#125;;<br></code></pre></td></tr></table></figure><h2 id="处理js资源"><a href="#处理js资源" class="headerlink" title="处理js资源"></a>处理js资源</h2><ul><li>eslint——代码格式，语法</li><li>Babel——兼容性</li></ul><h3 id="eslint"><a href="#eslint" class="headerlink" title="eslint"></a>eslint</h3><h4 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h4><p><code>.eslintrc.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-comment">// 继承 Eslint规则</span><br>    <span class="hljs-attr">extends</span>: [<span class="hljs-string">&quot;eslint:recommended&quot;</span>],<br>    <span class="hljs-attr">env</span>: &#123;<br>        <span class="hljs-attr">node</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 启用node中全局变量</span><br>        <span class="hljs-attr">browser</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 启用浏览器中全局变量</span><br>    &#125;,<br>    <span class="hljs-attr">parserOptions</span>: &#123;<br>        <span class="hljs-attr">ecmaVersion</span>: <span class="hljs-number">6</span>, <span class="hljs-comment">//es6</span><br>        <span class="hljs-attr">sourceType</span>: <span class="hljs-string">&quot;module&quot;</span>,   <span class="hljs-comment">//es module</span><br>    &#125;,<br>    <span class="hljs-attr">rules</span>: &#123;<br>        <span class="hljs-string">&quot;no-var&quot;</span>: <span class="hljs-number">2</span>, <span class="hljs-comment">// 不能使用var定义变量</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><code>.eslintignore</code></p><ul><li>忽略打包文件</li></ul><p>去官网看</p><h4 id="使用"><a href="#使用" class="headerlink" title="使用"></a><strong>使用</strong></h4><p>安装</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">npm install eslint-webpack-plugin eslint  --save-dev<br></code></pre></td></tr></table></figure><p><strong>webpack.config.js</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">ESLintPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;eslint-webpack-plugin&#x27;</span>);<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-comment">// ...</span><br>  <span class="hljs-attr">plugins</span>: [<span class="hljs-keyword">new</span> <span class="hljs-title class_">ESLintPlugin</span>(options)],<br>  <span class="hljs-comment">// ...</span><br>&#125;;<br></code></pre></td></tr></table></figure><h3 id="Babel"><a href="#Babel" class="headerlink" title="Babel"></a>Babel</h3><p>安装</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">npm install -D babel-loader @babel/core @babel/preset-env<br></code></pre></td></tr></table></figure><p><strong>webpack.config.js</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-attr">module</span>: &#123;<br>  <span class="hljs-attr">rules</span>: [<br>    &#123;<br>      <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.m?js$/</span>,<br>      <span class="hljs-attr">exclude</span>: <span class="hljs-regexp">/(node_modules|bower_components)/</span>,<br>      <span class="hljs-attr">use</span>: &#123;<br>        <span class="hljs-attr">loader</span>: <span class="hljs-string">&#x27;babel-loader&#x27;</span>,<br>        <span class="hljs-attr">options</span>: &#123;<br>          <span class="hljs-attr">presets</span>: [<span class="hljs-string">&#x27;@babel/preset-env&#x27;</span>]<br>        &#125;<br>      &#125;<br>    &#125;<br>  ]<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="处理HTMl资源"><a href="#处理HTMl资源" class="headerlink" title="处理HTMl资源"></a>处理HTMl资源</h2><p>安装</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">npm install --save-dev html-webpack-plugin<br></code></pre></td></tr></table></figure><p>使用</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js">ndle。 只需添加该插件到你的 webpack 配置中，如下所示：<br><br><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;html-webpack-plugin&#x27;</span>);<br><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>);<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">entry</span>: <span class="hljs-string">&#x27;index.js&#x27;</span>,<br>  <span class="hljs-attr">output</span>: &#123;<br>    <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&#x27;./dist&#x27;</span>),<br>    <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;index_bundle.js&#x27;</span>,<br>  &#125;,<br>  <span class="hljs-attr">plugins</span>: [<span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>()],<br>&#125;;<br></code></pre></td></tr></table></figure><h2 id="开发服务器-amp-自动化"><a href="#开发服务器-amp-自动化" class="headerlink" title="开发服务器&amp;自动化"></a>开发服务器&amp;自动化</h2><p> 自动化编译</p><p><strong>安装</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">npm i webpack-dev-server -D<br></code></pre></td></tr></table></figure><p><strong>配置</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">entry</span>: <span class="hljs-string">&#x27;index.js&#x27;</span>,<br>  <span class="hljs-comment">// 开发服务器</span><br>  <span class="hljs-attr">devServer</span>: &#123;<br>  <span class="hljs-attr">hsot</span>:<span class="hljs-string">&quot;localhost&quot;</span>,   <span class="hljs-comment">// 启动服务器域名</span><br>  <span class="hljs-attr">port</span>:<span class="hljs-string">&quot;3000&quot;</span>,    <span class="hljs-comment">// 启动服务器端口号</span><br>  <span class="hljs-attr">open</span>:<span class="hljs-literal">true</span>,  <span class="hljs-comment">// 是否自动打开浏览器</span><br>  &#125;,<br>&#125;;<br></code></pre></td></tr></table></figure><p><strong>使用</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">npx webpack server<br></code></pre></td></tr></table></figure><h2 id="生产模式"><a href="#生产模式" class="headerlink" title="生产模式"></a>生产模式</h2><ul><li>主要对代码进行优化</li></ul><h3 id="区分开发模式和生产模式"><a href="#区分开发模式和生产模式" class="headerlink" title="区分开发模式和生产模式"></a>区分开发模式和生产模式</h3><p>创建<code>config</code>文件夹，用来存放不同模式的配置文件</p><ul><li><code>webpack.dev.js</code>开发模式的配置文件</li><li><code>webpack.prod.js</code>生产模式的配置文件</li></ul><p><strong>使用</strong></p><ul><li>开发模式</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">npx webpack server --config ./config/webpack.dev.js<br></code></pre></td></tr></table></figure><ul><li>生产模式</li></ul><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arduino">npx webpack --config ./config/webpack.prod.js<br></code></pre></td></tr></table></figure><p>在<code>package.json</code>配置快捷</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;scripts&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;start&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;npm run dev&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;test&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;dev&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;webpack server --config ./config/webpack.dev.js&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;build&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;webpack --config ./config/webpack.prod.js&quot;</span><br>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>后面直接 <code>npm start</code> 就是开发环境的了</p><p><code>npm run build</code> 就是生产环境的了</p><h2 id="Css处理"><a href="#Css处理" class="headerlink" title="Css处理"></a>Css处理</h2><h3 id="提取Css成单独文件"><a href="#提取Css成单独文件" class="headerlink" title="提取Css成单独文件"></a>提取Css成单独文件</h3><p>Css文件目前被打包到js文件中，当js文件加载时，会创建一个style标签来生成样式</p><p>这样对于网站来说，会出现闪屏现象</p><ul><li>应该时单独的Css文件，通过link标签加载性能才好</li></ul><p>安装</p><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs q">npm install --<span class="hljs-built_in">save</span>-<span class="hljs-built_in">dev</span> mini-css-extract-plugin<br></code></pre></td></tr></table></figure><p><strong>webpack.config.js</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">MiniCssExtractPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;mini-css-extract-plugin&quot;</span>);<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">plugins</span>: [<span class="hljs-keyword">new</span> <span class="hljs-title class_">MiniCssExtractPlugin</span>()],<br>  <span class="hljs-attr">module</span>: &#123;<br>    <span class="hljs-attr">rules</span>: [<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.css$/i</span>,<br>        <span class="hljs-comment">//更新之前的css</span><br>        <span class="hljs-attr">use</span>: [<span class="hljs-title class_">MiniCssExtractPlugin</span>.<span class="hljs-property">loader</span>, <span class="hljs-string">&quot;css-loader&quot;</span>],<br>      &#125;,<br>    ],<br>  &#125;,<br>&#125;;<br></code></pre></td></tr></table></figure><h3 id="Css兼容性处理"><a href="#Css兼容性处理" class="headerlink" title="Css兼容性处理"></a>Css兼容性处理</h3><p>安装</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript"><span class="hljs-built_in">npm</span> i postcss-loader postcss postcss-preset-env -D<br></code></pre></td></tr></table></figure><p><strong>webpack.config.js</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">module</span>: &#123;<br>    <span class="hljs-attr">rules</span>: [<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.css$/i</span>,<br>        <span class="hljs-attr">use</span>: [<br>          <span class="hljs-string">&#x27;style-loader&#x27;</span>,<br>          <span class="hljs-string">&#x27;css-loader&#x27;</span>,<br>          &#123;<br>            <span class="hljs-attr">loader</span>: <span class="hljs-string">&#x27;postcss-loader&#x27;</span>,<br>            <span class="hljs-attr">options</span>: &#123;<br>              <span class="hljs-attr">postcssOptions</span>: &#123;<br>                <span class="hljs-attr">plugins</span>: [<br>                  [<br>                    <span class="hljs-string">&#x27;postcss-preset-env&#x27;</span>,<br>                    &#123;<br>                      <span class="hljs-comment">// 其他选项</span><br>                    &#125;,<br>                  ],<br>                ],<br>              &#125;,<br>            &#125;,<br>          &#125;,<br>        ],<br>      &#125;,<br>    ],<br>  &#125;,<br>&#125;;<br></code></pre></td></tr></table></figure><h3 id="封装样式loader函数"><a href="#封装样式loader函数" class="headerlink" title="封装样式loader函数"></a>封装样式loader函数</h3><h3 id="Css压缩"><a href="#Css压缩" class="headerlink" title="Css压缩"></a>Css压缩</h3><p>安装</p><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs q">npm install css-minimizer-webpack-plugin --<span class="hljs-built_in">save</span>-<span class="hljs-built_in">dev</span><br></code></pre></td></tr></table></figure><p><strong>webpack.config.js</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">MiniCssExtractPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;mini-css-extract-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">CssMinimizerPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;css-minimizer-webpack-plugin&quot;</span>);<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">module</span>: &#123;<br>    <span class="hljs-attr">rules</span>: [<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/.s?css$/</span>,<br>        <span class="hljs-attr">use</span>: [<span class="hljs-title class_">MiniCssExtractPlugin</span>.<span class="hljs-property">loader</span>, <span class="hljs-string">&quot;css-loader&quot;</span>, <span class="hljs-string">&quot;sass-loader&quot;</span>],<br>      &#125;,<br>    ],<br>  &#125;,<br>  <span class="hljs-attr">optimization</span>: &#123;<br>    <span class="hljs-attr">minimizer</span>: [<br>      <span class="hljs-comment">// 在 webpack@5 中，你可以使用 `...` 语法来扩展现有的 minimizer（即 `terser-webpack-plugin`），将下一行取消注释</span><br>      <span class="hljs-comment">// `...`,</span><br>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">CssMinimizerPlugin</span>(),<br>    ],<br>  &#125;,<br>  <span class="hljs-attr">plugins</span>: [<span class="hljs-keyword">new</span> <span class="hljs-title class_">MiniCssExtractPlugin</span>()],<br>&#125;;<br></code></pre></td></tr></table></figure><h1 id="高级"><a href="#高级" class="headerlink" title="高级"></a>高级</h1><h2 id="提升开发体验"><a href="#提升开发体验" class="headerlink" title="提升开发体验"></a>提升开发体验</h2><h3 id="SourceMap"><a href="#SourceMap" class="headerlink" title="SourceMap"></a>SourceMap</h3><ul><li>SourceMap（源代码映射）是一个用来生成源代码与构建后代码一一映射的文件的方案</li><li>它会生成一个<code>xxx.map</code>文件，里面包含源代码和构建后代码每一行、每一列的映射关系。当构建后代码出错了，会通过<code>xxx.map</code>文件，从构建后代码出错位置找到映射后源代码出错位置，从而让浏览器提示源代码文件出错位置，帮助我们更快找到错误根源</li></ul><p>开发模式：<code>cheap-module-source-map</code></p><ul><li>优点：打包编译速度快，只包含行映射</li><li>缺点：没有列映射</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    ...<br>    <span class="hljs-attr">mode</span>:<span class="hljs-string">&quot;development&quot;</span>,<br>    <span class="hljs-attr">devtool</span>:<span class="hljs-string">&quot;cheap-module-source-map&quot;</span>,<br>&#125;<br></code></pre></td></tr></table></figure><p>生成模式：<code>source-map</code></p><ul><li>优点：包含行&#x2F;列映射</li><li>缺点：打包编译速度更慢</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    ...<br>    <span class="hljs-attr">mode</span>:<span class="hljs-string">&quot;production&quot;</span>,<br>    <span class="hljs-attr">devtool</span>:<span class="hljs-string">&quot;source-map&quot;</span>,<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="提升打包构建速度"><a href="#提升打包构建速度" class="headerlink" title="提升打包构建速度"></a>提升打包构建速度</h2><h3 id="HotModuleReplacement-模块热替换"><a href="#HotModuleReplacement-模块热替换" class="headerlink" title="HotModuleReplacement 模块热替换"></a>HotModuleReplacement 模块热替换</h3><ul><li>webpack默认会将所有模块全部重新编译打包</li><li>在程序运行中，替换、添加或删除模块，而无需重新加载整个页面</li></ul><h3 id="OneOf"><a href="#OneOf" class="headerlink" title="OneOf"></a>OneOf</h3><ul><li>每个文件只能被其中一个loader配置处理</li></ul><h3 id="Include-x2F-Exclude"><a href="#Include-x2F-Exclude" class="headerlink" title="Include&#x2F;Exclude"></a>Include&#x2F;Exclude</h3><ul><li>只能选择一种使用</li><li>Include——只运行这个</li><li>Exclude——不运行这个</li></ul><h3 id="Cache缓存"><a href="#Cache缓存" class="headerlink" title="Cache缓存"></a>Cache缓存</h3><p>每次打包时js文件都要经Eslint检查和Babel编译，速度比较慢</p><p>我们可以<strong>缓存之前的Eslint检查和Babel编译结果</strong>，这样第二次打包时速度就更快</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">cache:true, <span class="hljs-regexp">//</span>开启缓存<br>cacheCompression:false, <span class="hljs-regexp">//</span>关闭缓存文件压缩<br>cacheLocation: path.resolve(__dirname,<span class="hljs-string">&quot;../node_modules/.cache/eslintcache&quot;</span>),<span class="hljs-regexp">//</span>缓存位置<br></code></pre></td></tr></table></figure><h3 id="Thead"><a href="#Thead" class="headerlink" title="Thead"></a>Thead</h3><ul><li><p>对js文件处理主要是eslint、babel、Terser三个工具 </p></li><li><p>多进程打包：开启电脑的多个进程同时干一件事</p></li></ul><p>安装</p><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs q">npm install --<span class="hljs-built_in">save</span>-<span class="hljs-built_in">dev</span> thread-loader<br></code></pre></td></tr></table></figure><p><strong>webpack.config.js</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">module</span>: &#123;<br>    <span class="hljs-attr">rules</span>: [<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.js$/</span>,<br>        <span class="hljs-attr">include</span>: path.<span class="hljs-title function_">resolve</span>(<span class="hljs-string">&#x27;src&#x27;</span>),<br>        <span class="hljs-attr">use</span>: [<br>          <span class="hljs-string">&quot;thread-loader&quot;</span>,<br>          <span class="hljs-comment">// 耗时的 loader （例如 babel-loader）</span><br>        ],<br>      &#125;,<br>    ],<br>  &#125;,<br>&#125;;<br></code></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">use</span>: [<br>  &#123;<br>    <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;thread-loader&quot;</span>,<br>    <span class="hljs-comment">// 有同样配置的 loader 会共享一个 worker 池</span><br>    <span class="hljs-attr">options</span>: &#123;<br>      <span class="hljs-comment">// 产生的 worker 的数量，默认是 (cpu 核心数 - 1)，或者，</span><br>      <span class="hljs-comment">// 在 require(&#x27;os&#x27;).cpus() 是 undefined 时回退至 1</span><br>      <span class="hljs-attr">workers</span>: <span class="hljs-number">2</span>,<br><br>      <span class="hljs-comment">// 一个 worker 进程中并行执行工作的数量</span><br>      <span class="hljs-comment">// 默认为 20</span><br>      <span class="hljs-attr">workerParallelJobs</span>: <span class="hljs-number">50</span>,<br><br>      <span class="hljs-comment">// 额外的 node.js 参数</span><br>      <span class="hljs-attr">workerNodeArgs</span>: [<span class="hljs-string">&#x27;--max-old-space-size=1024&#x27;</span>],<br><br>      <span class="hljs-comment">// 允许重新生成一个僵死的 work 池</span><br>      <span class="hljs-comment">// 这个过程会降低整体编译速度</span><br>      <span class="hljs-comment">// 并且开发环境应该设置为 false</span><br>      <span class="hljs-attr">poolRespawn</span>: <span class="hljs-literal">false</span>,<br><br>      <span class="hljs-comment">// 闲置时定时删除 worker 进程</span><br>      <span class="hljs-comment">// 默认为 500（ms）</span><br>      <span class="hljs-comment">// 可以设置为无穷大，这样在监视模式(--watch)下可以保持 worker 持续存在</span><br>      <span class="hljs-attr">poolTimeout</span>: <span class="hljs-number">2000</span>,<br><br>      <span class="hljs-comment">// 池分配给 worker 的工作数量</span><br>      <span class="hljs-comment">// 默认为 200</span><br>      <span class="hljs-comment">// 降低这个数值会降低总体的效率，但是会提升工作分布更均一</span><br>      <span class="hljs-attr">poolParallelJobs</span>: <span class="hljs-number">50</span>,<br><br>      <span class="hljs-comment">// 池的名称</span><br>      <span class="hljs-comment">// 可以修改名称来创建其余选项都一样的池</span><br>      <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;my-pool&quot;</span><br>    &#125;,<br>  &#125;,<br>  <span class="hljs-comment">// 耗时的 loader（例如 babel-loader）</span><br>];<br></code></pre></td></tr></table></figure><h2 id="减少代码体积"><a href="#减少代码体积" class="headerlink" title="减少代码体积"></a>减少代码体积</h2><h3 id="Tree-Shaking"><a href="#Tree-Shaking" class="headerlink" title="Tree Shaking"></a>Tree Shaking</h3><h3 id="Babel-1"><a href="#Babel-1" class="headerlink" title="Babel"></a>Babel</h3><ul><li>Babel为编译的每个文件都插入了辅助代码，使代码体积过大</li><li>将这些辅助代码作为一个独立模块，为避免重复引入</li></ul><p>安装</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript"><span class="hljs-built_in">npm</span> i @babel/plugin-transform-runtime -D<br></code></pre></td></tr></table></figure><h3 id="Image-Minimizer"><a href="#Image-Minimizer" class="headerlink" title="Image Minimizer"></a>Image Minimizer</h3><ul><li>对图片进行压缩，减少图片体积</li><li>本地项目静态图片才需要进行压缩</li></ul><p>安装</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arduino">npm install image-minimizer-webpack-plugin imagemin -D<br></code></pre></td></tr></table></figure><p>无损压缩</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">npm <span class="hljs-keyword">install </span>imagemin-gifsicle imagemin-<span class="hljs-keyword">jpegtran </span>imagemin-optipng imagemin-svgo -D<br></code></pre></td></tr></table></figure><h2 id="优化代码运行性能"><a href="#优化代码运行性能" class="headerlink" title="优化代码运行性能"></a>优化代码运行性能</h2><h3 id="Code-Split"><a href="#Code-Split" class="headerlink" title="Code Split"></a>Code Split</h3><ul><li><p>打包代码时会将所有 js 文件打包到一个文件中，体积太大了。我们如果只要渲染首页，就应该只加载首页的 js 文件，其他文件不应该加载。</p></li><li><p>所以我们需要将打包生成的文件进行代码分割，生成多个 js 文件，渲染哪个页面就只加载某个 js 文件，这样加载的资源就少，速度就更快。</p></li></ul><p>代码分割（Code Split）主要做了两件事：</p><ol><li><p>分割文件：将打包生成的文件进行分割，生成多个 js 文件。</p></li><li><p>按需加载：需要哪个文件就加载哪个文件。</p></li></ol><h4 id="1、多入口"><a href="#1、多入口" class="headerlink" title="1、多入口"></a>1、多入口</h4><p>安装</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">npm <span class="hljs-selector-tag">i</span> webpack webpack-cli <span class="hljs-selector-tag">html</span>-webpack-plugin -D<br></code></pre></td></tr></table></figure><p><strong>webpack.config.js</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;path&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;html-webpack-plugin&quot;</span>);<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-comment">// 单入口</span><br>  <span class="hljs-comment">// entry: &#x27;./src/main.js&#x27;,</span><br>  <span class="hljs-comment">// 多入口</span><br>  <span class="hljs-attr">entry</span>: &#123;<br>    <span class="hljs-attr">main</span>: <span class="hljs-string">&quot;./src/main.js&quot;</span>,<br>    <span class="hljs-attr">app</span>: <span class="hljs-string">&quot;./src/app.js&quot;</span>,<br>  &#125;,<br>  <span class="hljs-attr">output</span>: &#123;<br>    <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;./dist&quot;</span>),<br>    <span class="hljs-comment">// [name]是webpack命名规则，使用chunk的name作为输出的文件名。</span><br>    <span class="hljs-comment">// 什么是chunk？打包的资源就是chunk，输出出去叫bundle。</span><br>    <span class="hljs-comment">// chunk的name是啥呢？ 比如： entry中xxx: &quot;./src/xxx.js&quot;, name就是xxx。注意是前面的xxx，和文件名无关。</span><br>    <span class="hljs-comment">// 为什么需要这样命名呢？如果还是之前写法main.js，那么打包生成两个js文件都会叫做main.js会发生覆盖。(实际上会直接报错的)</span><br>    <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;js/[name].js&quot;</span>,<br>    <span class="hljs-attr">clear</span>: <span class="hljs-literal">true</span>,<br>  &#125;,<br>  <span class="hljs-attr">plugins</span>: [<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(&#123;<br>      <span class="hljs-attr">template</span>: <span class="hljs-string">&quot;./public/index.html&quot;</span>,<br>    &#125;),<br>  ],<br>  <span class="hljs-attr">mode</span>: <span class="hljs-string">&quot;production&quot;</span>,<br>&#125;;<br></code></pre></td></tr></table></figure><ul><li>配置了几个入口，至少输出几个 js 文件</li></ul><h4 id="2、提取重复代码"><a href="#2、提取重复代码" class="headerlink" title="2、提取重复代码"></a>2、提取重复代码</h4><p>如果多入口文件中都引用了同一份代码，我们不希望这份代码被打包到两个文件中，导致代码重复，体积更大。</p><p>我们需要提取多入口的重复代码，只打包生成一个 js 文件，其他文件引用它就好。</p><p><strong>webpack.config.js</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;path&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;html-webpack-plugin&quot;</span>);<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-comment">// 单入口</span><br>  <span class="hljs-comment">// entry: &#x27;./src/main.js&#x27;,</span><br>  <span class="hljs-comment">// 多入口</span><br>  <span class="hljs-attr">entry</span>: &#123;<br>    <span class="hljs-attr">main</span>: <span class="hljs-string">&quot;./src/main.js&quot;</span>,<br>    <span class="hljs-attr">app</span>: <span class="hljs-string">&quot;./src/app.js&quot;</span>,<br>  &#125;,<br>  <span class="hljs-attr">output</span>: &#123;<br>    <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;./dist&quot;</span>),<br>    <span class="hljs-comment">// [name]是webpack命名规则，使用chunk的name作为输出的文件名。</span><br>    <span class="hljs-comment">// 什么是chunk？打包的资源就是chunk，输出出去叫bundle。</span><br>    <span class="hljs-comment">// chunk的name是啥呢？ 比如： entry中xxx: &quot;./src/xxx.js&quot;, name就是xxx。注意是前面的xxx，和文件名无关。</span><br>    <span class="hljs-comment">// 为什么需要这样命名呢？如果还是之前写法main.js，那么打包生成两个js文件都会叫做main.js会发生覆盖。(实际上会直接报错的)</span><br>    <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;js/[name].js&quot;</span>,<br>    <span class="hljs-attr">clean</span>: <span class="hljs-literal">true</span>,<br>  &#125;,<br>  <span class="hljs-attr">plugins</span>: [<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(&#123;<br>      <span class="hljs-attr">template</span>: <span class="hljs-string">&quot;./public/index.html&quot;</span>,<br>    &#125;),<br>  ],<br>  <span class="hljs-attr">mode</span>: <span class="hljs-string">&quot;production&quot;</span>,<br>  <span class="hljs-attr">optimization</span>: &#123;<br>    <span class="hljs-comment">// 代码分割配置</span><br>    <span class="hljs-attr">splitChunks</span>: &#123;<br>      <span class="hljs-attr">chunks</span>: <span class="hljs-string">&quot;all&quot;</span>, <span class="hljs-comment">// 对所有模块都进行分割</span><br>      <span class="hljs-comment">// 以下是默认值</span><br>      <span class="hljs-comment">// minSize: 20000, // 分割代码最小的大小</span><br>      <span class="hljs-comment">// minRemainingSize: 0, // 类似于minSize，最后确保提取的文件大小不能为0</span><br>      <span class="hljs-comment">// minChunks: 1, // 至少被引用的次数，满足条件才会代码分割</span><br>      <span class="hljs-comment">// maxAsyncRequests: 30, // 按需加载时并行加载的文件的最大数量</span><br>      <span class="hljs-comment">// maxInitialRequests: 30, // 入口js文件最大并行请求数量</span><br>      <span class="hljs-comment">// enforceSizeThreshold: 50000, // 超过50kb一定会单独打包（此时会忽略minRemainingSize、maxAsyncRequests、maxInitialRequests）</span><br>      <span class="hljs-comment">// cacheGroups: &#123; // 组，哪些模块要打包到一个组</span><br>      <span class="hljs-comment">//   defaultVendors: &#123; // 组名</span><br>      <span class="hljs-comment">//     test: /[\\/]node_modules[\\/]/, // 需要打包到一起的模块</span><br>      <span class="hljs-comment">//     priority: -10, // 权重（越大越高）</span><br>      <span class="hljs-comment">//     reuseExistingChunk: true, // 如果当前 chunk 包含已从主 bundle 中拆分出的模块，则它将被重用，而不是生成新的模块</span><br>      <span class="hljs-comment">//   &#125;,</span><br>      <span class="hljs-comment">//   default: &#123; // 其他没有写的配置会使用上面的默认值</span><br>      <span class="hljs-comment">//     minChunks: 2, // 这里的minChunks权重更大</span><br>      <span class="hljs-comment">//     priority: -20,</span><br>      <span class="hljs-comment">//     reuseExistingChunk: true,</span><br>      <span class="hljs-comment">//   &#125;,</span><br>      <span class="hljs-comment">// &#125;,</span><br>      <span class="hljs-comment">// 修改配置</span><br>      <span class="hljs-attr">cacheGroups</span>: &#123;<br>        <span class="hljs-comment">// 组，哪些模块要打包到一个组</span><br>        <span class="hljs-comment">// defaultVendors: &#123; // 组名</span><br>        <span class="hljs-comment">//   test: /[\\/]node_modules[\\/]/, // 需要打包到一起的模块</span><br>        <span class="hljs-comment">//   priority: -10, // 权重（越大越高）</span><br>        <span class="hljs-comment">//   reuseExistingChunk: true, // 如果当前 chunk 包含已从主 bundle 中拆分出的模块，则它将被重用，而不是生成新的模块</span><br>        <span class="hljs-comment">// &#125;,</span><br>        <span class="hljs-attr">default</span>: &#123;<br>          <span class="hljs-comment">// 其他没有写的配置会使用上面的默认值</span><br>          <span class="hljs-attr">minSize</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// 我们定义的文件体积太小了，所以要改打包的最小文件体积</span><br>          <span class="hljs-attr">minChunks</span>: <span class="hljs-number">2</span>,<br>          <span class="hljs-attr">priority</span>: -<span class="hljs-number">20</span>,<br>          <span class="hljs-attr">reuseExistingChunk</span>: <span class="hljs-literal">true</span>,<br>        &#125;,<br>      &#125;,<br>    &#125;,<br>  &#125;,<br>&#125;;<br></code></pre></td></tr></table></figure><ul><li>此时我们会发现生成 3 个 js 文件，其中有一个就是提取的公共模块</li></ul><h4 id="3、按需加载，动态导入"><a href="#3、按需加载，动态导入" class="headerlink" title="3、按需加载，动态导入"></a>3、按需加载，动态导入</h4><p>想要实现按需加载，动态导入模块。还需要额外配置：</p><ol><li>修改文件</li></ol><ul><li>main.js</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;hello main&quot;</span>);<br><br><span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;btn&quot;</span>).<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-comment">// 动态导入 --&gt; 实现按需加载</span><br>  <span class="hljs-comment">// 即使只被引用了一次，也会代码分割</span><br>  <span class="hljs-keyword">import</span>(<span class="hljs-string">&quot;./math.js&quot;</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">&#123; sum &#125;</span>) =&gt;</span> &#123;<br>    <span class="hljs-title function_">alert</span>(<span class="hljs-title function_">sum</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>));<br>  &#125;);<br>&#125;;<br></code></pre></td></tr></table></figure><ul><li>app.js</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;hello app&quot;</span>);<br></code></pre></td></tr></table></figure><ul><li>public&#x2F;index.html</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Code Split<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>hello webpack<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;btn&quot;</span>&gt;</span>计算<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><ul><li>运行指令</li></ul><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">npx webpack<br></code></pre></td></tr></table></figure><p>我们可以发现，一旦通过 import 动态导入语法导入模块，模块就被代码分割，同时也能按需加载了</p><h4 id="4、单入口"><a href="#4、单入口" class="headerlink" title="4、单入口"></a>4、单入口</h4><p>开发时我们可能是单页面应用（SPA），只有一个入口（单入口）。那么我们需要这样配置：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;path&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;html-webpack-plugin&quot;</span>);<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-comment">// 单入口</span><br>  <span class="hljs-attr">entry</span>: <span class="hljs-string">&quot;./src/main.js&quot;</span>,<br>  <span class="hljs-comment">// 多入口</span><br>  <span class="hljs-comment">// entry: &#123;</span><br>  <span class="hljs-comment">//   main: &quot;./src/main.js&quot;,</span><br>  <span class="hljs-comment">//   app: &quot;./src/app.js&quot;,</span><br>  <span class="hljs-comment">// &#125;,</span><br>  <span class="hljs-attr">output</span>: &#123;<br>    <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;./dist&quot;</span>),<br>    <span class="hljs-comment">// [name]是webpack命名规则，使用chunk的name作为输出的文件名。</span><br>    <span class="hljs-comment">// 什么是chunk？打包的资源就是chunk，输出出去叫bundle。</span><br>    <span class="hljs-comment">// chunk的name是啥呢？ 比如： entry中xxx: &quot;./src/xxx.js&quot;, name就是xxx。注意是前面的xxx，和文件名无关。</span><br>    <span class="hljs-comment">// 为什么需要这样命名呢？如果还是之前写法main.js，那么打包生成两个js文件都会叫做main.js会发生覆盖。(实际上会直接报错的)</span><br>    <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;js/[name].js&quot;</span>,<br>    <span class="hljs-attr">clean</span>: <span class="hljs-literal">true</span>,<br>  &#125;,<br>  <span class="hljs-attr">plugins</span>: [<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(&#123;<br>      <span class="hljs-attr">template</span>: <span class="hljs-string">&quot;./public/index.html&quot;</span>,<br>    &#125;),<br>  ],<br>  <span class="hljs-attr">mode</span>: <span class="hljs-string">&quot;production&quot;</span>,<br>  <span class="hljs-attr">optimization</span>: &#123;<br>    <span class="hljs-comment">// 代码分割配置</span><br>    <span class="hljs-attr">splitChunks</span>: &#123;<br>      <span class="hljs-attr">chunks</span>: <span class="hljs-string">&quot;all&quot;</span>, <span class="hljs-comment">// 对所有模块都进行分割</span><br>      <span class="hljs-comment">// 以下是默认值</span><br>      <span class="hljs-comment">// minSize: 20000, // 分割代码最小的大小</span><br>      <span class="hljs-comment">// minRemainingSize: 0, // 类似于minSize，最后确保提取的文件大小不能为0</span><br>      <span class="hljs-comment">// minChunks: 1, // 至少被引用的次数，满足条件才会代码分割</span><br>      <span class="hljs-comment">// maxAsyncRequests: 30, // 按需加载时并行加载的文件的最大数量</span><br>      <span class="hljs-comment">// maxInitialRequests: 30, // 入口js文件最大并行请求数量</span><br>      <span class="hljs-comment">// enforceSizeThreshold: 50000, // 超过50kb一定会单独打包（此时会忽略minRemainingSize、maxAsyncRequests、maxInitialRequests）</span><br>      <span class="hljs-comment">// cacheGroups: &#123; // 组，哪些模块要打包到一个组</span><br>      <span class="hljs-comment">//   defaultVendors: &#123; // 组名</span><br>      <span class="hljs-comment">//     test: /[\\/]node_modules[\\/]/, // 需要打包到一起的模块</span><br>      <span class="hljs-comment">//     priority: -10, // 权重（越大越高）</span><br>      <span class="hljs-comment">//     reuseExistingChunk: true, // 如果当前 chunk 包含已从主 bundle 中拆分出的模块，则它将被重用，而不是生成新的模块</span><br>      <span class="hljs-comment">//   &#125;,</span><br>      <span class="hljs-comment">//   default: &#123; // 其他没有写的配置会使用上面的默认值</span><br>      <span class="hljs-comment">//     minChunks: 2, // 这里的minChunks权重更大</span><br>      <span class="hljs-comment">//     priority: -20,</span><br>      <span class="hljs-comment">//     reuseExistingChunk: true,</span><br>      <span class="hljs-comment">//   &#125;,</span><br>      <span class="hljs-comment">// &#125;,</span><br>  &#125;,<br>&#125;;<br></code></pre></td></tr></table></figure><h4 id="5、更新配置"><a href="#5、更新配置" class="headerlink" title="5、更新配置"></a>5、更新配置</h4><p>最终我们会使用单入口+代码分割+动态导入方式来进行配置。更新之前的配置文件。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// webpack.prod.js</span><br><span class="hljs-keyword">const</span> os = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;os&quot;</span>);<br><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;path&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">ESLintWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;eslint-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;html-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">MiniCssExtractPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;mini-css-extract-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">CssMinimizerPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;css-minimizer-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">TerserPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;terser-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">ImageMinimizerPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;image-minimizer-webpack-plugin&quot;</span>);<br><br><span class="hljs-comment">// cpu核数</span><br><span class="hljs-keyword">const</span> threads = os.<span class="hljs-title function_">cpus</span>().<span class="hljs-property">length</span>;<br><br><span class="hljs-comment">// 获取处理样式的Loaders</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">getStyleLoaders</span> = (<span class="hljs-params">preProcessor</span>) =&gt; &#123;<br>  <span class="hljs-keyword">return</span> [<br>    <span class="hljs-title class_">MiniCssExtractPlugin</span>.<span class="hljs-property">loader</span>,<br>    <span class="hljs-string">&quot;css-loader&quot;</span>,<br>    &#123;<br>      <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;postcss-loader&quot;</span>,<br>      <span class="hljs-attr">options</span>: &#123;<br>        <span class="hljs-attr">postcssOptions</span>: &#123;<br>          <span class="hljs-attr">plugins</span>: [<br>            <span class="hljs-string">&quot;postcss-preset-env&quot;</span>, <span class="hljs-comment">// 能解决大多数样式兼容性问题</span><br>          ],<br>        &#125;,<br>      &#125;,<br>    &#125;,<br>    preProcessor,<br>  ].<span class="hljs-title function_">filter</span>(<span class="hljs-title class_">Boolean</span>);<br>&#125;;<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">entry</span>: <span class="hljs-string">&quot;./src/main.js&quot;</span>,<br>  <span class="hljs-attr">output</span>: &#123;<br>    <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../dist&quot;</span>), <span class="hljs-comment">// 生产模式需要输出</span><br>    <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;static/js/main.js&quot;</span>, <span class="hljs-comment">// 将 js 文件输出到 static/js 目录中</span><br>    <span class="hljs-attr">clean</span>: <span class="hljs-literal">true</span>,<br>  &#125;,<br>  <span class="hljs-attr">module</span>: &#123;<br>    <span class="hljs-attr">rules</span>: [<br>      &#123;<br>        <span class="hljs-attr">oneOf</span>: [<br>          &#123;<br>            <span class="hljs-comment">// 用来匹配 .css 结尾的文件</span><br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.css$/</span>,<br>            <span class="hljs-comment">// use 数组里面 Loader 执行顺序是从右到左</span><br>            <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(),<br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.less$/</span>,<br>            <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(<span class="hljs-string">&quot;less-loader&quot;</span>),<br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.s[ac]ss$/</span>,<br>            <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(<span class="hljs-string">&quot;sass-loader&quot;</span>),<br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.styl$/</span>,<br>            <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(<span class="hljs-string">&quot;stylus-loader&quot;</span>),<br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(png|jpe?g|gif|svg)$/</span>,<br>            <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;asset&quot;</span>,<br>            <span class="hljs-attr">parser</span>: &#123;<br>              <span class="hljs-attr">dataUrlCondition</span>: &#123;<br>                <span class="hljs-attr">maxSize</span>: <span class="hljs-number">10</span> * <span class="hljs-number">1024</span>, <span class="hljs-comment">// 小于10kb的图片会被base64处理</span><br>              &#125;,<br>            &#125;,<br>            <span class="hljs-attr">generator</span>: &#123;<br>              <span class="hljs-comment">// 将图片文件输出到 static/imgs 目录中</span><br>              <span class="hljs-comment">// 将图片文件命名 [hash:8][ext][query]</span><br>              <span class="hljs-comment">// [hash:8]: hash值取8位</span><br>              <span class="hljs-comment">// [ext]: 使用之前的文件扩展名</span><br>              <span class="hljs-comment">// [query]: 添加之前的query参数</span><br>              <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;static/imgs/[hash:8][ext][query]&quot;</span>,<br>            &#125;,<br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(ttf|woff2?)$/</span>,<br>            <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;asset/resource&quot;</span>,<br>            <span class="hljs-attr">generator</span>: &#123;<br>              <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;static/media/[hash:8][ext][query]&quot;</span>,<br>            &#125;,<br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.js$/</span>,<br>            <span class="hljs-comment">// exclude: /node_modules/, // 排除node_modules代码不编译</span><br>            <span class="hljs-attr">include</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../src&quot;</span>), <span class="hljs-comment">// 也可以用包含</span><br>            <span class="hljs-attr">use</span>: [<br>              &#123;<br>                <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;thread-loader&quot;</span>, <span class="hljs-comment">// 开启多进程</span><br>                <span class="hljs-attr">options</span>: &#123;<br>                  <span class="hljs-attr">workers</span>: threads, <span class="hljs-comment">// 数量</span><br>                &#125;,<br>              &#125;,<br>              &#123;<br>                <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;babel-loader&quot;</span>,<br>                <span class="hljs-attr">options</span>: &#123;<br>                  <span class="hljs-attr">cacheDirectory</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 开启babel编译缓存</span><br>                  <span class="hljs-attr">cacheCompression</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// 缓存文件不要压缩</span><br>                  <span class="hljs-attr">plugins</span>: [<span class="hljs-string">&quot;@babel/plugin-transform-runtime&quot;</span>], <span class="hljs-comment">// 减少代码体积</span><br>                &#125;,<br>              &#125;,<br>            ],<br>          &#125;,<br>        ],<br>      &#125;,<br>    ],<br>  &#125;,<br>  <span class="hljs-attr">plugins</span>: [<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">ESLintWebpackPlugin</span>(&#123;<br>      <span class="hljs-comment">// 指定检查文件的根目录</span><br>      <span class="hljs-attr">context</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../src&quot;</span>),<br>      <span class="hljs-attr">exclude</span>: <span class="hljs-string">&quot;node_modules&quot;</span>, <span class="hljs-comment">// 默认值</span><br>      <span class="hljs-attr">cache</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 开启缓存</span><br>      <span class="hljs-comment">// 缓存目录</span><br>      <span class="hljs-attr">cacheLocation</span>: path.<span class="hljs-title function_">resolve</span>(<br>        __dirname,<br>        <span class="hljs-string">&quot;../node_modules/.cache/.eslintcache&quot;</span><br>      ),<br>      threads, <span class="hljs-comment">// 开启多进程</span><br>    &#125;),<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(&#123;<br>      <span class="hljs-comment">// 以 public/index.html 为模板创建文件</span><br>      <span class="hljs-comment">// 新的html文件有两个特点：1. 内容和源文件一致 2. 自动引入打包生成的js等资源</span><br>      <span class="hljs-attr">template</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../public/index.html&quot;</span>),<br>    &#125;),<br>    <span class="hljs-comment">// 提取css成单独文件</span><br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">MiniCssExtractPlugin</span>(&#123;<br>      <span class="hljs-comment">// 定义输出文件名和目录</span><br>      <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;static/css/main.css&quot;</span>,<br>    &#125;),<br>    <span class="hljs-comment">// css压缩</span><br>    <span class="hljs-comment">// new CssMinimizerPlugin(),</span><br>  ],<br>  <span class="hljs-attr">optimization</span>: &#123;<br>    <span class="hljs-attr">minimizer</span>: [<br>      <span class="hljs-comment">// css压缩也可以写到optimization.minimizer里面，效果一样的</span><br>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">CssMinimizerPlugin</span>(),<br>      <span class="hljs-comment">// 当生产模式会默认开启TerserPlugin，但是我们需要进行其他配置，就要重新写了</span><br>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">TerserPlugin</span>(&#123;<br>        <span class="hljs-attr">parallel</span>: threads, <span class="hljs-comment">// 开启多进程</span><br>      &#125;),<br>      <span class="hljs-comment">// 压缩图片</span><br>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImageMinimizerPlugin</span>(&#123;<br>        <span class="hljs-attr">minimizer</span>: &#123;<br>          <span class="hljs-attr">implementation</span>: <span class="hljs-title class_">ImageMinimizerPlugin</span>.<span class="hljs-property">imageminGenerate</span>,<br>          <span class="hljs-attr">options</span>: &#123;<br>            <span class="hljs-attr">plugins</span>: [<br>              [<span class="hljs-string">&quot;gifsicle&quot;</span>, &#123; <span class="hljs-attr">interlaced</span>: <span class="hljs-literal">true</span> &#125;],<br>              [<span class="hljs-string">&quot;jpegtran&quot;</span>, &#123; <span class="hljs-attr">progressive</span>: <span class="hljs-literal">true</span> &#125;],<br>              [<span class="hljs-string">&quot;optipng&quot;</span>, &#123; <span class="hljs-attr">optimizationLevel</span>: <span class="hljs-number">5</span> &#125;],<br>              [<br>                <span class="hljs-string">&quot;svgo&quot;</span>,<br>                &#123;<br>                  <span class="hljs-attr">plugins</span>: [<br>                    <span class="hljs-string">&quot;preset-default&quot;</span>,<br>                    <span class="hljs-string">&quot;prefixIds&quot;</span>,<br>                    &#123;<br>                      <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;sortAttrs&quot;</span>,<br>                      <span class="hljs-attr">params</span>: &#123;<br>                        <span class="hljs-attr">xmlnsOrder</span>: <span class="hljs-string">&quot;alphabetical&quot;</span>,<br>                      &#125;,<br>                    &#125;,<br>                  ],<br>                &#125;,<br>              ],<br>            ],<br>          &#125;,<br>        &#125;,<br>      &#125;),<br>    ],<br>    <span class="hljs-comment">// 代码分割配置</span><br>    <span class="hljs-attr">splitChunks</span>: &#123;<br>      <span class="hljs-attr">chunks</span>: <span class="hljs-string">&quot;all&quot;</span>, <span class="hljs-comment">// 对所有模块都进行分割</span><br>      <span class="hljs-comment">// 其他内容用默认配置即可</span><br>    &#125;,<br>  &#125;,<br>  <span class="hljs-comment">// devServer: &#123;</span><br>  <span class="hljs-comment">//   host: &quot;localhost&quot;, // 启动服务器域名</span><br>  <span class="hljs-comment">//   port: &quot;3000&quot;, // 启动服务器端口号</span><br>  <span class="hljs-comment">//   open: true, // 是否自动打开浏览器</span><br>  <span class="hljs-comment">// &#125;,</span><br>  <span class="hljs-attr">mode</span>: <span class="hljs-string">&quot;production&quot;</span>,<br>  <span class="hljs-attr">devtool</span>: <span class="hljs-string">&quot;source-map&quot;</span>,<br>&#125;;<br></code></pre></td></tr></table></figure><h4 id="6、给动态导入文件取名称"><a href="#6、给动态导入文件取名称" class="headerlink" title="6、给动态导入文件取名称"></a>6、给动态导入文件取名称</h4><p>1、修改文件</p><ul><li>main.js</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> sum <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./js/sum&quot;</span>;<br><span class="hljs-comment">// 引入资源，Webpack才会对其打包</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./css/iconfont.css&quot;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./css/index.css&quot;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./less/index.less&quot;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./sass/index.sass&quot;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./sass/index.scss&quot;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./styl/index.styl&quot;</span>;<br><br><span class="hljs-keyword">const</span> result2 = <span class="hljs-title function_">sum</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result2);<br><br><span class="hljs-comment">// 以下代码生产模式下会删除</span><br><span class="hljs-keyword">if</span> (<span class="hljs-variable language_">module</span>.<span class="hljs-property">hot</span>) &#123;<br>  <span class="hljs-variable language_">module</span>.<span class="hljs-property">hot</span>.<span class="hljs-title function_">accept</span>(<span class="hljs-string">&quot;./js/sum.js&quot;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">sum</span>) &#123;<br>    <span class="hljs-keyword">const</span> result2 = <span class="hljs-title function_">sum</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result2);<br>  &#125;);<br>&#125;<br><br><span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;btn&quot;</span>).<span class="hljs-property">onClick</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-comment">// eslint会对动态导入语法报错，需要修改eslint配置文件</span><br>  <span class="hljs-comment">// webpackChunkName: &quot;math&quot;：这是webpack动态导入模块命名的方式</span><br>  <span class="hljs-comment">// &quot;math&quot;将来就会作为[name]的值显示。</span><br>  <span class="hljs-keyword">import</span>(<span class="hljs-comment">/* webpackChunkName: &quot;math&quot; */</span> <span class="hljs-string">&quot;./js/math.js&quot;</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">&#123; count &#125;</span>) =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">count</span>(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>));<br>  &#125;);<br>&#125;;<br></code></pre></td></tr></table></figure><p>2、eslint 配置</p><ul><li>下载包</li></ul><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">npm i eslint-plugin-import -D<br></code></pre></td></tr></table></figure><ul><li>配置</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// .eslintrc.js</span><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-comment">// 继承 Eslint 规则</span><br>  <span class="hljs-attr">extends</span>: [<span class="hljs-string">&quot;eslint:recommended&quot;</span>],<br>  <span class="hljs-attr">env</span>: &#123;<br>    <span class="hljs-attr">node</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 启用node中全局变量</span><br>    <span class="hljs-attr">browser</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 启用浏览器中全局变量</span><br>  &#125;,<br>  <span class="hljs-attr">plugins</span>: [<span class="hljs-string">&quot;import&quot;</span>], <span class="hljs-comment">// 解决动态导入import语法报错问题 --&gt; 实际使用eslint-plugin-import的规则解决的</span><br>  <span class="hljs-attr">parserOptions</span>: &#123;<br>    <span class="hljs-attr">ecmaVersion</span>: <span class="hljs-number">6</span>,<br>    <span class="hljs-attr">sourceType</span>: <span class="hljs-string">&quot;module&quot;</span>,<br>  &#125;,<br>  <span class="hljs-attr">rules</span>: &#123;<br>    <span class="hljs-string">&quot;no-var&quot;</span>: <span class="hljs-number">2</span>, <span class="hljs-comment">// 不能使用 var 定义变量</span><br>  &#125;,<br>&#125;;<br></code></pre></td></tr></table></figure><ul><li>统一命名配置</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> os = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;os&quot;</span>);<br><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;path&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">ESLintWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;eslint-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;html-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">MiniCssExtractPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;mini-css-extract-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">CssMinimizerPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;css-minimizer-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">TerserPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;terser-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">ImageMinimizerPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;image-minimizer-webpack-plugin&quot;</span>);<br><br><span class="hljs-comment">// cpu核数</span><br><span class="hljs-keyword">const</span> threads = os.<span class="hljs-title function_">cpus</span>().<span class="hljs-property">length</span>;<br><br><span class="hljs-comment">// 获取处理样式的Loaders</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">getStyleLoaders</span> = (<span class="hljs-params">preProcessor</span>) =&gt; &#123;<br>  <span class="hljs-keyword">return</span> [<br>    <span class="hljs-title class_">MiniCssExtractPlugin</span>.<span class="hljs-property">loader</span>,<br>    <span class="hljs-string">&quot;css-loader&quot;</span>,<br>    &#123;<br>      <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;postcss-loader&quot;</span>,<br>      <span class="hljs-attr">options</span>: &#123;<br>        <span class="hljs-attr">postcssOptions</span>: &#123;<br>          <span class="hljs-attr">plugins</span>: [<br>            <span class="hljs-string">&quot;postcss-preset-env&quot;</span>, <span class="hljs-comment">// 能解决大多数样式兼容性问题</span><br>          ],<br>        &#125;,<br>      &#125;,<br>    &#125;,<br>    preProcessor,<br>  ].<span class="hljs-title function_">filter</span>(<span class="hljs-title class_">Boolean</span>);<br>&#125;;<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">entry</span>: <span class="hljs-string">&quot;./src/main.js&quot;</span>,<br>  <span class="hljs-attr">output</span>: &#123;<br>    <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../dist&quot;</span>), <span class="hljs-comment">// 生产模式需要输出</span><br>    <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;static/js/[name].js&quot;</span>, <span class="hljs-comment">// 入口文件打包输出资源命名方式</span><br>    <span class="hljs-attr">chunkFilename</span>: <span class="hljs-string">&quot;static/js/[name].chunk.js&quot;</span>, <span class="hljs-comment">// 动态导入输出资源命名方式</span><br>    <span class="hljs-attr">assetModuleFilename</span>: <span class="hljs-string">&quot;static/media/[name].[hash][ext]&quot;</span>, <span class="hljs-comment">// 图片、字体等资源命名方式（注意用hash）</span><br>    <span class="hljs-attr">clean</span>: <span class="hljs-literal">true</span>,<br>  &#125;,<br>  <span class="hljs-attr">module</span>: &#123;<br>    <span class="hljs-attr">rules</span>: [<br>      &#123;<br>        <span class="hljs-attr">oneOf</span>: [<br>          &#123;<br>            <span class="hljs-comment">// 用来匹配 .css 结尾的文件</span><br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.css$/</span>,<br>            <span class="hljs-comment">// use 数组里面 Loader 执行顺序是从右到左</span><br>            <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(),<br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.less$/</span>,<br>            <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(<span class="hljs-string">&quot;less-loader&quot;</span>),<br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.s[ac]ss$/</span>,<br>            <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(<span class="hljs-string">&quot;sass-loader&quot;</span>),<br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.styl$/</span>,<br>            <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(<span class="hljs-string">&quot;stylus-loader&quot;</span>),<br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(png|jpe?g|gif|svg)$/</span>,<br>            <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;asset&quot;</span>,<br>            <span class="hljs-attr">parser</span>: &#123;<br>              <span class="hljs-attr">dataUrlCondition</span>: &#123;<br>                <span class="hljs-attr">maxSize</span>: <span class="hljs-number">10</span> * <span class="hljs-number">1024</span>, <span class="hljs-comment">// 小于10kb的图片会被base64处理</span><br>              &#125;,<br>            &#125;,<br>            <span class="hljs-comment">// generator: &#123;</span><br>            <span class="hljs-comment">//   // 将图片文件输出到 static/imgs 目录中</span><br>            <span class="hljs-comment">//   // 将图片文件命名 [hash:8][ext][query]</span><br>            <span class="hljs-comment">//   // [hash:8]: hash值取8位</span><br>            <span class="hljs-comment">//   // [ext]: 使用之前的文件扩展名</span><br>            <span class="hljs-comment">//   // [query]: 添加之前的query参数</span><br>            <span class="hljs-comment">//   filename: &quot;static/imgs/[hash:8][ext][query]&quot;,</span><br>            <span class="hljs-comment">// &#125;,</span><br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(ttf|woff2?)$/</span>,<br>            <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;asset/resource&quot;</span>,<br>            <span class="hljs-comment">// generator: &#123;</span><br>            <span class="hljs-comment">//   filename: &quot;static/media/[hash:8][ext][query]&quot;,</span><br>            <span class="hljs-comment">// &#125;,</span><br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.js$/</span>,<br>            <span class="hljs-comment">// exclude: /node_modules/, // 排除node_modules代码不编译</span><br>            <span class="hljs-attr">include</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../src&quot;</span>), <span class="hljs-comment">// 也可以用包含</span><br>            <span class="hljs-attr">use</span>: [<br>              &#123;<br>                <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;thread-loader&quot;</span>, <span class="hljs-comment">// 开启多进程</span><br>                <span class="hljs-attr">options</span>: &#123;<br>                  <span class="hljs-attr">workers</span>: threads, <span class="hljs-comment">// 数量</span><br>                &#125;,<br>              &#125;,<br>              &#123;<br>                <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;babel-loader&quot;</span>,<br>                <span class="hljs-attr">options</span>: &#123;<br>                  <span class="hljs-attr">cacheDirectory</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 开启babel编译缓存</span><br>                  <span class="hljs-attr">cacheCompression</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// 缓存文件不要压缩</span><br>                  <span class="hljs-attr">plugins</span>: [<span class="hljs-string">&quot;@babel/plugin-transform-runtime&quot;</span>], <span class="hljs-comment">// 减少代码体积</span><br>                &#125;,<br>              &#125;,<br>            ],<br>          &#125;,<br>        ],<br>      &#125;,<br>    ],<br>  &#125;,<br>  <span class="hljs-attr">plugins</span>: [<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">ESLintWebpackPlugin</span>(&#123;<br>      <span class="hljs-comment">// 指定检查文件的根目录</span><br>      <span class="hljs-attr">context</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../src&quot;</span>),<br>      <span class="hljs-attr">exclude</span>: <span class="hljs-string">&quot;node_modules&quot;</span>, <span class="hljs-comment">// 默认值</span><br>      <span class="hljs-attr">cache</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 开启缓存</span><br>      <span class="hljs-comment">// 缓存目录</span><br>      <span class="hljs-attr">cacheLocation</span>: path.<span class="hljs-title function_">resolve</span>(<br>        __dirname,<br>        <span class="hljs-string">&quot;../node_modules/.cache/.eslintcache&quot;</span><br>      ),<br>      threads, <span class="hljs-comment">// 开启多进程</span><br>    &#125;),<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(&#123;<br>      <span class="hljs-comment">// 以 public/index.html 为模板创建文件</span><br>      <span class="hljs-comment">// 新的html文件有两个特点：1. 内容和源文件一致 2. 自动引入打包生成的js等资源</span><br>      <span class="hljs-attr">template</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../public/index.html&quot;</span>),<br>    &#125;),<br>    <span class="hljs-comment">// 提取css成单独文件</span><br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">MiniCssExtractPlugin</span>(&#123;<br>      <span class="hljs-comment">// 定义输出文件名和目录</span><br>      <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;static/css/[name].css&quot;</span>,<br>      <span class="hljs-attr">chunkFilename</span>: <span class="hljs-string">&quot;static/css/[name].chunk.css&quot;</span>,<br>    &#125;),<br>    <span class="hljs-comment">// css压缩</span><br>    <span class="hljs-comment">// new CssMinimizerPlugin(),</span><br>  ],<br>  <span class="hljs-attr">optimization</span>: &#123;<br>    <span class="hljs-attr">minimizer</span>: [<br>      <span class="hljs-comment">// css压缩也可以写到optimization.minimizer里面，效果一样的</span><br>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">CssMinimizerPlugin</span>(),<br>      <span class="hljs-comment">// 当生产模式会默认开启TerserPlugin，但是我们需要进行其他配置，就要重新写了</span><br>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">TerserPlugin</span>(&#123;<br>        <span class="hljs-attr">parallel</span>: threads, <span class="hljs-comment">// 开启多进程</span><br>      &#125;),<br>      <span class="hljs-comment">// 压缩图片</span><br>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImageMinimizerPlugin</span>(&#123;<br>        <span class="hljs-attr">minimizer</span>: &#123;<br>          <span class="hljs-attr">implementation</span>: <span class="hljs-title class_">ImageMinimizerPlugin</span>.<span class="hljs-property">imageminGenerate</span>,<br>          <span class="hljs-attr">options</span>: &#123;<br>            <span class="hljs-attr">plugins</span>: [<br>              [<span class="hljs-string">&quot;gifsicle&quot;</span>, &#123; <span class="hljs-attr">interlaced</span>: <span class="hljs-literal">true</span> &#125;],<br>              [<span class="hljs-string">&quot;jpegtran&quot;</span>, &#123; <span class="hljs-attr">progressive</span>: <span class="hljs-literal">true</span> &#125;],<br>              [<span class="hljs-string">&quot;optipng&quot;</span>, &#123; <span class="hljs-attr">optimizationLevel</span>: <span class="hljs-number">5</span> &#125;],<br>              [<br>                <span class="hljs-string">&quot;svgo&quot;</span>,<br>                &#123;<br>                  <span class="hljs-attr">plugins</span>: [<br>                    <span class="hljs-string">&quot;preset-default&quot;</span>,<br>                    <span class="hljs-string">&quot;prefixIds&quot;</span>,<br>                    &#123;<br>                      <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;sortAttrs&quot;</span>,<br>                      <span class="hljs-attr">params</span>: &#123;<br>                        <span class="hljs-attr">xmlnsOrder</span>: <span class="hljs-string">&quot;alphabetical&quot;</span>,<br>                      &#125;,<br>                    &#125;,<br>                  ],<br>                &#125;,<br>              ],<br>            ],<br>          &#125;,<br>        &#125;,<br>      &#125;),<br>    ],<br>    <span class="hljs-comment">// 代码分割配置</span><br>    <span class="hljs-attr">splitChunks</span>: &#123;<br>      <span class="hljs-attr">chunks</span>: <span class="hljs-string">&quot;all&quot;</span>, <span class="hljs-comment">// 对所有模块都进行分割</span><br>      <span class="hljs-comment">// 其他内容用默认配置即可</span><br>    &#125;,<br>  &#125;,<br>  <span class="hljs-comment">// devServer: &#123;</span><br>  <span class="hljs-comment">//   host: &quot;localhost&quot;, // 启动服务器域名</span><br>  <span class="hljs-comment">//   port: &quot;3000&quot;, // 启动服务器端口号</span><br>  <span class="hljs-comment">//   open: true, // 是否自动打开浏览器</span><br>  <span class="hljs-comment">// &#125;,</span><br>  <span class="hljs-attr">mode</span>: <span class="hljs-string">&quot;production&quot;</span>,<br>  <span class="hljs-attr">devtool</span>: <span class="hljs-string">&quot;source-map&quot;</span>,<br>&#125;;<br></code></pre></td></tr></table></figure><ul><li>运行指令</li></ul><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">npx webpack<br></code></pre></td></tr></table></figure><p>观察打包输出 js 文件名称</p><h3 id="Preload-x2F-Prefetch"><a href="#Preload-x2F-Prefetch" class="headerlink" title="Preload &#x2F; Prefetch"></a>Preload &#x2F; Prefetch</h3><h4 id="为什么"><a href="#为什么" class="headerlink" title="为什么"></a>为什么</h4><p>我们前面已经做了代码分割，同时会使用 import 动态导入语法来进行代码按需加载（我们也叫懒加载，比如路由懒加载就是这样实现的）。</p><p>但是加载速度还不够好，比如：是用户点击按钮时才加载这个资源的，如果资源体积很大，那么用户会感觉到明显卡顿效果。</p><p>我们想在浏览器空闲时间，加载后续需要使用的资源。我们就需要用上 <code>Preload</code> 或 <code>Prefetch</code> 技术</p><h4 id="是什么"><a href="#是什么" class="headerlink" title="是什么"></a>是什么</h4><ul><li><code>reload</code>：告诉浏览器立即加载资源。</li><li><code>Prefetch</code>：告诉浏览器在空闲时才开始加载资源。</li></ul><p>它们共同点：</p><ul><li>都只会加载资源，并不执行。</li><li>都有缓存。</li></ul><p>它们区别：</p><ul><li><code>Preload</code>加载优先级高，<code>Prefetch</code>加载优先级低。</li><li><code>Preload</code>只能加载当前页面需要使用的资源，<code>Prefetch</code>可以加载当前页面资源，也可以加载下一个页面需要使用的资源。</li></ul><p>总结：</p><ul><li>当前页面优先级高的资源用 <code>Preload</code> 加载。</li><li>下一个页面需要使用的资源用 <code>Prefetch</code> 加载。</li></ul><p>它们的问题：兼容性较差。</p><ul><li>我们可以去 <a href="https://caniuse.com/">Can I Useopen in new window</a> 网站查询 API 的兼容性问题。</li><li><code>Preload</code> 相对于 <code>Prefetch</code> 兼容性好一点。</li></ul><h4 id="怎么用"><a href="#怎么用" class="headerlink" title="怎么用"></a>怎么用</h4><p>1、下载包</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">npm i @vue/preload-webpack-plugin -D<br></code></pre></td></tr></table></figure><p>2、配置 webpack.prod.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> os = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;os&quot;</span>);<br><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;path&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">ESLintWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;eslint-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;html-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">MiniCssExtractPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;mini-css-extract-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">CssMinimizerPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;css-minimizer-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">TerserPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;terser-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">ImageMinimizerPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;image-minimizer-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">PreloadWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@vue/preload-webpack-plugin&quot;</span>);<br><br><span class="hljs-comment">// cpu核数</span><br><span class="hljs-keyword">const</span> threads = os.<span class="hljs-title function_">cpus</span>().<span class="hljs-property">length</span>;<br><br><span class="hljs-comment">// 获取处理样式的Loaders</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">getStyleLoaders</span> = (<span class="hljs-params">preProcessor</span>) =&gt; &#123;<br>  <span class="hljs-keyword">return</span> [<br>    <span class="hljs-title class_">MiniCssExtractPlugin</span>.<span class="hljs-property">loader</span>,<br>    <span class="hljs-string">&quot;css-loader&quot;</span>,<br>    &#123;<br>      <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;postcss-loader&quot;</span>,<br>      <span class="hljs-attr">options</span>: &#123;<br>        <span class="hljs-attr">postcssOptions</span>: &#123;<br>          <span class="hljs-attr">plugins</span>: [<br>            <span class="hljs-string">&quot;postcss-preset-env&quot;</span>, <span class="hljs-comment">// 能解决大多数样式兼容性问题</span><br>          ],<br>        &#125;,<br>      &#125;,<br>    &#125;,<br>    preProcessor,<br>  ].<span class="hljs-title function_">filter</span>(<span class="hljs-title class_">Boolean</span>);<br>&#125;;<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">entry</span>: <span class="hljs-string">&quot;./src/main.js&quot;</span>,<br>  <span class="hljs-attr">output</span>: &#123;<br>    <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../dist&quot;</span>), <span class="hljs-comment">// 生产模式需要输出</span><br>    <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;static/js/[name].js&quot;</span>, <span class="hljs-comment">// 入口文件打包输出资源命名方式</span><br>    <span class="hljs-attr">chunkFilename</span>: <span class="hljs-string">&quot;static/js/[name].chunk.js&quot;</span>, <span class="hljs-comment">// 动态导入输出资源命名方式</span><br>    <span class="hljs-attr">assetModuleFilename</span>: <span class="hljs-string">&quot;static/media/[name].[hash][ext]&quot;</span>, <span class="hljs-comment">// 图片、字体等资源命名方式（注意用hash）</span><br>    <span class="hljs-attr">clean</span>: <span class="hljs-literal">true</span>,<br>  &#125;,<br>  <span class="hljs-attr">module</span>: &#123;<br>    <span class="hljs-attr">rules</span>: [<br>      &#123;<br>        <span class="hljs-attr">oneOf</span>: [<br>          &#123;<br>            <span class="hljs-comment">// 用来匹配 .css 结尾的文件</span><br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.css$/</span>,<br>            <span class="hljs-comment">// use 数组里面 Loader 执行顺序是从右到左</span><br>            <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(),<br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.less$/</span>,<br>            <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(<span class="hljs-string">&quot;less-loader&quot;</span>),<br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.s[ac]ss$/</span>,<br>            <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(<span class="hljs-string">&quot;sass-loader&quot;</span>),<br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.styl$/</span>,<br>            <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(<span class="hljs-string">&quot;stylus-loader&quot;</span>),<br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(png|jpe?g|gif|svg)$/</span>,<br>            <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;asset&quot;</span>,<br>            <span class="hljs-attr">parser</span>: &#123;<br>              <span class="hljs-attr">dataUrlCondition</span>: &#123;<br>                <span class="hljs-attr">maxSize</span>: <span class="hljs-number">10</span> * <span class="hljs-number">1024</span>, <span class="hljs-comment">// 小于10kb的图片会被base64处理</span><br>              &#125;,<br>            &#125;,<br>            <span class="hljs-comment">// generator: &#123;</span><br>            <span class="hljs-comment">//   // 将图片文件输出到 static/imgs 目录中</span><br>            <span class="hljs-comment">//   // 将图片文件命名 [hash:8][ext][query]</span><br>            <span class="hljs-comment">//   // [hash:8]: hash值取8位</span><br>            <span class="hljs-comment">//   // [ext]: 使用之前的文件扩展名</span><br>            <span class="hljs-comment">//   // [query]: 添加之前的query参数</span><br>            <span class="hljs-comment">//   filename: &quot;static/imgs/[hash:8][ext][query]&quot;,</span><br>            <span class="hljs-comment">// &#125;,</span><br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(ttf|woff2?)$/</span>,<br>            <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;asset/resource&quot;</span>,<br>            <span class="hljs-comment">// generator: &#123;</span><br>            <span class="hljs-comment">//   filename: &quot;static/media/[hash:8][ext][query]&quot;,</span><br>            <span class="hljs-comment">// &#125;,</span><br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.js$/</span>,<br>            <span class="hljs-comment">// exclude: /node_modules/, // 排除node_modules代码不编译</span><br>            <span class="hljs-attr">include</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../src&quot;</span>), <span class="hljs-comment">// 也可以用包含</span><br>            <span class="hljs-attr">use</span>: [<br>              &#123;<br>                <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;thread-loader&quot;</span>, <span class="hljs-comment">// 开启多进程</span><br>                <span class="hljs-attr">options</span>: &#123;<br>                  <span class="hljs-attr">workers</span>: threads, <span class="hljs-comment">// 数量</span><br>                &#125;,<br>              &#125;,<br>              &#123;<br>                <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;babel-loader&quot;</span>,<br>                <span class="hljs-attr">options</span>: &#123;<br>                  <span class="hljs-attr">cacheDirectory</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 开启babel编译缓存</span><br>                  <span class="hljs-attr">cacheCompression</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// 缓存文件不要压缩</span><br>                  <span class="hljs-attr">plugins</span>: [<span class="hljs-string">&quot;@babel/plugin-transform-runtime&quot;</span>], <span class="hljs-comment">// 减少代码体积</span><br>                &#125;,<br>              &#125;,<br>            ],<br>          &#125;,<br>        ],<br>      &#125;,<br>    ],<br>  &#125;,<br>  <span class="hljs-attr">plugins</span>: [<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">ESLintWebpackPlugin</span>(&#123;<br>      <span class="hljs-comment">// 指定检查文件的根目录</span><br>      <span class="hljs-attr">context</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../src&quot;</span>),<br>      <span class="hljs-attr">exclude</span>: <span class="hljs-string">&quot;node_modules&quot;</span>, <span class="hljs-comment">// 默认值</span><br>      <span class="hljs-attr">cache</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 开启缓存</span><br>      <span class="hljs-comment">// 缓存目录</span><br>      <span class="hljs-attr">cacheLocation</span>: path.<span class="hljs-title function_">resolve</span>(<br>        __dirname,<br>        <span class="hljs-string">&quot;../node_modules/.cache/.eslintcache&quot;</span><br>      ),<br>      threads, <span class="hljs-comment">// 开启多进程</span><br>    &#125;),<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(&#123;<br>      <span class="hljs-comment">// 以 public/index.html 为模板创建文件</span><br>      <span class="hljs-comment">// 新的html文件有两个特点：1. 内容和源文件一致 2. 自动引入打包生成的js等资源</span><br>      <span class="hljs-attr">template</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../public/index.html&quot;</span>),<br>    &#125;),<br>    <span class="hljs-comment">// 提取css成单独文件</span><br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">MiniCssExtractPlugin</span>(&#123;<br>      <span class="hljs-comment">// 定义输出文件名和目录</span><br>      <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;static/css/[name].css&quot;</span>,<br>      <span class="hljs-attr">chunkFilename</span>: <span class="hljs-string">&quot;static/css/[name].chunk.css&quot;</span>,<br>    &#125;),<br>    <span class="hljs-comment">// css压缩</span><br>    <span class="hljs-comment">// new CssMinimizerPlugin(),</span><br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">PreloadWebpackPlugin</span>(&#123;<br>      <span class="hljs-attr">rel</span>: <span class="hljs-string">&quot;preload&quot;</span>, <span class="hljs-comment">// preload兼容性更好</span><br>      <span class="hljs-attr">as</span>: <span class="hljs-string">&quot;script&quot;</span>,<br>      <span class="hljs-comment">// rel: &#x27;prefetch&#x27; // prefetch兼容性更差</span><br>    &#125;),<br>  ],<br>  <span class="hljs-attr">optimization</span>: &#123;<br>    <span class="hljs-attr">minimizer</span>: [<br>      <span class="hljs-comment">// css压缩也可以写到optimization.minimizer里面，效果一样的</span><br>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">CssMinimizerPlugin</span>(),<br>      <span class="hljs-comment">// 当生产模式会默认开启TerserPlugin，但是我们需要进行其他配置，就要重新写了</span><br>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">TerserPlugin</span>(&#123;<br>        <span class="hljs-attr">parallel</span>: threads, <span class="hljs-comment">// 开启多进程</span><br>      &#125;),<br>      <span class="hljs-comment">// 压缩图片</span><br>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImageMinimizerPlugin</span>(&#123;<br>        <span class="hljs-attr">minimizer</span>: &#123;<br>          <span class="hljs-attr">implementation</span>: <span class="hljs-title class_">ImageMinimizerPlugin</span>.<span class="hljs-property">imageminGenerate</span>,<br>          <span class="hljs-attr">options</span>: &#123;<br>            <span class="hljs-attr">plugins</span>: [<br>              [<span class="hljs-string">&quot;gifsicle&quot;</span>, &#123; <span class="hljs-attr">interlaced</span>: <span class="hljs-literal">true</span> &#125;],<br>              [<span class="hljs-string">&quot;jpegtran&quot;</span>, &#123; <span class="hljs-attr">progressive</span>: <span class="hljs-literal">true</span> &#125;],<br>              [<span class="hljs-string">&quot;optipng&quot;</span>, &#123; <span class="hljs-attr">optimizationLevel</span>: <span class="hljs-number">5</span> &#125;],<br>              [<br>                <span class="hljs-string">&quot;svgo&quot;</span>,<br>                &#123;<br>                  <span class="hljs-attr">plugins</span>: [<br>                    <span class="hljs-string">&quot;preset-default&quot;</span>,<br>                    <span class="hljs-string">&quot;prefixIds&quot;</span>,<br>                    &#123;<br>                      <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;sortAttrs&quot;</span>,<br>                      <span class="hljs-attr">params</span>: &#123;<br>                        <span class="hljs-attr">xmlnsOrder</span>: <span class="hljs-string">&quot;alphabetical&quot;</span>,<br>                      &#125;,<br>                    &#125;,<br>                  ],<br>                &#125;,<br>              ],<br>            ],<br>          &#125;,<br>        &#125;,<br>      &#125;),<br>    ],<br>    <span class="hljs-comment">// 代码分割配置</span><br>    <span class="hljs-attr">splitChunks</span>: &#123;<br>      <span class="hljs-attr">chunks</span>: <span class="hljs-string">&quot;all&quot;</span>, <span class="hljs-comment">// 对所有模块都进行分割</span><br>      <span class="hljs-comment">// 其他内容用默认配置即可</span><br>    &#125;,<br>  &#125;,<br>  <span class="hljs-comment">// devServer: &#123;</span><br>  <span class="hljs-comment">//   host: &quot;localhost&quot;, // 启动服务器域名</span><br>  <span class="hljs-comment">//   port: &quot;3000&quot;, // 启动服务器端口号</span><br>  <span class="hljs-comment">//   open: true, // 是否自动打开浏览器</span><br>  <span class="hljs-comment">// &#125;,</span><br>  <span class="hljs-attr">mode</span>: <span class="hljs-string">&quot;production&quot;</span>,<br>  <span class="hljs-attr">devtool</span>: <span class="hljs-string">&quot;source-map&quot;</span>,<br>&#125;;<br></code></pre></td></tr></table></figure><h3 id="Network-Cache"><a href="#Network-Cache" class="headerlink" title="Network Cache"></a>Network Cache</h3><h4 id="为什么-1"><a href="#为什么-1" class="headerlink" title="为什么"></a>为什么</h4><p>将来开发时我们对静态资源会使用缓存来优化，这样浏览器第二次请求资源就能读取缓存了，速度很快。</p><p>但是这样的话就会有一个问题, 因为前后输出的文件名是一样的，都叫 main.js，一旦将来发布新版本，因为文件名没有变化导致浏览器会直接读取缓存，不会加载新资源，项目也就没法更新了。</p><p>所以我们从文件名入手，确保更新前后文件名不一样，这样就可以做缓存了</p><h4 id="是什么-1"><a href="#是什么-1" class="headerlink" title="是什么"></a>是什么</h4><p>们都会生成一个唯一的 hash 值。</p><ul><li>fullhash（webpack4 是 hash）</li></ul><p>每次修改任何一个文件，所有文件名的 hash 至都将改变。所以一旦修改了任何一个文件，整个项目的文件缓存都将失效。</p><ul><li>chunkhash</li></ul><p>根据不同的入口文件(Entry)进行依赖文件解析、构建对应的 chunk，生成对应的哈希值。我们 js 和 css 是同一个引入，会共享一个 hash 值。</p><ul><li>contenthash</li></ul><p>根据文件内容生成 hash 值，只有文件内容变化了，hash 值才会变化。所有文件 hash 值是独享且不同的</p><h4 id="怎么用-1"><a href="#怎么用-1" class="headerlink" title="怎么用"></a>怎么用</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> os = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;os&quot;</span>);<br><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;path&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">ESLintWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;eslint-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;html-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">MiniCssExtractPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;mini-css-extract-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">CssMinimizerPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;css-minimizer-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">TerserPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;terser-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">ImageMinimizerPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;image-minimizer-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">PreloadWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@vue/preload-webpack-plugin&quot;</span>);<br><br><span class="hljs-comment">// cpu核数</span><br><span class="hljs-keyword">const</span> threads = os.<span class="hljs-title function_">cpus</span>().<span class="hljs-property">length</span>;<br><br><span class="hljs-comment">// 获取处理样式的Loaders</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">getStyleLoaders</span> = (<span class="hljs-params">preProcessor</span>) =&gt; &#123;<br>  <span class="hljs-keyword">return</span> [<br>    <span class="hljs-title class_">MiniCssExtractPlugin</span>.<span class="hljs-property">loader</span>,<br>    <span class="hljs-string">&quot;css-loader&quot;</span>,<br>    &#123;<br>      <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;postcss-loader&quot;</span>,<br>      <span class="hljs-attr">options</span>: &#123;<br>        <span class="hljs-attr">postcssOptions</span>: &#123;<br>          <span class="hljs-attr">plugins</span>: [<br>            <span class="hljs-string">&quot;postcss-preset-env&quot;</span>, <span class="hljs-comment">// 能解决大多数样式兼容性问题</span><br>          ],<br>        &#125;,<br>      &#125;,<br>    &#125;,<br>    preProcessor,<br>  ].<span class="hljs-title function_">filter</span>(<span class="hljs-title class_">Boolean</span>);<br>&#125;;<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">entry</span>: <span class="hljs-string">&quot;./src/main.js&quot;</span>,<br>  <span class="hljs-attr">output</span>: &#123;<br>    <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../dist&quot;</span>), <span class="hljs-comment">// 生产模式需要输出</span><br>    <span class="hljs-comment">// [contenthash:8]使用contenthash，取8位长度</span><br>    <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;static/js/[name].[contenthash:8].js&quot;</span>, <span class="hljs-comment">// 入口文件打包输出资源命名方式</span><br>    <span class="hljs-attr">chunkFilename</span>: <span class="hljs-string">&quot;static/js/[name].[contenthash:8].chunk.js&quot;</span>, <span class="hljs-comment">// 动态导入输出资源命名方式</span><br>    <span class="hljs-attr">assetModuleFilename</span>: <span class="hljs-string">&quot;static/media/[name].[hash][ext]&quot;</span>, <span class="hljs-comment">// 图片、字体等资源命名方式（注意用hash）</span><br>    <span class="hljs-attr">clean</span>: <span class="hljs-literal">true</span>,<br>  &#125;,<br>  <span class="hljs-attr">module</span>: &#123;<br>    <span class="hljs-attr">rules</span>: [<br>      &#123;<br>        <span class="hljs-attr">oneOf</span>: [<br>          &#123;<br>            <span class="hljs-comment">// 用来匹配 .css 结尾的文件</span><br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.css$/</span>,<br>            <span class="hljs-comment">// use 数组里面 Loader 执行顺序是从右到左</span><br>            <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(),<br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.less$/</span>,<br>            <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(<span class="hljs-string">&quot;less-loader&quot;</span>),<br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.s[ac]ss$/</span>,<br>            <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(<span class="hljs-string">&quot;sass-loader&quot;</span>),<br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.styl$/</span>,<br>            <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(<span class="hljs-string">&quot;stylus-loader&quot;</span>),<br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(png|jpe?g|gif|svg)$/</span>,<br>            <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;asset&quot;</span>,<br>            <span class="hljs-attr">parser</span>: &#123;<br>              <span class="hljs-attr">dataUrlCondition</span>: &#123;<br>                <span class="hljs-attr">maxSize</span>: <span class="hljs-number">10</span> * <span class="hljs-number">1024</span>, <span class="hljs-comment">// 小于10kb的图片会被base64处理</span><br>              &#125;,<br>            &#125;,<br>            <span class="hljs-comment">// generator: &#123;</span><br>            <span class="hljs-comment">//   // 将图片文件输出到 static/imgs 目录中</span><br>            <span class="hljs-comment">//   // 将图片文件命名 [hash:8][ext][query]</span><br>            <span class="hljs-comment">//   // [hash:8]: hash值取8位</span><br>            <span class="hljs-comment">//   // [ext]: 使用之前的文件扩展名</span><br>            <span class="hljs-comment">//   // [query]: 添加之前的query参数</span><br>            <span class="hljs-comment">//   filename: &quot;static/imgs/[hash:8][ext][query]&quot;,</span><br>            <span class="hljs-comment">// &#125;,</span><br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(ttf|woff2?)$/</span>,<br>            <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;asset/resource&quot;</span>,<br>            <span class="hljs-comment">// generator: &#123;</span><br>            <span class="hljs-comment">//   filename: &quot;static/media/[hash:8][ext][query]&quot;,</span><br>            <span class="hljs-comment">// &#125;,</span><br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.js$/</span>,<br>            <span class="hljs-comment">// exclude: /node_modules/, // 排除node_modules代码不编译</span><br>            <span class="hljs-attr">include</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../src&quot;</span>), <span class="hljs-comment">// 也可以用包含</span><br>            <span class="hljs-attr">use</span>: [<br>              &#123;<br>                <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;thread-loader&quot;</span>, <span class="hljs-comment">// 开启多进程</span><br>                <span class="hljs-attr">options</span>: &#123;<br>                  <span class="hljs-attr">workers</span>: threads, <span class="hljs-comment">// 数量</span><br>                &#125;,<br>              &#125;,<br>              &#123;<br>                <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;babel-loader&quot;</span>,<br>                <span class="hljs-attr">options</span>: &#123;<br>                  <span class="hljs-attr">cacheDirectory</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 开启babel编译缓存</span><br>                  <span class="hljs-attr">cacheCompression</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// 缓存文件不要压缩</span><br>                  <span class="hljs-attr">plugins</span>: [<span class="hljs-string">&quot;@babel/plugin-transform-runtime&quot;</span>], <span class="hljs-comment">// 减少代码体积</span><br>                &#125;,<br>              &#125;,<br>            ],<br>          &#125;,<br>        ],<br>      &#125;,<br>    ],<br>  &#125;,<br>  <span class="hljs-attr">plugins</span>: [<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">ESLintWebpackPlugin</span>(&#123;<br>      <span class="hljs-comment">// 指定检查文件的根目录</span><br>      <span class="hljs-attr">context</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../src&quot;</span>),<br>      <span class="hljs-attr">exclude</span>: <span class="hljs-string">&quot;node_modules&quot;</span>, <span class="hljs-comment">// 默认值</span><br>      <span class="hljs-attr">cache</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 开启缓存</span><br>      <span class="hljs-comment">// 缓存目录</span><br>      <span class="hljs-attr">cacheLocation</span>: path.<span class="hljs-title function_">resolve</span>(<br>        __dirname,<br>        <span class="hljs-string">&quot;../node_modules/.cache/.eslintcache&quot;</span><br>      ),<br>      threads, <span class="hljs-comment">// 开启多进程</span><br>    &#125;),<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(&#123;<br>      <span class="hljs-comment">// 以 public/index.html 为模板创建文件</span><br>      <span class="hljs-comment">// 新的html文件有两个特点：1. 内容和源文件一致 2. 自动引入打包生成的js等资源</span><br>      <span class="hljs-attr">template</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../public/index.html&quot;</span>),<br>    &#125;),<br>    <span class="hljs-comment">// 提取css成单独文件</span><br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">MiniCssExtractPlugin</span>(&#123;<br>      <span class="hljs-comment">// 定义输出文件名和目录</span><br>      <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;static/css/[name].[contenthash:8].css&quot;</span>,<br>      <span class="hljs-attr">chunkFilename</span>: <span class="hljs-string">&quot;static/css/[name].[contenthash:8].chunk.css&quot;</span>,<br>    &#125;),<br>    <span class="hljs-comment">// css压缩</span><br>    <span class="hljs-comment">// new CssMinimizerPlugin(),</span><br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">PreloadWebpackPlugin</span>(&#123;<br>      <span class="hljs-attr">rel</span>: <span class="hljs-string">&quot;preload&quot;</span>, <span class="hljs-comment">// preload兼容性更好</span><br>      <span class="hljs-attr">as</span>: <span class="hljs-string">&quot;script&quot;</span>,<br>      <span class="hljs-comment">// rel: &#x27;prefetch&#x27; // prefetch兼容性更差</span><br>    &#125;),<br>  ],<br>  <span class="hljs-attr">optimization</span>: &#123;<br>    <span class="hljs-attr">minimizer</span>: [<br>      <span class="hljs-comment">// css压缩也可以写到optimization.minimizer里面，效果一样的</span><br>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">CssMinimizerPlugin</span>(),<br>      <span class="hljs-comment">// 当生产模式会默认开启TerserPlugin，但是我们需要进行其他配置，就要重新写了</span><br>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">TerserPlugin</span>(&#123;<br>        <span class="hljs-attr">parallel</span>: threads, <span class="hljs-comment">// 开启多进程</span><br>      &#125;),<br>      <span class="hljs-comment">// 压缩图片</span><br>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImageMinimizerPlugin</span>(&#123;<br>        <span class="hljs-attr">minimizer</span>: &#123;<br>          <span class="hljs-attr">implementation</span>: <span class="hljs-title class_">ImageMinimizerPlugin</span>.<span class="hljs-property">imageminGenerate</span>,<br>          <span class="hljs-attr">options</span>: &#123;<br>            <span class="hljs-attr">plugins</span>: [<br>              [<span class="hljs-string">&quot;gifsicle&quot;</span>, &#123; <span class="hljs-attr">interlaced</span>: <span class="hljs-literal">true</span> &#125;],<br>              [<span class="hljs-string">&quot;jpegtran&quot;</span>, &#123; <span class="hljs-attr">progressive</span>: <span class="hljs-literal">true</span> &#125;],<br>              [<span class="hljs-string">&quot;optipng&quot;</span>, &#123; <span class="hljs-attr">optimizationLevel</span>: <span class="hljs-number">5</span> &#125;],<br>              [<br>                <span class="hljs-string">&quot;svgo&quot;</span>,<br>                &#123;<br>                  <span class="hljs-attr">plugins</span>: [<br>                    <span class="hljs-string">&quot;preset-default&quot;</span>,<br>                    <span class="hljs-string">&quot;prefixIds&quot;</span>,<br>                    &#123;<br>                      <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;sortAttrs&quot;</span>,<br>                      <span class="hljs-attr">params</span>: &#123;<br>                        <span class="hljs-attr">xmlnsOrder</span>: <span class="hljs-string">&quot;alphabetical&quot;</span>,<br>                      &#125;,<br>                    &#125;,<br>                  ],<br>                &#125;,<br>              ],<br>            ],<br>          &#125;,<br>        &#125;,<br>      &#125;),<br>    ],<br>    <span class="hljs-comment">// 代码分割配置</span><br>    <span class="hljs-attr">splitChunks</span>: &#123;<br>      <span class="hljs-attr">chunks</span>: <span class="hljs-string">&quot;all&quot;</span>, <span class="hljs-comment">// 对所有模块都进行分割</span><br>      <span class="hljs-comment">// 其他内容用默认配置即可</span><br>    &#125;,<br>  &#125;,<br>  <span class="hljs-comment">// devServer: &#123;</span><br>  <span class="hljs-comment">//   host: &quot;localhost&quot;, // 启动服务器域名</span><br>  <span class="hljs-comment">//   port: &quot;3000&quot;, // 启动服务器端口号</span><br>  <span class="hljs-comment">//   open: true, // 是否自动打开浏览器</span><br>  <span class="hljs-comment">// &#125;,</span><br>  <span class="hljs-attr">mode</span>: <span class="hljs-string">&quot;production&quot;</span>,<br>  <span class="hljs-attr">devtool</span>: <span class="hljs-string">&quot;source-map&quot;</span>,<br>&#125;;<br></code></pre></td></tr></table></figure><ul><li>问题：</li></ul><p>当我们修改 math.js 文件再重新打包的时候，因为 contenthash 原因，math.js 文件 hash 值发生了变化（这是正常的）。</p><p>但是 main.js 文件的 hash 值也发生了变化，这会导致 main.js 的缓存失效。明明我们只修改 math.js, 为什么 main.js 也会变身变化呢？</p><ul><li>原因：<ul><li>更新前：math.xxx.js, main.js 引用的 math.xxx.js</li><li>更新后：math.yyy.js, main.js 引用的 math.yyy.js, 文件名发生了变化，间接导致 main.js 也发生了变化</li></ul></li><li>解决：</li></ul><p>将 hash 值单独保管在一个 runtime 文件中。</p><p>我们最终输出三个文件：main、math、runtime。当 math 文件发送变化，变化的是 math 和 runtime 文件，main 不变。</p><p>runtime 文件只保存文件的 hash 值和它们与文件关系，整个文件体积就比较小，所以变化重新请求的代价也小。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> os = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;os&quot;</span>);<br><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;path&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">ESLintWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;eslint-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;html-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">MiniCssExtractPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;mini-css-extract-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">CssMinimizerPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;css-minimizer-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">TerserPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;terser-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">ImageMinimizerPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;image-minimizer-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">PreloadWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@vue/preload-webpack-plugin&quot;</span>);<br><br><span class="hljs-comment">// cpu核数</span><br><span class="hljs-keyword">const</span> threads = os.<span class="hljs-title function_">cpus</span>().<span class="hljs-property">length</span>;<br><br><span class="hljs-comment">// 获取处理样式的Loaders</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">getStyleLoaders</span> = (<span class="hljs-params">preProcessor</span>) =&gt; &#123;<br>  <span class="hljs-keyword">return</span> [<br>    <span class="hljs-title class_">MiniCssExtractPlugin</span>.<span class="hljs-property">loader</span>,<br>    <span class="hljs-string">&quot;css-loader&quot;</span>,<br>    &#123;<br>      <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;postcss-loader&quot;</span>,<br>      <span class="hljs-attr">options</span>: &#123;<br>        <span class="hljs-attr">postcssOptions</span>: &#123;<br>          <span class="hljs-attr">plugins</span>: [<br>            <span class="hljs-string">&quot;postcss-preset-env&quot;</span>, <span class="hljs-comment">// 能解决大多数样式兼容性问题</span><br>          ],<br>        &#125;,<br>      &#125;,<br>    &#125;,<br>    preProcessor,<br>  ].<span class="hljs-title function_">filter</span>(<span class="hljs-title class_">Boolean</span>);<br>&#125;;<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">entry</span>: <span class="hljs-string">&quot;./src/main.js&quot;</span>,<br>  <span class="hljs-attr">output</span>: &#123;<br>    <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../dist&quot;</span>), <span class="hljs-comment">// 生产模式需要输出</span><br>    <span class="hljs-comment">// [contenthash:8]使用contenthash，取8位长度</span><br>    <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;static/js/[name].[contenthash:8].js&quot;</span>, <span class="hljs-comment">// 入口文件打包输出资源命名方式</span><br>    <span class="hljs-attr">chunkFilename</span>: <span class="hljs-string">&quot;static/js/[name].[contenthash:8].chunk.js&quot;</span>, <span class="hljs-comment">// 动态导入输出资源命名方式</span><br>    <span class="hljs-attr">assetModuleFilename</span>: <span class="hljs-string">&quot;static/media/[name].[hash][ext]&quot;</span>, <span class="hljs-comment">// 图片、字体等资源命名方式（注意用hash）</span><br>    <span class="hljs-attr">clean</span>: <span class="hljs-literal">true</span>,<br>  &#125;,<br>  <span class="hljs-attr">module</span>: &#123;<br>    <span class="hljs-attr">rules</span>: [<br>      &#123;<br>        <span class="hljs-attr">oneOf</span>: [<br>          &#123;<br>            <span class="hljs-comment">// 用来匹配 .css 结尾的文件</span><br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.css$/</span>,<br>            <span class="hljs-comment">// use 数组里面 Loader 执行顺序是从右到左</span><br>            <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(),<br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.less$/</span>,<br>            <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(<span class="hljs-string">&quot;less-loader&quot;</span>),<br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.s[ac]ss$/</span>,<br>            <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(<span class="hljs-string">&quot;sass-loader&quot;</span>),<br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.styl$/</span>,<br>            <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(<span class="hljs-string">&quot;stylus-loader&quot;</span>),<br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(png|jpe?g|gif|svg)$/</span>,<br>            <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;asset&quot;</span>,<br>            <span class="hljs-attr">parser</span>: &#123;<br>              <span class="hljs-attr">dataUrlCondition</span>: &#123;<br>                <span class="hljs-attr">maxSize</span>: <span class="hljs-number">10</span> * <span class="hljs-number">1024</span>, <span class="hljs-comment">// 小于10kb的图片会被base64处理</span><br>              &#125;,<br>            &#125;,<br>            <span class="hljs-comment">// generator: &#123;</span><br>            <span class="hljs-comment">//   // 将图片文件输出到 static/imgs 目录中</span><br>            <span class="hljs-comment">//   // 将图片文件命名 [hash:8][ext][query]</span><br>            <span class="hljs-comment">//   // [hash:8]: hash值取8位</span><br>            <span class="hljs-comment">//   // [ext]: 使用之前的文件扩展名</span><br>            <span class="hljs-comment">//   // [query]: 添加之前的query参数</span><br>            <span class="hljs-comment">//   filename: &quot;static/imgs/[hash:8][ext][query]&quot;,</span><br>            <span class="hljs-comment">// &#125;,</span><br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(ttf|woff2?)$/</span>,<br>            <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;asset/resource&quot;</span>,<br>            <span class="hljs-comment">// generator: &#123;</span><br>            <span class="hljs-comment">//   filename: &quot;static/media/[hash:8][ext][query]&quot;,</span><br>            <span class="hljs-comment">// &#125;,</span><br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.js$/</span>,<br>            <span class="hljs-comment">// exclude: /node_modules/, // 排除node_modules代码不编译</span><br>            <span class="hljs-attr">include</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../src&quot;</span>), <span class="hljs-comment">// 也可以用包含</span><br>            <span class="hljs-attr">use</span>: [<br>              &#123;<br>                <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;thread-loader&quot;</span>, <span class="hljs-comment">// 开启多进程</span><br>                <span class="hljs-attr">options</span>: &#123;<br>                  <span class="hljs-attr">workers</span>: threads, <span class="hljs-comment">// 数量</span><br>                &#125;,<br>              &#125;,<br>              &#123;<br>                <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;babel-loader&quot;</span>,<br>                <span class="hljs-attr">options</span>: &#123;<br>                  <span class="hljs-attr">cacheDirectory</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 开启babel编译缓存</span><br>                  <span class="hljs-attr">cacheCompression</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// 缓存文件不要压缩</span><br>                  <span class="hljs-attr">plugins</span>: [<span class="hljs-string">&quot;@babel/plugin-transform-runtime&quot;</span>], <span class="hljs-comment">// 减少代码体积</span><br>                &#125;,<br>              &#125;,<br>            ],<br>          &#125;,<br>        ],<br>      &#125;,<br>    ],<br>  &#125;,<br>  <span class="hljs-attr">plugins</span>: [<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">ESLintWebpackPlugin</span>(&#123;<br>      <span class="hljs-comment">// 指定检查文件的根目录</span><br>      <span class="hljs-attr">context</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../src&quot;</span>),<br>      <span class="hljs-attr">exclude</span>: <span class="hljs-string">&quot;node_modules&quot;</span>, <span class="hljs-comment">// 默认值</span><br>      <span class="hljs-attr">cache</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 开启缓存</span><br>      <span class="hljs-comment">// 缓存目录</span><br>      <span class="hljs-attr">cacheLocation</span>: path.<span class="hljs-title function_">resolve</span>(<br>        __dirname,<br>        <span class="hljs-string">&quot;../node_modules/.cache/.eslintcache&quot;</span><br>      ),<br>      threads, <span class="hljs-comment">// 开启多进程</span><br>    &#125;),<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(&#123;<br>      <span class="hljs-comment">// 以 public/index.html 为模板创建文件</span><br>      <span class="hljs-comment">// 新的html文件有两个特点：1. 内容和源文件一致 2. 自动引入打包生成的js等资源</span><br>      <span class="hljs-attr">template</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../public/index.html&quot;</span>),<br>    &#125;),<br>    <span class="hljs-comment">// 提取css成单独文件</span><br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">MiniCssExtractPlugin</span>(&#123;<br>      <span class="hljs-comment">// 定义输出文件名和目录</span><br>      <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;static/css/[name].[contenthash:8].css&quot;</span>,<br>      <span class="hljs-attr">chunkFilename</span>: <span class="hljs-string">&quot;static/css/[name].[contenthash:8].chunk.css&quot;</span>,<br>    &#125;),<br>    <span class="hljs-comment">// css压缩</span><br>    <span class="hljs-comment">// new CssMinimizerPlugin(),</span><br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">PreloadWebpackPlugin</span>(&#123;<br>      <span class="hljs-attr">rel</span>: <span class="hljs-string">&quot;preload&quot;</span>, <span class="hljs-comment">// preload兼容性更好</span><br>      <span class="hljs-attr">as</span>: <span class="hljs-string">&quot;script&quot;</span>,<br>      <span class="hljs-comment">// rel: &#x27;prefetch&#x27; // prefetch兼容性更差</span><br>    &#125;),<br>  ],<br>  <span class="hljs-attr">optimization</span>: &#123;<br>    <span class="hljs-attr">minimizer</span>: [<br>      <span class="hljs-comment">// css压缩也可以写到optimization.minimizer里面，效果一样的</span><br>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">CssMinimizerPlugin</span>(),<br>      <span class="hljs-comment">// 当生产模式会默认开启TerserPlugin，但是我们需要进行其他配置，就要重新写了</span><br>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">TerserPlugin</span>(&#123;<br>        <span class="hljs-attr">parallel</span>: threads, <span class="hljs-comment">// 开启多进程</span><br>      &#125;),<br>      <span class="hljs-comment">// 压缩图片</span><br>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImageMinimizerPlugin</span>(&#123;<br>        <span class="hljs-attr">minimizer</span>: &#123;<br>          <span class="hljs-attr">implementation</span>: <span class="hljs-title class_">ImageMinimizerPlugin</span>.<span class="hljs-property">imageminGenerate</span>,<br>          <span class="hljs-attr">options</span>: &#123;<br>            <span class="hljs-attr">plugins</span>: [<br>              [<span class="hljs-string">&quot;gifsicle&quot;</span>, &#123; <span class="hljs-attr">interlaced</span>: <span class="hljs-literal">true</span> &#125;],<br>              [<span class="hljs-string">&quot;jpegtran&quot;</span>, &#123; <span class="hljs-attr">progressive</span>: <span class="hljs-literal">true</span> &#125;],<br>              [<span class="hljs-string">&quot;optipng&quot;</span>, &#123; <span class="hljs-attr">optimizationLevel</span>: <span class="hljs-number">5</span> &#125;],<br>              [<br>                <span class="hljs-string">&quot;svgo&quot;</span>,<br>                &#123;<br>                  <span class="hljs-attr">plugins</span>: [<br>                    <span class="hljs-string">&quot;preset-default&quot;</span>,<br>                    <span class="hljs-string">&quot;prefixIds&quot;</span>,<br>                    &#123;<br>                      <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;sortAttrs&quot;</span>,<br>                      <span class="hljs-attr">params</span>: &#123;<br>                        <span class="hljs-attr">xmlnsOrder</span>: <span class="hljs-string">&quot;alphabetical&quot;</span>,<br>                      &#125;,<br>                    &#125;,<br>                  ],<br>                &#125;,<br>              ],<br>            ],<br>          &#125;,<br>        &#125;,<br>      &#125;),<br>    ],<br>    <span class="hljs-comment">// 代码分割配置</span><br>    <span class="hljs-attr">splitChunks</span>: &#123;<br>      <span class="hljs-attr">chunks</span>: <span class="hljs-string">&quot;all&quot;</span>, <span class="hljs-comment">// 对所有模块都进行分割</span><br>      <span class="hljs-comment">// 其他内容用默认配置即可</span><br>    &#125;,<br>    <span class="hljs-comment">// 提取runtime文件</span><br>    <span class="hljs-attr">runtimeChunk</span>: &#123;<br>      <span class="hljs-attr">name</span>: <span class="hljs-function">(<span class="hljs-params">entrypoint</span>) =&gt;</span> <span class="hljs-string">`runtime~<span class="hljs-subst">$&#123;entrypoint.name&#125;</span>`</span>, <span class="hljs-comment">// runtime文件命名规则</span><br>    &#125;,<br>  &#125;,<br>  <span class="hljs-comment">// devServer: &#123;</span><br>  <span class="hljs-comment">//   host: &quot;localhost&quot;, // 启动服务器域名</span><br>  <span class="hljs-comment">//   port: &quot;3000&quot;, // 启动服务器端口号</span><br>  <span class="hljs-comment">//   open: true, // 是否自动打开浏览器</span><br>  <span class="hljs-comment">// &#125;,</span><br>  <span class="hljs-attr">mode</span>: <span class="hljs-string">&quot;production&quot;</span>,<br>  <span class="hljs-attr">devtool</span>: <span class="hljs-string">&quot;source-map&quot;</span>,<br>&#125;;<br></code></pre></td></tr></table></figure><h3 id="Core-js"><a href="#Core-js" class="headerlink" title="Core-js"></a>Core-js</h3><h4 id="为什么-2"><a href="#为什么-2" class="headerlink" title="为什么"></a>为什么</h4><p>过去我们使用 babel 对 js 代码进行了兼容性处理，其中使用@babel&#x2F;preset-env 智能预设来处理兼容性问题。</p><p>它能将 ES6 的一些语法进行编译转换，比如箭头函数、点点点运算符等。但是如果是 async 函数、promise 对象、数组的一些方法（includes）等，它没办法处理。</p><p>所以此时我们 js 代码仍然存在兼容性问题，一旦遇到低版本浏览器会直接报错。所以我们想要将 js 兼容性问题彻底解决</p><h4 id="是什么-2"><a href="#是什么-2" class="headerlink" title="是什么"></a>是什么</h4><p><code>core-js</code> 是专门用来做 ES6 以及以上 API 的 <code>polyfill</code>。</p><p><code>polyfill</code>翻译过来叫做垫片&#x2F;补丁。就是用社区上提供的一段代码，让我们在不兼容某些新特性的浏览器上，使用该新特性</p><h4 id="怎么用-2"><a href="#怎么用-2" class="headerlink" title="怎么用"></a>怎么用</h4><p>1、修改 main.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> count <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./js/count&quot;</span>;<br><span class="hljs-keyword">import</span> sum <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./js/sum&quot;</span>;<br><span class="hljs-comment">// 引入资源，Webpack才会对其打包</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./css/iconfont.css&quot;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./css/index.css&quot;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./less/index.less&quot;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./sass/index.sass&quot;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./sass/index.scss&quot;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./styl/index.styl&quot;</span>;<br><br><span class="hljs-keyword">const</span> result1 = <span class="hljs-title function_">count</span>(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result1);<br><span class="hljs-keyword">const</span> result2 = <span class="hljs-title function_">sum</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result2);<br><span class="hljs-comment">// 添加promise代码</span><br><span class="hljs-keyword">const</span> promise = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>();<br>promise.<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;hello promise&quot;</span>);<br>&#125;);<br></code></pre></td></tr></table></figure><ul><li>此时 Eslint 会对 Promise 报错。</li></ul><p>2、修改配置文件</p><ul><li>下载包</li></ul><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">npm i @babel/eslint-parser -D<br></code></pre></td></tr></table></figure><ul><li>.eslintrc.js</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-comment">// 继承 Eslint 规则</span><br>  <span class="hljs-attr">extends</span>: [<span class="hljs-string">&quot;eslint:recommended&quot;</span>],<br>  <span class="hljs-attr">parser</span>: <span class="hljs-string">&quot;@babel/eslint-parser&quot;</span>, <span class="hljs-comment">// 支持最新的最终 ECMAScript 标准</span><br>  <span class="hljs-attr">env</span>: &#123;<br>    <span class="hljs-attr">node</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 启用node中全局变量</span><br>    <span class="hljs-attr">browser</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 启用浏览器中全局变量</span><br>  &#125;,<br>  <span class="hljs-attr">plugins</span>: [<span class="hljs-string">&quot;import&quot;</span>], <span class="hljs-comment">// 解决动态导入import语法报错问题 --&gt; 实际使用eslint-plugin-import的规则解决的</span><br>  <span class="hljs-attr">parserOptions</span>: &#123;<br>    <span class="hljs-attr">ecmaVersion</span>: <span class="hljs-number">6</span>, <span class="hljs-comment">// es6</span><br>    <span class="hljs-attr">sourceType</span>: <span class="hljs-string">&quot;module&quot;</span>, <span class="hljs-comment">// es module</span><br>  &#125;,<br>  <span class="hljs-attr">rules</span>: &#123;<br>    <span class="hljs-string">&quot;no-var&quot;</span>: <span class="hljs-number">2</span>, <span class="hljs-comment">// 不能使用 var 定义变量</span><br>  &#125;,<br>&#125;;<br></code></pre></td></tr></table></figure><p>3、运行指令</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">npm run build<br></code></pre></td></tr></table></figure><p>此时观察打包输出的 js 文件，我们发现 Promise 语法并没有编译转换，所以我们需要使用 <code>core-js</code> 来进行 <code>polyfill</code>。</p><p>4、使用<code>core-js</code></p><ul><li>下载包</li></ul><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">npm i core-js<br></code></pre></td></tr></table></figure><ul><li>手动全部引入</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;core-js&quot;</span>;<br><span class="hljs-keyword">import</span> count <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./js/count&quot;</span>;<br><span class="hljs-keyword">import</span> sum <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./js/sum&quot;</span>;<br><span class="hljs-comment">// 引入资源，Webpack才会对其打包</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./css/iconfont.css&quot;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./css/index.css&quot;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./less/index.less&quot;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./sass/index.sass&quot;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./sass/index.scss&quot;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./styl/index.styl&quot;</span>;<br><br><span class="hljs-keyword">const</span> result1 = <span class="hljs-title function_">count</span>(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result1);<br><span class="hljs-keyword">const</span> result2 = <span class="hljs-title function_">sum</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result2);<br><span class="hljs-comment">// 添加promise代码</span><br><span class="hljs-keyword">const</span> promise = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>();<br>promise.<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;hello promise&quot;</span>);<br>&#125;);<br></code></pre></td></tr></table></figure><p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20</p><p>这样引入会将所有兼容性代码全部引入，体积太大了。我们只想引入 promise 的 <code>polyfill</code>。</p><ul><li>手动按需引入</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;core-js/es/promise&quot;</span>;<br><span class="hljs-keyword">import</span> count <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./js/count&quot;</span>;<br><span class="hljs-keyword">import</span> sum <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./js/sum&quot;</span>;<br><span class="hljs-comment">// 引入资源，Webpack才会对其打包</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./css/iconfont.css&quot;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./css/index.css&quot;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./less/index.less&quot;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./sass/index.sass&quot;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./sass/index.scss&quot;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./styl/index.styl&quot;</span>;<br><br><span class="hljs-keyword">const</span> result1 = <span class="hljs-title function_">count</span>(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result1);<br><span class="hljs-keyword">const</span> result2 = <span class="hljs-title function_">sum</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result2);<br><span class="hljs-comment">// 添加promise代码</span><br><span class="hljs-keyword">const</span> promise = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>();<br>promise.<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;hello promise&quot;</span>);<br>&#125;);<br></code></pre></td></tr></table></figure><p>只引入打包 promise 的 <code>polyfill</code>，打包体积更小。但是将来如果还想使用其他语法，我需要手动引入库很麻烦。</p><ul><li><p>自动按需引入</p><ul><li>main.js</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> count <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./js/count&quot;</span>;<br><span class="hljs-keyword">import</span> sum <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./js/sum&quot;</span>;<br><span class="hljs-comment">// 引入资源，Webpack才会对其打包</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./css/iconfont.css&quot;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./css/index.css&quot;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./less/index.less&quot;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./sass/index.sass&quot;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./sass/index.scss&quot;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./styl/index.styl&quot;</span>;<br><br><span class="hljs-keyword">const</span> result1 = <span class="hljs-title function_">count</span>(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result1);<br><span class="hljs-keyword">const</span> result2 = <span class="hljs-title function_">sum</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result2);<br><span class="hljs-comment">// 添加promise代码</span><br><span class="hljs-keyword">const</span> promise = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>();<br>promise.<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;hello promise&quot;</span>);<br>&#125;);<br></code></pre></td></tr></table></figure><ul><li>babel.config.js</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-comment">// 智能预设：能够编译ES6语法</span><br>  <span class="hljs-attr">presets</span>: [<br>    [<br>      <span class="hljs-string">&quot;@babel/preset-env&quot;</span>,<br>      <span class="hljs-comment">// 按需加载core-js的polyfill</span><br>      &#123; <span class="hljs-attr">useBuiltIns</span>: <span class="hljs-string">&quot;usage&quot;</span>, <span class="hljs-attr">corejs</span>: &#123; <span class="hljs-attr">version</span>: <span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-attr">proposals</span>: <span class="hljs-literal">true</span> &#125; &#125;,<br>    ],<br>  ],<br>&#125;;<br></code></pre></td></tr></table></figure></li></ul><p>此时就会自动根据我们代码中使用的语法，来按需加载相应的 <code>polyfill</code> 了</p><h3 id="PWA"><a href="#PWA" class="headerlink" title="PWA"></a>PWA</h3><h4 id="为什么-3"><a href="#为什么-3" class="headerlink" title="为什么"></a>为什么</h4><p>开发 Web App 项目，项目一旦处于网络离线情况，就没法访问了。</p><p>我们希望给项目提供离线体验。</p><h4 id="是什么-3"><a href="#是什么-3" class="headerlink" title="是什么"></a>是什么</h4><p>渐进式网络应用程序(progressive web application - PWA)：是一种可以提供类似于 native app(原生应用程序) 体验的 Web App 的技术。</p><p>其中最重要的是，在 <strong>离线(offline)</strong> 时应用程序能够继续运行功能。</p><p>内部通过 Service Workers 技术实现的。</p><h4 id="怎么用-3"><a href="#怎么用-3" class="headerlink" title="怎么用"></a>怎么用</h4><p>1、下载包</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">npm i workbox-webpack-plugin -D<br></code></pre></td></tr></table></figure><p>2、修改配置文件</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> os = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;os&quot;</span>);<br><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;path&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">ESLintWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;eslint-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;html-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">MiniCssExtractPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;mini-css-extract-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">CssMinimizerPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;css-minimizer-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">TerserPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;terser-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">ImageMinimizerPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;image-minimizer-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">PreloadWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@vue/preload-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">WorkboxPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;workbox-webpack-plugin&quot;</span>);<br><br><span class="hljs-comment">// cpu核数</span><br><span class="hljs-keyword">const</span> threads = os.<span class="hljs-title function_">cpus</span>().<span class="hljs-property">length</span>;<br><br><span class="hljs-comment">// 获取处理样式的Loaders</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">getStyleLoaders</span> = (<span class="hljs-params">preProcessor</span>) =&gt; &#123;<br>  <span class="hljs-keyword">return</span> [<br>    <span class="hljs-title class_">MiniCssExtractPlugin</span>.<span class="hljs-property">loader</span>,<br>    <span class="hljs-string">&quot;css-loader&quot;</span>,<br>    &#123;<br>      <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;postcss-loader&quot;</span>,<br>      <span class="hljs-attr">options</span>: &#123;<br>        <span class="hljs-attr">postcssOptions</span>: &#123;<br>          <span class="hljs-attr">plugins</span>: [<br>            <span class="hljs-string">&quot;postcss-preset-env&quot;</span>, <span class="hljs-comment">// 能解决大多数样式兼容性问题</span><br>          ],<br>        &#125;,<br>      &#125;,<br>    &#125;,<br>    preProcessor,<br>  ].<span class="hljs-title function_">filter</span>(<span class="hljs-title class_">Boolean</span>);<br>&#125;;<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">entry</span>: <span class="hljs-string">&quot;./src/main.js&quot;</span>,<br>  <span class="hljs-attr">output</span>: &#123;<br>    <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../dist&quot;</span>), <span class="hljs-comment">// 生产模式需要输出</span><br>    <span class="hljs-comment">// [contenthash:8]使用contenthash，取8位长度</span><br>    <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;static/js/[name].[contenthash:8].js&quot;</span>, <span class="hljs-comment">// 入口文件打包输出资源命名方式</span><br>    <span class="hljs-attr">chunkFilename</span>: <span class="hljs-string">&quot;static/js/[name].[contenthash:8].chunk.js&quot;</span>, <span class="hljs-comment">// 动态导入输出资源命名方式</span><br>    <span class="hljs-attr">assetModuleFilename</span>: <span class="hljs-string">&quot;static/media/[name].[hash][ext]&quot;</span>, <span class="hljs-comment">// 图片、字体等资源命名方式（注意用hash）</span><br>    <span class="hljs-attr">clean</span>: <span class="hljs-literal">true</span>,<br>  &#125;,<br>  <span class="hljs-attr">module</span>: &#123;<br>    <span class="hljs-attr">rules</span>: [<br>      &#123;<br>        <span class="hljs-attr">oneOf</span>: [<br>          &#123;<br>            <span class="hljs-comment">// 用来匹配 .css 结尾的文件</span><br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.css$/</span>,<br>            <span class="hljs-comment">// use 数组里面 Loader 执行顺序是从右到左</span><br>            <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(),<br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.less$/</span>,<br>            <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(<span class="hljs-string">&quot;less-loader&quot;</span>),<br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.s[ac]ss$/</span>,<br>            <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(<span class="hljs-string">&quot;sass-loader&quot;</span>),<br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.styl$/</span>,<br>            <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(<span class="hljs-string">&quot;stylus-loader&quot;</span>),<br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(png|jpe?g|gif|svg)$/</span>,<br>            <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;asset&quot;</span>,<br>            <span class="hljs-attr">parser</span>: &#123;<br>              <span class="hljs-attr">dataUrlCondition</span>: &#123;<br>                <span class="hljs-attr">maxSize</span>: <span class="hljs-number">10</span> * <span class="hljs-number">1024</span>, <span class="hljs-comment">// 小于10kb的图片会被base64处理</span><br>              &#125;,<br>            &#125;,<br>            <span class="hljs-comment">// generator: &#123;</span><br>            <span class="hljs-comment">//   // 将图片文件输出到 static/imgs 目录中</span><br>            <span class="hljs-comment">//   // 将图片文件命名 [hash:8][ext][query]</span><br>            <span class="hljs-comment">//   // [hash:8]: hash值取8位</span><br>            <span class="hljs-comment">//   // [ext]: 使用之前的文件扩展名</span><br>            <span class="hljs-comment">//   // [query]: 添加之前的query参数</span><br>            <span class="hljs-comment">//   filename: &quot;static/imgs/[hash:8][ext][query]&quot;,</span><br>            <span class="hljs-comment">// &#125;,</span><br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(ttf|woff2?)$/</span>,<br>            <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;asset/resource&quot;</span>,<br>            <span class="hljs-comment">// generator: &#123;</span><br>            <span class="hljs-comment">//   filename: &quot;static/media/[hash:8][ext][query]&quot;,</span><br>            <span class="hljs-comment">// &#125;,</span><br>          &#125;,<br>          &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.js$/</span>,<br>            <span class="hljs-comment">// exclude: /node_modules/, // 排除node_modules代码不编译</span><br>            <span class="hljs-attr">include</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../src&quot;</span>), <span class="hljs-comment">// 也可以用包含</span><br>            <span class="hljs-attr">use</span>: [<br>              &#123;<br>                <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;thread-loader&quot;</span>, <span class="hljs-comment">// 开启多进程</span><br>                <span class="hljs-attr">options</span>: &#123;<br>                  <span class="hljs-attr">workers</span>: threads, <span class="hljs-comment">// 数量</span><br>                &#125;,<br>              &#125;,<br>              &#123;<br>                <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;babel-loader&quot;</span>,<br>                <span class="hljs-attr">options</span>: &#123;<br>                  <span class="hljs-attr">cacheDirectory</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 开启babel编译缓存</span><br>                  <span class="hljs-attr">cacheCompression</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// 缓存文件不要压缩</span><br>                  <span class="hljs-attr">plugins</span>: [<span class="hljs-string">&quot;@babel/plugin-transform-runtime&quot;</span>], <span class="hljs-comment">// 减少代码体积</span><br>                &#125;,<br>              &#125;,<br>            ],<br>          &#125;,<br>        ],<br>      &#125;,<br>    ],<br>  &#125;,<br>  <span class="hljs-attr">plugins</span>: [<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">ESLintWebpackPlugin</span>(&#123;<br>      <span class="hljs-comment">// 指定检查文件的根目录</span><br>      <span class="hljs-attr">context</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../src&quot;</span>),<br>      <span class="hljs-attr">exclude</span>: <span class="hljs-string">&quot;node_modules&quot;</span>, <span class="hljs-comment">// 默认值</span><br>      <span class="hljs-attr">cache</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 开启缓存</span><br>      <span class="hljs-comment">// 缓存目录</span><br>      <span class="hljs-attr">cacheLocation</span>: path.<span class="hljs-title function_">resolve</span>(<br>        __dirname,<br>        <span class="hljs-string">&quot;../node_modules/.cache/.eslintcache&quot;</span><br>      ),<br>      threads, <span class="hljs-comment">// 开启多进程</span><br>    &#125;),<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(&#123;<br>      <span class="hljs-comment">// 以 public/index.html 为模板创建文件</span><br>      <span class="hljs-comment">// 新的html文件有两个特点：1. 内容和源文件一致 2. 自动引入打包生成的js等资源</span><br>      <span class="hljs-attr">template</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../public/index.html&quot;</span>),<br>    &#125;),<br>    <span class="hljs-comment">// 提取css成单独文件</span><br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">MiniCssExtractPlugin</span>(&#123;<br>      <span class="hljs-comment">// 定义输出文件名和目录</span><br>      <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;static/css/[name].[contenthash:8].css&quot;</span>,<br>      <span class="hljs-attr">chunkFilename</span>: <span class="hljs-string">&quot;static/css/[name].[contenthash:8].chunk.css&quot;</span>,<br>    &#125;),<br>    <span class="hljs-comment">// css压缩</span><br>    <span class="hljs-comment">// new CssMinimizerPlugin(),</span><br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">PreloadWebpackPlugin</span>(&#123;<br>      <span class="hljs-attr">rel</span>: <span class="hljs-string">&quot;preload&quot;</span>, <span class="hljs-comment">// preload兼容性更好</span><br>      <span class="hljs-attr">as</span>: <span class="hljs-string">&quot;script&quot;</span>,<br>      <span class="hljs-comment">// rel: &#x27;prefetch&#x27; // prefetch兼容性更差</span><br>    &#125;),<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">WorkboxPlugin</span>.<span class="hljs-title class_">GenerateSW</span>(&#123;<br>      <span class="hljs-comment">// 这些选项帮助快速启用 ServiceWorkers</span><br>      <span class="hljs-comment">// 不允许遗留任何“旧的” ServiceWorkers</span><br>      <span class="hljs-attr">clientsClaim</span>: <span class="hljs-literal">true</span>,<br>      <span class="hljs-attr">skipWaiting</span>: <span class="hljs-literal">true</span>,<br>    &#125;),<br>  ],<br>  <span class="hljs-attr">optimization</span>: &#123;<br>    <span class="hljs-attr">minimizer</span>: [<br>      <span class="hljs-comment">// css压缩也可以写到optimization.minimizer里面，效果一样的</span><br>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">CssMinimizerPlugin</span>(),<br>      <span class="hljs-comment">// 当生产模式会默认开启TerserPlugin，但是我们需要进行其他配置，就要重新写了</span><br>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">TerserPlugin</span>(&#123;<br>        <span class="hljs-attr">parallel</span>: threads, <span class="hljs-comment">// 开启多进程</span><br>      &#125;),<br>      <span class="hljs-comment">// 压缩图片</span><br>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImageMinimizerPlugin</span>(&#123;<br>        <span class="hljs-attr">minimizer</span>: &#123;<br>          <span class="hljs-attr">implementation</span>: <span class="hljs-title class_">ImageMinimizerPlugin</span>.<span class="hljs-property">imageminGenerate</span>,<br>          <span class="hljs-attr">options</span>: &#123;<br>            <span class="hljs-attr">plugins</span>: [<br>              [<span class="hljs-string">&quot;gifsicle&quot;</span>, &#123; <span class="hljs-attr">interlaced</span>: <span class="hljs-literal">true</span> &#125;],<br>              [<span class="hljs-string">&quot;jpegtran&quot;</span>, &#123; <span class="hljs-attr">progressive</span>: <span class="hljs-literal">true</span> &#125;],<br>              [<span class="hljs-string">&quot;optipng&quot;</span>, &#123; <span class="hljs-attr">optimizationLevel</span>: <span class="hljs-number">5</span> &#125;],<br>              [<br>                <span class="hljs-string">&quot;svgo&quot;</span>,<br>                &#123;<br>                  <span class="hljs-attr">plugins</span>: [<br>                    <span class="hljs-string">&quot;preset-default&quot;</span>,<br>                    <span class="hljs-string">&quot;prefixIds&quot;</span>,<br>                    &#123;<br>                      <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;sortAttrs&quot;</span>,<br>                      <span class="hljs-attr">params</span>: &#123;<br>                        <span class="hljs-attr">xmlnsOrder</span>: <span class="hljs-string">&quot;alphabetical&quot;</span>,<br>                      &#125;,<br>                    &#125;,<br>                  ],<br>                &#125;,<br>              ],<br>            ],<br>          &#125;,<br>        &#125;,<br>      &#125;),<br>    ],<br>    <span class="hljs-comment">// 代码分割配置</span><br>    <span class="hljs-attr">splitChunks</span>: &#123;<br>      <span class="hljs-attr">chunks</span>: <span class="hljs-string">&quot;all&quot;</span>, <span class="hljs-comment">// 对所有模块都进行分割</span><br>      <span class="hljs-comment">// 其他内容用默认配置即可</span><br>    &#125;,<br>  &#125;,<br>  <span class="hljs-comment">// devServer: &#123;</span><br>  <span class="hljs-comment">//   host: &quot;localhost&quot;, // 启动服务器域名</span><br>  <span class="hljs-comment">//   port: &quot;3000&quot;, // 启动服务器端口号</span><br>  <span class="hljs-comment">//   open: true, // 是否自动打开浏览器</span><br>  <span class="hljs-comment">// &#125;,</span><br>  <span class="hljs-attr">mode</span>: <span class="hljs-string">&quot;production&quot;</span>,<br>  <span class="hljs-attr">devtool</span>: <span class="hljs-string">&quot;source-map&quot;</span>,<br>&#125;;<br></code></pre></td></tr></table></figure><p>3、修改 main.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> count <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./js/count&quot;</span>;<br><span class="hljs-keyword">import</span> sum <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./js/sum&quot;</span>;<br><span class="hljs-comment">// 引入资源，Webpack才会对其打包</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./css/iconfont.css&quot;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./css/index.css&quot;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./less/index.less&quot;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./sass/index.sass&quot;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./sass/index.scss&quot;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./styl/index.styl&quot;</span>;<br><br><span class="hljs-keyword">const</span> result1 = <span class="hljs-title function_">count</span>(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result1);<br><span class="hljs-keyword">const</span> result2 = <span class="hljs-title function_">sum</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result2);<br><span class="hljs-comment">// 添加promise代码</span><br><span class="hljs-keyword">const</span> promise = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>();<br>promise.<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;hello promise&quot;</span>);<br>&#125;);<br><br><span class="hljs-keyword">const</span> arr = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr.<span class="hljs-title function_">includes</span>(<span class="hljs-number">5</span>));<br><br><span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;serviceWorker&quot;</span> <span class="hljs-keyword">in</span> navigator) &#123;<br>  <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;load&quot;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>    navigator.<span class="hljs-property">serviceWorker</span><br>      .<span class="hljs-title function_">register</span>(<span class="hljs-string">&quot;/service-worker.js&quot;</span>)<br>      .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">registration</span>) =&gt;</span> &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;SW registered: &quot;</span>, registration);<br>      &#125;)<br>      .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">registrationError</span>) =&gt;</span> &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;SW registration failed: &quot;</span>, registrationError);<br>      &#125;);<br>  &#125;);<br>&#125;<br></code></pre></td></tr></table></figure><p>4、运行指令</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">npm run build<br></code></pre></td></tr></table></figure><p>此时如果直接通过 VSCode 访问打包后页面，在浏览器控制台会发现 <code>SW registration failed</code>。</p><p>因为我们打开的访问路径是：<code>http://127.0.0.1:5500/dist/index.html</code>。此时页面会去请求 <code>service-worker.js</code> 文件，请求路径是：<code>http://127.0.0.1:5500/service-worker.js</code>，这样找不到会 404。</p><p>实际 <code>service-worker.js</code> 文件路径是：<code>http://127.0.0.1:5500/dist/service-worker.js</code>。</p><p>5、解决路径问题</p><ul><li>下载包</li></ul><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">npm i serve -g<br></code></pre></td></tr></table></figure><p>serve 也是用来启动开发服务器来部署代码查看效果的。</p><ul><li>运行指令</li></ul><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">serve dist<br></code></pre></td></tr></table></figure><p>此时通过 serve 启动的服务器我们 service-worker 就能注册成功了。</p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>我们从 4 个角度对 webpack 和代码进行了优化：</p><ol><li>提升开发体验</li></ol><ul><li>使用 <code>Source Map</code> 让开发或上线时代码报错能有更加准确的错误提示。</li></ul><ol><li>提升 webpack 提升打包构建速度</li></ol><ul><li>使用 <code>HotModuleReplacement</code> 让开发时只重新编译打包更新变化了的代码，不变的代码使用缓存，从而使更新速度更快。</li><li>使用 <code>OneOf</code> 让资源文件一旦被某个 loader 处理了，就不会继续遍历了，打包速度更快。</li><li>使用 <code>Include/Exclude</code> 排除或只检测某些文件，处理的文件更少，速度更快。</li><li>使用 <code>Cache</code> 对 eslint 和 babel 处理的结果进行缓存，让第二次打包速度更快。</li><li>使用 <code>Thead</code> 多进程处理 eslint 和 babel 任务，速度更快。（需要注意的是，进程启动通信都有开销的，要在比较多代码处理时使用才有效果）</li></ul><ol><li>减少代码体积</li></ol><ul><li>使用 <code>Tree Shaking</code> 剔除了没有使用的多余代码，让代码体积更小。</li><li>使用 <code>@babel/plugin-transform-runtime</code> 插件对 babel 进行处理，让辅助代码从中引入，而不是每个文件都生成辅助代码，从而体积更小。</li><li>使用 <code>Image Minimizer</code> 对项目中图片进行压缩，体积更小，请求速度更快。（需要注意的是，如果项目中图片都是在线链接，那么就不需要了。本地项目静态图片才需要进行压缩。）</li></ul><ol><li>优化代码运行性能</li></ol><ul><li>使用 <code>Code Split</code> 对代码进行分割成多个 js 文件，从而使单个文件体积更小，并行加载 js 速度更快。并通过 import 动态导入语法进行按需加载，从而达到需要使用时才加载该资源，不用时不加载资源。</li><li>使用 <code>Preload / Prefetch</code> 对代码进行提前加载，等未来需要使用时就能直接使用，从而用户体验更好。</li><li>使用 <code>Network Cache</code> 能对输出资源文件进行更好的命名，将来好做缓存，从而用户体验更好。</li><li>使用 <code>Core-js</code> 对 js 进行兼容性处理，让我们代码能运行在低版本浏览器。</li><li>使用 <code>PWA</code> 能让代码离线也能访问，从而提升用户体验。</li></ul><h1 id="项目"><a href="#项目" class="headerlink" title="项目"></a>项目</h1><h2 id="Vue-脚手架"><a href="#Vue-脚手架" class="headerlink" title="Vue 脚手架"></a>Vue 脚手架</h2><h3 id="开发模式配置"><a href="#开发模式配置" class="headerlink" title="开发模式配置"></a>开发模式配置</h3><ul><li>webpack.dev.js</li></ul><p>下载包</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arduino">npm install -D vue-loader vue-<span class="hljs-keyword">template</span>-compiler<br></code></pre></td></tr></table></figure><p><strong>webpack.config.js</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> &#123; <span class="hljs-title class_">VueLoaderPlugin</span> &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;vue-loader&#x27;</span>)<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">module</span>: &#123;<br>    <span class="hljs-attr">rules</span>: [<br>      <span class="hljs-comment">// ... 其它规则</span><br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.vue$/</span>,<br>        <span class="hljs-attr">loader</span>: <span class="hljs-string">&#x27;vue-loader&#x27;</span><br>      &#125;<br>    ]<br>  &#125;,<br>  <span class="hljs-attr">plugins</span>: [<br>    <span class="hljs-comment">// 请确保引入这个插件！</span><br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">VueLoaderPlugin</span>()<br>  ]<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="开发模式配置-1"><a href="#开发模式配置-1" class="headerlink" title="开发模式配置"></a>开发模式配置</h3><ul><li>webpack.dev.js</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;path&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">ESLintWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;eslint-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;html-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> &#123; <span class="hljs-title class_">VueLoaderPlugin</span> &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;vue-loader&quot;</span>);<br><span class="hljs-keyword">const</span> &#123; <span class="hljs-title class_">DefinePlugin</span> &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;webpack&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">CopyPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;copy-webpack-plugin&quot;</span>);<br><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">getStyleLoaders</span> = (<span class="hljs-params">preProcessor</span>) =&gt; &#123;<br>  <span class="hljs-keyword">return</span> [<br>    <span class="hljs-string">&quot;vue-style-loader&quot;</span>,<br>    <span class="hljs-string">&quot;css-loader&quot;</span>,<br>    &#123;<br>      <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;postcss-loader&quot;</span>,<br>      <span class="hljs-attr">options</span>: &#123;<br>        <span class="hljs-attr">postcssOptions</span>: &#123;<br>          <span class="hljs-attr">plugins</span>: [<br>            <span class="hljs-string">&quot;postcss-preset-env&quot;</span>, <span class="hljs-comment">// 能解决大多数样式兼容性问题</span><br>          ],<br>        &#125;,<br>      &#125;,<br>    &#125;,<br>    preProcessor,<br>  ].<span class="hljs-title function_">filter</span>(<span class="hljs-title class_">Boolean</span>);<br>&#125;;<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">entry</span>: <span class="hljs-string">&quot;./src/main.js&quot;</span>,<br>  <span class="hljs-attr">output</span>: &#123;<br>    <span class="hljs-attr">path</span>: <span class="hljs-literal">undefined</span>,<br>    <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;static/js/[name].js&quot;</span>,<br>    <span class="hljs-attr">chunkFilename</span>: <span class="hljs-string">&quot;static/js/[name].chunk.js&quot;</span>,<br>    <span class="hljs-attr">assetModuleFilename</span>: <span class="hljs-string">&quot;static/js/[hash:10][ext][query]&quot;</span>,<br>  &#125;,<br>  <span class="hljs-attr">module</span>: &#123;<br>    <span class="hljs-attr">rules</span>: [<br>      &#123;<br>        <span class="hljs-comment">// 用来匹配 .css 结尾的文件</span><br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.css$/</span>,<br>        <span class="hljs-comment">// use 数组里面 Loader 执行顺序是从右到左</span><br>        <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(),<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.less$/</span>,<br>        <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(<span class="hljs-string">&quot;less-loader&quot;</span>),<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.s[ac]ss$/</span>,<br>        <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(<span class="hljs-string">&quot;sass-loader&quot;</span>),<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.styl$/</span>,<br>        <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(<span class="hljs-string">&quot;stylus-loader&quot;</span>),<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(png|jpe?g|gif|svg)$/</span>,<br>        <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;asset&quot;</span>,<br>        <span class="hljs-attr">parser</span>: &#123;<br>          <span class="hljs-attr">dataUrlCondition</span>: &#123;<br>            <span class="hljs-attr">maxSize</span>: <span class="hljs-number">10</span> * <span class="hljs-number">1024</span>, <span class="hljs-comment">// 小于10kb的图片会被base64处理</span><br>          &#125;,<br>        &#125;,<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(ttf|woff2?)$/</span>,<br>        <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;asset/resource&quot;</span>,<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(jsx|js)$/</span>,<br>        <span class="hljs-attr">include</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../src&quot;</span>),<br>        <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;babel-loader&quot;</span>,<br>        <span class="hljs-attr">options</span>: &#123;<br>          <span class="hljs-attr">cacheDirectory</span>: <span class="hljs-literal">true</span>,<br>          <span class="hljs-attr">cacheCompression</span>: <span class="hljs-literal">false</span>,<br>          <span class="hljs-attr">plugins</span>: [<br>            <span class="hljs-comment">// &quot;@babel/plugin-transform-runtime&quot; // presets中包含了</span><br>          ],<br>        &#125;,<br>      &#125;,<br>      <span class="hljs-comment">// vue-loader不支持oneOf</span><br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.vue$/</span>,<br>        <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;vue-loader&quot;</span>, <span class="hljs-comment">// 内部会给vue文件注入HMR功能代码</span><br>        <span class="hljs-attr">options</span>: &#123;<br>          <span class="hljs-comment">// 开启缓存</span><br>          <span class="hljs-attr">cacheDirectory</span>: path.<span class="hljs-title function_">resolve</span>(<br>            __dirname,<br>            <span class="hljs-string">&quot;node_modules/.cache/vue-loader&quot;</span><br>          ),<br>        &#125;,<br>      &#125;,<br>    ],<br>  &#125;,<br>  <span class="hljs-attr">plugins</span>: [<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">ESLintWebpackPlugin</span>(&#123;<br>      <span class="hljs-attr">context</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../src&quot;</span>),<br>      <span class="hljs-attr">exclude</span>: <span class="hljs-string">&quot;node_modules&quot;</span>,<br>      <span class="hljs-attr">cache</span>: <span class="hljs-literal">true</span>,<br>      <span class="hljs-attr">cacheLocation</span>: path.<span class="hljs-title function_">resolve</span>(<br>        __dirname,<br>        <span class="hljs-string">&quot;../node_modules/.cache/.eslintcache&quot;</span><br>      ),<br>    &#125;),<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(&#123;<br>      <span class="hljs-attr">template</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../public/index.html&quot;</span>),<br>    &#125;),<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">CopyPlugin</span>(&#123;<br>      <span class="hljs-attr">patterns</span>: [<br>        &#123;<br>          <span class="hljs-attr">from</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../public&quot;</span>),<br>          <span class="hljs-attr">to</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../dist&quot;</span>),<br>          <span class="hljs-attr">toType</span>: <span class="hljs-string">&quot;dir&quot;</span>,<br>          <span class="hljs-attr">noErrorOnMissing</span>: <span class="hljs-literal">true</span>,<br>          <span class="hljs-attr">globOptions</span>: &#123;<br>            <span class="hljs-attr">ignore</span>: [<span class="hljs-string">&quot;**/index.html&quot;</span>],<br>          &#125;,<br>          <span class="hljs-attr">info</span>: &#123;<br>            <span class="hljs-attr">minimized</span>: <span class="hljs-literal">true</span>,<br>          &#125;,<br>        &#125;,<br>      ],<br>    &#125;),<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">VueLoaderPlugin</span>(),<br>    <span class="hljs-comment">// 解决页面警告</span><br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">DefinePlugin</span>(&#123;<br>      <span class="hljs-attr">__VUE_OPTIONS_API__</span>: <span class="hljs-string">&quot;true&quot;</span>,<br>      <span class="hljs-attr">__VUE_PROD_DEVTOOLS__</span>: <span class="hljs-string">&quot;false&quot;</span>,<br>    &#125;),<br>  ],<br>  <span class="hljs-attr">optimization</span>: &#123;<br>    <span class="hljs-attr">splitChunks</span>: &#123;<br>      <span class="hljs-attr">chunks</span>: <span class="hljs-string">&quot;all&quot;</span>,<br>    &#125;,<br>    <span class="hljs-attr">runtimeChunk</span>: &#123;<br>      <span class="hljs-attr">name</span>: <span class="hljs-function">(<span class="hljs-params">entrypoint</span>) =&gt;</span> <span class="hljs-string">`runtime~<span class="hljs-subst">$&#123;entrypoint.name&#125;</span>`</span>,<br>    &#125;,<br>  &#125;,<br>  <span class="hljs-attr">resolve</span>: &#123;<br>    <span class="hljs-attr">extensions</span>: [<span class="hljs-string">&quot;.vue&quot;</span>, <span class="hljs-string">&quot;.js&quot;</span>, <span class="hljs-string">&quot;.json&quot;</span>], <span class="hljs-comment">// 自动补全文件扩展名，让vue可以使用</span><br>  &#125;,<br>  <span class="hljs-attr">devServer</span>: &#123;<br>    <span class="hljs-attr">open</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">host</span>: <span class="hljs-string">&quot;localhost&quot;</span>,<br>    <span class="hljs-attr">port</span>: <span class="hljs-number">3000</span>,<br>    <span class="hljs-attr">hot</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">compress</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">historyApiFallback</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 解决vue-router刷新404问题</span><br>  &#125;,<br>  <span class="hljs-attr">mode</span>: <span class="hljs-string">&quot;development&quot;</span>,<br>  <span class="hljs-attr">devtool</span>: <span class="hljs-string">&quot;cheap-module-source-map&quot;</span>,<br>&#125;;<br></code></pre></td></tr></table></figure><h3 id="生产模式配置"><a href="#生产模式配置" class="headerlink" title="生产模式配置"></a>生产模式配置</h3><ul><li>webpack.prod.js</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;path&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">ESLintWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;eslint-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;html-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">MiniCssExtractPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;mini-css-extract-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">CssMinimizerPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;css-minimizer-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">TerserWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;terser-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">ImageMinimizerPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;image-minimizer-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> &#123; <span class="hljs-title class_">VueLoaderPlugin</span> &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;vue-loader&quot;</span>);<br><span class="hljs-keyword">const</span> &#123; <span class="hljs-title class_">DefinePlugin</span> &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;webpack&quot;</span>);<br><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">getStyleLoaders</span> = (<span class="hljs-params">preProcessor</span>) =&gt; &#123;<br>  <span class="hljs-keyword">return</span> [<br>    <span class="hljs-title class_">MiniCssExtractPlugin</span>.<span class="hljs-property">loader</span>,<br>    <span class="hljs-string">&quot;css-loader&quot;</span>,<br>    &#123;<br>      <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;postcss-loader&quot;</span>,<br>      <span class="hljs-attr">options</span>: &#123;<br>        <span class="hljs-attr">postcssOptions</span>: &#123;<br>          <span class="hljs-attr">plugins</span>: [<br>            <span class="hljs-string">&quot;postcss-preset-env&quot;</span>, <span class="hljs-comment">// 能解决大多数样式兼容性问题</span><br>          ],<br>        &#125;,<br>      &#125;,<br>    &#125;,<br>    preProcessor,<br>  ].<span class="hljs-title function_">filter</span>(<span class="hljs-title class_">Boolean</span>);<br>&#125;;<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">entry</span>: <span class="hljs-string">&quot;./src/main.js&quot;</span>,<br>  <span class="hljs-attr">output</span>: &#123;<br>    <span class="hljs-attr">path</span>: <span class="hljs-literal">undefined</span>,<br>    <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;static/js/[name].[contenthash:10].js&quot;</span>,<br>    <span class="hljs-attr">chunkFilename</span>: <span class="hljs-string">&quot;static/js/[name].[contenthash:10].chunk.js&quot;</span>,<br>    <span class="hljs-attr">assetModuleFilename</span>: <span class="hljs-string">&quot;static/js/[hash:10][ext][query]&quot;</span>,<br>    <span class="hljs-attr">clean</span>: <span class="hljs-literal">true</span>,<br>  &#125;,<br>  <span class="hljs-attr">module</span>: &#123;<br>    <span class="hljs-attr">rules</span>: [<br>      &#123;<br>        <span class="hljs-comment">// 用来匹配 .css 结尾的文件</span><br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.css$/</span>,<br>        <span class="hljs-comment">// use 数组里面 Loader 执行顺序是从右到左</span><br>        <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(),<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.less$/</span>,<br>        <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(<span class="hljs-string">&quot;less-loader&quot;</span>),<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.s[ac]ss$/</span>,<br>        <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(<span class="hljs-string">&quot;sass-loader&quot;</span>),<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.styl$/</span>,<br>        <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(<span class="hljs-string">&quot;stylus-loader&quot;</span>),<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(png|jpe?g|gif|svg)$/</span>,<br>        <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;asset&quot;</span>,<br>        <span class="hljs-attr">parser</span>: &#123;<br>          <span class="hljs-attr">dataUrlCondition</span>: &#123;<br>            <span class="hljs-attr">maxSize</span>: <span class="hljs-number">10</span> * <span class="hljs-number">1024</span>, <span class="hljs-comment">// 小于10kb的图片会被base64处理</span><br>          &#125;,<br>        &#125;,<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(ttf|woff2?)$/</span>,<br>        <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;asset/resource&quot;</span>,<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(jsx|js)$/</span>,<br>        <span class="hljs-attr">include</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../src&quot;</span>),<br>        <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;babel-loader&quot;</span>,<br>        <span class="hljs-attr">options</span>: &#123;<br>          <span class="hljs-attr">cacheDirectory</span>: <span class="hljs-literal">true</span>,<br>          <span class="hljs-attr">cacheCompression</span>: <span class="hljs-literal">false</span>,<br>          <span class="hljs-attr">plugins</span>: [<br>            <span class="hljs-comment">// &quot;@babel/plugin-transform-runtime&quot; // presets中包含了</span><br>          ],<br>        &#125;,<br>      &#125;,<br>      <span class="hljs-comment">// vue-loader不支持oneOf</span><br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.vue$/</span>,<br>        <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;vue-loader&quot;</span>, <span class="hljs-comment">// 内部会给vue文件注入HMR功能代码</span><br>        <span class="hljs-attr">options</span>: &#123;<br>          <span class="hljs-comment">// 开启缓存</span><br>          <span class="hljs-attr">cacheDirectory</span>: path.<span class="hljs-title function_">resolve</span>(<br>            __dirname,<br>            <span class="hljs-string">&quot;node_modules/.cache/vue-loader&quot;</span><br>          ),<br>        &#125;,<br>      &#125;,<br>    ],<br>  &#125;,<br>  <span class="hljs-attr">plugins</span>: [<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">ESLintWebpackPlugin</span>(&#123;<br>      <span class="hljs-attr">context</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../src&quot;</span>),<br>      <span class="hljs-attr">exclude</span>: <span class="hljs-string">&quot;node_modules&quot;</span>,<br>      <span class="hljs-attr">cache</span>: <span class="hljs-literal">true</span>,<br>      <span class="hljs-attr">cacheLocation</span>: path.<span class="hljs-title function_">resolve</span>(<br>        __dirname,<br>        <span class="hljs-string">&quot;../node_modules/.cache/.eslintcache&quot;</span><br>      ),<br>    &#125;),<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(&#123;<br>      <span class="hljs-attr">template</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../public/index.html&quot;</span>),<br>    &#125;),<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">CopyPlugin</span>(&#123;<br>      <span class="hljs-attr">patterns</span>: [<br>        &#123;<br>          <span class="hljs-attr">from</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../public&quot;</span>),<br>          <span class="hljs-attr">to</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../dist&quot;</span>),<br>          <span class="hljs-attr">toType</span>: <span class="hljs-string">&quot;dir&quot;</span>,<br>          <span class="hljs-attr">noErrorOnMissing</span>: <span class="hljs-literal">true</span>,<br>          <span class="hljs-attr">globOptions</span>: &#123;<br>            <span class="hljs-attr">ignore</span>: [<span class="hljs-string">&quot;**/index.html&quot;</span>],<br>          &#125;,<br>          <span class="hljs-attr">info</span>: &#123;<br>            <span class="hljs-attr">minimized</span>: <span class="hljs-literal">true</span>,<br>          &#125;,<br>        &#125;,<br>      ],<br>    &#125;),<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">MiniCssExtractPlugin</span>(&#123;<br>      <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;static/css/[name].[contenthash:10].css&quot;</span>,<br>      <span class="hljs-attr">chunkFilename</span>: <span class="hljs-string">&quot;static/css/[name].[contenthash:10].chunk.css&quot;</span>,<br>    &#125;),<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">VueLoaderPlugin</span>(),<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">DefinePlugin</span>(&#123;<br>      <span class="hljs-attr">__VUE_OPTIONS_API__</span>: <span class="hljs-string">&quot;true&quot;</span>,<br>      <span class="hljs-attr">__VUE_PROD_DEVTOOLS__</span>: <span class="hljs-string">&quot;false&quot;</span>,<br>    &#125;),<br>  ],<br>  <span class="hljs-attr">optimization</span>: &#123;<br>    <span class="hljs-comment">// 压缩的操作</span><br>    <span class="hljs-attr">minimizer</span>: [<br>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">CssMinimizerPlugin</span>(),<br>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">TerserWebpackPlugin</span>(),<br>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImageMinimizerPlugin</span>(&#123;<br>        <span class="hljs-attr">minimizer</span>: &#123;<br>          <span class="hljs-attr">implementation</span>: <span class="hljs-title class_">ImageMinimizerPlugin</span>.<span class="hljs-property">imageminGenerate</span>,<br>          <span class="hljs-attr">options</span>: &#123;<br>            <span class="hljs-attr">plugins</span>: [<br>              [<span class="hljs-string">&quot;gifsicle&quot;</span>, &#123; <span class="hljs-attr">interlaced</span>: <span class="hljs-literal">true</span> &#125;],<br>              [<span class="hljs-string">&quot;jpegtran&quot;</span>, &#123; <span class="hljs-attr">progressive</span>: <span class="hljs-literal">true</span> &#125;],<br>              [<span class="hljs-string">&quot;optipng&quot;</span>, &#123; <span class="hljs-attr">optimizationLevel</span>: <span class="hljs-number">5</span> &#125;],<br>              [<br>                <span class="hljs-string">&quot;svgo&quot;</span>,<br>                &#123;<br>                  <span class="hljs-attr">plugins</span>: [<br>                    <span class="hljs-string">&quot;preset-default&quot;</span>,<br>                    <span class="hljs-string">&quot;prefixIds&quot;</span>,<br>                    &#123;<br>                      <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;sortAttrs&quot;</span>,<br>                      <span class="hljs-attr">params</span>: &#123;<br>                        <span class="hljs-attr">xmlnsOrder</span>: <span class="hljs-string">&quot;alphabetical&quot;</span>,<br>                      &#125;,<br>                    &#125;,<br>                  ],<br>                &#125;,<br>              ],<br>            ],<br>          &#125;,<br>        &#125;,<br>      &#125;),<br>    ],<br>    <span class="hljs-attr">splitChunks</span>: &#123;<br>      <span class="hljs-attr">chunks</span>: <span class="hljs-string">&quot;all&quot;</span>,<br>    &#125;,<br>    <span class="hljs-attr">runtimeChunk</span>: &#123;<br>      <span class="hljs-attr">name</span>: <span class="hljs-function">(<span class="hljs-params">entrypoint</span>) =&gt;</span> <span class="hljs-string">`runtime~<span class="hljs-subst">$&#123;entrypoint.name&#125;</span>`</span>,<br>    &#125;,<br>  &#125;,<br>  <span class="hljs-attr">resolve</span>: &#123;<br>    <span class="hljs-attr">extensions</span>: [<span class="hljs-string">&quot;.vue&quot;</span>, <span class="hljs-string">&quot;.js&quot;</span>, <span class="hljs-string">&quot;.json&quot;</span>],<br>  &#125;,<br>  <span class="hljs-attr">mode</span>: <span class="hljs-string">&quot;production&quot;</span>,<br>  <span class="hljs-attr">devtool</span>: <span class="hljs-string">&quot;source-map&quot;</span>,<br>&#125;;<br></code></pre></td></tr></table></figure><h3 id="其他配置"><a href="#其他配置" class="headerlink" title="其他配置"></a>其他配置</h3><ul><li>package.json</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;vue-cli&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;version&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1.0.0&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;main&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;main.js&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;scripts&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;start&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;npm run dev&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;dev&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;cross-env NODE_ENV=development webpack serve --config ./config/webpack.dev.js&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;build&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;cross-env NODE_ENV=production webpack --config ./config/webpack.prod.js&quot;</span><br>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;keywords&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;author&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;license&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ISC&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;devDependencies&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;@babel/core&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^7.17.10&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;@babel/eslint-parser&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^7.17.0&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;@vue/cli-plugin-babel&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^5.0.4&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;babel-loader&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^8.2.5&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;copy-webpack-plugin&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^10.2.4&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;cross-env&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^7.0.3&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;css-loader&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^6.7.1&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;css-minimizer-webpack-plugin&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^3.4.1&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;eslint-plugin-vue&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^8.7.1&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;eslint-webpack-plugin&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^3.1.1&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;html-webpack-plugin&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^5.5.0&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;image-minimizer-webpack-plugin&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^3.2.3&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;imagemin&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^8.0.1&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;imagemin-gifsicle&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^7.0.0&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;imagemin-jpegtran&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^7.0.0&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;imagemin-optipng&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^8.0.0&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;imagemin-svgo&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^10.0.1&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;less-loader&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^10.2.0&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;mini-css-extract-plugin&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^2.6.0&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;postcss-preset-env&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^7.5.0&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;sass-loader&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^12.6.0&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;stylus-loader&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^6.2.0&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;vue-loader&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^17.0.0&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;vue-style-loader&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^4.1.3&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;vue-template-compiler&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^2.6.14&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;webpack&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^5.72.0&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;webpack-cli&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^4.9.2&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;webpack-dev-server&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^4.9.0&quot;</span><br>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;dependencies&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;vue&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^3.2.33&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;vue-router&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^4.0.15&quot;</span><br>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;browserslist&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;last 2 version&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;&gt; 1%&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;not dead&quot;</span><span class="hljs-punctuation">]</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><ul><li>.eslintrc.js</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">root</span>: <span class="hljs-literal">true</span>,<br>  <span class="hljs-attr">env</span>: &#123;<br>    <span class="hljs-attr">node</span>: <span class="hljs-literal">true</span>,<br>  &#125;,<br>  <span class="hljs-attr">extends</span>: [<span class="hljs-string">&quot;plugin:vue/vue3-essential&quot;</span>, <span class="hljs-string">&quot;eslint:recommended&quot;</span>],<br>  <span class="hljs-attr">parserOptions</span>: &#123;<br>    <span class="hljs-attr">parser</span>: <span class="hljs-string">&quot;@babel/eslint-parser&quot;</span>,<br>  &#125;,<br>&#125;;<br></code></pre></td></tr></table></figure><ul><li>babel.config.js</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">presets</span>: [<span class="hljs-string">&quot;@vue/cli-plugin-babel/preset&quot;</span>],<br>&#125;;<br></code></pre></td></tr></table></figure><h3 id="合并开发和生产配置"><a href="#合并开发和生产配置" class="headerlink" title="合并开发和生产配置"></a>合并开发和生产配置</h3><ul><li>webpack.config.js</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;path&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">ESLintWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;eslint-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;html-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">MiniCssExtractPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;mini-css-extract-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">CssMinimizerPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;css-minimizer-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">TerserWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;terser-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">ImageMinimizerPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;image-minimizer-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> &#123; <span class="hljs-title class_">VueLoaderPlugin</span> &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;vue-loader&quot;</span>);<br><span class="hljs-keyword">const</span> &#123; <span class="hljs-title class_">DefinePlugin</span> &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;webpack&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">CopyPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;copy-webpack-plugin&quot;</span>);<br><br><span class="hljs-comment">// 需要通过 cross-env 定义环境变量</span><br><span class="hljs-keyword">const</span> isProduction = process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> === <span class="hljs-string">&quot;production&quot;</span>;<br><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">getStyleLoaders</span> = (<span class="hljs-params">preProcessor</span>) =&gt; &#123;<br>  <span class="hljs-keyword">return</span> [<br>    isProduction ? <span class="hljs-title class_">MiniCssExtractPlugin</span>.<span class="hljs-property">loader</span> : <span class="hljs-string">&quot;vue-style-loader&quot;</span>,<br>    <span class="hljs-string">&quot;css-loader&quot;</span>,<br>    &#123;<br>      <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;postcss-loader&quot;</span>,<br>      <span class="hljs-attr">options</span>: &#123;<br>        <span class="hljs-attr">postcssOptions</span>: &#123;<br>          <span class="hljs-attr">plugins</span>: [<span class="hljs-string">&quot;postcss-preset-env&quot;</span>],<br>        &#125;,<br>      &#125;,<br>    &#125;,<br>    preProcessor,<br>  ].<span class="hljs-title function_">filter</span>(<span class="hljs-title class_">Boolean</span>);<br>&#125;;<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">entry</span>: <span class="hljs-string">&quot;./src/main.js&quot;</span>,<br>  <span class="hljs-attr">output</span>: &#123;<br>    <span class="hljs-attr">path</span>: isProduction ? path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../dist&quot;</span>) : <span class="hljs-literal">undefined</span>,<br>    <span class="hljs-attr">filename</span>: isProduction<br>      ? <span class="hljs-string">&quot;static/js/[name].[contenthash:10].js&quot;</span><br>      : <span class="hljs-string">&quot;static/js/[name].js&quot;</span>,<br>    <span class="hljs-attr">chunkFilename</span>: isProduction<br>      ? <span class="hljs-string">&quot;static/js/[name].[contenthash:10].chunk.js&quot;</span><br>      : <span class="hljs-string">&quot;static/js/[name].chunk.js&quot;</span>,<br>    <span class="hljs-attr">assetModuleFilename</span>: <span class="hljs-string">&quot;static/js/[hash:10][ext][query]&quot;</span>,<br>    <span class="hljs-attr">clean</span>: <span class="hljs-literal">true</span>,<br>  &#125;,<br>  <span class="hljs-attr">module</span>: &#123;<br>    <span class="hljs-attr">rules</span>: [<br>      &#123;<br>        <span class="hljs-comment">// 用来匹配 .css 结尾的文件</span><br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.css$/</span>,<br>        <span class="hljs-comment">// use 数组里面 Loader 执行顺序是从右到左</span><br>        <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(),<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.less$/</span>,<br>        <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(<span class="hljs-string">&quot;less-loader&quot;</span>),<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.s[ac]ss$/</span>,<br>        <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(<span class="hljs-string">&quot;sass-loader&quot;</span>),<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.styl$/</span>,<br>        <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(<span class="hljs-string">&quot;stylus-loader&quot;</span>),<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(png|jpe?g|gif|svg)$/</span>,<br>        <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;asset&quot;</span>,<br>        <span class="hljs-attr">parser</span>: &#123;<br>          <span class="hljs-attr">dataUrlCondition</span>: &#123;<br>            <span class="hljs-attr">maxSize</span>: <span class="hljs-number">10</span> * <span class="hljs-number">1024</span>, <span class="hljs-comment">// 小于10kb的图片会被base64处理</span><br>          &#125;,<br>        &#125;,<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(ttf|woff2?)$/</span>,<br>        <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;asset/resource&quot;</span>,<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(jsx|js)$/</span>,<br>        <span class="hljs-attr">include</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../src&quot;</span>),<br>        <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;babel-loader&quot;</span>,<br>        <span class="hljs-attr">options</span>: &#123;<br>          <span class="hljs-attr">cacheDirectory</span>: <span class="hljs-literal">true</span>,<br>          <span class="hljs-attr">cacheCompression</span>: <span class="hljs-literal">false</span>,<br>          <span class="hljs-attr">plugins</span>: [<br>            <span class="hljs-comment">// &quot;@babel/plugin-transform-runtime&quot; // presets中包含了</span><br>          ],<br>        &#125;,<br>      &#125;,<br>      <span class="hljs-comment">// vue-loader不支持oneOf</span><br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.vue$/</span>,<br>        <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;vue-loader&quot;</span>, <span class="hljs-comment">// 内部会给vue文件注入HMR功能代码</span><br>        <span class="hljs-attr">options</span>: &#123;<br>          <span class="hljs-comment">// 开启缓存</span><br>          <span class="hljs-attr">cacheDirectory</span>: path.<span class="hljs-title function_">resolve</span>(<br>            __dirname,<br>            <span class="hljs-string">&quot;node_modules/.cache/vue-loader&quot;</span><br>          ),<br>        &#125;,<br>      &#125;,<br>    ],<br>  &#125;,<br>  <span class="hljs-attr">plugins</span>: [<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">ESLintWebpackPlugin</span>(&#123;<br>      <span class="hljs-attr">context</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../src&quot;</span>),<br>      <span class="hljs-attr">exclude</span>: <span class="hljs-string">&quot;node_modules&quot;</span>,<br>      <span class="hljs-attr">cache</span>: <span class="hljs-literal">true</span>,<br>      <span class="hljs-attr">cacheLocation</span>: path.<span class="hljs-title function_">resolve</span>(<br>        __dirname,<br>        <span class="hljs-string">&quot;../node_modules/.cache/.eslintcache&quot;</span><br>      ),<br>    &#125;),<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(&#123;<br>      <span class="hljs-attr">template</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../public/index.html&quot;</span>),<br>    &#125;),<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">CopyPlugin</span>(&#123;<br>      <span class="hljs-attr">patterns</span>: [<br>        &#123;<br>          <span class="hljs-attr">from</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../public&quot;</span>),<br>          <span class="hljs-attr">to</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../dist&quot;</span>),<br>          <span class="hljs-attr">toType</span>: <span class="hljs-string">&quot;dir&quot;</span>,<br>          <span class="hljs-attr">noErrorOnMissing</span>: <span class="hljs-literal">true</span>,<br>          <span class="hljs-attr">globOptions</span>: &#123;<br>            <span class="hljs-attr">ignore</span>: [<span class="hljs-string">&quot;**/index.html&quot;</span>],<br>          &#125;,<br>          <span class="hljs-attr">info</span>: &#123;<br>            <span class="hljs-attr">minimized</span>: <span class="hljs-literal">true</span>,<br>          &#125;,<br>        &#125;,<br>      ],<br>    &#125;),<br>    isProduction &amp;&amp;<br>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">MiniCssExtractPlugin</span>(&#123;<br>        <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;static/css/[name].[contenthash:10].css&quot;</span>,<br>        <span class="hljs-attr">chunkFilename</span>: <span class="hljs-string">&quot;static/css/[name].[contenthash:10].chunk.css&quot;</span>,<br>      &#125;),<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">VueLoaderPlugin</span>(),<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">DefinePlugin</span>(&#123;<br>      <span class="hljs-attr">__VUE_OPTIONS_API__</span>: <span class="hljs-string">&quot;true&quot;</span>,<br>      <span class="hljs-attr">__VUE_PROD_DEVTOOLS__</span>: <span class="hljs-string">&quot;false&quot;</span>,<br>    &#125;),<br>  ].<span class="hljs-title function_">filter</span>(<span class="hljs-title class_">Boolean</span>),<br>  <span class="hljs-attr">optimization</span>: &#123;<br>    <span class="hljs-attr">minimize</span>: isProduction,<br>    <span class="hljs-comment">// 压缩的操作</span><br>    <span class="hljs-attr">minimizer</span>: [<br>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">CssMinimizerPlugin</span>(),<br>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">TerserWebpackPlugin</span>(),<br>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImageMinimizerPlugin</span>(&#123;<br>        <span class="hljs-attr">minimizer</span>: &#123;<br>          <span class="hljs-attr">implementation</span>: <span class="hljs-title class_">ImageMinimizerPlugin</span>.<span class="hljs-property">imageminGenerate</span>,<br>          <span class="hljs-attr">options</span>: &#123;<br>            <span class="hljs-attr">plugins</span>: [<br>              [<span class="hljs-string">&quot;gifsicle&quot;</span>, &#123; <span class="hljs-attr">interlaced</span>: <span class="hljs-literal">true</span> &#125;],<br>              [<span class="hljs-string">&quot;jpegtran&quot;</span>, &#123; <span class="hljs-attr">progressive</span>: <span class="hljs-literal">true</span> &#125;],<br>              [<span class="hljs-string">&quot;optipng&quot;</span>, &#123; <span class="hljs-attr">optimizationLevel</span>: <span class="hljs-number">5</span> &#125;],<br>              [<br>                <span class="hljs-string">&quot;svgo&quot;</span>,<br>                &#123;<br>                  <span class="hljs-attr">plugins</span>: [<br>                    <span class="hljs-string">&quot;preset-default&quot;</span>,<br>                    <span class="hljs-string">&quot;prefixIds&quot;</span>,<br>                    &#123;<br>                      <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;sortAttrs&quot;</span>,<br>                      <span class="hljs-attr">params</span>: &#123;<br>                        <span class="hljs-attr">xmlnsOrder</span>: <span class="hljs-string">&quot;alphabetical&quot;</span>,<br>                      &#125;,<br>                    &#125;,<br>                  ],<br>                &#125;,<br>              ],<br>            ],<br>          &#125;,<br>        &#125;,<br>      &#125;),<br>    ],<br>    <span class="hljs-attr">splitChunks</span>: &#123;<br>      <span class="hljs-attr">chunks</span>: <span class="hljs-string">&quot;all&quot;</span>,<br>    &#125;,<br>    <span class="hljs-attr">runtimeChunk</span>: &#123;<br>      <span class="hljs-attr">name</span>: <span class="hljs-function">(<span class="hljs-params">entrypoint</span>) =&gt;</span> <span class="hljs-string">`runtime~<span class="hljs-subst">$&#123;entrypoint.name&#125;</span>`</span>,<br>    &#125;,<br>  &#125;,<br>  <span class="hljs-attr">resolve</span>: &#123;<br>    <span class="hljs-attr">extensions</span>: [<span class="hljs-string">&quot;.vue&quot;</span>, <span class="hljs-string">&quot;.js&quot;</span>, <span class="hljs-string">&quot;.json&quot;</span>],<br>  &#125;,<br>  <span class="hljs-attr">devServer</span>: &#123;<br>    <span class="hljs-attr">open</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">host</span>: <span class="hljs-string">&quot;localhost&quot;</span>,<br>    <span class="hljs-attr">port</span>: <span class="hljs-number">3000</span>,<br>    <span class="hljs-attr">hot</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">compress</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">historyApiFallback</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 解决vue-router刷新404问题</span><br>  &#125;,<br>  <span class="hljs-attr">mode</span>: isProduction ? <span class="hljs-string">&quot;production&quot;</span> : <span class="hljs-string">&quot;development&quot;</span>,<br>  <span class="hljs-attr">devtool</span>: isProduction ? <span class="hljs-string">&quot;source-map&quot;</span> : <span class="hljs-string">&quot;cheap-module-source-map&quot;</span>,<br>&#125;;<br></code></pre></td></tr></table></figure><h3 id="优化配置"><a href="#优化配置" class="headerlink" title="优化配置"></a>优化配置</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;path&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">ESLintWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;eslint-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;html-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">MiniCssExtractPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;mini-css-extract-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">CssMinimizerPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;css-minimizer-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">ImageMinimizerPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;image-minimizer-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">TerserWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;terser-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">CopyPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;copy-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> &#123; <span class="hljs-title class_">VueLoaderPlugin</span> &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;vue-loader&quot;</span>);<br><span class="hljs-keyword">const</span> &#123; <span class="hljs-title class_">DefinePlugin</span> &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;webpack&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">AutoImport</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;unplugin-auto-import/webpack&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">Components</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;unplugin-vue-components/webpack&quot;</span>);<br><span class="hljs-keyword">const</span> &#123; <span class="hljs-title class_">ElementPlusResolver</span> &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;unplugin-vue-components/resolvers&quot;</span>);<br><span class="hljs-comment">// 需要通过 cross-env 定义环境变量</span><br><span class="hljs-keyword">const</span> isProduction = process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> === <span class="hljs-string">&quot;production&quot;</span>;<br><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">getStyleLoaders</span> = (<span class="hljs-params">preProcessor</span>) =&gt; &#123;<br>  <span class="hljs-keyword">return</span> [<br>    isProduction ? <span class="hljs-title class_">MiniCssExtractPlugin</span>.<span class="hljs-property">loader</span> : <span class="hljs-string">&quot;vue-style-loader&quot;</span>,<br>    <span class="hljs-string">&quot;css-loader&quot;</span>,<br>    &#123;<br>      <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;postcss-loader&quot;</span>,<br>      <span class="hljs-attr">options</span>: &#123;<br>        <span class="hljs-attr">postcssOptions</span>: &#123;<br>          <span class="hljs-attr">plugins</span>: [<span class="hljs-string">&quot;postcss-preset-env&quot;</span>],<br>        &#125;,<br>      &#125;,<br>    &#125;,<br>    preProcessor &amp;&amp; &#123;<br>      <span class="hljs-attr">loader</span>: preProcessor,<br>      <span class="hljs-attr">options</span>:<br>        preProcessor === <span class="hljs-string">&quot;sass-loader&quot;</span><br>          ? &#123;<br>              <span class="hljs-comment">// 自定义主题：自动引入我们定义的scss文件</span><br>              <span class="hljs-attr">additionalData</span>: <span class="hljs-string">`@use &quot;@/styles/element/index.scss&quot; as *;`</span>,<br>            &#125;<br>          : &#123;&#125;,<br>    &#125;,<br>  ].<span class="hljs-title function_">filter</span>(<span class="hljs-title class_">Boolean</span>);<br>&#125;;<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">entry</span>: <span class="hljs-string">&quot;./src/main.js&quot;</span>,<br>  <span class="hljs-attr">output</span>: &#123;<br>    <span class="hljs-attr">path</span>: isProduction ? path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../dist&quot;</span>) : <span class="hljs-literal">undefined</span>,<br>    <span class="hljs-attr">filename</span>: isProduction<br>      ? <span class="hljs-string">&quot;static/js/[name].[contenthash:10].js&quot;</span><br>      : <span class="hljs-string">&quot;static/js/[name].js&quot;</span>,<br>    <span class="hljs-attr">chunkFilename</span>: isProduction<br>      ? <span class="hljs-string">&quot;static/js/[name].[contenthash:10].chunk.js&quot;</span><br>      : <span class="hljs-string">&quot;static/js/[name].chunk.js&quot;</span>,<br>    <span class="hljs-attr">assetModuleFilename</span>: <span class="hljs-string">&quot;static/js/[hash:10][ext][query]&quot;</span>,<br>    <span class="hljs-attr">clean</span>: <span class="hljs-literal">true</span>,<br>  &#125;,<br>  <span class="hljs-attr">module</span>: &#123;<br>    <span class="hljs-attr">rules</span>: [<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.css$/</span>,<br>        <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(),<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.less$/</span>,<br>        <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(<span class="hljs-string">&quot;less-loader&quot;</span>),<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.s[ac]ss$/</span>,<br>        <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(<span class="hljs-string">&quot;sass-loader&quot;</span>),<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.styl$/</span>,<br>        <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(<span class="hljs-string">&quot;stylus-loader&quot;</span>),<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(png|jpe?g|gif|svg)$/</span>,<br>        <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;asset&quot;</span>,<br>        <span class="hljs-attr">parser</span>: &#123;<br>          <span class="hljs-attr">dataUrlCondition</span>: &#123;<br>            <span class="hljs-attr">maxSize</span>: <span class="hljs-number">10</span> * <span class="hljs-number">1024</span>,<br>          &#125;,<br>        &#125;,<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(ttf|woff2?)$/</span>,<br>        <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;asset/resource&quot;</span>,<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(jsx|js)$/</span>,<br>        <span class="hljs-attr">include</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../src&quot;</span>),<br>        <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;babel-loader&quot;</span>,<br>        <span class="hljs-attr">options</span>: &#123;<br>          <span class="hljs-attr">cacheDirectory</span>: <span class="hljs-literal">true</span>,<br>          <span class="hljs-attr">cacheCompression</span>: <span class="hljs-literal">false</span>,<br>          <span class="hljs-attr">plugins</span>: [<br>            <span class="hljs-comment">// &quot;@babel/plugin-transform-runtime&quot; // presets中包含了</span><br>          ],<br>        &#125;,<br>      &#125;,<br>      <span class="hljs-comment">// vue-loader不支持oneOf</span><br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.vue$/</span>,<br>        <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;vue-loader&quot;</span>, <span class="hljs-comment">// 内部会给vue文件注入HMR功能代码</span><br>        <span class="hljs-attr">options</span>: &#123;<br>          <span class="hljs-comment">// 开启缓存</span><br>          <span class="hljs-attr">cacheDirectory</span>: path.<span class="hljs-title function_">resolve</span>(<br>            __dirname,<br>            <span class="hljs-string">&quot;node_modules/.cache/vue-loader&quot;</span><br>          ),<br>        &#125;,<br>      &#125;,<br>    ],<br>  &#125;,<br>  <span class="hljs-attr">plugins</span>: [<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">ESLintWebpackPlugin</span>(&#123;<br>      <span class="hljs-attr">context</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../src&quot;</span>),<br>      <span class="hljs-attr">exclude</span>: <span class="hljs-string">&quot;node_modules&quot;</span>,<br>      <span class="hljs-attr">cache</span>: <span class="hljs-literal">true</span>,<br>      <span class="hljs-attr">cacheLocation</span>: path.<span class="hljs-title function_">resolve</span>(<br>        __dirname,<br>        <span class="hljs-string">&quot;../node_modules/.cache/.eslintcache&quot;</span><br>      ),<br>    &#125;),<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(&#123;<br>      <span class="hljs-attr">template</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../public/index.html&quot;</span>),<br>    &#125;),<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">CopyPlugin</span>(&#123;<br>      <span class="hljs-attr">patterns</span>: [<br>        &#123;<br>          <span class="hljs-attr">from</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../public&quot;</span>),<br>          <span class="hljs-attr">to</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../dist&quot;</span>),<br>          <span class="hljs-attr">toType</span>: <span class="hljs-string">&quot;dir&quot;</span>,<br>          <span class="hljs-attr">noErrorOnMissing</span>: <span class="hljs-literal">true</span>,<br>          <span class="hljs-attr">globOptions</span>: &#123;<br>            <span class="hljs-attr">ignore</span>: [<span class="hljs-string">&quot;**/index.html&quot;</span>],<br>          &#125;,<br>          <span class="hljs-attr">info</span>: &#123;<br>            <span class="hljs-attr">minimized</span>: <span class="hljs-literal">true</span>,<br>          &#125;,<br>        &#125;,<br>      ],<br>    &#125;),<br>    isProduction &amp;&amp;<br>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">MiniCssExtractPlugin</span>(&#123;<br>        <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;static/css/[name].[contenthash:10].css&quot;</span>,<br>        <span class="hljs-attr">chunkFilename</span>: <span class="hljs-string">&quot;static/css/[name].[contenthash:10].chunk.css&quot;</span>,<br>      &#125;),<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">VueLoaderPlugin</span>(),<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">DefinePlugin</span>(&#123;<br>      <span class="hljs-attr">__VUE_OPTIONS_API__</span>: <span class="hljs-string">&quot;true&quot;</span>,<br>      <span class="hljs-attr">__VUE_PROD_DEVTOOLS__</span>: <span class="hljs-string">&quot;false&quot;</span>,<br>    &#125;),<br>    <span class="hljs-comment">// 按需加载element-plus组件样式</span><br>    <span class="hljs-title class_">AutoImport</span>(&#123;<br>      <span class="hljs-attr">resolvers</span>: [<span class="hljs-title class_">ElementPlusResolver</span>()],<br>    &#125;),<br>    <span class="hljs-title class_">Components</span>(&#123;<br>      <span class="hljs-attr">resolvers</span>: [<br>        <span class="hljs-title class_">ElementPlusResolver</span>(&#123;<br>          <span class="hljs-attr">importStyle</span>: <span class="hljs-string">&quot;sass&quot;</span>, <span class="hljs-comment">// 自定义主题</span><br>        &#125;),<br>      ],<br>    &#125;),<br>  ].<span class="hljs-title function_">filter</span>(<span class="hljs-title class_">Boolean</span>),<br>  <span class="hljs-attr">optimization</span>: &#123;<br>    <span class="hljs-attr">minimize</span>: isProduction,<br>    <span class="hljs-comment">// 压缩的操作</span><br>    <span class="hljs-attr">minimizer</span>: [<br>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">CssMinimizerPlugin</span>(),<br>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">TerserWebpackPlugin</span>(),<br>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImageMinimizerPlugin</span>(&#123;<br>        <span class="hljs-attr">minimizer</span>: &#123;<br>          <span class="hljs-attr">implementation</span>: <span class="hljs-title class_">ImageMinimizerPlugin</span>.<span class="hljs-property">imageminGenerate</span>,<br>          <span class="hljs-attr">options</span>: &#123;<br>            <span class="hljs-attr">plugins</span>: [<br>              [<span class="hljs-string">&quot;gifsicle&quot;</span>, &#123; <span class="hljs-attr">interlaced</span>: <span class="hljs-literal">true</span> &#125;],<br>              [<span class="hljs-string">&quot;jpegtran&quot;</span>, &#123; <span class="hljs-attr">progressive</span>: <span class="hljs-literal">true</span> &#125;],<br>              [<span class="hljs-string">&quot;optipng&quot;</span>, &#123; <span class="hljs-attr">optimizationLevel</span>: <span class="hljs-number">5</span> &#125;],<br>              [<br>                <span class="hljs-string">&quot;svgo&quot;</span>,<br>                &#123;<br>                  <span class="hljs-attr">plugins</span>: [<br>                    <span class="hljs-string">&quot;preset-default&quot;</span>,<br>                    <span class="hljs-string">&quot;prefixIds&quot;</span>,<br>                    &#123;<br>                      <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;sortAttrs&quot;</span>,<br>                      <span class="hljs-attr">params</span>: &#123;<br>                        <span class="hljs-attr">xmlnsOrder</span>: <span class="hljs-string">&quot;alphabetical&quot;</span>,<br>                      &#125;,<br>                    &#125;,<br>                  ],<br>                &#125;,<br>              ],<br>            ],<br>          &#125;,<br>        &#125;,<br>      &#125;),<br>    ],<br>    <span class="hljs-attr">splitChunks</span>: &#123;<br>      <span class="hljs-attr">chunks</span>: <span class="hljs-string">&quot;all&quot;</span>,<br>      <span class="hljs-attr">cacheGroups</span>: &#123;<br>        <span class="hljs-comment">// layouts通常是admin项目的主体布局组件，所有路由组件都要使用的</span><br>        <span class="hljs-comment">// 可以单独打包，从而复用</span><br>        <span class="hljs-comment">// 如果项目中没有，请删除</span><br>        <span class="hljs-attr">layouts</span>: &#123;<br>          <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;layouts&quot;</span>,<br>          <span class="hljs-attr">test</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../src/layouts&quot;</span>),<br>          <span class="hljs-attr">priority</span>: <span class="hljs-number">40</span>,<br>        &#125;,<br>        <span class="hljs-comment">// 如果项目中使用element-plus，此时将所有node_modules打包在一起，那么打包输出文件会比较大。</span><br>        <span class="hljs-comment">// 所以我们将node_modules中比较大的模块单独打包，从而并行加载速度更好</span><br>        <span class="hljs-comment">// 如果项目中没有，请删除</span><br>        <span class="hljs-attr">elementUI</span>: &#123;<br>          <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;chunk-elementPlus&quot;</span>,<br>          <span class="hljs-attr">test</span>: <span class="hljs-regexp">/[\\/]node_modules[\\/]_?element-plus(.*)/</span>,<br>          <span class="hljs-attr">priority</span>: <span class="hljs-number">30</span>,<br>        &#125;,<br>        <span class="hljs-comment">// 将vue相关的库单独打包，减少node_modules的chunk体积。</span><br>        <span class="hljs-attr">vue</span>: &#123;<br>          <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;vue&quot;</span>,<br>          <span class="hljs-attr">test</span>: <span class="hljs-regexp">/[\\/]node_modules[\\/]vue(.*)[\\/]/</span>,<br>          <span class="hljs-attr">chunks</span>: <span class="hljs-string">&quot;initial&quot;</span>,<br>          <span class="hljs-attr">priority</span>: <span class="hljs-number">20</span>,<br>        &#125;,<br>        <span class="hljs-attr">libs</span>: &#123;<br>          <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;chunk-libs&quot;</span>,<br>          <span class="hljs-attr">test</span>: <span class="hljs-regexp">/[\\/]node_modules[\\/]/</span>,<br>          <span class="hljs-attr">priority</span>: <span class="hljs-number">10</span>, <span class="hljs-comment">// 权重最低，优先考虑前面内容</span><br>          <span class="hljs-attr">chunks</span>: <span class="hljs-string">&quot;initial&quot;</span>,<br>        &#125;,<br>      &#125;,<br>    &#125;,<br>    <span class="hljs-attr">runtimeChunk</span>: &#123;<br>      <span class="hljs-attr">name</span>: <span class="hljs-function">(<span class="hljs-params">entrypoint</span>) =&gt;</span> <span class="hljs-string">`runtime~<span class="hljs-subst">$&#123;entrypoint.name&#125;</span>`</span>,<br>    &#125;,<br>  &#125;,<br>  <span class="hljs-attr">resolve</span>: &#123;<br>    <span class="hljs-attr">extensions</span>: [<span class="hljs-string">&quot;.vue&quot;</span>, <span class="hljs-string">&quot;.js&quot;</span>, <span class="hljs-string">&quot;.json&quot;</span>],<br>    <span class="hljs-attr">alias</span>: &#123;<br>      <span class="hljs-comment">// 路径别名</span><br>      <span class="hljs-string">&quot;@&quot;</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;../src&quot;</span>),<br>    &#125;,<br>  &#125;,<br>  <span class="hljs-attr">devServer</span>: &#123;<br>    <span class="hljs-attr">open</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">host</span>: <span class="hljs-string">&quot;localhost&quot;</span>,<br>    <span class="hljs-attr">port</span>: <span class="hljs-number">3000</span>,<br>    <span class="hljs-attr">hot</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">compress</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">historyApiFallback</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 解决vue-router刷新404问题</span><br>  &#125;,<br>  <span class="hljs-attr">mode</span>: isProduction ? <span class="hljs-string">&quot;production&quot;</span> : <span class="hljs-string">&quot;development&quot;</span>,<br>  <span class="hljs-attr">devtool</span>: isProduction ? <span class="hljs-string">&quot;source-map&quot;</span> : <span class="hljs-string">&quot;cheap-module-source-map&quot;</span>,<br>  <span class="hljs-attr">performance</span>: <span class="hljs-literal">false</span>,<br>&#125;;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>webpack</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>typescript</title>
    <link href="/2023/03/22/%E7%AC%94%E8%AE%B0/typescript/"/>
    <url>/2023/03/22/%E7%AC%94%E8%AE%B0/typescript/</url>
    
    <content type="html"><![CDATA[<h2 id="基本数据类型"><a href="#基本数据类型" class="headerlink" title="基本数据类型"></a>基本数据类型</h2><h3 id="类型声明"><a href="#类型声明" class="headerlink" title="类型声明"></a>类型声明</h3><ul><li><p>类型声明是TS非常重要的一个特点</p></li><li><p>通过类型声明可以指定TS中变量（参数、形参）的类型</p></li><li><p>指定类型后，当为变量赋值时，TS编译器会自动检查值是否符合类型声明，符合则赋值，否则报错</p></li><li><p>简而言之，类型声明给变量设置了类型，使得变量只能存储某种类型的值</p></li></ul><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">let</span> 变量: 类型;<br><br><span class="hljs-keyword">let</span> 变量: 类型 = 值;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params">参数: 类型, 参数: 类型</span>): 类型&#123;<br>    ...<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="自动类型判断"><a href="#自动类型判断" class="headerlink" title="自动类型判断"></a>自动类型判断</h3><ul><li>TS拥有自动的类型判断机制</li><li>当对变量的声明和赋值是同时进行的，TS编译器会自动判断变量的类型</li><li>所以如果你的变量的声明和赋值时同时进行的，可以省略掉类型声明</li></ul><h3 id="类型"><a href="#类型" class="headerlink" title="类型"></a>类型</h3><table><thead><tr><th align="center">类型</th><th align="center">例子</th><th align="center">描述</th></tr></thead><tbody><tr><td align="center">number</td><td align="center">1, -33, 2.5</td><td align="center">任意数字</td></tr><tr><td align="center">string</td><td align="center">‘hi’, “hi”, <code>hi</code></td><td align="center">任意字符串</td></tr><tr><td align="center">boolean</td><td align="center">true、false</td><td align="center">布尔值true或false</td></tr><tr><td align="center">字面量</td><td align="center">其本身</td><td align="center">限制变量的值就是该字面量的值</td></tr><tr><td align="center">any</td><td align="center">*</td><td align="center">任意类型</td></tr><tr><td align="center">unknown</td><td align="center">*</td><td align="center">类型安全的any</td></tr><tr><td align="center">void</td><td align="center">空值（undefined）</td><td align="center">没有值（或undefined）</td></tr><tr><td align="center">never</td><td align="center">没有值</td><td align="center">不能是任何值</td></tr><tr><td align="center">object</td><td align="center">{name:’孙悟空’}</td><td align="center">任意的JS对象</td></tr><tr><td align="center">array</td><td align="center">[1,2,3]</td><td align="center">任意JS数组</td></tr><tr><td align="center">tuple</td><td align="center">[4,5]</td><td align="center">元素，TS新增类型，固定长度数组</td></tr><tr><td align="center">enum</td><td align="center">enum{A, B}</td><td align="center">枚举，TS中新增类型</td></tr></tbody></table><h4 id="1、number"><a href="#1、number" class="headerlink" title="1、number"></a>1、number</h4><h4 id="2、string"><a href="#2、string" class="headerlink" title="2、string"></a>2、string</h4><h4 id="3、boolean"><a href="#3、boolean" class="headerlink" title="3、boolean"></a>3、boolean</h4><h4 id="4、字面量"><a href="#4、字面量" class="headerlink" title="4、字面量"></a>4、字面量</h4><h4 id="5、any"><a href="#5、any" class="headerlink" title="5、any"></a>5、any</h4><h4 id="6、unknown"><a href="#6、unknown" class="headerlink" title="6、unknown"></a>6、unknown</h4><h4 id="7、void"><a href="#7、void" class="headerlink" title="7、void"></a>7、void</h4><h4 id="8、never"><a href="#8、never" class="headerlink" title="8、never"></a>8、never</h4><h4 id="9、object"><a href="#9、object" class="headerlink" title="9、object"></a>9、object</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">let</span> <span class="hljs-attr">a</span>:<span class="hljs-built_in">object</span>;<br>a=&#123;&#125;;<br><br><span class="hljs-comment">// &#123;&#125; 依赖指定随心中可以包含哪些属性</span><br><span class="hljs-comment">// 语法：&#123;属性名:属性值，属性名:属性值&#125;</span><br><span class="hljs-comment">//  这个是一一对应的，声明多少个属性就要写多少个</span><br><span class="hljs-comment">//  在属性名后面加上?，表示属性是可选的</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">b</span>: &#123;<span class="hljs-attr">name</span>:<span class="hljs-built_in">string</span>,age?:<span class="hljs-built_in">number</span>&#125;;<br>b = &#123;<span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;妮露&#x27;</span>&#125;;<br><br><span class="hljs-comment">// [propName:string]: any  表示任意属性</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">c</span>: &#123;<span class="hljs-attr">name</span>:<span class="hljs-built_in">string</span>,[<span class="hljs-attr">propName</span>:<span class="hljs-built_in">string</span>]: <span class="hljs-built_in">any</span>&#125;;<br>c = &#123;<span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;甘雨&#x27;</span>,<span class="hljs-attr">age</span>:<span class="hljs-number">18</span>,<span class="hljs-attr">sex</span>:<span class="hljs-string">&#x27;男&#x27;</span>&#125;<br><br><span class="hljs-comment">// 设置函数结构的类型声明</span><br><span class="hljs-comment">// 语法：(形参:类型，形参:类型) =&gt; 返回值</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">d</span>: <span class="hljs-function">(<span class="hljs-params">a:<span class="hljs-built_in">number</span>,b:<span class="hljs-built_in">number</span></span>) =&gt;</span> <span class="hljs-built_in">number</span>;<br>d = <span class="hljs-keyword">function</span>(<span class="hljs-params">n1,n2</span>)&#123;<br>    <span class="hljs-keyword">return</span> n1 + n2;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="10、array"><a href="#10、array" class="headerlink" title="10、array"></a>10、array</h4><p>数组的类型声明：</p><ul><li>类型[]</li><li>Array&lt;类型&gt;</li></ul><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-comment">// string[] 表示字符串数组</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">a</span>:<span class="hljs-built_in">string</span>[];<br>a = [<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;b&#x27;</span>,<span class="hljs-string">&#x27;c&#x27;</span>];<br><br><span class="hljs-comment">// number[] 表示数值数组</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">b</span>: <span class="hljs-built_in">number</span>[];<br>b = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>];<br><br><span class="hljs-comment">// Array&lt;&gt; 表示数组</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">c</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-built_in">number</span>&gt;;<br>c= [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>];<br></code></pre></td></tr></table></figure><h4 id="11、tuple"><a href="#11、tuple" class="headerlink" title="11、tuple"></a>11、tuple</h4><p>元组，就是固定长度的数组</p><ul><li>语法：[类型,类型,类型]</li></ul><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">let</span> <span class="hljs-attr">a</span>: [<span class="hljs-built_in">string</span>, <span class="hljs-built_in">number</span>];<br>a = [<span class="hljs-string">&quot;hello&quot;</span>, <span class="hljs-number">10</span>]; <br></code></pre></td></tr></table></figure><h4 id="12、enum"><a href="#12、enum" class="headerlink" title="12、enum"></a>12、enum</h4><p>枚举</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">enum</span> <span class="hljs-title class_">Color</span> &#123;<br>  <span class="hljs-title class_">Red</span>,<br>  <span class="hljs-title class_">Green</span>,<br>  <span class="hljs-title class_">Blue</span>,<br>&#125;<br><span class="hljs-keyword">let</span> <span class="hljs-attr">c</span>: <span class="hljs-title class_">Color</span> = <span class="hljs-title class_">Color</span>.<span class="hljs-property">Green</span>;<br><br><span class="hljs-keyword">enum</span> <span class="hljs-title class_">Color</span> &#123;<br>  <span class="hljs-title class_">Red</span> = <span class="hljs-number">1</span>,<br>  <span class="hljs-title class_">Green</span>,<br>  <span class="hljs-title class_">Blue</span>,<br>&#125;<br><span class="hljs-keyword">let</span> <span class="hljs-attr">c</span>: <span class="hljs-title class_">Color</span> = <span class="hljs-title class_">Color</span>.<span class="hljs-property">Green</span>;<br><br><span class="hljs-keyword">enum</span> <span class="hljs-title class_">Color</span> &#123;<br>  <span class="hljs-title class_">Red</span> = <span class="hljs-number">1</span>,<br>  <span class="hljs-title class_">Green</span> = <span class="hljs-number">2</span>,<br>  <span class="hljs-title class_">Blue</span> = <span class="hljs-number">4</span>,<br>&#125;<br><span class="hljs-keyword">let</span> <span class="hljs-attr">c</span>: <span class="hljs-title class_">Color</span> = <span class="hljs-title class_">Color</span>.<span class="hljs-property">Green</span>;<br></code></pre></td></tr></table></figure><h4 id="13、-amp"><a href="#13、-amp" class="headerlink" title="13、&amp;"></a>13、&amp;</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-comment">// 同时满足两个</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">a</span>: &#123;<span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>&#125; &amp; &#123;<span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>&#125;<br>a = &#123;<span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;妮露&#x27;</span>,<span class="hljs-attr">age</span>:<span class="hljs-number">18</span>&#125;<br></code></pre></td></tr></table></figure><h4 id="14、类型别名"><a href="#14、类型别名" class="headerlink" title="14、类型别名"></a>14、类型别名</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">let</span> <span class="hljs-attr">a</span>:<span class="hljs-number">1</span> | <span class="hljs-number">2</span> | <span class="hljs-number">3</span> | <span class="hljs-number">4</span> | <span class="hljs-number">5</span>;<br><span class="hljs-keyword">let</span> <span class="hljs-attr">b</span>:<span class="hljs-number">1</span> | <span class="hljs-number">2</span> | <span class="hljs-number">3</span> | <span class="hljs-number">4</span> | <span class="hljs-number">5</span>;<br><br><span class="hljs-keyword">type</span> myType = <span class="hljs-number">1</span> | <span class="hljs-number">2</span> | <span class="hljs-number">3</span> | <span class="hljs-number">4</span> | <span class="hljs-number">5</span>;<br><span class="hljs-keyword">let</span> <span class="hljs-attr">c</span>:myType;<br><span class="hljs-keyword">let</span> <span class="hljs-attr">d</span>:myType;<br></code></pre></td></tr></table></figure><h3 id="类型断言"><a href="#类型断言" class="headerlink" title="类型断言"></a>类型断言</h3><p>有些情况下，变量的类型对于我们来说是很明确，<strong>但是TS编译器却并不清楚</strong>，此时，可以通过类型断言来告诉编译器变量的类型，断言有两种形式：</p><ul><li><p>第一种</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">let</span> <span class="hljs-attr">someValue</span>: <span class="hljs-built_in">unknown</span> = <span class="hljs-string">&quot;this is a string&quot;</span>;<br><span class="hljs-keyword">let</span> <span class="hljs-attr">strLength</span>: <span class="hljs-built_in">number</span> = (someValue <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>).<span class="hljs-property">length</span>;<br></code></pre></td></tr></table></figure></li><li><p>第二种</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">let</span> <span class="hljs-attr">someValue</span>: <span class="hljs-built_in">unknown</span> = <span class="hljs-string">&quot;this is a string&quot;</span>;<br><span class="hljs-keyword">let</span> <span class="hljs-attr">strLength</span>: <span class="hljs-built_in">number</span> = (&lt;<span class="hljs-built_in">string</span>&gt;someValue).<span class="hljs-property">length</span>;<br></code></pre></td></tr></table></figure></li></ul><h2 id="编译选项"><a href="#编译选项" class="headerlink" title="编译选项"></a>编译选项</h2><h3 id="自动编译文件"><a href="#自动编译文件" class="headerlink" title="自动编译文件"></a>自动编译文件</h3><ul><li><p>编译文件时，使用 -w 指令后，TS编译器会自动监视文件的变化，并在文件发生变化时对文件进行重新编译。</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">tsc</span> xxx.ts -w<br></code></pre></td></tr></table></figure></li></ul><h3 id="自动编译整个项目"><a href="#自动编译整个项目" class="headerlink" title="自动编译整个项目"></a>自动编译整个项目</h3><ul><li>如果直接使用tsc指令，则可以自动将当前项目下的所有ts文件编译为js文件。</li><li>但是能直接使用tsc命令的前提时，要先在项目根目录下创建一个ts的配置文件 tsconfig.json</li><li>tsconfig.json是一个JSON文件，添加配置文件后，只需只需 tsc 命令即可完成对整个项目的编译</li></ul><h3 id="配置选项"><a href="#配置选项" class="headerlink" title="配置选项"></a>配置选项</h3><h4 id="include"><a href="#include" class="headerlink" title="include"></a>include</h4><ul><li>定义希望被编译文件所在的目录</li><li>默认值：[“**&#x2F;*“]  <code>**:目录</code>，<code>*：文件</code></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-string">&quot;include&quot;</span>:[<span class="hljs-string">&quot;src/**/*&quot;</span>, <span class="hljs-string">&quot;tests/**/*&quot;</span>]<br></code></pre></td></tr></table></figure><ul><li>上述示例中，所有src目录和tests目录下的文件都会被编译</li></ul><h4 id="exclude"><a href="#exclude" class="headerlink" title="exclude"></a>exclude</h4><ul><li>定义需要排除在外的目录</li><li>默认值：[“node_modules”, “bower_components”, “jspm_packages”]</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-string">&quot;exclude&quot;</span>: [<span class="hljs-string">&quot;./src/hello/**/*&quot;</span>]<br></code></pre></td></tr></table></figure><ul><li>上述示例中，src下hello目录下的文件都不会被编译</li></ul><h4 id="extends"><a href="#extends" class="headerlink" title="extends"></a>extends</h4><ul><li>定义被继承的配置文件</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-string">&quot;extends&quot;</span>: <span class="hljs-string">&quot;./configs/base&quot;</span><br></code></pre></td></tr></table></figure><ul><li>上述示例中，当前配置文件中会自动包含config目录下base.json中的所有配置信息</li></ul><h4 id="files"><a href="#files" class="headerlink" title="files"></a>files</h4><ul><li>指定被编译文件的列表，只有需要编译的文件少时才会用到</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-string">&quot;files&quot;</span>: [<br>    <span class="hljs-string">&quot;core.ts&quot;</span>,<br>    <span class="hljs-string">&quot;sys.ts&quot;</span>,<br>    <span class="hljs-string">&quot;types.ts&quot;</span>,<br>    <span class="hljs-string">&quot;scanner.ts&quot;</span>,<br>    <span class="hljs-string">&quot;parser.ts&quot;</span>,<br>    <span class="hljs-string">&quot;utilities.ts&quot;</span>,<br>    <span class="hljs-string">&quot;binder.ts&quot;</span>,<br>    <span class="hljs-string">&quot;checker.ts&quot;</span>,<br>    <span class="hljs-string">&quot;tsc.ts&quot;</span><br>  ]<br></code></pre></td></tr></table></figure><ul><li>列表中的文件都会被TS编译器所编译</li></ul><h4 id="compilerOptions"><a href="#compilerOptions" class="headerlink" title="compilerOptions"></a>compilerOptions</h4><ul><li><p>编译选项是配置文件中非常重要也比较复杂的配置选项</p></li><li><p>在compilerOptions中包含多个子选项，用来完成对编译的配置</p></li><li><p>项目选项:</p></li></ul><h5 id="target"><a href="#target" class="headerlink" title="target"></a>target</h5><ul><li><p>设置ts代码编译的目标版本</p></li><li><p>可选值：ES3（默认）、ES5、ES6&#x2F;ES2015、ES7&#x2F;ES2016、ES2017、ES2018、ES2019、ES2020、ESNext</p></li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-attr">&quot;compilerOptions&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;target&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ES6&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><ul><li>如上设置，我们所编写的ts代码将会被编译为ES6版本的js代码</li></ul><h5 id="lib"><a href="#lib" class="headerlink" title="lib"></a>lib</h5><ul><li>指定代码运行时所包含的库（宿主环境）</li><li>可选值：ES5、ES6&#x2F;ES2015、ES7&#x2F;ES2016、ES2017、ES2018、ES2019、ES2020、ESNext、DOM、WebWorker、ScriptHost ……</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-attr">&quot;compilerOptions&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;target&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ES6&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;lib&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;ES6&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;DOM&quot;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;outDir&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;dist&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;outFile&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;dist/aa.js&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><h5 id="module"><a href="#module" class="headerlink" title="module"></a>module</h5><ul><li><p>设置编译后代码使用的模块化系统</p></li><li><p>可选值：CommonJS、UMD、AMD、System、ES2020、ESNext、None</p></li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-attr">&quot;compilerOptions&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;module&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;CommonJS&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><h5 id="outDir"><a href="#outDir" class="headerlink" title="outDir"></a>outDir</h5><ul><li><p>编译后文件的所在目录</p></li><li><p>默认情况下，编译后的js文件会和ts文件位于相同的目录，设置outDir后可以改变编译后文件的位置</p></li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-attr">&quot;compilerOptions&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;outDir&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;dist&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><ul><li>设置后编译后的js文件将会生成到dist目录</li></ul><h5 id="outFile"><a href="#outFile" class="headerlink" title="outFile"></a>outFile</h5><ul><li><p>将所有的文件编译为一个js文件</p></li><li><p>默认会将所有的编写在全局作用域中的代码合并为一个js文件，如果module制定了None、System或AMD则会将模块一起合并到文件之中</p></li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-attr">&quot;compilerOptions&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;outFile&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;dist/app.js&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><h5 id="rootDir"><a href="#rootDir" class="headerlink" title="rootDir"></a>rootDir</h5><ul><li>指定代码的根目录，默认情况下编译后文件的目录结构会以最长的公共目录为根目录，通过rootDir可以手动指定根目录</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-attr">&quot;compilerOptions&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;rootDir&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;./src&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><h5 id="allowJs"><a href="#allowJs" class="headerlink" title="allowJs"></a>allowJs</h5><ul><li>是否对js文件编译</li></ul><h5 id="checkJs"><a href="#checkJs" class="headerlink" title="checkJs"></a>checkJs</h5><ul><li>是否对js文件进行检查</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-attr">&quot;compilerOptions&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;allowJs&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;checkJs&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><h5 id="removeComments"><a href="#removeComments" class="headerlink" title="removeComments"></a>removeComments</h5><ul><li>是否删除注释</li><li>默认值：false</li></ul><h5 id="noEmit"><a href="#noEmit" class="headerlink" title="noEmit"></a>noEmit</h5><ul><li>不对代码进行编译</li><li>默认值：false</li></ul><h5 id="sourceMap"><a href="#sourceMap" class="headerlink" title="sourceMap"></a>sourceMap</h5><ul><li>是否生成sourceMap</li><li>默认值：false</li></ul><h4 id="严格检查"><a href="#严格检查" class="headerlink" title="严格检查"></a>严格检查</h4><h5 id="strict"><a href="#strict" class="headerlink" title="strict"></a>strict</h5><ul><li>启用所有的严格检查，默认值为true，设置后相当于开启了所有的严格检查</li></ul><h5 id="alwaysStrict"><a href="#alwaysStrict" class="headerlink" title="alwaysStrict"></a>alwaysStrict</h5><ul><li>总是以严格模式对代码进行编译</li></ul><h5 id="noImplicitAny"><a href="#noImplicitAny" class="headerlink" title="noImplicitAny"></a>noImplicitAny</h5><ul><li>禁止隐式的any类型</li></ul><h5 id="noImplicitThis"><a href="#noImplicitThis" class="headerlink" title="noImplicitThis"></a>noImplicitThis</h5><ul><li>禁止类型不明确的this</li></ul><h5 id="strictBindCallApply"><a href="#strictBindCallApply" class="headerlink" title="strictBindCallApply"></a>strictBindCallApply</h5><ul><li>严格检查bind、call和apply的参数列表</li></ul><h5 id="strictFunctionTypes"><a href="#strictFunctionTypes" class="headerlink" title="strictFunctionTypes"></a>strictFunctionTypes</h5><ul><li>严格检查函数的类型</li></ul><h5 id="strictNullChecks"><a href="#strictNullChecks" class="headerlink" title="strictNullChecks"></a>strictNullChecks</h5><ul><li>严格的空值检查</li></ul><h5 id="strictPropertyInitialization"><a href="#strictPropertyInitialization" class="headerlink" title="strictPropertyInitialization"></a>strictPropertyInitialization</h5><ul><li>严格检查属性是否初始化</li></ul><h3 id="额外检查"><a href="#额外检查" class="headerlink" title="额外检查"></a>额外检查</h3><h5 id="noFallthroughCasesInSwitch"><a href="#noFallthroughCasesInSwitch" class="headerlink" title="noFallthroughCasesInSwitch"></a>noFallthroughCasesInSwitch</h5><ul><li>检查switch语句包含正确的break</li></ul><h5 id="noImplicitReturns"><a href="#noImplicitReturns" class="headerlink" title="noImplicitReturns"></a>noImplicitReturns</h5><ul><li>检查函数没有隐式的返回值</li></ul><h5 id="noUnusedLocals"><a href="#noUnusedLocals" class="headerlink" title="noUnusedLocals"></a>noUnusedLocals</h5><ul><li>检查未使用的局部变量</li></ul><h5 id="noUnusedParameters"><a href="#noUnusedParameters" class="headerlink" title="noUnusedParameters"></a>noUnusedParameters</h5><ul><li>检查未使用的参数</li></ul><h4 id="高级"><a href="#高级" class="headerlink" title="高级"></a>高级</h4><h5 id="allowUnreachableCode"><a href="#allowUnreachableCode" class="headerlink" title="allowUnreachableCode"></a>allowUnreachableCode</h5><ul><li>检查不可达代码</li><li>可选值：<ul><li>true，忽略不可达代码</li><li>false，不可达代码将引起错误</li></ul></li></ul><h5 id="noEmitOnError"><a href="#noEmitOnError" class="headerlink" title="noEmitOnError"></a>noEmitOnError</h5><ul><li>有错误的情况下不进行编译</li><li>默认值：false</li></ul><h2 id="webpack"><a href="#webpack" class="headerlink" title="webpack"></a>webpack</h2><ul><li>通常情况下，实际开发中我们都需要使用构建工具对代码进行打包，TS同样也可以结合构建工具一起使用，下边以webpack为例介绍一下如何结合构建工具使用TS。</li></ul><p><strong>步骤：</strong></p><ol><li><p>初始化项目</p><ul><li>进入项目根目录，执行命令 <code> npm init -y</code><ul><li>主要作用：创建package.json文件</li></ul></li></ul></li><li><p>下载构建工具</p><ul><li><code>npm i -D webpack webpack-cli webpack-dev-server typescript ts-loader clean-webpack-plugin</code><ul><li>共安装了7个包<ul><li>webpack<ul><li>构建工具webpack</li></ul></li><li>webpack-cli<ul><li>webpack的命令行工具</li></ul></li><li>webpack-dev-server<ul><li>webpack的开发服务器</li></ul></li><li>typescript<ul><li>ts编译器</li></ul></li><li>ts-loader<ul><li>ts加载器，用于在webpack中编译ts文件</li></ul></li><li>html-webpack-plugin<ul><li>webpack中html插件，用来自动创建html文件</li></ul></li><li>clean-webpack-plugin<ul><li>webpack中的清除插件，每次构建都会先清除目录</li></ul></li></ul></li></ul></li></ul></li><li><p>根目录下创建webpack的配置文件webpack.config.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;path&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;html-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> &#123; <span class="hljs-title class_">CleanWebpackPlugin</span> &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;clean-webpack-plugin&quot;</span>);<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">optimization</span>:&#123;<br>        <span class="hljs-attr">minimize</span>: <span class="hljs-literal">false</span> <span class="hljs-comment">// 关闭代码压缩，可选</span><br>    &#125;,<br><br>    <span class="hljs-attr">entry</span>: <span class="hljs-string">&quot;./src/index.ts&quot;</span>,<br>    <br>    <span class="hljs-attr">devtool</span>: <span class="hljs-string">&quot;inline-source-map&quot;</span>,<br>    <br>    <span class="hljs-attr">devServer</span>: &#123;<br>        <span class="hljs-attr">contentBase</span>: <span class="hljs-string">&#x27;./dist&#x27;</span><br>    &#125;,<br><br>    <span class="hljs-attr">output</span>: &#123;<br>        <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;dist&quot;</span>),<br>        <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;bundle.js&quot;</span>,<br>        <span class="hljs-attr">environment</span>: &#123;<br>            <span class="hljs-attr">arrowFunction</span>: <span class="hljs-literal">false</span> <span class="hljs-comment">// 关闭webpack的箭头函数，可选</span><br>        &#125;<br>    &#125;,<br><br>    <span class="hljs-attr">resolve</span>: &#123;<br>        <span class="hljs-attr">extensions</span>: [<span class="hljs-string">&quot;.ts&quot;</span>, <span class="hljs-string">&quot;.js&quot;</span>]<br>    &#125;,<br>    <br>    <span class="hljs-attr">module</span>: &#123;<br>        <span class="hljs-attr">rules</span>: [<br>            &#123;<br>                <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.ts$/</span>,<br>                <span class="hljs-attr">use</span>: &#123;<br>                   <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;ts-loader&quot;</span>     <br>                &#125;,<br>                <span class="hljs-attr">exclude</span>: <span class="hljs-regexp">/node_modules/</span><br>            &#125;<br>        ]<br>    &#125;,<br><br>    <span class="hljs-attr">plugins</span>: [<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">CleanWebpackPlugin</span>(),<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(&#123;<br>            <span class="hljs-attr">title</span>:<span class="hljs-string">&#x27;TS测试&#x27;</span><br>        &#125;),<br>    ]<br><br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>根目录下创建tsconfig.json，配置可以根据自己需要</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;compilerOptions&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;target&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ES2015&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;module&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ES2015&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;strict&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><br>    <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure></li><li><p>修改package.json添加如下配置</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  ...略...<br>  <span class="hljs-attr">&quot;scripts&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;test&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;build&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;webpack&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;start&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;webpack serve --open chrome.exe&quot;</span><br>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>  ...略...<br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure></li><li><p>在src下创建ts文件，并在并命令行执行<code>npm run build</code>对代码进行编译，或者执行<code>npm start</code>来启动开发服务器</p></li></ol><h2 id="Babel"><a href="#Babel" class="headerlink" title="Babel"></a>Babel</h2><p>经过一系列的配置，使得TS和webpack已经结合到了一起，除了webpack，开发中还经常需要结合babel来对代码进行转换以使其可以兼容到更多的浏览器，在上述步骤的基础上，通过以下步骤再将babel引入到项目中。</p><ol><li><p>安装依赖包：</p><ul><li><code>npm i -D @babel/core @babel/preset-env babel-loader core-js</code></li><li>共安装了4个包，分别是：<ul><li>@babel&#x2F;core<ul><li>babel的核心工具</li></ul></li><li>@babel&#x2F;preset-env<ul><li>babel的预定义环境</li></ul></li><li>@babel-loader<ul><li>babel在webpack中的加载器</li></ul></li><li>core-js<ul><li>core-js用来使老版本的浏览器支持新版ES语法</li></ul></li></ul></li></ul></li><li><p>修改webpack.config.js配置文件</p></li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs javascript">...略...<br><span class="hljs-attr">module</span>: &#123;<br>    <span class="hljs-attr">rules</span>: [<br>        &#123;<br>            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.ts$/</span>,<br>            <span class="hljs-attr">use</span>: [<br>                &#123;<br>                    <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;babel-loader&quot;</span>,<br>                    <span class="hljs-attr">options</span>:&#123;<br>                        <span class="hljs-attr">presets</span>: [<br>                            [<br>                                <span class="hljs-string">&quot;@babel/preset-env&quot;</span>,<br>                                &#123;<br>                                    <span class="hljs-string">&quot;targets&quot;</span>:&#123;<br>                                        <span class="hljs-string">&quot;chrome&quot;</span>: <span class="hljs-string">&quot;58&quot;</span>,<br>                                        <span class="hljs-string">&quot;ie&quot;</span>: <span class="hljs-string">&quot;11&quot;</span><br>                                    &#125;,<br>                                    <span class="hljs-string">&quot;corejs&quot;</span>:<span class="hljs-string">&quot;3&quot;</span>,<br>                                    <span class="hljs-string">&quot;useBuiltIns&quot;</span>: <span class="hljs-string">&quot;usage&quot;</span><br>                                &#125;<br>                            ]<br>                        ]<br>                    &#125;<br>                &#125;,<br>                &#123;<br>                    <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;ts-loader&quot;</span>,<br><br>                &#125;<br>            ],<br>            <span class="hljs-attr">exclude</span>: <span class="hljs-regexp">/node_modules/</span><br>        &#125;<br>    ]<br>&#125;<br>...略...<br></code></pre></td></tr></table></figure><p>如此一来，使用ts编译后的文件将会再次被babel处理，使得代码可以在大部分浏览器中直接使用，可以在配置选项的targets中指定要兼容的浏览器版本。</p><h2 id="最后的配置"><a href="#最后的配置" class="headerlink" title="最后的配置"></a>最后的配置</h2><p><code>webpack.config.js</code>的配置</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;path&quot;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;html-webpack-plugin&quot;</span>);<br><span class="hljs-keyword">const</span> &#123; <span class="hljs-title class_">CleanWebpackPlugin</span> &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;clean-webpack-plugin&quot;</span>);<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">optimization</span>: &#123;<br>        <span class="hljs-attr">minimize</span>: <span class="hljs-literal">false</span> <span class="hljs-comment">// 关闭代码压缩，可选</span><br>    &#125;,<br><br>    <span class="hljs-comment">//指定入口文件</span><br>    <span class="hljs-attr">entry</span>: <span class="hljs-string">&quot;./src/index.ts&quot;</span>,<br><br>    <span class="hljs-attr">devtool</span>: <span class="hljs-string">&quot;inline-source-map&quot;</span>,<br><br>    <span class="hljs-attr">devServer</span>: &#123;<br>        <span class="hljs-attr">contentBase</span>: <span class="hljs-string">&#x27;./dist&#x27;</span><br>    &#125;,<br><br>    <span class="hljs-comment">// 指定打包文件所在目录</span><br>    <span class="hljs-attr">output</span>: &#123;<br>        <span class="hljs-comment">// 指定打包文件的目录</span><br>        <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&quot;dist&quot;</span>),<br>        <span class="hljs-comment">// 打包后的文件</span><br>        <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;bundle.js&quot;</span>,<br>        <span class="hljs-attr">environment</span>: &#123;<br>            <span class="hljs-attr">arrowFunction</span>: <span class="hljs-literal">false</span> <span class="hljs-comment">// 关闭webpack的箭头函数，可选</span><br>        &#125;<br>    &#125;,<br><br>    <span class="hljs-comment">// 用来设置引用模块</span><br>    <span class="hljs-attr">resolve</span>: &#123;<br>        <span class="hljs-attr">extensions</span>: [<span class="hljs-string">&quot;.ts&quot;</span>, <span class="hljs-string">&quot;.js&quot;</span>]<br>    &#125;,<br><br>    <span class="hljs-comment">// 指定webpack打包时使用的模块</span><br>    <span class="hljs-attr">module</span>: &#123;<br>        <span class="hljs-comment">// 指定要加载的规则</span><br>        <span class="hljs-attr">rules</span>: [<br>            &#123;<br>                <span class="hljs-comment">// test指定的时规则生效的文件 ，ts文件</span><br>                <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.ts$/</span>,<br>                <span class="hljs-comment">// 使用的loader</span><br>                <span class="hljs-attr">use</span>: [<br>                    &#123;<br>                        <span class="hljs-comment">// 指定加载器</span><br>                        <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;babel-loader&quot;</span>,<br>                        <span class="hljs-comment">// 设置babel</span><br>                        <span class="hljs-attr">options</span>: &#123;<br>                            <span class="hljs-comment">// 设置预定义的环境</span><br>                            <span class="hljs-attr">presets</span>: [<br>                                [<br>                                    <span class="hljs-comment">// 指定环境的插件</span><br>                                    <span class="hljs-string">&quot;@babel/preset-env&quot;</span>,<br>                                    &#123;<br>                                        <span class="hljs-comment">// 指定要兼容的浏览器版本</span><br>                                        <span class="hljs-string">&quot;targets&quot;</span>: &#123;<br>                                            <span class="hljs-string">&quot;chrome&quot;</span>: <span class="hljs-string">&quot;58&quot;</span>,<br>                                            <span class="hljs-string">&quot;ie&quot;</span>: <span class="hljs-string">&quot;11&quot;</span><br>                                        &#125;,<br>                                        <span class="hljs-comment">// corejs版本</span><br>                                        <span class="hljs-string">&quot;corejs&quot;</span>: <span class="hljs-string">&quot;3&quot;</span>,<br>                                        <span class="hljs-comment">// 使用corejs的方法 usage 表示按需加载</span><br>                                        <span class="hljs-string">&quot;useBuiltIns&quot;</span>: <span class="hljs-string">&quot;usage&quot;</span><br>                                    &#125;<br>                                ]<br>                            ]<br>                        &#125;<br>                    &#125;,<br>                    &#123;<br>                        <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;ts-loader&quot;</span>,<br><br>                    &#125;<br>                ],<br>                <span class="hljs-comment">// 要排除的文件</span><br>                <span class="hljs-attr">exclude</span>: <span class="hljs-regexp">/node_modules/</span><br>            &#125;<br>        ]<br>    &#125;,<br><br>    <span class="hljs-comment">// 配置webpack插件</span><br>    <span class="hljs-attr">plugins</span>: [<br>        <span class="hljs-comment">// 每次构建都会先清除目录</span><br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">CleanWebpackPlugin</span>(),<br>        <span class="hljs-comment">// 自动生成html</span><br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(&#123;<br>            <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;TS测试&#x27;</span><br>        &#125;),<br>    ]<br><br>&#125;<br></code></pre></td></tr></table></figure><h1 id="面向对象"><a href="#面向对象" class="headerlink" title="面向对象"></a>面向对象</h1><h2 id="类-class"><a href="#类-class" class="headerlink" title="类 class"></a>类 class</h2><p>要想面向对象，操作对象，首先便要拥有对象，那么下一个问题就是如何创建对象。要创建对象，必须要先定义类，所谓的类可以理解为对象的模型，程序中可以根据类创建指定类型的对象，举例来说：可以通过Person类来创建人的对象，通过Dog类创建狗的对象，通过Car类来创建汽车的对象，不同的类可以用来创建不同的对象。</p><p><strong>定义类：</strong></p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">class</span> 类名 &#123;<br>属性名: 类型;<br><br><span class="hljs-title function_">constructor</span>(<span class="hljs-params">参数: 类型</span>)&#123;<br><span class="hljs-variable language_">this</span>.属性名 = 参数;<br>&#125;<br><br>方法名()&#123;<br>....<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>实例</strong></p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span>&#123;<br>    <span class="hljs-keyword">readonly</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">&#x27;妮露&#x27;</span>;<br>    <span class="hljs-keyword">static</span> <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">18</span>;<br><br>    <span class="hljs-comment">// 构造函数，定义类都需要加上这个</span><br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, age: <span class="hljs-built_in">number</span></span>)&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;<br>    &#125;<br><br>    <span class="hljs-title function_">sayHello</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`大家好，我是<span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.name&#125;</span>`</span>);<br>    &#125;<br>    <br>     <span class="hljs-keyword">static</span> <span class="hljs-title function_">sayHello2</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`大家好2，我是<span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.name&#125;</span>`</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// 使用类</span><br><span class="hljs-keyword">const</span> p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&#x27;孙悟空&#x27;</span>, <span class="hljs-number">18</span>);<br>p.<span class="hljs-title function_">sayHello</span>();<br></code></pre></td></tr></table></figure><ul><li>直接定义的属性时实例属性，需要通过对象的实例去访问</li></ul><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">const</span> per = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>();<br>per.<span class="hljs-property">name</span>;<br></code></pre></td></tr></table></figure><ul><li>使用static开头的属性时静态属性（类属性），可以直接通过类去访问</li></ul><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-title class_">Person</span>.<span class="hljs-property">age</span>;<br></code></pre></td></tr></table></figure><ul><li><p>在属性前使用readonly关键字表示该属性只读不可改</p></li><li><p>使用static开头的属性时静态方法（类方法），可以直接通过类去访问</p></li></ul><h2 id="面向对象的特点"><a href="#面向对象的特点" class="headerlink" title="面向对象的特点"></a>面向对象的特点</h2><h3 id="封装"><a href="#封装" class="headerlink" title="封装"></a>封装</h3><ul><li><p>对象实质上就是属性和方法的容器，它的主要作用就是存储属性和方法，这就是所谓的封装</p></li><li><p>默认情况下，对象的属性是可以任意的修改的，为了确保数据的安全性，在TS中可以对属性的权限进行设置</p></li><li><p>只读属性（readonly）：</p><ul><li>如果在声明属性时添加一个readonly，则属性便成了只读属性无法修改</li></ul></li><li><p><strong>TS中属性具有三种修饰符</strong>：（怎么和Java差不多呀）</p><ul><li>public（默认值），可以在类、子类和对象中修改</li><li>protected ，可以在类、子类中修改</li><li>private ，可以在类中修改，添加set和get方法修改和获取属性</li></ul></li></ul><h4 id="public"><a href="#public" class="headerlink" title="public"></a>public</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>; <span class="hljs-comment">// 写或什么都不写都是public</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>;<br><br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, age: <span class="hljs-built_in">number</span></span>)&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name; <span class="hljs-comment">// 可以在类中修改</span><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;<br>    &#125;<br><br>    <span class="hljs-title function_">sayHello</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`大家好，我是<span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.name&#125;</span>`</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Employee</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Person</span>&#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, age: <span class="hljs-built_in">number</span></span>)&#123;<br>        <span class="hljs-variable language_">super</span>(name, age);<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name; <span class="hljs-comment">//子类中可以修改</span><br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&#x27;孙悟空&#x27;</span>, <span class="hljs-number">18</span>);<br>p.<span class="hljs-property">name</span> = <span class="hljs-string">&#x27;猪八戒&#x27;</span>;<span class="hljs-comment">// 可以通过对象修改</span><br></code></pre></td></tr></table></figure><h4 id="protected"><a href="#protected" class="headerlink" title="protected"></a>protected</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>;<br><br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, age: <span class="hljs-built_in">number</span></span>)&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name; <span class="hljs-comment">// 可以修改</span><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;<br>    &#125;<br><br>    <span class="hljs-title function_">sayHello</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`大家好，我是<span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.name&#125;</span>`</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Employee</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Person</span>&#123;<br><br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, age: <span class="hljs-built_in">number</span></span>)&#123;<br>        <span class="hljs-variable language_">super</span>(name, age);<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name; <span class="hljs-comment">//子类中可以修改</span><br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&#x27;孙悟空&#x27;</span>, <span class="hljs-number">18</span>);<br>p.<span class="hljs-property">name</span> = <span class="hljs-string">&#x27;猪八戒&#x27;</span>; <span class="hljs-comment">// 不能修改</span><br></code></pre></td></tr></table></figure><h4 id="private"><a href="#private" class="headerlink" title="private"></a>private</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>;<br><br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, age: <span class="hljs-built_in">number</span></span>)&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name; <span class="hljs-comment">// 可以修改</span><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;<br>    &#125;<br><br>    <span class="hljs-title function_">sayHello</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`大家好，我是<span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.name&#125;</span>`</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Employee</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Person</span>&#123;<br><br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, age: <span class="hljs-built_in">number</span></span>)&#123;<br>        <span class="hljs-variable language_">super</span>(name, age);<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name; <span class="hljs-comment">//子类中不能修改</span><br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&#x27;孙悟空&#x27;</span>, <span class="hljs-number">18</span>);<br>p.<span class="hljs-property">name</span> = <span class="hljs-string">&#x27;猪八戒&#x27;</span>;<span class="hljs-comment">// 不能修改</span><br></code></pre></td></tr></table></figure><h3 id="属性存取器"><a href="#属性存取器" class="headerlink" title="属性存取器"></a>属性存取器</h3><ul><li><p>对于一些不希望被任意修改的属性，可以将其设置为private</p></li><li><p>直接将其设置为<strong>private</strong>将导致无法再通过对象修改其中的属性</p></li><li><p>我们可以在类中定义一组读取、设置属性的方法，这种对属性读取或设置的属性被称为属性的存取器</p></li><li><p>读取属性的方法叫做<strong>setter</strong>方法，设置属性的方法叫做<strong>getter</strong>方法</p></li><li><p>示例：</p><ul><li><p>&#96;&#96;&#96;typescript<br>class Person{<br>private _name: string;<br><br>constructor(name: string){<br>    this._name &#x3D; name;<br>}<br><br>get name(){<br>    return this._name;<br>}<br><br>set name(name: string){<br>    this._name &#x3D; name;<br>}<br>}</p><p>const p1 &#x3D; new Person(‘孙悟空’);<br>console.log(p1.name); &#x2F;&#x2F; 通过getter读取name属性<br>p1.name &#x3D; ‘猪八戒’; &#x2F;&#x2F; 通过setter修改name属性</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs autoit"><br><span class="hljs-meta">#### 静态属性</span><br><br>- 静态属性（方法），也称为类属性。使用静态属性无需创建实例，通过类即可直接使用<br><br>- 静态属性（方法）使用<span class="hljs-keyword">static</span>开头<br><br>- 示例：<br><br>  - ```typescript<br>    class Tools&#123;<br>        <span class="hljs-keyword">static</span> PI = <span class="hljs-number">3.1415926</span><span class="hljs-comment">;</span><br>        <br>        <span class="hljs-keyword">static</span> sum(num1: <span class="hljs-built_in">number</span>, num2: <span class="hljs-built_in">number</span>)&#123;<br>            <span class="hljs-keyword">return</span> num1 + num2<br>        &#125;<br>    &#125;<br>    <br>    console.<span class="hljs-built_in">log</span>(Tools.PI)<span class="hljs-comment">;</span><br>    console.<span class="hljs-built_in">log</span>(Tools.sum(<span class="hljs-number">123</span>, <span class="hljs-number">456</span>))<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure></li></ul></li></ul><h4 id="this"><a href="#this" class="headerlink" title="this"></a>this</h4><ul><li>在类中，<strong>使用this表示当前对象</strong></li></ul><h4 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h4><ul><li><p>继承时面向对象中的又一个特性</p></li><li><p>通过继承可以将其他类中的属性和方法引入到当前类中</p><ul><li><p>示例：</p><ul><li><p>&#96;&#96;&#96;typescript<br>class Animal{<br>name: string;<br>age: number;<br><br>constructor(name: string, age: number){<br>    this.name &#x3D; name;<br>    this.age &#x3D; age;<br>}<br>}</p><p>class Dog extends Animal{</p><pre><code class="hljs">bark()&#123;    console.log(`$&#123;this.name&#125;在汪汪叫！`);&#125;</code></pre><p>}</p><p>const dog &#x3D; new Dog(‘旺财’, 4);<br>dog.bark();</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript"><br>- 通过继承可以在不修改类的情况下完成对类的扩展<br><br>- **重写**<br><br>  - 发生继承时，如果**子类中的方法会替换掉父类中的同名方法**，这就称为方法的重写<br><br>  - 示例：<br><br>    - ```<span class="language-javascript">typescript</span><br><span class="language-javascript">      <span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span>&#123;</span><br><span class="language-javascript">          <span class="hljs-attr">name</span>: string;</span><br><span class="language-javascript">          <span class="hljs-attr">age</span>: number;</span><br><span class="language-javascript">      </span><br><span class="language-javascript">          <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: string, age: number</span>)&#123;</span><br><span class="language-javascript">              <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;</span><br><span class="language-javascript">              <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;</span><br><span class="language-javascript">          &#125;</span><br><span class="language-javascript">      </span><br><span class="language-javascript">          <span class="hljs-title function_">run</span>(<span class="hljs-params"></span>)&#123;</span><br><span class="language-javascript">              <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`父类中的run方法！`</span>);</span><br><span class="language-javascript">          &#125;</span><br><span class="language-javascript">      &#125;</span><br><span class="language-javascript">      </span><br><span class="language-javascript">      <span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Animal</span>&#123;</span><br><span class="language-javascript">      </span><br><span class="language-javascript">          <span class="hljs-title function_">bark</span>(<span class="hljs-params"></span>)&#123;</span><br><span class="language-javascript">              <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.name&#125;</span>在汪汪叫！`</span>);</span><br><span class="language-javascript">          &#125;</span><br><span class="language-javascript">      </span><br><span class="language-javascript">          <span class="hljs-title function_">run</span>(<span class="hljs-params"></span>)&#123;</span><br><span class="language-javascript">              <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`子类中的run方法，会重写父类中的run方法！`</span>);</span><br><span class="language-javascript">          &#125;</span><br><span class="language-javascript">      &#125;</span><br><span class="language-javascript">      </span><br><span class="language-javascript">      <span class="hljs-keyword">const</span> dog = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>(<span class="hljs-string">&#x27;旺财&#x27;</span>, <span class="hljs-number">4</span>);</span><br><span class="language-javascript">      dog.<span class="hljs-title function_">bark</span>();</span><br></code></pre></td></tr></table></figure></li></ul></li></ul></li><li><p>在子类中可以使用<code>super</code>来完成对父类的引用</p><ul><li><p>如果在子类写了构造函数，在字类构造函数必须对父类的构造函数进行调用</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span>&#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;<br><br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span></span>)&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;<br>    &#125;<br><br>    <span class="hljs-title function_">run</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`父类中的run方法！`</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Animal</span>&#123;<br><span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, age: <span class="hljs-built_in">number</span></span>)&#123;<br>        <span class="hljs-variable language_">super</span>(name);<span class="hljs-comment">//调用父类的构造函数</span><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> dog = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>(<span class="hljs-string">&#x27;旺财&#x27;</span>, <span class="hljs-number">4</span>);<br>dog.<span class="hljs-title function_">bark</span>();<br></code></pre></td></tr></table></figure></li></ul></li></ul><h4 id="抽象类（abstract-class）"><a href="#抽象类（abstract-class）" class="headerlink" title="抽象类（abstract class）"></a>抽象类（abstract class）</h4><ul><li><p>抽象类是专门用来被其他类所继承的类，它<strong>只能被其他类所继承不能用来创建实例</strong></p></li><li><pre><code class="typescript">abstract class Animal&#123;    abstract run(): void;    bark()&#123;        console.log(&#39;动物在叫~&#39;);    &#125;&#125;class Dog extends Animals&#123;    run()&#123;        console.log(&#39;狗在跑~&#39;);    &#125;&#125;<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs php"><br>- 使用<span class="hljs-keyword">abstract</span>开头的方法叫做**抽象方法**，抽象方法**没有方法体**只能定义在抽象类中，继承抽象类时抽象方法必须要**实现**<br><br><span class="hljs-comment">## 接口（Interface）</span><br><br>接口的作用类似于抽象类，不同点在于接口中的**所有方法和属性都是没有实值的**，换句话说接口中的**所有方法都是抽象方法**。接口主要负责定义**一个类的结构**，接口可以去限制一个对象的接口，**对象只有包含接口中定义的所有属性和方法时才能匹配接口**。同时，可以让一个类去实现接口，实现接口时类中要保护接口中的所有属性。<br><br>- 示例（检查对象类型）：<br><br>  - ```typescript<br>    <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Person</span></span>&#123;<br>        name: <span class="hljs-keyword">string</span>;<br>        <span class="hljs-title function_ invoke__">sayHello</span>():<span class="hljs-keyword">void</span>;<br>    &#125;<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fn</span>(<span class="hljs-params">per: Person</span>)</span>&#123;<br>        per.<span class="hljs-title function_ invoke__">sayHello</span>();<br>    &#125;<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">fn</span>(<span class="hljs-params">&#123;name:<span class="hljs-string">&#x27;孙悟空&#x27;</span>, sayHello(<span class="hljs-params"></span>) &#123;console.log(<span class="hljs-params">`Hello, 我是 $&#123;this.name&#125;`</span>)&#125;&#125;</span>)</span>;<br>    <br></code></pre></td></tr></table></figure></code></pre></li><li><p>示例（实现）</p><ul><li><pre><code class="typescript">interface Person&#123;    name: string;    sayHello():void;&#125;class Student implements Person&#123;    constructor(public name: string) &#123;    &#125;    sayHello() &#123;        console.log(&#39;大家好，我是&#39;+this.name);    &#125;&#125;<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs ada"><br>  - <br><br><br><br>## 泛型（<span class="hljs-keyword">Generic</span>）<br><br>定义一个函数或类时，有些情况下无法确定其中要使用的具体类型（返回值、参数、属性的类型不能确定），此时泛型便能够发挥作用。<br><br>- 举个例子：<br><br>  - ```typescript<br>    <span class="hljs-keyword">function</span> <span class="hljs-title">test</span>(arg: any): any&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-type">arg</span>;<br>    &#125;<br></code></pre></td></tr></table></figure></code></pre></li><li><p>上例中，test函数有一个参数类型不确定，但是能确定的时其返回值的类型和参数的类型是相同的，由于类型不确定所以参数和返回值均使用了any，但是很明显这样做是不合适的，首先使用any会关闭TS的类型检查，其次这样设置也不能体现出参数和返回值是相同的类型</p></li><li><p>使用泛型：</p></li><li><pre><code class="typescript">function test&lt;T&gt;(arg: T): T&#123;    return arg;&#125;<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs r"><br><span class="hljs-operator">-</span> 这里的```&lt;T&gt;```就是泛型，<span class="hljs-built_in">T</span>是我们给这个类型起的名字（不一定非叫<span class="hljs-built_in">T</span>），设置泛型后即可在函数中使用<span class="hljs-built_in">T</span>来表示该类型。<span class="hljs-operator">*</span><span class="hljs-operator">*</span>所以泛型其实很好理解，就表示某个类型。<span class="hljs-operator">*</span><span class="hljs-operator">*</span><br><br><span class="hljs-operator">-</span> 那么如何使用上边的函数呢？<br><br>  <span class="hljs-operator">-</span> 方式一（直接使用）：<br><br>    <span class="hljs-operator">-</span> ```typescript<br>      test(10)<br></code></pre></td></tr></table></figure>  - 使用时可以直接传递参数使用，类型会由TS自动推断出来，但有时编译器无法自动推断时还需要使用下面的方式- 方式二（指定类型）：  - ```typescript    test&lt;number&gt;(10)    <figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs ada"><br>    - 也可以在函数后手动指定泛型<br><br>- 可以同时指定多个泛型，泛型间使用逗号隔开：<br><br>  - ```typescript<br>    <span class="hljs-keyword">function</span> <span class="hljs-title">test&lt;T,</span> K&gt;(a: T, b: K): K&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-type">b</span>;<br>    &#125;<br>    <br>    test&lt;number, string&gt;(<span class="hljs-number">10</span>, <span class="hljs-string">&quot;hello&quot;</span>);<br></code></pre></td></tr></table></figure>- 使用泛型时，完全可以将**泛型当成是一个普通的类**去使用</code></pre></li><li><p>类中同样可以使用泛型：</p><ul><li><pre><code class="typescript">class MyClass&lt;T&gt;&#123;    prop: T;    constructor(prop: T)&#123;        this.prop = prop;    &#125;&#125;<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs ada"><br>- 除此之外，也可以对泛型的范围进行约束<br><br>  - ```typescript<br>    <span class="hljs-keyword">interface</span> MyInter&#123;<br>        length: number;<br>    &#125;<br>    <br>    <span class="hljs-keyword">function</span> <span class="hljs-title">test&lt;T</span> extends MyInter&gt;(arg: T): number&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-type">arg.length</span>;<br>    &#125;<br></code></pre></td></tr></table></figure></code></pre></li><li><p>使用T extends MyInter表示泛型T必须是MyInter的子类，不一定非要使用接口类和抽象类同样适用。</p></li></ul></li></ul></li></ul>]]></content>
    
    
    <categories>
      
      <category>笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>javascript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>symbol</title>
    <link href="/2023/03/22/%E7%AC%94%E8%AE%B0/symbol/"/>
    <url>/2023/03/22/%E7%AC%94%E8%AE%B0/symbol/</url>
    
    <content type="html"><![CDATA[<h2 id="symbol"><a href="#symbol" class="headerlink" title="symbol"></a>symbol</h2><h3 id="1、什么是symbol"><a href="#1、什么是symbol" class="headerlink" title="1、什么是symbol"></a>1、什么是symbol</h3><blockquote><p>Symbol是ES6中引入的一种新的基本数据类型，用于表示一个独一无二的值。它是JavaScript中的第七种数据类型，与undefined、null、Number（数值）、String（字符串）、Boolean（布尔值）、Object（对象）并列。</p></blockquote><p>创建：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> a = <span class="hljs-title class_">Symbol</span>();<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a);  <span class="hljs-comment">//Symbol()</span><br></code></pre></td></tr></table></figure><ul><li>使用Symbol函数可以生成一个Symbol类型的值，但是你不能在调用Symbol时使用new关键字，因为Symbol是基本数据类型，而不是对象</li></ul><p>使用Symbol()创建一个Symbol类型的值并赋值给a变量后，你就得到了一个在内存中独一无二的值。现在除了通过变量a，任何人在任何作用域内都无法重新创建出这个值。例如当你这样写：</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">const b <span class="hljs-operator">=</span> Symbol()<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><p>尽管a和b都是使用Symbol()创建出来的，但是它们在内存中看起来却是这样的：</p><p><img src="C:\Users\谢红尘\笔记\图片\symbol.png" alt="symbol"></p><p>实际上，a变量拿到了内存中某块内存的唯一引用（这里所说的引用，其实就是该内存的地址）。如果不借助a变量，你不可能再得到这个地址。因此：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">a !== b;  <span class="hljs-regexp">//</span>a和b持有的是两块内存的引用<br><br>const c = a;  <span class="hljs-regexp">//</span>手动把a里保存的地址保存在c变量中<br>a === c;  <span class="hljs-regexp">//</span>c和a现在指向同一块内存，因为它们保存了同样的地址<br></code></pre></td></tr></table></figure><p><img src="C:\Users\谢红尘\笔记\图片\symbol1.png" alt="symbol1"></p><h3 id="2、Symbol的作用"><a href="#2、Symbol的作用" class="headerlink" title="2、Symbol的作用"></a>2、Symbol的作用</h3><p>如果a中的属性是使用Symbol类型的变量作为键，那么它就无法被篡改：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//模块A.js</span><br><span class="hljs-keyword">var</span> s = <span class="hljs-title class_">Symbol</span>();<br><span class="hljs-keyword">var</span> a = &#123;<br><span class="hljs-attr">name</span>: <span class="hljs-string">&quot;夕山雨&quot;</span>,<br><span class="hljs-comment">//s是个变量，因此需要用中括号包裹起来</span><br>    [s]: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;  <br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>;<br>    &#125;<br>&#125;<br><span class="hljs-built_in">exports</span> <span class="hljs-keyword">default</span> a;<br><br><span class="hljs-comment">//模块B.js</span><br><span class="hljs-keyword">var</span> a = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;A.js&quot;</span>);<br><span class="hljs-keyword">var</span> s = <span class="hljs-title class_">Symbol</span>();<br><br>a[s] = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>    ...  <span class="hljs-comment">//它不会对A模块中的[s]属性造成任何影响，因为两个模块的[s]不是同一个属性</span><br>&#125;<br></code></pre></td></tr></table></figure><ul><li>现在，我们使用一个Symbol类型的变量作为对象属性的键。由于s是一个<strong>变量</strong>，而不是字符串，因此需要使用<strong>中括号</strong>括起来（否则它会被当做字符串对待）。</li><li>通过把对象的属性的键值设置为Symbol类型，我们有效避免了对象属性被修改，在模块化开发中，对象本身也就更安全。</li></ul><p><img src="C:\Users\谢红尘\笔记\图片\symbol2.png" alt="symbol2"></p><p>通常来说，如果想要修改对象的某个属性，那么你首先需要获得这个属性的键，参考上面的内存图，实际上就是获得这个键在<strong>内存中的地址</strong>（也就是变量s指向的那个内存区）。</p><h3 id="3、Symbol的语法规范"><a href="#3、Symbol的语法规范" class="headerlink" title="3、Symbol的语法规范"></a>3、Symbol的语法规范</h3><h4 id="1、基本语法"><a href="#1、基本语法" class="headerlink" title="1、基本语法"></a>1、基本语法</h4><p>创建一个Symbol变量：</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">var s <span class="hljs-operator">=</span> Symbol()<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><p>由于<strong>Symbol不是继承自Object</strong>，因此不可以使用<strong>new关键字</strong>来生成Symbol变量。使用上述语句创建的变量s，在控制台中进行输出时会显示为Symbol()。假如有另一个变量：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> b = <span class="hljs-title class_">Symbol</span>();<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(s);  <span class="hljs-comment">//Symbol()</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(b);  <span class="hljs-comment">//Symbol()</span><br></code></pre></td></tr></table></figure><p>变量s和变量b并不是同一个值，但它们在控制台的输出却是一样的，这样不利于我们区分两个变量。为此，我们可以在调用Symbol的时候传入一个字符串作为对当前Symbol变量的描述：</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-keyword">var</span> s = Symbol(<span class="hljs-string">&quot;symbol1&quot;</span>);<br><span class="hljs-keyword">var</span> b = Symbol(<span class="hljs-string">&quot;symbol2&quot;</span>);<br><br><span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(s); <span class="hljs-comment">//Symbol(&quot;symbol1&quot;)</span><br><span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(b); <span class="hljs-comment">//Symbol(&quot;symbol2&quot;)</span><br></code></pre></td></tr></table></figure><p>现在我们可以在控制台中区分开变量s和变量b了。</p><p>需要注意的是，<strong>使用相同描述符的两个Symbol并不相等</strong>：</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">var</span> s = <span class="hljs-built_in">Symbol</span>(<span class="hljs-string">&quot;s&quot;</span>);<br><span class="hljs-keyword">var</span> b = <span class="hljs-built_in">Symbol</span>(<span class="hljs-string">&quot;s&quot;</span>);<br><br>s !== b;<br></code></pre></td></tr></table></figure><p>如果你希望得到一个Symbol的<strong>描述符</strong>，可以借助Symbol原型上的description属性（Symbol.prototype.description）：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> sym = <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">&#x27;My symbol&#x27;</span>);<br><span class="hljs-title class_">String</span>(sym) <span class="hljs-comment">// &#x27;Symbol(My symbol)&#x27;</span><br>sym.<span class="hljs-title function_">toString</span>() <span class="hljs-comment">// &#x27;Symbol(My symbol)&#x27;</span><br><br><span class="hljs-keyword">let</span> sym2 = <span class="hljs-title class_">Symbol</span>();<br><span class="hljs-title class_">Boolean</span>(sym2) <span class="hljs-comment">// true</span><br></code></pre></td></tr></table></figure><p>Symbol还可以显式的转化为字符串或布尔值，<strong>但是不能转化为数值</strong>：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> sym = <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">&#x27;My symbol&#x27;</span>);<br><span class="hljs-title class_">String</span>(sym) <span class="hljs-comment">// &#x27;Symbol(My symbol)&#x27;</span><br>sym.<span class="hljs-title function_">toString</span>() <span class="hljs-comment">// &#x27;Symbol(My symbol)&#x27;</span><br><br><span class="hljs-keyword">let</span> sym2 = <span class="hljs-title class_">Symbol</span>();<br><span class="hljs-title class_">Boolean</span>(sym2) <span class="hljs-comment">// true</span><br></code></pre></td></tr></table></figure><h4 id="2、Symbol属性的遍历"><a href="#2、Symbol属性的遍历" class="headerlink" title="2、Symbol属性的遍历"></a>2、Symbol属性的遍历</h4><ul><li>以Symbol类型的变量作为对象属性时，该属性不会出现在for … in、for … of循环中，也不会被Object.keys()、Object.getOwnPropertyNames()、JSON.stringify()返回。</li></ul><blockquote><p>但该属性并不是私有属性，它可以被专门的Object.getOwnPropertySymbols()方法遍历出来。该方法返回一个数组，包含了当前对象的所有用作属性名的Symbol值：</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs html">var s1 = Symbol(&#x27;a&#x27;);<br>var s2 = Symbol(&#x27;b&#x27;);<br><br>var a = &#123;<br>    name: &quot;夕山雨&quot;,<br>    [s1]: 24,<br>    [s2]: function()&#123;&#125;<br>&#125;<br><br>var s = Object.getOwnPropertySymbols(a); //[Symbol(a), Symbol(b)]<br>a[s[0]] = 24; //返回的数组元素不是字符串，而是实际的Symbol值，<br>               //因此可以通过它引用到对象的该属性<br></code></pre></td></tr></table></figure><ul><li>因此遍历该方法的返回值即可遍历所有的Symbol属性</li></ul><blockquote><p>ES6新增的Reflect.ownKeys()方法可以遍历出所有的常规键名和Symbol键名。语法为:</p></blockquote><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript"><span class="hljs-built_in">Reflect</span>.ownKeys(a); <span class="hljs-regexp">//</span>[<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-built_in">Symbol</span>(a), <span class="hljs-built_in">Symbol</span>(b)]<br></code></pre></td></tr></table></figure><h4 id="3、Symbol-for-，Symbol-keyFor"><a href="#3、Symbol-for-，Symbol-keyFor" class="headerlink" title="3、Symbol.for()，Symbol.keyFor()"></a>3、Symbol.for()，Symbol.keyFor()</h4><p>Symbol提供了一种可以创建相同Symbol的机制，就是使用Symbol.for()方法进行注册。通过该方法生成的Symbol会根据描述符进行全局注册，之后再次通过Symbol.for()传入相同的描述符时，就可以得到相同的Symbol值。如：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> s1 = <span class="hljs-title class_">Symbol</span>.<span class="hljs-title function_">for</span>(<span class="hljs-string">&#x27;symbol&#x27;</span>);  <span class="hljs-comment">//向全局注册了以&quot;symbol&quot;为描述符的Symbol浅拷贝</span><br><span class="hljs-comment">//由于描述符&quot;symbol&quot;已被注册到全局，因此这里创建的Symbol与上面是同一个</span><br><span class="hljs-keyword">var</span> s2 = <span class="hljs-title class_">Symbol</span>.<span class="hljs-title function_">for</span>(<span class="hljs-string">&#x27;symbol&#x27;</span>);  <br><br>s1 === s2;<br></code></pre></td></tr></table></figure><p>这里指的全局不单指该变量所在的作用域，它在各个iframe甚至service worker中都是有效的，因此这是一种允许不同作用域创建相同Symbol的机制。</p><p>如果你想得到一个全局注册的Symbol的描述符，可以使用Symbol.keyFor()方法：</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Symbol</span>.</span></span>key<span class="hljs-constructor">For(<span class="hljs-params">s1</span>)</span>;  <span class="hljs-comment">//&quot;symbol&quot;</span><br></code></pre></td></tr></table></figure><p>它输出了变量s1的全局注册标识符“symbol”。</p><h4 id="4、内置的Symbol值"><a href="#4、内置的Symbol值" class="headerlink" title="4、内置的Symbol值"></a>4、内置的Symbol值</h4><h5 id="1-Symbol-hasInstance"><a href="#1-Symbol-hasInstance" class="headerlink" title="1. Symbol.hasInstance"></a>1. Symbol.hasInstance</h5><p>当使用instanceof运算符判断某个对象是否为某个构造函数的实例时，就是在调用该构造函数上的静态方法[Symbol.hasInstance]，它是js引擎预先定义好的。如：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js">[] <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Array</span>;  <span class="hljs-comment">//true</span><br><br><span class="hljs-comment">//浏览器实际上是在调用下面的方法</span><br><span class="hljs-title class_">Array</span>[<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">hasInstance</span>]([]);<br></code></pre></td></tr></table></figure><p>实际上，instanceof右侧不要求一定是构造函数，也可以是一个普通的对象，只要该对象实现了[Symbol.hasInstance]方法即可。如：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//1. 使用构造函数 </span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">F</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-variable language_">this</span>[<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">hasInstance</span>] = <span class="hljs-keyword">function</span>(<span class="hljs-params">obj</span>)&#123;<br>        <span class="hljs-keyword">return</span> obj.<span class="hljs-property">constructor</span> === F;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">var</span> f = <span class="hljs-keyword">new</span> <span class="hljs-title function_">F</span>();<br>f <span class="hljs-keyword">instanceof</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">F</span>();  <span class="hljs-comment">//true</span><br><br><span class="hljs-comment">//2. 使用class</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span> &#123;<br>  [<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">hasInstance</span>](foo) &#123;<br>    <span class="hljs-keyword">return</span> foo <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Array</span>;<br>  &#125;<br>&#125;<br><br>[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>] <span class="hljs-keyword">instanceof</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyClass</span>() <span class="hljs-comment">// true</span><br><br><span class="hljs-comment">//3. 直接使用一个实现了Symbol.hasInstance的对象</span><br><span class="hljs-keyword">var</span> a = &#123;<br>  [<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">hasInstance</span>](foo) &#123;<br>    <span class="hljs-keyword">return</span> foo <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Array</span>;<br>  &#125;<br>&#125;<br><br>[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>] <span class="hljs-keyword">instanceof</span> a <span class="hljs-comment">// true</span><br></code></pre></td></tr></table></figure><ul><li><p>总的来说，instanceof的行为就是，遇到a instanceof b这样的语句，就调用b<a href="a">Symbol.hasInstance</a>，该函数的返回值就是该语句的返回值。这里如果b是构造函数，就调用它的静态方法，如果是对象，就调用它的实例方法或原型方法。</p></li><li><p>不过，如果instanceof右侧不包含[Symbol.hasInstance]方法，那么浏览器会抛出这样的错误：Right-hand side of ‘instanceof’ is not callable，表示右侧不可被instanceof运算符调用。</p></li></ul><h5 id="2、Symbol-isConcatSpreadable"><a href="#2、Symbol-isConcatSpreadable" class="headerlink" title="2、Symbol.isConcatSpreadable"></a>2、Symbol.isConcatSpreadable</h5><p>属性决定了当前对象作为<code>concat</code>的参数时是否可以展开。通常：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> obj = &#123;<span class="hljs-attr">age</span>: <span class="hljs-number">24</span>&#125;;<br>[<span class="hljs-number">1</span>].<span class="hljs-title function_">concat</span>(obj); <span class="hljs-comment">//[1, &#123;age: 24&#125;]</span><br></code></pre></td></tr></table></figure><p>obj被传入concat后会直接作为一个元素添加到数组中。通过将obj的Symbol.isConcatSpreadable属性设置为true，obj会在执行concat时尝试展开，如果该对象无法展开，obj不会被拼接到数组中去。所谓的可展开，指的是obj是否为数组或类数组结构。如果obj是数组，显然是可展开的，如果它有length属性，并且有”0”，”1”这样的属性键，那么它就是类数组，也是可以展开的：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//设置了该对象需要展开，但它无法展开，因此最终结果为[]</span><br><span class="hljs-keyword">var</span> obj = &#123;<span class="hljs-attr">age</span>: <span class="hljs-number">24</span>, [<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">isConcatSpreadable</span>]: <span class="hljs-literal">true</span>&#125;;<br>[].<span class="hljs-title function_">concat</span>(obj); <span class="hljs-comment">//[]</span><br><br><span class="hljs-comment">//这是一个类数组对象，它是可展开的</span><br><span class="hljs-keyword">var</span> obj = &#123;<br>  <span class="hljs-attr">length</span>: <span class="hljs-number">2</span>, <br>  <span class="hljs-string">&quot;0&quot;</span>: <span class="hljs-number">24</span>, <br>  <span class="hljs-string">&quot;1&quot;</span>: <span class="hljs-number">25</span>, <br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;夕山雨&quot;</span>,<br>  [<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">isConcatSpreadable</span>]: <span class="hljs-literal">true</span><br>&#125;;<br><span class="hljs-comment">//name属性被丢弃了，因为它无法被obj[index]的方式引用到</span><br>[].<span class="hljs-title function_">concat</span>(obj); <span class="hljs-comment">//[24, 25]</span><br></code></pre></td></tr></table></figure><h5 id="3、Symbol-species"><a href="#3、Symbol-species" class="headerlink" title="3、Symbol.species"></a>3、Symbol.species</h5><p>该属性用于在继承的时候指定一个类的类别。如：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">T1</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Promise</span> &#123;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">T2</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Promise</span> &#123;<br>  <span class="hljs-keyword">static</span> get [<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">species</span>]() &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>;<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">new</span> <span class="hljs-title function_">T1</span>() <span class="hljs-keyword">instanceof</span> <span class="hljs-variable constant_">T1</span> <span class="hljs-comment">// true</span><br><span class="hljs-keyword">new</span> <span class="hljs-title function_">T2</span>() <span class="hljs-keyword">instanceof</span> <span class="hljs-variable constant_">T2</span> <span class="hljs-comment">// false</span><br></code></pre></td></tr></table></figure><p>对于T1，由它构造出的实例默认都是T1的实例。而在T2中我们为该类定义了[Symbol.species]方法，它始终返回Promise，因此由T2构造出的实例都不再被认为是T2的实例，而是Promise的实例。</p><p>该方法允许我们在定义衍生对象时，人为指定由它构造出的实例的构造函数。</p><h5 id="4、Symbol-match-x2F-replace-x2F-search-x2F-split"><a href="#4、Symbol-match-x2F-replace-x2F-search-x2F-split" class="headerlink" title="4、Symbol.match&#x2F;replace&#x2F;search&#x2F;split"></a>4、Symbol.match&#x2F;replace&#x2F;search&#x2F;split</h5><p>这四个方法允许我们以对象的方式<strong>自定义</strong>String的match、replace、search、split方法。以match为例，我们通常这样调用它：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> s = <span class="hljs-string">&quot;hello&quot;</span>;<br>s.<span class="hljs-title function_">match</span>(<span class="hljs-title class_">RegExp</span>);  <span class="hljs-comment">//匹配一个正则表达式</span><br></code></pre></td></tr></table></figure><p>假如我们需要为当前的字符串s定制一个自己的match方法，但是又不希望修改String原型上的match方法（因为这样会影响到其他的字符串调用match方法）。Symbol.match就为我们提供了这种能力。</p><p>对于上面的例子，如果传入的对象具有[Symbol.match]方法，那么js引擎就会修改match方法默认的行为，去调用定义的[Symbol.match]方法。如:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> a = &#123;<br>    [<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">match</span>]()&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-string">&quot;hello&quot;</span>.<span class="hljs-title function_">match</span>(a);  <span class="hljs-comment">//true</span><br></code></pre></td></tr></table></figure><p>当调用字符串的match方法并传入具有[Symbol.match]属性的对象时，js引擎就会调用对象的这个方法。</p><p>上面的写法等同于下面的写法：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">a[<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">match</span>](<span class="hljs-string">&quot;hello&quot;</span>);  <span class="hljs-comment">//true</span><br></code></pre></td></tr></table></figure><p>replace、search和split也是相同的原理。下面分别给一个简单的例子：</p><p><strong>replace:</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> x = &#123;&#125;;<br>x[<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">replace</span>] = <span class="hljs-function">(<span class="hljs-params">...s</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(s);<br><br><span class="hljs-string">&#x27;Hello&#x27;</span>.<span class="hljs-title function_">replace</span>(x, <span class="hljs-string">&#x27;World&#x27;</span>) <span class="hljs-comment">// [&quot;Hello&quot;, &quot;World&quot;]</span><br></code></pre></td></tr></table></figure><p>由于replace的第一个参数有[Symbol.replace]方法，因此js引擎会调用这个方法，并把调用者‘Hello’和第二个参数‘World’作为参数传递给该方法。这样，上面的写法就等同于：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">x[<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">replace</span>](<span class="hljs-string">&quot;Hello&quot;</span>, <span class="hljs-string">&quot;world&quot;</span>);<br></code></pre></td></tr></table></figure><p><strong>search:</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> a = &#123;<br>    [<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">match</span>]()&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-string">&quot;hello&quot;</span>.<span class="hljs-title function_">search</span>(a);  <span class="hljs-comment">//true</span><br></code></pre></td></tr></table></figure><ul><li>原理同match</li></ul><p><strong>split：</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> a = &#123;<br>    <span class="hljs-attr">sep</span>: <span class="hljs-string">&quot;,&quot;</span>,<br>    [<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">match</span>](t)&#123;<br>        <span class="hljs-keyword">return</span> t.<span class="hljs-title function_">split</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">sep</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-string">&quot;hello,world&quot;</span>.<span class="hljs-title function_">split</span>(a);  <span class="hljs-comment">//[&quot;hello&quot;, &quot;world&quot;]</span><br></code></pre></td></tr></table></figure><ul><li>原理也与match相同</li></ul><h5 id="5、Symbol-iterator"><a href="#5、Symbol-iterator" class="headerlink" title="5、Symbol.iterator"></a>5、Symbol.iterator</h5><p>定义一个对象的遍历器方法。凡是具有[Symbol.iterator]方法的对象都是可遍历的，可以使用for … of循环依次输出对象的每个属性。数组和类数组，以及ES6新增的Map、Set等都原生部署了该方法，因此它们都可遍历。如：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> item <span class="hljs-keyword">of</span> [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>])&#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(item); <span class="hljs-comment">//依次输出1，2，3</span><br>&#125;<br></code></pre></td></tr></table></figure><p>任何一个数组都具备这个原生的遍历器方法：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js">&gt; [][<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">iterator</span>]<br><br>&lt; ƒ <span class="hljs-title function_">values</span>(<span class="hljs-params"></span>) &#123; [native code] &#125; <span class="hljs-comment">//C++实现</span><br></code></pre></td></tr></table></figure><p>普通对象默认不具有该遍历器方法，因此无法用for … of循环遍历出对象所有的属性值。如果你希望让普通对象可遍历，可以手动为该对象定义遍历器方法，如：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> a = &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;夕山雨&quot;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">24</span>,<br>    [<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">iterator</span>]: <span class="hljs-keyword">function</span>* ()&#123;<br>        <span class="hljs-keyword">yield</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>;<br>        <span class="hljs-keyword">yield</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>这里为了简单，使用了ES6的Generator函数，它定义该遍历器先输出name属性，再输出age属性。因此当你用for … of来输出a的属性值时，就可以得到结果：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> item <span class="hljs-keyword">of</span> a)&#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(item);  <span class="hljs-comment">//依次输出：&quot;夕山雨&quot;  24</span><br>&#125;<br></code></pre></td></tr></table></figure><h5 id="6、Symbol-toPrimitive"><a href="#6、Symbol-toPrimitive" class="headerlink" title="6、Symbol.toPrimitive"></a>6、Symbol.toPrimitive</h5><p>该方法定义了一个对象如何被转化为一个基本数据类型。通常对象是不能直接与基本数据类型的变量进行运算的，但是如果你为它定义了[Symbol.toPrimitive]方法，它就可以按照你所指定的规则转化为基本数据类型。它接收一个字符串，表示需要转换成的数据类型：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> obj = &#123;<br>  [<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">toPrimitive</span>](hint) &#123;<br>    <span class="hljs-keyword">switch</span> (hint) &#123;<br>      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;number&#x27;</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">123</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;string&#x27;</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;str&#x27;</span>;<br>      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;default&#x27;</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;default&#x27;</span>;<br>      <span class="hljs-attr">default</span>:<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>();<br>     &#125;<br>   &#125;<br>&#125;;<br><br><span class="hljs-number">2</span> * obj <span class="hljs-comment">// 246</span><br><span class="hljs-number">3</span> + obj <span class="hljs-comment">// &#x27;3default&#x27;</span><br>obj == <span class="hljs-string">&#x27;default&#x27;</span> <span class="hljs-comment">// true</span><br><span class="hljs-title class_">String</span>(obj) <span class="hljs-comment">// &#x27;str&#x27;</span><br></code></pre></td></tr></table></figure><p>这里表示，如果对象需要转化为数字，就返回123；如果需要转化为字符串，就转化为’str’；如果没有指定要转化的类型，那就返回字符串’Default’。</p><p>由于乘法运算*只能对数值操作，因此js引擎会调用[Symbol.toPrimitive]并传入”number”，将obj转化为数字。而加法既可以对数值生效，也可以对字符串生效，因此js引擎传入了”default”。该方法默认只接受number、string和default这三个值。</p><h5 id="7、Symbol-toStringTag"><a href="#7、Symbol-toStringTag" class="headerlink" title="7、Symbol.toStringTag"></a>7、Symbol.toStringTag</h5><p>可以自定义对象的toString()方法。通常对象的toString方法会返回一个类似[object Object]的字符串，表示该对象的类型，如：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> a = &#123;&#125;;<br><br>a.<span class="hljs-title function_">toString</span>();  <span class="hljs-comment">//&quot;[object Object]&quot;</span><br></code></pre></td></tr></table></figure><p>但是如果你修改了对象的Symbol.toStringTag方法，返回值就会发生变化：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js">a[<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">toStringTag</span>] = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;xxx&quot;</span>;<br>&#125;<br>a.<span class="hljs-title function_">toString</span>(); <span class="hljs-comment">//&quot;[object xxx]&quot;</span><br></code></pre></td></tr></table></figure><p>可以看到，我们定义的返回值覆盖了之前的字符串中的后半部分“Object”，因此该方法可以用于定制对象的toString()的返回值。</p><h5 id="8、Symbol-unscopables"><a href="#8、Symbol-unscopables" class="headerlink" title="8、Symbol.unscopables"></a>8、Symbol.unscopables</h5><p>该方法用于with语句。它指定在使用with语句时，哪些属性不属于with环境。举个例子：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> author = &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;夕山雨&quot;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">24</span>,<br>    <span class="hljs-attr">stature</span>: <span class="hljs-string">&quot;179&quot;</span>,<br>    <span class="hljs-attr">weight</span>: <span class="hljs-number">65</span><br>&#125;<br><br><span class="hljs-keyword">var</span> name = <span class="hljs-string">&quot;张三&quot;</span>;<br><span class="hljs-keyword">var</span> age = <span class="hljs-string">&quot;28&quot;</span>;<br><br><span class="hljs-title function_">with</span>(<span class="hljs-params">author</span>)&#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(name);  <span class="hljs-comment">//“夕山雨”</span><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(age);   <span class="hljs-comment">//24</span><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(stature);  <span class="hljs-comment">//&quot;179&quot;</span><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(weight);   <span class="hljs-comment">//65</span><br>&#125;<br></code></pre></td></tr></table></figure><p>默认情况下，对于with语句内引用的变量，js引擎会优先去with的作用对象上查找对应的属性，如果找不到，才认为是外部变量。但是你可以人为指定哪些属性不应该去作用对象上查找，如：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> author = &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;夕山雨&quot;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">24</span>,<br>    <span class="hljs-attr">stature</span>: <span class="hljs-string">&quot;179&quot;</span>,<br>    <span class="hljs-attr">weight</span>: <span class="hljs-number">65</span>,<br>    get [<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">unscopables</span>]()&#123;<br>      <span class="hljs-keyword">return</span> &#123; <span class="hljs-attr">name</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">age</span>: <span class="hljs-literal">true</span> &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">var</span> name = <span class="hljs-string">&quot;张三&quot;</span>;<br><span class="hljs-keyword">var</span> age = <span class="hljs-string">&quot;28&quot;</span>;<br><span class="hljs-keyword">var</span> stature = <span class="hljs-string">&quot;153&quot;</span>;<br><span class="hljs-keyword">var</span> weight = <span class="hljs-number">80</span>;<br><br><span class="hljs-title function_">with</span>(<span class="hljs-params">author</span>)&#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(name);  <span class="hljs-comment">//“张三”</span><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(age);   <span class="hljs-comment">//28</span><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(stature);  <span class="hljs-comment">//&quot;179&quot;</span><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(weight);   <span class="hljs-comment">//65</span><br>&#125;<br></code></pre></td></tr></table></figure><p>可以看到，由于我们认为指定了name和age两个属性不作用域with环境，因此这里的name和age输出的是外部的变量，而stature和weight输出的仍然是author的属性值。</p>]]></content>
    
    
    <categories>
      
      <category>笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>javascript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>jquery</title>
    <link href="/2023/03/22/%E7%AC%94%E8%AE%B0/jquery/"/>
    <url>/2023/03/22/%E7%AC%94%E8%AE%B0/jquery/</url>
    
    <content type="html"><![CDATA[<h1 id="jQuery"><a href="#jQuery" class="headerlink" title="jQuery"></a>jQuery</h1><h2 id="1、概述"><a href="#1、概述" class="headerlink" title="1、概述"></a>1、概述</h2><h3 id="1、JavaScript库"><a href="#1、JavaScript库" class="headerlink" title="1、JavaScript库"></a>1、JavaScript库</h3><blockquote><p>JavaScript库：即library，是一个封装好的特定的集合（方法和函数）。从封装一大堆函数的角度理解，就是在这个库中，封装了很多预先定义好的函数在里面，比如动画animate、hide、show，比如获取元素等</p></blockquote><ul><li>简单理解：就是一个js文件，里面对我们原生js代码进行了封装，存放到里面，这样我们可以快速高效的使用这些封装好的功能了。</li></ul><p>常见JavaScript库</p><blockquote><p>jQuery、Prototype、YUI、Dojo、Ext JS、移动端的zepto</p></blockquote><h3 id="2、jQuery概念"><a href="#2、jQuery概念" class="headerlink" title="2、jQuery概念"></a>2、jQuery概念</h3><ul><li>jQuery是一个快速、简洁的JavaScript库，其宗旨是write less，Do More即提倡写更少的代码，做更多的事情</li></ul><blockquote><p>j就是JavaScript，Query查询；意思 就是查询js，把js中的DOM操作做了封装，我们可以快速的查询使用里面的功能</p><p>jQuery封装了JavaScript常用的功能代码，优化了DOM操作、事件处理、动画设计和Ajax交互</p><p>学习jQuery本质：学习调用这些函数（方法）</p></blockquote><p><strong>优点：</strong></p><p><img src="/img/jquery/youdian.png" alt="image"></p><h2 id="2、jQuery使用"><a href="#2、jQuery使用" class="headerlink" title="2、jQuery使用"></a>2、jQuery使用</h2><p>引入</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;jquery-1.10.2.min.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br></code></pre></td></tr></table></figure><p><strong>语法</strong></p><p>jQuery 语法是通过选取 HTML 元素，并对选取的元素执行某些操作。</p><p>基础语法： <strong>$(selector).action()</strong></p><ul><li>美元符号定义 jQuery，一般用$，也可以用jQuery</li><li>选择符（selector）”查询”和”查找” HTML 元素</li><li>jQuery 的 action() 执行对元素的操作</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js">$(<span class="hljs-variable language_">this</span>).<span class="hljs-title function_">hide</span>() - 隐藏当前元素<br><br>$(<span class="hljs-string">&quot;p&quot;</span>).<span class="hljs-title function_">hide</span>() - 隐藏所有 &lt;p&gt; 元素<br><br>$(<span class="hljs-string">&quot;p.test&quot;</span>).<span class="hljs-title function_">hide</span>() - 隐藏所有 <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;test&quot;</span> 的 &lt;p&gt; 元素<br><br>$(<span class="hljs-string">&quot;#test&quot;</span>).<span class="hljs-title function_">hide</span>() - 隐藏 id=<span class="hljs-string">&quot;test&quot;</span> 的元素<br></code></pre></td></tr></table></figure><p>为了防止文档在完全加载（就绪）之前运行 jQuery 代码，即在 DOM 加载完成后才可以对 DOM 进行操作。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript">$(<span class="hljs-variable language_">document</span>).<span class="hljs-title function_">ready</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br> <br>   <span class="hljs-comment">// 开始写 jQuery 代码...</span><br> <br>&#125;);<br>或<br>$(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br> <br>   <span class="hljs-comment">// 开始写 jQuery 代码...</span><br> <br>&#125;);<br></code></pre></td></tr></table></figure><ul><li>等着DOM结构渲染完毕即可执行内部代码，不必等到所有外部资源加载完成，jQuery帮我们完成了封装</li><li>相当于原生js中的DOMContenLoaded</li><li>不同于原生js中的load事件是等页面文档、外部的js文件、css文件、图片加载完毕才执行内部代码</li></ul><h3 id="jQuery对象和DOM对象"><a href="#jQuery对象和DOM对象" class="headerlink" title="jQuery对象和DOM对象"></a>jQuery对象和DOM对象</h3><ul><li>用原生js获取过来的对象就是DOM对象</li><li>jQuery方法获取过来的对象就是jQuery对象</li><li>jQUery对象本质是：利用$对DOM对象包装后产生的对象（伪数组形式存储）</li><li>jQuery对象不能使用<strong>原生js的属性和方法</strong></li></ul><h3 id="相互转换"><a href="#相互转换" class="headerlink" title="相互转换"></a><strong>相互转换</strong></h3><h4 id="1、DOM对象转换为jQuery对象"><a href="#1、DOM对象转换为jQuery对象" class="headerlink" title="1、DOM对象转换为jQuery对象"></a>1、DOM对象转换为jQuery对象</h4><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs arcade">$(DOM对象)<br>$(<span class="hljs-string">&#x27;div&#x27;</span>)<br></code></pre></td></tr></table></figure><h4 id="2、jQuery对象转换为DOM对象"><a href="#2、jQuery对象转换为DOM对象" class="headerlink" title="2、jQuery对象转换为DOM对象"></a>2、jQuery对象转换为DOM对象</h4><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs scss">$(DOM对象)<span class="hljs-selector-attr">[index]</span><span class="hljs-comment">//index是索引号</span><br>$(DOM对象)<span class="hljs-selector-class">.get</span>(index)<span class="hljs-comment">//index是索引号</span><br><br>$(&#x27;div&#x27;)<span class="hljs-selector-attr">[0]</span><br></code></pre></td></tr></table></figure><h2 id="3、jQuery常用API"><a href="#3、jQuery常用API" class="headerlink" title="3、jQuery常用API"></a>3、jQuery常用API</h2><h3 id="1、jQuery选择器"><a href="#1、jQuery选择器" class="headerlink" title="1、jQuery选择器"></a>1、jQuery选择器</h3><h4 id="1、基础选择器"><a href="#1、基础选择器" class="headerlink" title="1、基础选择器"></a>1、基础选择器</h4><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade">$(<span class="hljs-string">&quot;选择器&quot;</span>)<span class="hljs-comment">//里面选择器直接写css选择器即可，但是要加引号  </span><br></code></pre></td></tr></table></figure><p><img src="/img/jquery/xuanzheqi.png" alt="image"></p><h4 id="2、jQuery层级选择器"><a href="#2、jQuery层级选择器" class="headerlink" title="2、jQuery层级选择器"></a>2、jQuery层级选择器</h4><p><img src="/img/jquery/xuanzheqi2.png" alt="image"></p><h4 id="3、隐式迭代"><a href="#3、隐式迭代" class="headerlink" title="3、隐式迭代"></a>3、隐式迭代</h4><blockquote><p>jQuery设置样式</p></blockquote><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade">$(<span class="hljs-string">&quot;div&quot;</span>).css(<span class="hljs-string">&#x27;属性&#x27;</span>,<span class="hljs-string">&#x27;值&#x27;</span>);<br></code></pre></td></tr></table></figure><p>便利内部DOM元素（伪数组形式存储）的过程叫做<strong>隐式迭代</strong></p><blockquote><p>简单理解：给匹配的所有元素进行循环遍历，执行相应的方法，而不用我们再进行循环，简化我们的操作，方便我们调用</p></blockquote><h4 id="4、jQuery筛选选择器"><a href="#4、jQuery筛选选择器" class="headerlink" title="4、jQuery筛选选择器"></a>4、jQuery筛选选择器</h4><p><img src="/img/jquery/saixuanqi.png" alt="image"></p><h4 id="5、jQuery筛选方法"><a href="#5、jQuery筛选方法" class="headerlink" title="5、jQuery筛选方法"></a>5、jQuery筛选方法</h4><p><img src="/img/jquery/saixuanfangfa.png" alt="image"></p><h4 id="6、jQuery排他思想"><a href="#6、jQuery排他思想" class="headerlink" title="6、jQuery排他思想"></a>6、jQuery排他思想</h4><ol><li>隐式迭代给所有的按钮都绑定了点击事件</li><li>当前的元素变化背景颜色</li><li>其余的兄弟去掉背景颜色   隐式迭代</li></ol><h3 id="2、jQuery样式操作"><a href="#2、jQuery样式操作" class="headerlink" title="2、jQuery样式操作"></a>2、jQuery样式操作</h3><h4 id="1、操作css方法"><a href="#1、操作css方法" class="headerlink" title="1、操作css方法"></a>1、操作css方法</h4><ul><li>jQuery可以使用css方法来修改简单元素样式，也可以操作类，修改多个样式</li></ul><p>1、参数只写属性名，则返回属性值</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">$(<span class="hljs-variable language_">this</span>).<span class="hljs-title function_">css</span>(<span class="hljs-string">&quot;color&quot;</span>);<br></code></pre></td></tr></table></figure><p>2、参数值属性名，属性值，逗号分隔，是一组样式，属性必须要加引号，值如果是数字可以不用写单位和引号</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">$(<span class="hljs-variable language_">this</span>).<span class="hljs-title function_">css</span>(<span class="hljs-string">&quot;color&quot;</span>,<span class="hljs-string">&quot;red&quot;</span>);<br></code></pre></td></tr></table></figure><p>3、参数是对象形式，方便设置多组样式，属性名和属性值用冒号隔开，属性可以不用加引号</p><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs processing">$(<span class="hljs-variable">this</span>).<span class="hljs-property">css</span>(&#123;<span class="hljs-string">&quot;color&quot;</span>:<span class="hljs-string">&quot;red&quot;</span>,<span class="hljs-string">&quot;font-size&quot;</span>:<span class="hljs-string">&quot;20px&quot;</span>&#125;);<br>$(<span class="hljs-variable">this</span>).<span class="hljs-property">css</span>(&#123;<span class="hljs-type">color</span>:<span class="hljs-built_in">red</span>,font-<span class="hljs-built_in">size</span>:<span class="hljs-number">20</span>px&#125;);<br></code></pre></td></tr></table></figure><h4 id="2、设置类样式方法"><a href="#2、设置类样式方法" class="headerlink" title="2、设置类样式方法"></a>2、设置类样式方法</h4><blockquote><p>作用等同于以前的classList，可以操作类样式，注意操作类里面的参数不要加点</p></blockquote><p>1、添加类</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-constructor">$(<span class="hljs-string">&quot;div&quot;</span>)</span>.add<span class="hljs-constructor">Class(<span class="hljs-string">&quot;current&quot;</span>)</span>;<br></code></pre></td></tr></table></figure><p>2、移除类</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-constructor">$(<span class="hljs-string">&quot;div&quot;</span>)</span>.remove<span class="hljs-constructor">Class(<span class="hljs-string">&quot;current&quot;</span>)</span>;<br></code></pre></td></tr></table></figure><p>3、切换类</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-constructor">$(<span class="hljs-string">&quot;div&quot;</span>)</span>.toggle<span class="hljs-constructor">Class(<span class="hljs-string">&quot;current&quot;</span>)</span>;<br></code></pre></td></tr></table></figure><h3 id="3、类操作与className区别"><a href="#3、类操作与className区别" class="headerlink" title="3、类操作与className区别"></a>3、类操作与className区别</h3><ul><li>原生 JS 中 className 会覆盖元素原先里面的类名</li><li>jQuery里面类操作只是对指定类进行操作，不影响原先的类名（相当于追加类名，但以前的仍保留）</li></ul><h2 id="4、jQuery效果"><a href="#4、jQuery效果" class="headerlink" title="4、jQuery效果"></a>4、jQuery效果</h2><p><img src="/img/jquery/xiaoguo.png" alt="image"></p><h3 id="1、显示、隐藏效果"><a href="#1、显示、隐藏效果" class="headerlink" title="1、显示、隐藏效果"></a>1、显示、隐藏效果</h3><h4 id="1、显示语法规范"><a href="#1、显示语法规范" class="headerlink" title="1、显示语法规范"></a>1、显示语法规范</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">show(<span class="hljs-selector-attr">[speed]</span>,<span class="hljs-selector-attr">[easing]</span>,<span class="hljs-selector-attr">[fn]</span>);<br></code></pre></td></tr></table></figure><ul><li>参数都可以省略，无动画直接显示</li><li>speed：三种预定速度之一的字符串（”slow“，”normal“，”fast“）或表示动画时长的毫秒数值</li><li>easing：（Optional）用来指定切换效果，默认是”swing“，可以用参数”linear“</li><li>fn：回调函数，在动画完成时执行的函数，每个元素执行一次</li></ul><h4 id="2、隐藏语法规范"><a href="#2、隐藏语法规范" class="headerlink" title="2、隐藏语法规范"></a>2、隐藏语法规范</h4><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-built_in">hide</span>([speed],[easing],[fn]);<br><span class="hljs-built_in">hide</span>(<span class="hljs-number">1000</span>);<br><span class="hljs-built_in">hide</span>(<span class="hljs-number">1000</span>, function() &#123;<br><span class="hljs-built_in">alert</span>(<span class="hljs-number">1</span>);<br>&#125;)<br></code></pre></td></tr></table></figure><ul><li>参数都可以省略，无动画直接显示</li><li>speed：三种预定速度之一的字符串（”slow“，”normal“，”fast“）或表示动画时长的毫秒数值</li><li>easing：（Optional）用来指定切换效果，默认是”swing“，可以用参数”linear“</li><li>fn：回调函数，在动画完成时执行的函数，每个元素执行一次</li></ul><h4 id="3、切换"><a href="#3、切换" class="headerlink" title="3、切换"></a>3、切换</h4><ul><li>通过 jQuery，您可以使用 toggle() 方法来切换 hide() 和 show() 方法。</li></ul><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mel">$(<span class="hljs-string">&quot;p&quot;</span>).<span class="hljs-keyword">toggle</span>();<br></code></pre></td></tr></table></figure><h3 id="2、淡入淡出"><a href="#2、淡入淡出" class="headerlink" title="2、淡入淡出"></a>2、淡入淡出</h3><p>Fading 方法：</p><p>通过 jQuery，您可以实现元素的淡入淡出效果。</p><p>jQuery 拥有下面四种 fade 方法：</p><ul><li>fadeIn()</li><li>fadeOut()</li><li>fadeToggle()</li><li>fadeTo()</li></ul><h4 id="1、fadeIn-方法"><a href="#1、fadeIn-方法" class="headerlink" title="1、fadeIn() 方法"></a>1、fadeIn() 方法</h4><ul><li>jQuery fadeIn() 用于淡入已隐藏的元素。</li></ul><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">fade<span class="hljs-constructor">In([<span class="hljs-params">speed</span>],[<span class="hljs-params">easing</span>],[<span class="hljs-params">fn</span>])</span>;<br></code></pre></td></tr></table></figure><h4 id="2、fadeOut-方法"><a href="#2、fadeOut-方法" class="headerlink" title="2、fadeOut() 方法"></a>2、fadeOut() 方法</h4><ul><li>jQuery fadeOut() 方法用于淡出可见元素。</li></ul><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">fade<span class="hljs-constructor">Out([<span class="hljs-params">speed</span>],[<span class="hljs-params">easing</span>],[<span class="hljs-params">fn</span>])</span>;<br></code></pre></td></tr></table></figure><h4 id="3、fadeToggle-方法"><a href="#3、fadeToggle-方法" class="headerlink" title="3、fadeToggle() 方法"></a>3、fadeToggle() 方法</h4><ul><li><p>jQuery fadeToggle() 方法可以在 fadeIn() 与 fadeOut() 方法之间进行切换。</p></li><li><p>如果元素已淡出，则 fadeToggle() 会向元素添加淡入效果。</p></li><li><p>如果元素已淡入，则 fadeToggle() 会向元素添加淡出效果。</p></li></ul><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">fade<span class="hljs-constructor">Toggle([<span class="hljs-params">speed</span>],[<span class="hljs-params">easing</span>],[<span class="hljs-params">fn</span>])</span>;<br></code></pre></td></tr></table></figure><h4 id="4、fadeTo-方法"><a href="#4、fadeTo-方法" class="headerlink" title="4、fadeTo() 方法"></a>4、fadeTo() 方法</h4><ul><li>jQuery fadeTo() 方法允许渐变为给定的不透明度（值介于 0 与 1 之间）。</li></ul><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">fade<span class="hljs-constructor">TO([<span class="hljs-params">speed</span>],[<span class="hljs-params">easing</span>],<span class="hljs-params">opacity</span>,[<span class="hljs-params">fn</span>])</span>;<br></code></pre></td></tr></table></figure><ul><li>opacity透明度必须写，取值0~1之间</li></ul><h3 id="3、滑动"><a href="#3、滑动" class="headerlink" title="3、滑动"></a>3、滑动</h3><p>通过 jQuery，您可以在元素上创建滑动效果。</p><p>jQuery 拥有以下滑动方法：</p><ul><li>slideDown()</li><li>slideUp()</li><li>slideToggle()</li></ul><h4 id="1、slideDown-方法"><a href="#1、slideDown-方法" class="headerlink" title="1、slideDown() 方法"></a>1、slideDown() 方法</h4><ul><li>jQuery slideDown() 方法用于向下滑动元素。</li></ul><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">slide<span class="hljs-constructor">Down([<span class="hljs-params">speed</span>],[<span class="hljs-params">easing</span>],[<span class="hljs-params">fn</span>])</span>;<br></code></pre></td></tr></table></figure><h4 id="2、slideUp-方法"><a href="#2、slideUp-方法" class="headerlink" title="2、slideUp() 方法"></a>2、slideUp() 方法</h4><ul><li>jQuery slideUp() 方法用于向上滑动元素。</li></ul><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">slide<span class="hljs-constructor">Up([<span class="hljs-params">speed</span>],[<span class="hljs-params">easing</span>],[<span class="hljs-params">fn</span>])</span>;<br></code></pre></td></tr></table></figure><h4 id="3、slideToggle-方法"><a href="#3、slideToggle-方法" class="headerlink" title="3、slideToggle() 方法"></a>3、slideToggle() 方法</h4><ul><li><p>jQuery slideToggle() 方法可以在 slideDown() 与 slideUp() 方法之间进行切换。</p></li><li><p>如果元素向下滑动，则 slideToggle() 可向上滑动它们。</p></li><li><p>如果元素向上滑动，则 slideToggle() 可向下滑动它们。</p></li></ul><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">slide<span class="hljs-constructor">Toggle([<span class="hljs-params">speed</span>],[<span class="hljs-params">easing</span>],[<span class="hljs-params">fn</span>])</span>;<br></code></pre></td></tr></table></figure><h3 id="4、动画"><a href="#4、动画" class="headerlink" title="4、动画"></a>4、动画</h3><h4 id="1、语法"><a href="#1、语法" class="headerlink" title="1、语法"></a>1、语法</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">animate(params,<span class="hljs-selector-attr">[speed]</span>,<span class="hljs-selector-attr">[easing]</span>,<span class="hljs-selector-attr">[fn]</span>);<br></code></pre></td></tr></table></figure><ul><li>params:想要更改的样式属性，以对象形式传递，<strong>必须写</strong>。属性名可以不用带引号，如果时复合属性则需要采取驼峰命名法borderLeft。其余参数可以省略</li></ul><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs arcade">$(<span class="hljs-string">&quot;button&quot;</span>).click(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>  $(<span class="hljs-string">&quot;div&quot;</span>).animate(&#123;<span class="hljs-attr">left</span>:<span class="hljs-string">&#x27;250px&#x27;</span>&#125;);<br>&#125;);<br></code></pre></td></tr></table></figure><p>可以多个属性</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs arcade">$(<span class="hljs-string">&quot;button&quot;</span>).click(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>  $(<span class="hljs-string">&quot;div&quot;</span>).animate(&#123;<br>    <span class="hljs-attr">left</span>: <span class="hljs-number">250</span>px,<br>    <span class="hljs-attr">opacity</span>: <span class="hljs-number">0.5</span>,<br>    <span class="hljs-attr">height</span>: <span class="hljs-number">150</span>px,<br>    <span class="hljs-attr">width</span>: <span class="hljs-number">150</span>px<br>  &#125;);<br>&#125;);<br></code></pre></td></tr></table></figure><h3 id="5、停止动画"><a href="#5、停止动画" class="headerlink" title="5、停止动画"></a>5、停止动画</h3><p>jQuery stop() 方法用于停止动画或效果，在它们完成之前。</p><ul><li>stop() 方法适用于所有 jQuery 效果函数，包括滑动、淡入淡出和自定义动画。</li></ul><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-built_in">stop</span>(stopAll,goToEnd);<br></code></pre></td></tr></table></figure><ul><li><p>可选的 stopAll 参数规定是否应该清除动画队列。默认是 false，即仅停止活动的动画，允许任何排入队列的动画向后执行。</p></li><li><p>可选的 goToEnd 参数规定是否立即完成当前动画。默认是 false。</p></li></ul><blockquote><p>因此，默认地，stop() 会清除在被选元素上指定的当前动画。</p></blockquote><h2 id="5、jQuery属性操作"><a href="#5、jQuery属性操作" class="headerlink" title="5、jQuery属性操作"></a>5、jQuery属性操作</h2><h4 id="1、prop"><a href="#1、prop" class="headerlink" title="1、prop()"></a>1、prop()</h4><ul><li>设置或获取元素固有属性值</li></ul><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">prop</span><span class="hljs-params">()</span></span><br></code></pre></td></tr></table></figure><h4 id="2、attr"><a href="#2、attr" class="headerlink" title="2、attr()"></a>2、attr()</h4><ul><li>设置或获取自定义属性</li></ul><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">attr</span><span class="hljs-params">(<span class="hljs-string">&quot;属性&quot;</span>)</span></span><span class="hljs-comment">//类似原生getAttribute</span><br><span class="hljs-function"><span class="hljs-title">attr</span><span class="hljs-params">(<span class="hljs-string">&quot;属性&quot;</span>,<span class="hljs-string">&quot;属性值&quot;</span>)</span></span><span class="hljs-comment">//类似原生setAttribute</span><br></code></pre></td></tr></table></figure><h4 id="3、data"><a href="#3、data" class="headerlink" title="3、data()"></a>3、data()</h4><ul><li>数据缓存 data()  这个里面吗的数据是存放在元素的内存里面</li><li>这个方法获取data-index   h5自定义属性  第一个 不用写data-   而且返回的是数字型</li></ul><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">data</span><span class="hljs-params">(<span class="hljs-string">&quot;index&quot;</span>)</span></span><br></code></pre></td></tr></table></figure><h2 id="6、jQuery内容文本值"><a href="#6、jQuery内容文本值" class="headerlink" title="6、jQuery内容文本值"></a>6、jQuery内容文本值</h2><ul><li>主要针对元素的内容还有表单的值操作</li></ul><h3 id="1、普通元素内容html"><a href="#1、普通元素内容html" class="headerlink" title="1、普通元素内容html()"></a>1、普通元素内容html()</h3><ul><li>相当于原生innerHTML</li></ul><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">html()<span class="hljs-regexp">//</span>获取元素的内容<br>html(<span class="hljs-string">&quot;内容&quot;</span>)<span class="hljs-regexp">//</span>设置元素的内容<br></code></pre></td></tr></table></figure><h3 id="2、普通元素文本内容text"><a href="#2、普通元素文本内容text" class="headerlink" title="2、普通元素文本内容text()"></a>2、普通元素文本内容text()</h3><ul><li>相当于原生innerText</li></ul><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">text</span><span class="hljs-params">()</span></span><span class="hljs-comment">//获取元素的内容</span><br><span class="hljs-function"><span class="hljs-title">text</span><span class="hljs-params">(<span class="hljs-string">&quot;内容&quot;</span>)</span></span><span class="hljs-comment">//设置元素的内容</span><br></code></pre></td></tr></table></figure><h3 id="3、表单值"><a href="#3、表单值" class="headerlink" title="3、表单值"></a>3、表单值</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">val</span><span class="hljs-params">()</span></span><span class="hljs-comment">//获取元素的值</span><br><span class="hljs-function"><span class="hljs-title">val</span><span class="hljs-params">(<span class="hljs-string">&quot;值&quot;</span>)</span></span><span class="hljs-comment">//设置元素的值</span><br></code></pre></td></tr></table></figure><h2 id="7、jQuery元素操作"><a href="#7、jQuery元素操作" class="headerlink" title="7、jQuery元素操作"></a>7、jQuery元素操作</h2><ul><li>主要是遍历、创建、添加、删除元素操作</li></ul><h3 id="1、遍历元素"><a href="#1、遍历元素" class="headerlink" title="1、遍历元素"></a>1、遍历元素</h3><h4 id="语法1"><a href="#语法1" class="headerlink" title="语法1"></a><strong>语法1</strong></h4><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs arcade">$(<span class="hljs-string">&quot;div&quot;</span>).each(<span class="hljs-keyword">function</span> (<span class="hljs-params">index, domEle</span>) &#123;<br>操作;<br>&#125;)<br></code></pre></td></tr></table></figure><ul><li>each()方法遍历匹配的每一个元素。主要用DOM处理，each每一个</li><li>里面的回调函数有2个参数：idea是每个元素的索引号，domEle是每隔DOM元素对象，不是jQuery对象</li><li>所以想要使用jQuery方法，需要给这个dom元素转换为jQuery对象    <strong>$(domEle)</strong></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        $(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">var</span> sum = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">            <span class="hljs-keyword">var</span> arr = [<span class="hljs-string">&quot;red&quot;</span>,<span class="hljs-string">&quot;green&quot;</span>,<span class="hljs-string">&quot;blue&quot;</span>];</span><br><span class="language-javascript">            $(<span class="hljs-string">&quot;div&quot;</span>).<span class="hljs-title function_">each</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">i,domEle</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-comment">// 回调函数第一个参数一定是索引号   可以指定</span></span><br><span class="language-javascript">                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(i);</span><br><span class="language-javascript">                <span class="hljs-comment">// 回调函数第二个参数一定是 dom 元素对象</span></span><br><span class="language-javascript">                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(domEle);</span><br><span class="language-javascript">                $(domEle).<span class="hljs-title function_">css</span>(<span class="hljs-string">&quot;color&quot;</span>,arr[i]);</span><br><span class="language-javascript">                sum += <span class="hljs-built_in">parseInt</span>($(domEle).<span class="hljs-title function_">text</span>());</span><br><span class="language-javascript">            &#125;)</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(sum);</span><br><span class="language-javascript">        &#125;)</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="语法2"><a href="#语法2" class="headerlink" title="语法2"></a><strong>语法2</strong></h4><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs arcade">$.each(object,<span class="hljs-keyword">function</span> (<span class="hljs-params">index, element</span>) &#123;<br>操作;<br>&#125;)<br><br>$.each($(<span class="hljs-string">&quot;div&quot;</span>),<span class="hljs-keyword">function</span> (<span class="hljs-params">i, ele</span>) &#123;<br><span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(i);<br><span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(ele);<br>&#125;)<br></code></pre></td></tr></table></figure><ul><li>$.each()方法可以用于遍历任何对象，主要用于数据处理，比如数组、对象</li><li>index：每个元素的索引号</li><li>element：遍历内容</li></ul><h2 id="8、jQuery尺寸、位置操作"><a href="#8、jQuery尺寸、位置操作" class="headerlink" title="8、jQuery尺寸、位置操作"></a>8、jQuery尺寸、位置操作</h2><h3 id="1、尺寸"><a href="#1、尺寸" class="headerlink" title="1、尺寸"></a>1、尺寸</h3><p><img src="/img/jquery/chicun.png" alt="image"></p><p><img src="/img/jquery/chicun.gif" alt="image"></p><h4 id="1、width-和height-方法"><a href="#1、width-和height-方法" class="headerlink" title="1、width()和height() 方法"></a>1、width()和height() 方法</h4><ul><li>width() 方法设置或返回元素的宽度（不包括内边距、边框或外边距）。</li><li>height() 方法设置或返回元素的高度（不包括内边距、边框或外边距）。</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js">$(<span class="hljs-string">&quot;button&quot;</span>).<span class="hljs-title function_">click</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>  <span class="hljs-keyword">var</span> txt=<span class="hljs-string">&quot;&quot;</span>;<br>  txt+=<span class="hljs-string">&quot;div 的宽度是: &quot;</span> + $(<span class="hljs-string">&quot;#div1&quot;</span>).<span class="hljs-title function_">width</span>() + <span class="hljs-string">&quot;&lt;/br&gt;&quot;</span>;<br>  txt+=<span class="hljs-string">&quot;div 的高度是: &quot;</span> + $(<span class="hljs-string">&quot;#div1&quot;</span>).<span class="hljs-title function_">height</span>();<br>  $(<span class="hljs-string">&quot;#div1&quot;</span>).<span class="hljs-title function_">html</span>(txt);<br>&#125;);<br></code></pre></td></tr></table></figure><h4 id="2、innerWidth-和-innerHeight-方法"><a href="#2、innerWidth-和-innerHeight-方法" class="headerlink" title="2、innerWidth() 和 innerHeight() 方法"></a>2、innerWidth() 和 innerHeight() 方法</h4><ul><li>innerWidth() 方法返回元素的宽度（包括内边距）。</li><li>innerHeight() 方法返回元素的高度（包括内边距）。</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js">$(<span class="hljs-string">&quot;button&quot;</span>).<span class="hljs-title function_">click</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>  <span class="hljs-keyword">var</span> txt=<span class="hljs-string">&quot;&quot;</span>;<br>  txt+=<span class="hljs-string">&quot;div 宽度，包含内边距: &quot;</span> + $(<span class="hljs-string">&quot;#div1&quot;</span>).<span class="hljs-title function_">innerWidth</span>() + <span class="hljs-string">&quot;&lt;/br&gt;&quot;</span>;<br>    txt+=<span class="hljs-string">&quot;div 高度，包含内边距: &quot;</span> + $(<span class="hljs-string">&quot;#div1&quot;</span>).<span class="hljs-title function_">innerHeight</span>();<br>  $(<span class="hljs-string">&quot;#div1&quot;</span>).<span class="hljs-title function_">html</span>(txt);<br>&#125;);<br></code></pre></td></tr></table></figure><h4 id="3、outerWidth-和-outerHeight-方法"><a href="#3、outerWidth-和-outerHeight-方法" class="headerlink" title="3、outerWidth() 和 outerHeight() 方法"></a>3、outerWidth() 和 outerHeight() 方法</h4><ul><li><p>outerWidth() 方法返回元素的宽度（包括内边距和边框）。</p></li><li><p>outerHeight() 方法返回元素的高度（包括内边距和边框）。</p></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js">$(<span class="hljs-string">&quot;button&quot;</span>).<span class="hljs-title function_">click</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>  <span class="hljs-keyword">var</span> txt=<span class="hljs-string">&quot;&quot;</span>;<br>  txt+=<span class="hljs-string">&quot;div 宽度，包含内边距和边框: &quot;</span> + $(<span class="hljs-string">&quot;#div1&quot;</span>).<span class="hljs-title function_">outerWidth</span>() + <span class="hljs-string">&quot;&lt;/br&gt;&quot;</span>;<br>  txt+=<span class="hljs-string">&quot;div 高度，包含内边距和边框: &quot;</span> + $(<span class="hljs-string">&quot;#div1&quot;</span>).<span class="hljs-title function_">outerHeight</span>();<br>  $(<span class="hljs-string">&quot;#div1&quot;</span>).<span class="hljs-title function_">html</span>(txt);<br>&#125;);<br></code></pre></td></tr></table></figure><h3 id="2、位置"><a href="#2、位置" class="headerlink" title="2、位置"></a>2、位置</h3><p>1、offset()</p><ul><li>设置或获取元素偏移</li></ul><ol><li>offset()方法设置会返回被选元素相对于文档的偏移坐标，跟父级没有关系</li><li>该方法有2个属性left、top。<strong>left</strong>：距离文档左侧的距离；<strong>top</strong>：距离文档顶部的距离</li><li>可以设置元素的偏移</li></ol><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">offset</span><span class="hljs-params">(&#123;top:<span class="hljs-number">10</span>,left30&#125;)</span></span><br></code></pre></td></tr></table></figure><p>2、position()</p><ul><li>获取距离带有定位的父级位置（偏移）如果父级没有定位，则以文档为准</li><li>只能获取不能设置</li></ul><p>3、scrollTop()&#x2F;scrollLeft()</p><ul><li>设置或获取元素被卷去的头部和左侧</li></ul><h2 id="9、jQuery事件"><a href="#9、jQuery事件" class="headerlink" title="9、jQuery事件"></a>9、jQuery事件</h2><h3 id="1、jQuery事件注册"><a href="#1、jQuery事件注册" class="headerlink" title="1、jQuery事件注册"></a>1、jQuery事件注册</h3><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs arcade">element.事件(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123; &#125;)<br>$(<span class="hljs-string">&quot;div&quot;</span>).clock(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123; 事件处理程序 &#125;)<br></code></pre></td></tr></table></figure><p>其他事件和原生基本一致</p><h3 id="2、jQuery事件处理"><a href="#2、jQuery事件处理" class="headerlink" title="2、jQuery事件处理"></a>2、jQuery事件处理</h3><h4 id="1、on-绑定事件"><a href="#1、on-绑定事件" class="headerlink" title="1、on()绑定事件"></a>1、on()绑定事件</h4><ul><li>在匹配元素上绑定一个或多个事件的事件处理函数</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript">element.<span class="hljs-title function_">on</span>(events,[selector],fn)<br><br>$(<span class="hljs-string">&quot;div&quot;</span>).<span class="hljs-title function_">on</span>(&#123; <br><span class="hljs-attr">mouseenter</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>$(<span class="hljs-variable language_">this</span>).<span class="hljs-title function_">css</span>(<span class="hljs-string">&quot;background&quot;</span>,<span class="hljs-string">&quot;red&quot;</span>);<br>&#125;,<br>    <span class="hljs-attr">click</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    $(<span class="hljs-variable language_">this</span>).<span class="hljs-title function_">css</span>(<span class="hljs-string">&quot;background&quot;</span>,<span class="hljs-string">&quot;red&quot;</span>);<br>    &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><ul><li>events：一个或多个用空格分隔的事件类型，如”click“或”keydown“</li><li>selector：元素的子元素选择器</li></ul><p><strong>on()优势</strong></p><ul><li>可以绑定多个事件，多个处理事件程序</li><li>如果事件处理程序相同</li></ul><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade">$(<span class="hljs-string">&quot;div&quot;</span>).on(<span class="hljs-string">&quot;mouseenter mouseover&quot;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123; &#125;)<br></code></pre></td></tr></table></figure><ul><li>可以事件委派操作。事件委派的定义是，把原来嫁给子元素身上的事件绑定在父元素身上，就是把事件委派给父元素</li></ul><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade">$(<span class="hljs-string">&quot;div&quot;</span>).on(<span class="hljs-string">&quot;mouseenter&quot;</span>,<span class="hljs-string">&quot;li&quot;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123; &#125;)<br></code></pre></td></tr></table></figure><ul><li>动态创建的元素，click()没有办法绑定事件，on()可以给动态生成的元素绑定事件</li></ul><h4 id="2、off-解绑事件"><a href="#2、off-解绑事件" class="headerlink" title="2、off()解绑事件"></a>2、off()解绑事件</h4><ul><li>off()方法可以移除通过on()方法添加的事件处理程序</li></ul><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs arcade">$(<span class="hljs-string">&quot;p&quot;</span>).off()<span class="hljs-comment">//解绑p元素所有的事件处理程序</span><br>$(<span class="hljs-string">&quot;p&quot;</span>).off(<span class="hljs-string">&quot;click&quot;</span>)<span class="hljs-comment">//解绑p元素的点击事件后面的foo是侦听函数名</span><br>$(<span class="hljs-string">&quot;p&quot;</span>).off(<span class="hljs-string">&quot;click&quot;</span>,<span class="hljs-string">&quot;li&quot;</span>)<span class="hljs-comment">//解绑事件委托</span><br></code></pre></td></tr></table></figure><h4 id="3、trigger-自动触发事件"><a href="#3、trigger-自动触发事件" class="headerlink" title="3、trigger()自动触发事件"></a>3、trigger()自动触发事件</h4><ul><li>有些事件希望自动触发，如轮播图。可以利用定时器自动触发右侧按钮点击事件，不必鼠标点击触发</li></ul><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">element.click()<span class="hljs-regexp">//</span>第一种简写<br>element.trigger(<span class="hljs-string">&quot;type&quot;</span>)<span class="hljs-regexp">//</span>第二种自动触发模式<br>element.triggerHandler(type)<span class="hljs-regexp">//</span>第三种不会触发元素的默认行为<br></code></pre></td></tr></table></figure><h3 id="3、jQuery事件对象"><a href="#3、jQuery事件对象" class="headerlink" title="3、jQuery事件对象"></a>3、jQuery事件对象</h3><ul><li>事件被触发，就会有事件对象的产生</li></ul><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs oxygene">element.on(events,[<span class="hljs-keyword">selector</span>],<span class="hljs-keyword">function</span><span class="hljs-params">(<span class="hljs-keyword">event</span>)</span> <span class="hljs-comment">&#123;&#125;</span>)<br></code></pre></td></tr></table></figure><ul><li>阻止默认行为：event.preventDefault()或者return flase</li><li>阻止冒泡：event.stopPropagation()</li></ul><h2 id="10、jQuery其他方法"><a href="#10、jQuery其他方法" class="headerlink" title="10、jQuery其他方法"></a>10、jQuery其他方法</h2><h3 id="1、jQuery拷贝对象"><a href="#1、jQuery拷贝对象" class="headerlink" title="1、jQuery拷贝对象"></a>1、jQuery拷贝对象</h3><ul><li>如果想要把某个对象拷贝（合并）给另外一个对象使用，此时可以使用<code>$.extend()</code>方法</li><li>如果目的对象原有属性和值，那么拷贝后会覆盖原有的属性值</li></ul><p>语法：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">$<span class="hljs-selector-class">.extend</span>(<span class="hljs-selector-attr">[deep]</span>,target,object1,<span class="hljs-selector-attr">[objectN]</span>)<br></code></pre></td></tr></table></figure><ul><li>deep：如果设为true为深拷贝，默认为false 浅拷贝<ul><li>浅拷贝：把原来对象里面吗的复杂数据类型中的地址拷贝给目的对象，修改目的对象会影响被拷贝对象</li><li>深拷贝：拷贝的是对象，不是地址，修改目的对象不会影响被拷贝对象</li></ul></li><li>target：要拷贝的目标对象</li><li>object1：待拷贝到第一个对象的对象</li></ul><h3 id="2、多库共存"><a href="#2、多库共存" class="headerlink" title="2、多库共存"></a>2、多库共存</h3><ul><li>jQuery使用$作为标识符，随着jQuery的流行，其他js库也会用这个$作为标识符，这样一起使用就会引起冲突</li></ul><blockquote><p>问题：让jQuery和其他js库不存在冲突，可以同时存在，这个就叫做多库共存</p></blockquote><p>解决方案：</p><ul><li>把里面的$符号同一改为jQuery</li><li>jQuery遍历规定新的名称：<code>$.noConflict()</code></li></ul>]]></content>
    
    
    <categories>
      
      <category>笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>javascript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>es6</title>
    <link href="/2023/03/22/%E7%AC%94%E8%AE%B0/es6/"/>
    <url>/2023/03/22/%E7%AC%94%E8%AE%B0/es6/</url>
    
    <content type="html"><![CDATA[<h1 id="JavaScript面向对象"><a href="#JavaScript面向对象" class="headerlink" title="JavaScript面向对象"></a>JavaScript面向对象</h1><h2 id="1、面向对象"><a href="#1、面向对象" class="headerlink" title="1、面向对象"></a>1、面向对象</h2><blockquote><p>面向对象的特性：</p><p>封装性、继承性、多态性</p></blockquote><p><img src="/img/es6/mianxiangduixiang.png" alt="image"></p><h2 id="2、ES6中的类和对象"><a href="#2、ES6中的类和对象" class="headerlink" title="2、ES6中的类和对象"></a>2、ES6中的类和对象</h2><p>面向对象的思维特点：</p><ol><li>抽取（抽象）对象共用的属性和行为组织(封装)成一个类(模板)</li><li>对类进行实例化, 获取类的对象</li></ol><blockquote><p>面向对象编程我们考虑的是有哪些对象，按照面向对象的思维特点，不断的创建对象，使用对象，指挥对象做事情</p></blockquote><h3 id="1、对象"><a href="#1、对象" class="headerlink" title="1、对象"></a>1、对象</h3><p>在 JavaScript 中，对象是一组无序的相关属性和方法的集合，所有的事物都是对象，例如字符串、数值、数组、函数等。</p><p>对象是由属性和方法组成的</p><ul><li>属性：事物的<strong>特征，在对象中用属性</strong>来表示</li><li>方法：事物的<strong>行为，在对象中用方法</strong>来表示</li></ul><h3 id="2、类"><a href="#2、类" class="headerlink" title="2、类"></a>2、类</h3><p>在 ES6 中新增加了类的概念，可以使用 class 关键字声明一个类，之后以这个类来实例化对象。</p><ul><li>类抽象了对象的公共部分，它泛指某一大类（class）</li><li>对象特指某一个，通过类实例化一个具体的对象</li></ul><h4 id="1、创建类"><a href="#1、创建类" class="headerlink" title="1、创建类"></a>1、创建类</h4><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">name</span> &#123;<br>    <span class="hljs-regexp">//</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">body</span><br>&#125;<br></code></pre></td></tr></table></figure><p>实例</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs haxe"><span class="hljs-keyword">var</span> XX = <span class="hljs-keyword">new</span> <span class="hljs-type">name</span>();<br></code></pre></td></tr></table></figure><blockquote><p>注意：类必须使用<code>new</code> 实例化对象</p></blockquote><h4 id="2、构造函数"><a href="#2、构造函数" class="headerlink" title="2、构造函数"></a>2、构造函数</h4><p><code>constructor()</code> 方法是类的构造函数(默认方法)，<strong>用于传递参数,返回实例对象</strong>，通过 new 命令生成对象实例时，自动调用该方法。如果没有显示定义, 类内部会自动给我们创建一个<code>constructor()</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-comment">// 1. 创建类 class  创建一个 明星类</span></span><br><span class="language-javascript">    <span class="hljs-keyword">class</span> <span class="hljs-title class_">Star</span> &#123;</span><br><span class="language-javascript">        <span class="hljs-comment">// constructor 构造器或者构造函数</span></span><br><span class="language-javascript">        <span class="hljs-title function_">constructor</span>(<span class="hljs-params">uname, age</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">uname</span> = uname;</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-comment">// 2. 利用类创建对象 new</span></span><br><span class="language-javascript">    <span class="hljs-keyword">var</span> ldh = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Star</span>(<span class="hljs-string">&#x27;刘德华&#x27;</span>, <span class="hljs-number">18</span>);</span><br><span class="language-javascript">    <span class="hljs-keyword">var</span> zxy = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Star</span>(<span class="hljs-string">&#x27;张学友&#x27;</span>, <span class="hljs-number">20</span>);</span><br><span class="language-javascript">    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ldh);</span><br><span class="language-javascript">    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(zxy);</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><ul><li><p>通过 class 关键字创建类，类名我们还是习惯性<strong>定义首字母大写</strong></p></li><li><p>类里面有个 <code>constructor</code>函数，可以接收传递过来的参数，同时返回实例对象</p></li><li><p><code>constructor</code>函数只要 new 生成实例时，就会自动调用这个函数，如果我们不写这个函数，类也会自动生成这个函数</p></li><li><p>最后注意语法规范</p><ul><li>创建类——类名后面不要加小括号</li><li>生成实例——类名后面加小括号</li><li>构造函数不需要加 function 关键字</li></ul></li></ul><h4 id="3、类添加方法"><a href="#3、类添加方法" class="headerlink" title="3、类添加方法"></a>3、类添加方法</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> &#123;<br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name,age</span>) &#123;   <br>      <span class="hljs-comment">// constructor 称为构造器或者构造函数</span><br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;<br>    &#125;<br>   <span class="hljs-title function_">say</span>(<span class="hljs-params"></span>) &#123;<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> + <span class="hljs-string">&#x27;你好&#x27;</span>);<br>   &#125;<br>&#125;      <br><span class="hljs-keyword">var</span> ldh = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&#x27;刘德华&#x27;</span>, <span class="hljs-number">18</span>); <br>ldh.<span class="hljs-title function_">say</span>() <br></code></pre></td></tr></table></figure><p><strong>注意</strong>： 方法之间不需要加逗号分隔，同时方法不需要添加 function 关键字。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;script&gt;<br>    <span class="hljs-comment">// 1. 创建类 class  创建一个 明星类</span><br>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">Star</span> &#123;<br>        <span class="hljs-comment">// 类的共有属性放到 constructor 里面</span><br>        <span class="hljs-title function_">constructor</span>(<span class="hljs-params">uname, age</span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">uname</span> = uname;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;<br>        &#125;<br>        <span class="hljs-title function_">sing</span>(<span class="hljs-params">song</span>) &#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">uname</span> + song);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// 2. 利用类创建对象 new</span><br>    <span class="hljs-keyword">var</span> ldh = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Star</span>(<span class="hljs-string">&#x27;刘德华&#x27;</span>, <span class="hljs-number">18</span>);<br>    <span class="hljs-keyword">var</span> zxy = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Star</span>(<span class="hljs-string">&#x27;张学友&#x27;</span>, <span class="hljs-number">20</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ldh);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(zxy);<br>    <span class="hljs-comment">// (1) 我们类里面所有的函数不需要写function </span><br>    <span class="hljs-comment">// (2) 多个函数方法之间不需要添加逗号分隔</span><br>    ldh.<span class="hljs-title function_">sing</span>(<span class="hljs-string">&#x27;冰雨&#x27;</span>);<br>    zxy.<span class="hljs-title function_">sing</span>(<span class="hljs-string">&#x27;李香兰&#x27;</span>);<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure><ul><li>类的共有属性放到<code>constructor</code> 里面</li><li>类里面的函数都不需要写 <code>function</code> 关键字</li></ul><h3 id="3、继承"><a href="#3、继承" class="headerlink" title="3、继承"></a>3、继承</h3><blockquote><p>子类可以继承父类的一些属性和方法。</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 父类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Father</span> &#123;<br>    <br>&#125;<br><span class="hljs-comment">// 子类继承父类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Son</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Father</span> &#123;<br>    <br>&#125;<br></code></pre></td></tr></table></figure><p>实例</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-comment">// 父类有加法方法</span></span><br><span class="language-javascript">    <span class="hljs-keyword">class</span> <span class="hljs-title class_">Father</span> &#123;</span><br><span class="language-javascript">        <span class="hljs-title function_">constructor</span>(<span class="hljs-params">x, y</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span> = x;</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span> = y;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-title function_">sum</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span>);</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript">    <span class="hljs-comment">// 子类继承父类加法方法 同时 扩展减法方法</span></span><br><span class="language-javascript">    <span class="hljs-keyword">class</span> <span class="hljs-title class_">Son</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Father</span> &#123;</span><br><span class="language-javascript">        <span class="hljs-title function_">constructor</span>(<span class="hljs-params">x, y</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">// 利用super 调用父类的构造函数</span></span><br><span class="language-javascript">            <span class="hljs-comment">// super 必须在子类this之前调用</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">super</span>(x, y);</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span> = x;</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span> = y;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-title function_">subtract</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span> - <span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span>);</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript">    <span class="hljs-keyword">var</span> son = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Son</span>(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>);</span><br><span class="language-javascript">    son.<span class="hljs-title function_">subtract</span>();</span><br><span class="language-javascript">    son.<span class="hljs-title function_">sum</span>();</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="4、super关键字"><a href="#4、super关键字" class="headerlink" title="4、super关键字"></a>4、super关键字</h3><ul><li><code>super</code> 关键字用于访问和调用对象父类上的函数，可以调用父类的构造函数，也可以调用父类的普通函数</li></ul><h4 id="1、调用父类的构造函数"><a href="#1、调用父类的构造函数" class="headerlink" title="1、调用父类的构造函数"></a>1、调用父类的构造函数</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 父类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">surname</span>)&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">surname</span> = surname;<br>    &#125;<br>&#125;<br><span class="hljs-comment">// 子类继承父类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span> entends <span class="hljs-title class_">Person</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">surname,firstname</span>) &#123;<br>        <span class="hljs-variable language_">super</span>(surname);<span class="hljs-comment">//调用父类的 constructor(surname)</span><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">firstname</span> = firstname;<span class="hljs-comment">//定义子类独有的属性</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>注意：<strong>子类在构造函数中使用super,必须放到this前面（必须先调用父类的构造方法，在使用子类构造方法）</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 父类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Father</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">surname</span>)&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">surname</span> = surname;<br>    &#125;<br>    <span class="hljs-title function_">saySurname</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;我的姓是&#x27;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">surname</span>);<br>    &#125;<br>&#125;<br><span class="hljs-comment">// 子类继承父类</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Son</span> entends <span class="hljs-title class_">Father</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">surname,firstname</span>) &#123;<br>        <span class="hljs-variable language_">super</span>(surname);<span class="hljs-comment">//调用父类的 constructor(surname)</span><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">firstname</span> = firstname;<span class="hljs-comment">//定义子类独有的属性</span><br>    &#125;<br>    <span class="hljs-title function_">sayFirstname</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;我的名字是:&#x27;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">firstname</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">var</span> damao = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Son</span>(<span class="hljs-string">&#x27;刘&#x27;</span>,<span class="hljs-string">&#x27;德华&#x27;</span>);<br>damao.<span class="hljs-title function_">saySurname</span>();<br>damao.<span class="hljs-title function_">sayFirstname</span>();<br></code></pre></td></tr></table></figure><h4 id="2、调用父类的普通函数"><a href="#2、调用父类的普通函数" class="headerlink" title="2、调用父类的普通函数"></a>2、调用父类的普通函数</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Father</span> &#123;<br>    <span class="hljs-title function_">say</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;我是爸爸&#x27;</span>;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Son</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Father</span> &#123;<br>    <span class="hljs-title function_">say</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-comment">// super.say() super调用父类的方法</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">super</span>.<span class="hljs-title function_">say</span>() + <span class="hljs-string">&#x27;的儿子&#x27;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">var</span> damao = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Son</span>();<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(damao.<span class="hljs-title function_">say</span>());<br></code></pre></td></tr></table></figure><ul><li>多个方法之间不需要添加逗号分隔</li><li>继承中属性和方法的查找原则：就近原则，先看子类，再看父类</li></ul><h3 id="5、注意点"><a href="#5、注意点" class="headerlink" title="5、注意点"></a>5、注意点</h3><ol><li><p>在ES6中类没有变量提升，所以必须先定义类，才能通过类实例化对象</p></li><li><p>类里面的共有属性和方法一定要加 <code>this</code>使用</p></li><li><p>类里面的<code>this</code>指向：</p><ul><li><code>constructor</code> 里面的 <code>this</code>指向实例对象</li><li>方法里面的<code>this</code>指向这个方法的调用者</li></ul><blockquote><p>也就说，谁调用这个方法，this就指向谁</p></blockquote></li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>点击<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> that;</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> _that;</span><br><span class="language-javascript">        <span class="hljs-keyword">class</span> <span class="hljs-title class_">Star</span> &#123;</span><br><span class="language-javascript">            <span class="hljs-title function_">constructor</span>(<span class="hljs-params">uname, age</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-comment">// constructor 里面的this 指向的是 创建的实例对象</span></span><br><span class="language-javascript">                that = <span class="hljs-variable language_">this</span>;</span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">uname</span> = uname;</span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;</span><br><span class="language-javascript">                <span class="hljs-comment">// this.sing();</span></span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">btn</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;button&#x27;</span>);</span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">btn</span>.<span class="hljs-property">onclick</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">sing</span>;</span><br><span class="language-javascript">            <span class="hljs-comment">//sing 不需要加括号，我们需要的是点击后才运行，如果变成 sing() 就会立即执行    </span></span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-title function_">sing</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">// 这个sing方法里面的this 指向的是 btn 这个按钮,因为这个按钮调用了这个函数</span></span><br><span class="language-javascript">                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(that.<span class="hljs-property">uname</span>); </span><br><span class="language-javascript">                <span class="hljs-comment">// that里面存储的是constructor里面的this</span></span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-title function_">dance</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-comment">// 这个dance里面的this 指向的是实例对象 ldh 因为ldh 调用了这个函数</span></span><br><span class="language-javascript">                _that = <span class="hljs-variable language_">this</span>;</span><br><span class="language-javascript">                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> ldh = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Star</span>(<span class="hljs-string">&#x27;刘德华&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(that === ldh);</span><br><span class="language-javascript">        ldh.<span class="hljs-title function_">dance</span>();</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(_that === ldh);</span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 1. 在 ES6 中类没有变量提升，所以必须先定义类，才能通过类实例化对象</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 2. 类里面的共有的属性和方法一定要加this使用.</span></span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="3、构造函数和原型"><a href="#3、构造函数和原型" class="headerlink" title="3、构造函数和原型"></a>3、构造函数和原型</h2><h3 id="1、概述"><a href="#1、概述" class="headerlink" title="1、概述"></a>1、概述</h3><p>在典型的 OOP 的语言中（如 Java），都存在类的概念，类就是对象的模板，对象就是类的实例，但在 ES6之前， JS 中并没用引入类的概念。</p><blockquote><p>ES6， 全称 ECMAScript 6.0 ，2015.06 发版。但是目前浏览器的 JavaScript 是 ES5 版本，大多数高版本的浏览器也支持 ES6，不过只实现了 ES6 的部分特性和功能。</p></blockquote><p>在 ES6之前 ，对象不是基于类创建的，而是用一种称为构建函数的特殊函数来定义对象和它们的特征。</p><ul><li>创建对象有三种方式<ul><li><strong>对象字面量</strong></li><li><strong>new Object()</strong></li><li><strong>自定义构造函数</strong></li></ul></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 1. 利用 new Object() 创建对象</span><br><span class="hljs-keyword">var</span> obj1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();<br><br><span class="hljs-comment">// 2. 利用对象字面量创建对象</span><br><span class="hljs-keyword">var</span> obj2 = &#123;&#125;；<br><br><span class="hljs-comment">// 3.利用构造函数创建对象</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Star</span>(<span class="hljs-params">uname,age</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">uname</span> = uname;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">sing</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;我会唱歌&#x27;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-keyword">var</span> ldh = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Star</span>(<span class="hljs-string">&#x27;刘德华&#x27;</span>,<span class="hljs-number">18</span>);<br></code></pre></td></tr></table></figure><p>注意：</p><ol><li>构造函数用于创建某一类对象，其首字母要大写</li><li>构造函数要和<code>new</code>一起使用才有意义</li></ol><h3 id="2、构造函数-1"><a href="#2、构造函数-1" class="headerlink" title="2、构造函数"></a>2、构造函数</h3><ul><li>构造函数是一种特殊的函数，主要用来初始化对象(为对象成员变量赋初始值)，它总与<code>new</code>一起使用</li><li>我们可以把对象中的一些公共的属性和方法抽取出来，然后封装到这个函数里面</li></ul><p>new 在执行时会做四件事</p><ol><li>在内存中创建一个新的空对象。</li><li>让 this 指向这个新的对象。</li><li>执行构造函数里面的代码，给这个新对象添加属性和方法。</li><li>返回这个新对象（所以构造函数里面不需要 return ）。</li></ol><h4 id="1、静态成员和实例成员"><a href="#1、静态成员和实例成员" class="headerlink" title="1、静态成员和实例成员"></a>1、静态成员和实例成员</h4><p>JavaScript 的构造函数中可以添加一些成员，可以在构造函数本身上添加，也可以在构造函数内部的<code>this</code>上添加。通过这两种方式添加的成员，就分别称为<strong>静态成员和实例成员</strong>。</p><ul><li>静态成员: 在构造函数本身上添加的成员为静态成员，只能由构造函数本身来访问</li><li>实例成员: 在构造函数内部创建的对象成员称为实例成员，只能由实例化的对象来访问</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 构造函数中的属性和方法我们称为成员，成员可以添加</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Star</span>(<span class="hljs-params">uname,age</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">uname</span> = uname;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">sing</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;我会唱歌&#x27;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-keyword">var</span> ldh = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Star</span>(<span class="hljs-string">&#x27;刘德华&#x27;</span>,<span class="hljs-number">18</span>);<br><br><span class="hljs-comment">// 实例成员就是构造函数内部通过this添加的成员  uname age sing  就是实例成员</span><br><span class="hljs-comment">// 实例成员只能通过实例化的对象来访问</span><br>ldh.<span class="hljs-title function_">sing</span>();<br><span class="hljs-title class_">Star</span>.<span class="hljs-property">uname</span>; <span class="hljs-comment">// undefined     不可以通过构造函数来访问实例成员</span><br><br><span class="hljs-comment">// 静态成员就是在构造函数本身上添加的成员 sex 就是静态成员</span><br><span class="hljs-comment">// 静态成员只能通过构造函数来访问</span><br><span class="hljs-title class_">Star</span>.<span class="hljs-property">sex</span> = <span class="hljs-string">&#x27;男&#x27;</span>;<br><span class="hljs-title class_">Star</span>.<span class="hljs-property">sex</span>;<br>ldh.<span class="hljs-property">sex</span>; <span class="hljs-comment">// undefined  不能通过对象来访问</span><br></code></pre></td></tr></table></figure><h4 id="2、构造函数的问题"><a href="#2、构造函数的问题" class="headerlink" title="2、构造函数的问题"></a>2、构造函数的问题</h4><p>构造函数方法很好用，但是存在浪费内存的问题。</p><p><img src="/img/es6/gouzhaohanshu.png" alt="image"></p><ul><li><strong>我们希望所有的对象使用同一个函数，这样就比较节省内存</strong></li></ul><h3 id="3、构造函数原型-prototype"><a href="#3、构造函数原型-prototype" class="headerlink" title="3、构造函数原型 prototype"></a>3、构造函数原型 prototype</h3><ul><li><p>构造函数通过原型分配的函数是所有对象所<strong>共享</strong>的,这样就解决了内存浪费问题</p></li><li><p>JavaScript 规定，每一个构造函数都有一个<code>prototype</code>属性，指向另一个对象，注意这个<code>prototype</code>就是一个<strong>对象</strong>，<strong>这个对象的所有属性和方法，都会被构造函数所拥有</strong></p></li><li><p>我们可以把那些<strong>不变的方法</strong>，直接定义在<code>prototype</code> 对象上，这样所有对象的实例就可以共享这些方法</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 1. 构造函数的问题. </span></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">Star</span>(<span class="hljs-params">uname, age</span>) &#123;</span><br><span class="language-javascript">    <span class="hljs-comment">//公共属性定义到构造函数里面</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">uname</span> = uname;</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;</span><br><span class="language-javascript">            <span class="hljs-comment">// this.sing = function() &#123;</span></span><br><span class="language-javascript">            <span class="hljs-comment">//     console.log(&#x27;我会唱歌&#x27;);</span></span><br><span class="language-javascript">            <span class="hljs-comment">// &#125;</span></span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript"><span class="hljs-comment">//公共的方法我们放到原型对象身上</span></span><br><span class="language-javascript">        <span class="hljs-title class_">Star</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">sing</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;我会唱歌&#x27;</span>);</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> ldh = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Star</span>(<span class="hljs-string">&#x27;刘德华&#x27;</span>, <span class="hljs-number">18</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> zxy = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Star</span>(<span class="hljs-string">&#x27;张学友&#x27;</span>, <span class="hljs-number">19</span>);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ldh.<span class="hljs-property">sing</span> === zxy.<span class="hljs-property">sing</span>);</span><br><span class="language-javascript">        ldh.<span class="hljs-title function_">sing</span>();</span><br><span class="language-javascript">        zxy.<span class="hljs-title function_">sing</span>();</span><br><span class="language-javascript">        <span class="hljs-comment">// 2. 一般情况下,我们的公共属性定义到构造函数里面, 公共的方法我们放到原型对象身上</span></span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><ul><li>一般情况下,我们的公共属性定义到构造函数里面, 公共的方法我们放到原型对象身上</li></ul><blockquote><p>原型是什么？</p></blockquote><ul><li>一个对象，我们也称为 <code>prototype</code> 为原型对象</li></ul><blockquote><p>原型的作用是什么？</p></blockquote><ul><li>共享方法</li></ul><h3 id="4、对象原型-proto"><a href="#4、对象原型-proto" class="headerlink" title="4、对象原型 __ proto __"></a>4、对象原型 __ proto __</h3><ul><li><p>对象都会有一个属性 <code>_proto_</code> 指向构造函数的<code>prototype</code>原型对象，之所以我们对象可以使用构造函数<code>prototype</code> 原型对象的属性和方法，就是因为对象有<code>_proto_</code>原型的存在。</p></li><li><p><code>_proto_</code>对象原型和原型对象 <code>prototype</code> 是<strong>等价</strong>的</p></li><li><p><code>_proto_</code>对象原型的意义就在于<strong>为对象的查找机制提供一个方向，或者说一条路线</strong>，但是它是一个非标准属性，因此实际开发中，不可以使用这个属性，它只是<strong>内部指向原型对象</strong> <code>prototype</code></p></li></ul><p><img src="/img/es6/duixiangyuanxing.png" alt="image"></p><ul><li><code>Star.prototype 和 ldh._proto_</code> 指向相同</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">Star</span>(<span class="hljs-params">uname, age</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">uname</span> = uname;</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-title class_">Star</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">sing</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;我会唱歌&#x27;</span>);</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> ldh = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Star</span>(<span class="hljs-string">&#x27;刘德华&#x27;</span>, <span class="hljs-number">18</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> zxy = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Star</span>(<span class="hljs-string">&#x27;张学友&#x27;</span>, <span class="hljs-number">19</span>);</span><br><span class="language-javascript">        ldh.<span class="hljs-title function_">sing</span>();</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ldh); </span><br><span class="language-javascript"><span class="hljs-comment">// 对象身上系统自己添加一个 __proto__ 指向我们构造函数的原型对象 prototype</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ldh.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">Star</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);</span><br><span class="language-javascript">        <span class="hljs-comment">// 方法的查找规则: 首先先看ldh 对象身上是否有 sing 方法,如果有就执行这个对象上的sing</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 如果没有sing 这个方法,因为有 __proto__ 的存在,就去构造函数原型对象prototype身上去查找sing这个方法</span></span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="5、constructor-构造函数"><a href="#5、constructor-构造函数" class="headerlink" title="5、constructor 构造函数"></a>5、constructor 构造函数</h3><ul><li><p>对象原型(__ proto __) 和构造函数(prototype)原型对象 里面都有一个属性 constructor 属性， constructor 我们称为构造函数，因为它指回构造函数本身。</p></li><li><p><code>constructor</code>主要用于记录该对象引用于哪个构造函数，它可以让原型对象重新指向原来的构造函数</p></li><li><p><strong>一般情况下，对象的方法都在构造函数(prototype)的原型对象中设置</strong></p></li><li><p>如果有多个对象的方法，我们可以给原型对象<code>prototype</code>采取对象形式赋值，但是这样会覆盖构造函数原型对象原来的内容，这样修改后的原型对象<code>constructor</code>就不再指向当前构造函数了。此时，我们可以在修改后的原型对象中，添加一个<code>constructor</code>指向原来的构造函数</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">Star</span>(<span class="hljs-params">uname, age</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">uname</span> = uname;</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-comment">// 很多情况下,我们需要手动的利用constructor 这个属性指回 原来的构造函数</span></span><br><span class="language-javascript">        <span class="hljs-comment">// Star.prototype.sing = function() &#123;</span></span><br><span class="language-javascript">        <span class="hljs-comment">//     console.log(&#x27;我会唱歌&#x27;);</span></span><br><span class="language-javascript">        <span class="hljs-comment">// &#125;;</span></span><br><span class="language-javascript">        <span class="hljs-comment">// Star.prototype.movie = function() &#123;</span></span><br><span class="language-javascript">        <span class="hljs-comment">//     console.log(&#x27;我会演电影&#x27;);</span></span><br><span class="language-javascript">        <span class="hljs-comment">// &#125;</span></span><br><span class="language-javascript">        <span class="hljs-title class_">Star</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">// 如果我们修改了原来的原型对象,给原型对象赋值的是一个对象,则必须手动的利用constructor指回原来的构造函数</span></span><br><span class="language-javascript">            <span class="hljs-attr">constructor</span>: <span class="hljs-title class_">Star</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">sing</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;我会唱歌&#x27;</span>);</span><br><span class="language-javascript">            &#125;,</span><br><span class="language-javascript">            <span class="hljs-attr">movie</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;我会演电影&#x27;</span>);</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> ldh = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Star</span>(<span class="hljs-string">&#x27;刘德华&#x27;</span>, <span class="hljs-number">18</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> zxy = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Star</span>(<span class="hljs-string">&#x27;张学友&#x27;</span>, <span class="hljs-number">19</span>);</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="6、三者关系"><a href="#6、三者关系" class="headerlink" title="6、三者关系"></a>6、三者关系</h3><p><img src="/img/es6/guangxi.png" alt="image"></p><h3 id="7、原型链查找规则"><a href="#7、原型链查找规则" class="headerlink" title="7、原型链查找规则"></a>7、原型链查找规则</h3><ol><li>当访问一个对象的属性(包括方法)时，首先查找这个对象自身有没有该属性</li><li>如果没有就查找它的原型(也就是<code>_proto_</code>指向的<code>prototype原型对象</code>)</li><li>如果还没有就查找原型对象的原型(Object的原型对象)</li><li>依次类推一直找到Object为止(null)</li><li>__ proto __对象原型的意义就在于为对象成员查找机制提供一个方向，或者说一条路线。</li></ol><p><img src="/img/es6/yuanxinglian.png" alt="image"></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">Star</span>(<span class="hljs-params">uname, age</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">uname</span> = uname;</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-title class_">Star</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">sing</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;我会唱歌&#x27;</span>);</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> ldh = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Star</span>(<span class="hljs-string">&#x27;刘德华&#x27;</span>, <span class="hljs-number">18</span>);</span><br><span class="language-javascript">        <span class="hljs-comment">// 1. 只要是对象就有__proto__ 原型, 指向原型对象</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Star</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Star</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);</span><br><span class="language-javascript">        <span class="hljs-comment">// 2.我们Star原型对象里面的__proto__原型指向的是 Object.prototype</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">__proto__</span>);</span><br><span class="language-javascript">        <span class="hljs-comment">// 3. 我们Object.prototype原型对象里面的__proto__原型  指向为 null</span></span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="8、原型对象this指向"><a href="#8、原型对象this指向" class="headerlink" title="8、原型对象this指向"></a>8、原型对象this指向</h3><ul><li>构造函数中的 <code>this</code>指向我们的实例对象</li><li>原型对象里面放的是方法，这个方法里面的<code>this</code>指向的是这个方法的调用者，也就是这个实例对象</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">Star</span>(<span class="hljs-params">uname, age</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">uname</span> = uname;</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> that;</span><br><span class="language-javascript">        <span class="hljs-title class_">Star</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">sing</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;我会唱歌&#x27;</span>);</span><br><span class="language-javascript">            that = <span class="hljs-variable language_">this</span>;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> ldh = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Star</span>(<span class="hljs-string">&#x27;刘德华&#x27;</span>, <span class="hljs-number">18</span>);</span><br><span class="language-javascript">        <span class="hljs-comment">// 1. 在构造函数中,里面this指向的是对象实例 ldh</span></span><br><span class="language-javascript">        ldh.<span class="hljs-title function_">sing</span>();</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(that === ldh);</span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 2.原型对象函数里面的this 指向的是 实例对象 ldh</span></span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="9、扩展内置对象"><a href="#9、扩展内置对象" class="headerlink" title="9、扩展内置对象"></a>9、扩展内置对象</h3><ul><li>可以通过原型对象，对原来的内置对象进行扩展自定义的方法</li><li>比如给数组增加自定义求偶数和的功能</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 原型对象的应用 扩展内置对象方法</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">sum</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">var</span> sum = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">length</span>; i++) &#123;</span><br><span class="language-javascript">                sum += <span class="hljs-variable language_">this</span>[i];</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-keyword">return</span> sum;</span><br><span class="language-javascript">        &#125;;</span><br><span class="language-javascript">        <span class="hljs-comment">//这个会覆盖原先的prototype</span></span><br><span class="language-javascript">        <span class="hljs-comment">// Array.prototype = &#123;</span></span><br><span class="language-javascript">        <span class="hljs-comment">//     sum: function() &#123;</span></span><br><span class="language-javascript">        <span class="hljs-comment">//         var sum = 0;</span></span><br><span class="language-javascript">        <span class="hljs-comment">//         for (var i = 0; i &lt; this.length; i++) &#123;</span></span><br><span class="language-javascript">        <span class="hljs-comment">//             sum += this[i];</span></span><br><span class="language-javascript">        <span class="hljs-comment">//         &#125;</span></span><br><span class="language-javascript">        <span class="hljs-comment">//         return sum;</span></span><br><span class="language-javascript">        <span class="hljs-comment">//     &#125;</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// &#125;</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> arr = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr.<span class="hljs-title function_">sum</span>());</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> arr1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(<span class="hljs-number">11</span>, <span class="hljs-number">22</span>, <span class="hljs-number">33</span>);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr1.<span class="hljs-title function_">sum</span>());</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><p>注意：</p><ul><li>数组和字符串内置对象不能给原型对象覆盖操作<code>Array.prototype = &#123;&#125;</code>，只能是<code>Array.prototype.xxx = function()&#123;&#125;</code>的方式</li></ul><h2 id="4、继承"><a href="#4、继承" class="headerlink" title="4、继承"></a>4、继承</h2><p>ES6 之前并没有给我们提供<code>extends</code>继承</p><ul><li>我们可以通过构造函数+原型对象模拟实现继承，被称为组合继承</li></ul><h3 id="1、call"><a href="#1、call" class="headerlink" title="1、call()"></a>1、call()</h3><blockquote><p>调用这个函数，并且修改函数运行时的 this 指向</p></blockquote><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lasso">fun.call(thisArg,arg1,arg2,<span class="hljs-params">...</span><span class="hljs-params">...</span>)<br></code></pre></td></tr></table></figure><ul><li><code>thisArg</code>：当前调用函数 this 的指向对象</li><li><code>arg1,arg2</code>： 传递的其他参数</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// call 方法</span></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params">x, y</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;我希望我的希望有希望&#x27;</span>);</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);<span class="hljs-comment">// Object&#123;...&#125;</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(x + y);<span class="hljs-comment">// 3</span></span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> o = &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;andy&#x27;</span></span><br><span class="language-javascript">        &#125;;</span><br><span class="language-javascript">        <span class="hljs-comment">// fn();</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 1. call() 可以调用函数</span></span><br><span class="language-javascript">        <span class="hljs-comment">// fn.call();</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 2. call() 可以改变这个函数的this指向 此时这个函数的this 就指向了o这个对象</span></span><br><span class="language-javascript">        fn.<span class="hljs-title function_">call</span>(o, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>);</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="2、借用构造函数继承父类型属性"><a href="#2、借用构造函数继承父类型属性" class="headerlink" title="2、借用构造函数继承父类型属性"></a>2、借用构造函数继承父类型属性</h3><ul><li>核心原理: 通过 <code>call()</code> 把父类型的 this 指向子类型的 this，这样就可以实现子类型继承父类型的属性</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 借用父构造函数继承属性</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 1. 父构造函数</span></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">Father</span>(<span class="hljs-params">uname, age</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">// this 指向父构造函数的对象实例</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">uname</span> = uname;</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-comment">// 2 .子构造函数 </span></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">Son</span>(<span class="hljs-params">uname, age, score</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">// this 指向子构造函数的对象实例</span></span><br><span class="language-javascript">            <span class="hljs-title class_">Father</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, uname, age);</span><br><span class="language-javascript">            <span class="hljs-comment">//使用father的构造函数，再把father的构造函数中的this修改成指向子构造函数对象的this</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">score</span> = score;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> son = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Son</span>(<span class="hljs-string">&#x27;刘德华&#x27;</span>, <span class="hljs-number">18</span>, <span class="hljs-number">100</span>);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(son);</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="3、借用原型对象继承父类型方法"><a href="#3、借用原型对象继承父类型方法" class="headerlink" title="3、借用原型对象继承父类型方法"></a>3、借用原型对象继承父类型方法</h3><ul><li>一般情况下，对象的方法都在构造函数的原型对象中设置，通过构造函数无法继承父类方法</li></ul><p>核心原理：</p><ol><li>将子类所共享的方法提取出来，让子类的 <code>prototype 原型对象 = new 父类()</code></li><li>本质： 子类原型对象等于是实例化父类，因为父类实例化之后另外开辟空间，就不会影响原来父类原型对象</li><li>将子类的<code>constructor</code>重新指向子类的构造函数</li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 借用父构造函数继承属性</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 1. 父构造函数</span></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">Father</span>(<span class="hljs-params">uname, age</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">// this 指向父构造函数的对象实例</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">uname</span> = uname;</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-title class_">Father</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">money</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">100000</span>);</span><br><span class="language-javascript">        &#125;;</span><br><span class="language-javascript">        <span class="hljs-comment">// 2 .子构造函数 </span></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">Son</span>(<span class="hljs-params">uname, age, score</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">// this 指向子构造函数的对象实例</span></span><br><span class="language-javascript">            <span class="hljs-title class_">Father</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, uname, age);</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">score</span> = score;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-comment">// Son.prototype = Father.prototype;  这样直接赋值会有问题,如果修改了子原型对象,父原型对象也会跟着一起变化</span></span><br><span class="language-javascript">        <span class="hljs-title class_">Son</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Father</span>();</span><br><span class="language-javascript">        <span class="hljs-comment">// 如果利用对象的形式修改了原型对象,别忘了利用constructor 指回原来的构造函数</span></span><br><span class="language-javascript">        <span class="hljs-title class_">Son</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Son</span>;</span><br><span class="language-javascript">        <span class="hljs-comment">// 这个是子构造函数专门的方法</span></span><br><span class="language-javascript">        <span class="hljs-title class_">Son</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">exam</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;孩子要考试&#x27;</span>);</span><br><span class="language-javascript"></span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> son = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Son</span>(<span class="hljs-string">&#x27;刘德华&#x27;</span>, <span class="hljs-number">18</span>, <span class="hljs-number">100</span>);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(son);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Father</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Son</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span>);<span class="hljs-comment">//这个会指向father，需要利用constructor 指回原来的构造函数</span></span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="4、类的本质"><a href="#4、类的本质" class="headerlink" title="4、类的本质"></a>4、类的本质</h3><ol><li>class 本质还是 <strong>function</strong></li><li>类的所有方法都定义在类的 <code>prototype</code>属性上</li><li>类创建的实例，里面也有<code>_proto_</code>指向类的<code>prototype</code>原型对象</li><li>所以 ES6 的类它的绝大部分功能，ES5都可以做到，新的class写法只是让对象原型的写法更加清晰、更像面向对象编程的语法而已。</li><li>所以 ES6 的类其实就是<strong>语法糖</strong></li><li>语法糖：语法糖就是一种便捷写法，简单理解。有两种方法可以实现同样的功能，但是一种写法更加清晰、方便，那么这个方法就是语法糖</li></ol><h2 id="5、ES5新增方法"><a href="#5、ES5新增方法" class="headerlink" title="5、ES5新增方法"></a>5、ES5新增方法</h2><p>ES5 给我们新增了一些方法，可以很方便的操作数组或者字符串</p><ul><li>数组方法</li><li>字符串方法</li><li>对象方法</li></ul><h3 id="1、数组方法"><a href="#1、数组方法" class="headerlink" title="1、数组方法"></a>1、数组方法</h3><ul><li>迭代(遍历)方法：foreach() ，map()，filter()，some() ，every() ;</li></ul><h4 id="1、forEach"><a href="#1、forEach" class="headerlink" title="1、forEach()"></a>1、forEach()</h4><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-built_in">array</span>.<span class="hljs-keyword">for</span><span class="hljs-constructor">Each(<span class="hljs-params">function</span>(<span class="hljs-params">currentValue</span>,<span class="hljs-params">index</span>,<span class="hljs-params">arr</span>)</span>)<br></code></pre></td></tr></table></figure><ul><li>currentValue : 数组当前项的值</li><li>index: 数组当前项的索引</li><li>arr: 数组对象本身</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// forEach 迭代(遍历) 数组</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> arr = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> sum = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">        arr.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">value, index, array</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;每个数组元素&#x27;</span> + value);</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;每个数组元素的索引号&#x27;</span> + index);</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;数组本身&#x27;</span> + array);</span><br><span class="language-javascript">            sum += value;</span><br><span class="language-javascript">        &#125;)</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(sum);</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="2、filter-筛选数组"><a href="#2、filter-筛选数组" class="headerlink" title="2、filter()筛选数组"></a>2、filter()筛选数组</h4><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-built_in">array</span>.<span class="hljs-built_in">filter</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">currentValue,index,arr</span>))<br></code></pre></td></tr></table></figure><ul><li><code>filter()</code>方法创建一个新的数组，新数组中的元素是通过检查指定数组中符合条件的所有元素，主要用于筛选数组</li><li><strong>注意它直接返回一个新数组</strong></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// filter 筛选数组</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> arr = [<span class="hljs-number">12</span>, <span class="hljs-number">66</span>, <span class="hljs-number">4</span>, <span class="hljs-number">88</span>, <span class="hljs-number">3</span>, <span class="hljs-number">7</span>];</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> newArr = arr.<span class="hljs-title function_">filter</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">value, index</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">// return value &gt;= 20;</span></span><br><span class="language-javascript">            <span class="hljs-keyword">return</span> value % <span class="hljs-number">2</span> === <span class="hljs-number">0</span>;</span><br><span class="language-javascript">        &#125;);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(newArr);</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="3、some"><a href="#3、some" class="headerlink" title="3、some()"></a>3、some()</h4><ul><li><code>some()</code>方法用于检测数组中的元素是否满足指定条件（查找数组中是否有满足条件的元素）</li><li>注意它返回的是<strong>布尔值</strong>，如果查找到这个元素，就返回true，如果查找不到就返回false</li><li>如果找到第一个满足条件的元素，则终止循环，不再继续查找</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// some 查找数组中是否有满足条件的元素 </span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> arr1 = [<span class="hljs-string">&#x27;red&#x27;</span>, <span class="hljs-string">&#x27;pink&#x27;</span>, <span class="hljs-string">&#x27;blue&#x27;</span>];</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> flag1 = arr1.<span class="hljs-title function_">some</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">return</span> value == <span class="hljs-string">&#x27;pink&#x27;</span>;</span><br><span class="language-javascript">        &#125;);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(flag1);</span><br><span class="language-javascript">        <span class="hljs-comment">// 1. filter 也是查找满足条件的元素 返回的是一个数组 而且是把所有满足条件的元素返回回来</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 2. some 也是查找满足条件的元素是否存在  返回的是一个布尔值 如果查找到第一个满足条件的元素就终止循环</span></span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="2、字符串方法"><a href="#2、字符串方法" class="headerlink" title="2、字符串方法"></a>2、字符串方法</h3><ul><li><code>trim()</code>方法会从一个字符串的两端删除空白字符，但中间的空格不会去掉</li><li><code>trim()</code>方法并不影响原字符串本身，它返回的是一个新的字符串</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>点击<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// trim 方法去除字符串两侧空格，但中间的空格不会去掉</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> str = <span class="hljs-string">&#x27;   an  dy   &#x27;</span>;</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str);</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> str1 = str.<span class="hljs-title function_">trim</span>();</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str1);</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> input = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;input&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;button&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;div&#x27;</span>);</span><br><span class="language-javascript">        btn.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">var</span> str = input.<span class="hljs-property">value</span>.<span class="hljs-title function_">trim</span>();</span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (str === <span class="hljs-string">&#x27;&#x27;</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;请输入内容&#x27;</span>);</span><br><span class="language-javascript">            &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str);</span><br><span class="language-javascript">                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(str.<span class="hljs-property">length</span>);</span><br><span class="language-javascript">                div.<span class="hljs-property">innerHTML</span> = str;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="3、对象方法"><a href="#3、对象方法" class="headerlink" title="3、对象方法"></a>3、对象方法</h3><h4 id="1、Object-keys"><a href="#1、Object-keys" class="headerlink" title="1、Object.keys()"></a>1、Object.keys()</h4><ol><li><code>Object.keys()</code>用于获取对象自身所有的属性</li><li>效果类似<code>for...in</code></li><li>返回一个由属性名组成的<strong>数组</strong></li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 用于获取对象自身所有的属性</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> obj = &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">pname</span>: <span class="hljs-string">&#x27;小米&#x27;</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">price</span>: <span class="hljs-number">1999</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">num</span>: <span class="hljs-number">2000</span></span><br><span class="language-javascript">        &#125;;</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> arr = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(obj);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr);</span><br><span class="language-javascript">        arr.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value);</span><br><span class="language-javascript">            <span class="hljs-comment">// id</span></span><br><span class="language-javascript">            <span class="hljs-comment">// pname</span></span><br><span class="language-javascript">            <span class="hljs-comment">// price</span></span><br><span class="language-javascript">            <span class="hljs-comment">// num</span></span><br><span class="language-javascript">        &#125;)</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="2、Object-defineProperty"><a href="#2、Object-defineProperty" class="headerlink" title="2、Object.defineProperty()"></a>2、Object.defineProperty()</h4><ul><li><code>Object.defineProperty()</code>定义对象中新属性或修改原有的属性(了解)</li></ul><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Object</span>.</span></span>define<span class="hljs-constructor">Property(<span class="hljs-params">obj</span>,<span class="hljs-params">prop</span>,<span class="hljs-params">descriptor</span>)</span><br></code></pre></td></tr></table></figure><ul><li>obj : 目标对象</li><li>prop : 需定义或修改的属性的名字</li><li>descriptor : 目标属性所拥有的特性</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// Object.defineProperty() 定义新属性或修改原有的属性</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> obj = &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">pname</span>: <span class="hljs-string">&#x27;小米&#x27;</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">price</span>: <span class="hljs-number">1999</span></span><br><span class="language-javascript">        &#125;;</span><br><span class="language-javascript">        <span class="hljs-comment">// 1. 以前的对象添加和修改属性的方式</span></span><br><span class="language-javascript">        <span class="hljs-comment">// obj.num = 1000;</span></span><br><span class="language-javascript">        <span class="hljs-comment">// obj.price = 99;</span></span><br><span class="language-javascript">        <span class="hljs-comment">// console.log(obj);</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 2. Object.defineProperty() 定义新属性或修改原有的属性</span></span><br><span class="language-javascript">        <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(obj, <span class="hljs-string">&#x27;num&#x27;</span>, &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">value</span>: <span class="hljs-number">1000</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span></span><br><span class="language-javascript">        &#125;);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj);</span><br><span class="language-javascript">        <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(obj, <span class="hljs-string">&#x27;price&#x27;</span>, &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">value</span>: <span class="hljs-number">9.9</span></span><br><span class="language-javascript">        &#125;);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj);</span><br><span class="language-javascript">        <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(obj, <span class="hljs-string">&#x27;id&#x27;</span>, &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">// 如果值为false 不允许修改这个属性值 默认值也是false</span></span><br><span class="language-javascript">            <span class="hljs-attr">writable</span>: <span class="hljs-literal">false</span>,</span><br><span class="language-javascript">        &#125;);</span><br><span class="language-javascript">        obj.<span class="hljs-property">id</span> = <span class="hljs-number">2</span>;</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj);</span><br><span class="language-javascript">        <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(obj, <span class="hljs-string">&#x27;address&#x27;</span>, &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">value</span>: <span class="hljs-string">&#x27;中国山东蓝翔技校xx单元&#x27;</span>,</span><br><span class="language-javascript">            <span class="hljs-comment">// 如果只为false 不允许修改这个属性值 默认值也是false</span></span><br><span class="language-javascript">            <span class="hljs-attr">writable</span>: <span class="hljs-literal">false</span>,</span><br><span class="language-javascript">            <span class="hljs-comment">// enumerable 如果值为false 则不允许遍历, 默认的值是 false</span></span><br><span class="language-javascript">            <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">false</span>,</span><br><span class="language-javascript">            <span class="hljs-comment">// configurable 如果为false 则不允许删除这个属性 不允许在修改第三个参数里面的特性 默认为false</span></span><br><span class="language-javascript">            <span class="hljs-attr">configurable</span>: <span class="hljs-literal">false</span></span><br><span class="language-javascript">        &#125;);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(obj));</span><br><span class="language-javascript">        <span class="hljs-keyword">delete</span> obj.<span class="hljs-property">address</span>;</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj);</span><br><span class="language-javascript">        <span class="hljs-keyword">delete</span> obj.<span class="hljs-property">pname</span>;</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj);</span><br><span class="language-javascript">        <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(obj, <span class="hljs-string">&#x27;address&#x27;</span>, &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">value</span>: <span class="hljs-string">&#x27;中国山东蓝翔技校xx单元&#x27;</span>,</span><br><span class="language-javascript">            <span class="hljs-comment">// 如果值为false 不允许修改这个属性值 默认值也是false</span></span><br><span class="language-javascript">            <span class="hljs-attr">writable</span>: <span class="hljs-literal">true</span>,</span><br><span class="language-javascript">            <span class="hljs-comment">// enumerable 如果值为false 则不允许遍历, 默认的值是 false</span></span><br><span class="language-javascript">            <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,</span><br><span class="language-javascript">            <span class="hljs-comment">// configurable 如果为false 则不允许删除这个属性 默认为false</span></span><br><span class="language-javascript">            <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span></span><br><span class="language-javascript">        &#125;);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj.<span class="hljs-property">address</span>);</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><ul><li><p>第三个参数 descriptor 说明：以对象形式{ }书写</p></li><li><p>value：设置属性的值，默认为undefined</p></li><li><p>writeable: 值是否可以重写 true | false 默认为false</p></li><li><p>enumerable: 目标属性是否可以被枚举 true | false 默认为false</p></li><li><p>configurable: 目标属性是否可以被删除或是否可以再次修改特性 true | false 默认为false</p></li></ul><h2 id="6、函数进阶"><a href="#6、函数进阶" class="headerlink" title="6、函数进阶"></a>6、函数进阶</h2><h3 id="1、函数的定义方式"><a href="#1、函数的定义方式" class="headerlink" title="1、函数的定义方式"></a>1、函数的定义方式</h3><ol><li>函数声明方式 function 关键字(命名函数)</li><li>函数表达式(匿名函数)</li><li>new Function()</li></ol><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-keyword">var</span> fn = <span class="hljs-keyword">new</span> <span class="hljs-keyword">Function</span>(<span class="hljs-params"><span class="hljs-string">&#x27;参数1&#x27;</span>,<span class="hljs-string">&#x27;参数2&#x27;</span>,.....,<span class="hljs-string">&#x27;函数体&#x27;</span></span>);<br></code></pre></td></tr></table></figure><ul><li>Function 里面参数都必须是字符串格式</li><li>第三种方式执行效率低，也不方便书写，因此较少使用</li><li>所有函数都是 Function 的实例(对象)</li><li>函数也属于对象</li></ul><p><img src="/img/es6/hanshu.png" alt="image"></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">//  函数的定义方式</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 1. 自定义函数(命名函数) </span></span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"></span>) &#123;&#125;;</span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 2. 函数表达式 (匿名函数)</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> fun = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;&#125;;</span><br><span class="language-javascript"></span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 3. 利用 new Function(&#x27;参数1&#x27;,&#x27;参数2&#x27;, &#x27;函数体&#x27;);</span></span><br><span class="language-javascript"><span class="hljs-comment">//             Function 里面参数都必须是字符串格式，执行效率低，较少写</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> f = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Function</span>(<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;console.log(a + b)&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-title function_">f</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>);</span><br><span class="language-javascript">        <span class="hljs-comment">// 4. 所有函数都是 Function 的实例(对象)</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">dir</span>(f);</span><br><span class="language-javascript">        <span class="hljs-comment">// 5. 函数也属于对象</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(f <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Object</span>);</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="2、函数的调用方式"><a href="#2、函数的调用方式" class="headerlink" title="2、函数的调用方式"></a>2、函数的调用方式</h3><ol><li>普通函数</li><li>对象的方法</li><li>构造函数</li><li>绑定事件函数</li><li>定时器函数</li><li>立即执行函数</li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 函数的调用方式</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 1. 普通函数</span></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;人生的巅峰&#x27;</span>);</span><br><span class="language-javascript"> </span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-comment">// fn();   fn.call()</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 2. 对象的方法</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> o = &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">sayHi</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;人生的巅峰&#x27;</span>);</span><br><span class="language-javascript"></span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        o.<span class="hljs-title function_">sayHi</span>();</span><br><span class="language-javascript">        <span class="hljs-comment">// 3. 构造函数</span></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">Star</span>(<span class="hljs-params"></span>) &#123;&#125;;</span><br><span class="language-javascript">        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Star</span>();</span><br><span class="language-javascript">        <span class="hljs-comment">// 4. 绑定事件函数</span></span><br><span class="language-javascript">        <span class="hljs-comment">// btn.onclick = function() &#123;&#125;;   // 点击了按钮就可以调用这个函数</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 5. 定时器函数</span></span><br><span class="language-javascript">        <span class="hljs-comment">// setInterval(function() &#123;&#125;, 1000);  这个函数是定时器自动1秒钟调用一次</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 6. 立即执行函数</span></span><br><span class="language-javascript">        (<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;人生的巅峰&#x27;</span>);</span><br><span class="language-javascript">        &#125;)();</span><br><span class="language-javascript">        <span class="hljs-comment">// 立即执行函数是自动调用</span></span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="3、函数内this的指向"><a href="#3、函数内this的指向" class="headerlink" title="3、函数内this的指向"></a>3、函数内this的指向</h3><ul><li><code>this</code>指向，是当我们调用函数的时候确定的，调用方式的不同决定了<code>this</code>的指向不同，一般我们指向我们的调用者</li></ul><table><thead><tr><th>调用方式</th><th>this指向</th></tr></thead><tbody><tr><td>普通函数调用</td><td>window</td></tr><tr><td>构造函数调用</td><td>实例对象，原型对象里面的方法也指向实例对象</td></tr><tr><td>对象方法调用</td><td>该方法所属对象</td></tr><tr><td>事件绑定方法</td><td>绑定事件对象</td></tr><tr><td>定时器函数</td><td>window</td></tr><tr><td>立即执行函数</td><td>window</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>点击<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 函数的不同调用方式决定了this 的指向不同</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 1. 普通函数 this 指向window</span></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;普通函数的this&#x27;</span> + <span class="hljs-variable language_">this</span>);</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">fn</span>();</span><br><span class="language-javascript">        <span class="hljs-comment">// 2. 对象的方法 this指向的是对象 o</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> o = &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">sayHi</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;对象方法的this:&#x27;</span> + <span class="hljs-variable language_">this</span>);</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        o.<span class="hljs-title function_">sayHi</span>();</span><br><span class="language-javascript">        <span class="hljs-comment">// 3. 构造函数 this 指向 ldh 这个实例对象 原型对象里面的this 指向的也是 ldh这个实例对象</span></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">Star</span>(<span class="hljs-params"></span>) &#123;&#125;;</span><br><span class="language-javascript">        <span class="hljs-title class_">Star</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">sing</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript"></span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> ldh = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Star</span>();</span><br><span class="language-javascript">        <span class="hljs-comment">// 4. 绑定事件函数 this 指向的是函数的调用者 btn这个按钮对象</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;button&#x27;</span>);</span><br><span class="language-javascript">        btn.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;绑定时间函数的this:&#x27;</span> + <span class="hljs-variable language_">this</span>);</span><br><span class="language-javascript">        &#125;;</span><br><span class="language-javascript">        <span class="hljs-comment">// 5. 定时器函数 this 指向的也是window</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">window</span>.<span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;定时器的this:&#x27;</span> + <span class="hljs-variable language_">this</span>);</span><br><span class="language-javascript"></span><br><span class="language-javascript">        &#125;, <span class="hljs-number">1000</span>);</span><br><span class="language-javascript">        <span class="hljs-comment">// 6. 立即执行函数 this还是指向window</span></span><br><span class="language-javascript">        (<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;立即执行函数的this&#x27;</span> + <span class="hljs-variable language_">this</span>);</span><br><span class="language-javascript">        &#125;)();</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="4、改变函数内部this指向"><a href="#4、改变函数内部this指向" class="headerlink" title="4、改变函数内部this指向"></a>4、改变函数内部this指向</h3><ul><li>JavaScript 为我们专门提供了一些函数方法来帮我们处理函数内部 this 的指向问题，常用的有 <code>bind(),call(),apply()</code>三种方法</li></ul><h4 id="1、call-方法"><a href="#1、call-方法" class="headerlink" title="1、call() 方法"></a>1、call() 方法</h4><ul><li><p><code>call()</code>方法调用一个对象，简单理解为调用函数的方式，但是它可以改变函数的<code>this</code>指向</p></li><li><p><code>fun.call(thisArg,arg1,arg2,.....)</code></p></li><li><p><code>thisArg</code>: 在 fun 函数运行时指定的 this 值</p></li><li><p><code>arg1,arg2</code>: 传递的其他参数</p></li><li><p>返回值就是函数的返回值，因为它就是调用函数</p></li><li><p>因此当我们想改变 this 指向，同时想调用这个函数的时候，可以使用 call，比如继承</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 改变函数内this指向  js提供了三种方法  call()  apply()  bind()</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 1. call()</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> o = &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;andy&#x27;</span></span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params">a, b</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a + b);</span><br><span class="language-javascript"></span><br><span class="language-javascript">        &#125;;</span><br><span class="language-javascript">        fn.<span class="hljs-title function_">call</span>(o, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>);</span><br><span class="language-javascript">        <span class="hljs-comment">// call 第一个可以调用函数 第二个可以改变函数内的this 指向</span></span><br><span class="language-javascript">        <span class="hljs-comment">// call 的主要作用可以实现继承</span></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">Father</span>(<span class="hljs-params">uname, age, sex</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">uname</span> = uname;</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">sex</span> = sex;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">Son</span>(<span class="hljs-params">uname, age, sex</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-title class_">Father</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, uname, age, sex);</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> son = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Son</span>(<span class="hljs-string">&#x27;刘德华&#x27;</span>, <span class="hljs-number">18</span>, <span class="hljs-string">&#x27;男&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(son);</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="2、apply-方法"><a href="#2、apply-方法" class="headerlink" title="2、apply()方法"></a>2、apply()方法</h4><ul><li><code>apply()</code>方法调用一个函数，简单理解为调用函数的方式，但是它可以改变函数的 <code>this</code>指向</li></ul><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs coq"><span class="hljs-keyword">fun</span>.<span class="hljs-built_in">apply</span>(thisArg,[argsArray])<br></code></pre></td></tr></table></figure><ul><li><p>thisArg: 在 fun 函数运行时指定的 this 值</p></li><li><p>argsArray : 传递的值，必须包含在数组里面</p></li><li><p>返回值就是函数的返回值，因为它就是调用函数</p></li><li><p>因此 apply 主要跟数组有关系，比如使用 Math.max() 求数组的最大值</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 改变函数内this指向  js提供了三种方法  call()  apply()  bind()</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 2. apply()  应用 运用的意思</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> o = &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;andy&#x27;</span></span><br><span class="language-javascript">        &#125;;</span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params">arr</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr); <span class="hljs-comment">// &#x27;pink&#x27;</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">        &#125;;</span><br><span class="language-javascript">        fn.<span class="hljs-title function_">apply</span>(o, [<span class="hljs-string">&#x27;pink&#x27;</span>]);</span><br><span class="language-javascript">        <span class="hljs-comment">// 1. 也是调用函数 第二个可以改变函数内部的this指向</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 2. 但是他的参数必须是数组(伪数组)</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 3. apply 的主要应用 比如说我们可以利用 apply 借助于数学内置对象求数组最大值 </span></span><br><span class="language-javascript">        <span class="hljs-comment">// Math.max();</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> arr = [<span class="hljs-number">1</span>, <span class="hljs-number">66</span>, <span class="hljs-number">3</span>, <span class="hljs-number">99</span>, <span class="hljs-number">4</span>];</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> arr1 = [<span class="hljs-string">&#x27;red&#x27;</span>, <span class="hljs-string">&#x27;pink&#x27;</span>];</span><br><span class="language-javascript">        <span class="hljs-comment">// var max = Math.max.apply(null, arr);</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> max = <span class="hljs-title class_">Math</span>.<span class="hljs-property">max</span>.<span class="hljs-title function_">apply</span>(<span class="hljs-title class_">Math</span>, arr);</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> min = <span class="hljs-title class_">Math</span>.<span class="hljs-property">min</span>.<span class="hljs-title function_">apply</span>(<span class="hljs-title class_">Math</span>, arr);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(max, min);</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="3、bind-方法"><a href="#3、bind-方法" class="headerlink" title="3、bind()方法"></a>3、bind()方法</h4><ul><li><code>bind()</code>方法不会调用函数。但是能改变函数内部 <code>this</code>指向</li></ul><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs coq"><span class="hljs-keyword">fun</span>.bind(thisArg,arg1,arg2,....)<br></code></pre></td></tr></table></figure><ul><li>返回由指定的 <code>this</code>值和初始化参数改造的 <strong>原函数拷贝</strong></li><li>因此当我们<strong>只是想改变 this 指向</strong>，并且不想调用这个函数的时候，可以使用bind</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>点击<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>点击<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>点击<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 改变函数内this指向  js提供了三种方法  call()  apply()  bind()</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 3. bind()  绑定 捆绑的意思</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> o = &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;andy&#x27;</span></span><br><span class="language-javascript">        &#125;;</span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params">a, b</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a + b);</span><br><span class="language-javascript"></span><br><span class="language-javascript"></span><br><span class="language-javascript">        &#125;;</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> f = fn.<span class="hljs-title function_">bind</span>(o, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>);</span><br><span class="language-javascript">        <span class="hljs-title function_">f</span>();</span><br><span class="language-javascript">        <span class="hljs-comment">// 1. 不会调用原来的函数   可以改变原来函数内部的this 指向</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 2. 返回的是原函数改变this之后产生的新函数</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 3. 如果有的函数我们不需要立即调用,但是又想改变这个函数内部的this指向此时用bind </span></span><br><span class="language-javascript">        <span class="hljs-comment">// 4. 我们有一个按钮,当我们点击了之后,就禁用这个按钮,3秒钟之后开启这个按钮</span></span><br><span class="language-javascript">        <span class="hljs-comment">// var btn1 = document.querySelector(&#x27;button&#x27;);</span></span><br><span class="language-javascript">        <span class="hljs-comment">// btn1.onclick = function() &#123;</span></span><br><span class="language-javascript">        <span class="hljs-comment">//     this.disabled = true; // 这个this 指向的是 btn 这个按钮</span></span><br><span class="language-javascript">        <span class="hljs-comment">//     // var that = this;</span></span><br><span class="language-javascript">        <span class="hljs-comment">//     setTimeout(function() &#123;</span></span><br><span class="language-javascript">        <span class="hljs-comment">//         // that.disabled = false; // 定时器函数里面的this 指向的是window</span></span><br><span class="language-javascript">        <span class="hljs-comment">//         this.disabled = false; // 此时定时器函数里面的this 指向的是btn</span></span><br><span class="language-javascript">        <span class="hljs-comment">//     &#125;.bind(this), 3000); // 这个this 指向的是btn 这个对象</span></span><br><span class="language-javascript">        <span class="hljs-comment">// &#125;</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> btns = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;button&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; btns.<span class="hljs-property">length</span>; i++) &#123;</span><br><span class="language-javascript">            btns[i].<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">disabled</span> = <span class="hljs-literal">true</span>;</span><br><span class="language-javascript">                <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">disabled</span> = <span class="hljs-literal">false</span>;</span><br><span class="language-javascript">                &#125;.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>), <span class="hljs-number">2000</span>);</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="4、总结"><a href="#4、总结" class="headerlink" title="4、总结"></a>4、总结</h4><p>call apply bind 总结：</p><p>相同点：</p><ul><li>都可以改变函数内部的 <code>this</code>指向</li></ul><p>区别点：</p><ul><li><code>call</code>和<code>apply</code>会调用函数，并且改变函数内部的<code>this</code>指向</li><li><code>call</code>和<code>apply</code>传递的参数不一样，call 传递参数，apply 必须数组形式</li><li><code>bind</code>不会调用函数，可以改变函数内部<code>this</code>指向</li></ul><p>主要应用场景</p><ol><li><code>call</code>经常做继承</li><li><code>apply</code>经常跟数组有关系，比如借助于数学对线实现数组最大值与最小值</li><li><code>bind</code>不调用函数，但是还想改变this指向，比如改变定时器内部的this指向</li></ol><h2 id="7、严格模式"><a href="#7、严格模式" class="headerlink" title="7、严格模式"></a>7、严格模式</h2><ul><li><p>JavaScript 除了提供正常模式外，还提供了严格模式</p></li><li><p>ES5 的严格模式是采用具有限制性 JavaScript 变体的一种方式，即在严格的条件下运行 JS 代码</p></li><li><p>严格模式在IE10 以上版本的浏览器才会被支持，旧版本浏览器会被忽略</p></li><li><p>严格模式对正常的JavaScript语义做了一些更改：</p><ul><li><p>消除了Javascript 语法的一些不合理、不严谨之处，减少了一些怪异行为</p></li><li><p>消除代码运行的一些不安全之处，保证代码运行的安全</p></li><li><p>提高编译器效率，增加运行速度</p></li><li><p>禁用了在 ECMAScript 的未来版本中可能会定义的一些语法，为未来新版本的 Javascript 做好铺垫。比如一些保留字如：class, enum, export, extends, import, super 不能做变量名</p></li></ul></li></ul><h3 id="1、开启严格模式"><a href="#1、开启严格模式" class="headerlink" title="1、开启严格模式"></a>1、开启严格模式</h3><h4 id="1、为脚本开启严格模式"><a href="#1、为脚本开启严格模式" class="headerlink" title="1、为脚本开启严格模式"></a>1、为脚本开启严格模式</h4><ul><li>为整个脚本文件开启严格模式，需要在所有语句之前放一个特定语句</li><li><code>&quot;use strict&quot;</code> 或<code>&#39;use strict&#39;</code></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-string">&#x27;user strict&#x27;</span>;</span><br><span class="language-javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;这是严格模式。&quot;</span>);</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><p>因为<code>&quot;use strict&quot;</code>加了引号，所以老版本的浏览器会把它当作一行普通字符串而忽略。</p><p>有的 script 基本是严格模式，有的 script 脚本是正常模式，这样不利于文件合并，所以可以将整个脚本文件放在一个立即执行的匿名函数之中。这样独立创建一个作用域而不影响其他 script 脚本文件。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>)&#123;</span><br><span class="language-javascript">    <span class="hljs-string">&#x27;use strict&#x27;</span>;</span><br><span class="language-javascript">     <span class="hljs-keyword">var</span> num = <span class="hljs-number">10</span>;</span><br><span class="language-javascript">     <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"></span>) &#123;&#125;</span><br><span class="language-javascript">&#125;)();   </span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="2、为函数开启严格模式"><a href="#2、为函数开启严格模式" class="headerlink" title="2、为函数开启严格模式"></a>2、为函数开启严格模式</h4><ul><li>若要给某个函数开启严格模式，需要把<code>&quot;use strict&quot;</code>或<code>&#39;use strict&#39;</code>声明放在函数体所有语句之前</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- 为整个脚本(script标签)开启严格模式 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"><span class="hljs-meta"></span></span><br><span class="hljs-meta"><span class="language-javascript">        &#x27;use strict&#x27;</span>;</span><br><span class="language-javascript">        <span class="hljs-comment">//   下面的js 代码就会按照严格模式执行代码</span></span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        (<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-string">&#x27;use strict&#x27;</span>;</span><br><span class="language-javascript">        &#125;)();</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- 为某个函数开启严格模式 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 此时只是给fn函数开启严格模式</span></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-string">&#x27;use strict&#x27;</span>;</span><br><span class="language-javascript">            <span class="hljs-comment">// 下面的代码按照严格模式执行</span></span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">fun</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">// 里面的还是按照普通模式执行</span></span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><ul><li>将<code>&quot;use strict&quot;</code> 放在函数体的第一行，则整个函数以 “严格模式”运行。</li></ul><h3 id="2、严格模式中的变化"><a href="#2、严格模式中的变化" class="headerlink" title="2、严格模式中的变化"></a>2、严格模式中的变化</h3><ul><li>严格模式对JavaScript的语法和行为，都做了一些改变</li></ul><h4 id="1、变量规定"><a href="#1、变量规定" class="headerlink" title="1、变量规定"></a>1、变量规定</h4><ul><li>在正常模式中，如果一个变量没有声明就赋值，默认是全局变量</li><li>严格模式禁止这种用法，变量都必须先用var 命令声明，然后再使用</li><li>严禁删除已经声明变量，例如，&#96;&#96;delete x&#96; 语法是错误的</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"><span class="hljs-meta"></span></span><br><span class="hljs-meta"><span class="language-javascript">        &#x27;use strict&#x27;</span>;</span><br><span class="language-javascript">        <span class="hljs-comment">// 1. 我们的变量名必须先声明再使用</span></span><br><span class="language-javascript">        <span class="hljs-comment">// num = 10;</span></span><br><span class="language-javascript">        <span class="hljs-comment">// console.log(num);</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> num = <span class="hljs-number">10</span>;</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num);</span><br><span class="language-javascript">        <span class="hljs-comment">// 2.我们不能随意删除已经声明好的变量</span></span><br><span class="language-javascript">        <span class="hljs-comment">// delete num;</span></span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="2、严格模式下this指向问题"><a href="#2、严格模式下this指向问题" class="headerlink" title="2、严格模式下this指向问题"></a>2、严格模式下this指向问题</h4><ol><li>以前在全局作用域函数中的<code>this</code>指向<code>window</code>对象</li><li>严格模式下全局作用域中函数中的<code>this</code> 是 undefined</li><li>以前构造函数时不加 <code>new</code> 也可以调用，当普通函数，<code>this</code>指向全局对象</li><li>严格模式下，如果构造函数不加 <code>new</code> 调用，<code>this</code>指向的是 <code>undefined</code> ，如果给它赋值，会报错</li><li><code>new</code> 实例化的构造函数指向创建的对象实例</li><li>定时器<code>this</code> 还是指向<code>window</code></li><li>事件、对象还是指向调用者</li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"><span class="hljs-meta"></span></span><br><span class="hljs-meta"><span class="language-javascript">        &#x27;use strict&#x27;</span>;</span><br><span class="language-javascript"><span class="hljs-comment">//3. 严格模式下全局作用域中函数中的 this 是 undefined。</span></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>); <span class="hljs-comment">// undefined。</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-title function_">fn</span>();</span><br><span class="language-javascript">        <span class="hljs-comment">//4. 严格模式下,如果 构造函数不加new调用, this 指向的是undefined 如果给他赋值则 会报错.</span></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">Star</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">sex</span> = <span class="hljs-string">&#x27;男&#x27;</span>;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-comment">// Star();</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> ldh = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Star</span>();</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ldh.<span class="hljs-property">sex</span>);</span><br><span class="language-javascript">        <span class="hljs-comment">//5. 定时器 this 还是指向 window </span></span><br><span class="language-javascript">        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);</span><br><span class="language-javascript"></span><br><span class="language-javascript">        &#125;, <span class="hljs-number">2000</span>);</span><br><span class="language-javascript">        </span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="3、函数变化"><a href="#3、函数变化" class="headerlink" title="3、函数变化"></a>3、函数变化</h3><ol><li>函数不能有重名的<strong>参数</strong></li><li>函数必须声明在顶层，新版本的JavaScript会引入“块级作用域”（ES6中已引入）。为了与新版本接轨，<strong>不允许在非函数的代码块内声明函数</strong></li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"><span class="hljs-meta"></span></span><br><span class="hljs-meta"><span class="language-javascript">        &#x27;use strict&#x27;</span>;</span><br><span class="language-javascript">        <span class="hljs-comment">// 6. 严格模式下函数里面的参数不允许有重名</span></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params">a, a</span>) &#123;</span><br><span class="language-javascript">           <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a + a);</span><br><span class="language-javascript"></span><br><span class="language-javascript">        &#125;;</span><br><span class="language-javascript">        <span class="hljs-comment">// fn(1, 2);</span></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"></span>) &#123;&#125;</span><br><span class="language-javascript">        </span><br><span class="language-javascript">        <span class="hljs-comment">// 不允许在非函数的代码块内声明函数</span></span><br><span class="language-javascript">        <span class="hljs-keyword">if</span>() &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"></span>) &#123;&#125;<span class="hljs-comment">//这样不允许</span></span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="8、高阶函数"><a href="#8、高阶函数" class="headerlink" title="8、高阶函数"></a>8、高阶函数</h2><ul><li>高阶函数是对其他函数进行操作的函数，它接收函数作为参数或将函数作为返回值输出</li></ul><p>接收函数作为参数</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 高阶函数- 函数可以作为参数传递</span></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params">a, b, callback</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a + b);</span><br><span class="language-javascript">            callback &amp;&amp; <span class="hljs-title function_">callback</span>();<span class="hljs-comment">//callback 若存在，则调用，不存在，不调用&amp;&amp;是且的意思，把必须都为真才能执行</span></span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-title function_">fn</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;我是最后调用的&#x27;</span>);</span><br><span class="language-javascript"></span><br><span class="language-javascript">        &#125;);</span><br><span class="language-javascript"></span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><p>将函数作为返回值</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"></span>)&#123;</span><br><span class="language-javascript">        <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;&#125;</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><ul><li>此时 fn 就是一个高阶函数</li><li>函数也是一种数据类型，同样可以作为参数，传递给另外一个参数使用。最典型的就是作为回调函数</li><li>同理函数也可以作为返回值传递回来</li></ul><h2 id="9、闭包"><a href="#9、闭包" class="headerlink" title="9、闭包"></a>9、闭包</h2><h3 id="1、变量作用域"><a href="#1、变量作用域" class="headerlink" title="1、变量作用域"></a>1、变量作用域</h3><p>变量根据作用域的不同分为两种：全局变量和局部变量</p><ol><li>函数内部可以使用全局变量</li><li>函数外部不可以使用局部变量</li><li>当函数执行完毕，本作用域内的局部变量会销毁。</li></ol><h3 id="2、什么是闭包"><a href="#2、什么是闭包" class="headerlink" title="2、什么是闭包"></a>2、什么是闭包</h3><p>闭包指有权访问另一个函数作用域中的变量的<strong>函数</strong></p><blockquote><p>简单理解：一个作用域可以访问另外一个函数内部的局部变量</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 闭包（closure）指有权访问另一个函数作用域中变量的函数。</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 闭包: 我们fn2 这个函数作用域 访问了另外一个函数 fn1 里面的局部变量 num</span></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn1</span>(<span class="hljs-params"></span>) &#123;<span class="hljs-comment">// fn1就是闭包函数</span></span><br><span class="language-javascript">            <span class="hljs-keyword">var</span> num = <span class="hljs-number">10</span>;</span><br><span class="language-javascript">            <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn2</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num); <span class="hljs-comment">//10</span></span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-title function_">fn2</span>();</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-title function_">fn1</span>();</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="3、在chrome中调试闭包"><a href="#3、在chrome中调试闭包" class="headerlink" title="3、在chrome中调试闭包"></a>3、在chrome中调试闭包</h3><ol><li>打开浏览器，按 F12 键启动 chrome 调试工具。</li><li>设置断点。</li><li>找到 Scope 选项（Scope 作用域的意思）。</li><li>当我们重新刷新页面，会进入断点调试，Scope 里面会有两个参数（global 全局作用域、local 局部作用域）。</li><li>当执行到 fn2() 时，Scope 里面会多一个 Closure 参数 ，这就表明产生了闭包。</li></ol><p><img src="/img/es6/bibao.png" alt="image"></p><h3 id="4、闭包的作用"><a href="#4、闭包的作用" class="headerlink" title="4、闭包的作用"></a>4、闭包的作用</h3><ul><li>延伸变量的作用范围</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 闭包（closure）指有权访问另一个函数作用域中变量的函数。</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 一个作用域可以访问另外一个函数的局部变量 </span></span><br><span class="language-javascript">        <span class="hljs-comment">// 我们fn 外面的作用域可以访问fn 内部的局部变量</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 闭包的主要作用: 延伸了变量的作用范围</span></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">var</span> num = <span class="hljs-number">10</span>;</span><br><span class="language-javascript">            <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num);</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> f = <span class="hljs-title function_">fn</span>();</span><br><span class="language-javascript">        <span class="hljs-title function_">f</span>();</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><p>练习：</p><p>点击li输出索引号：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;nav&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>榴莲<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>臭豆腐<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>鲱鱼罐头<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>大猪蹄子<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 闭包应用-点击li输出当前li的索引号</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 1. 我们可以利用动态添加属性的方式</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> lis = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.nav&#x27;</span>).<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;li&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; lis.<span class="hljs-property">length</span>; i++) &#123;</span><br><span class="language-javascript">            lis[i].<span class="hljs-property">index</span> = i;</span><br><span class="language-javascript">            lis[i].<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-comment">// console.log(i);</span></span><br><span class="language-javascript">                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">index</span>);</span><br><span class="language-javascript"></span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-comment">// 2. 利用闭包的方式得到当前小li 的索引号</span></span><br><span class="language-javascript">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; lis.<span class="hljs-property">length</span>; i++) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">// 利用for循环创建了4个立即执行函数</span></span><br><span class="language-javascript">            <span class="hljs-comment">// 立即执行函数也成为小闭包因为立即执行函数里面的任何一个函数都可以使用它的i这变量</span></span><br><span class="language-javascript">            (<span class="hljs-keyword">function</span>(<span class="hljs-params">i</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-comment">// console.log(i);</span></span><br><span class="language-javascript">                lis[i].<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(i);</span><br><span class="language-javascript"></span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;)(i);</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/img/es6/li.png" alt="image"></p><p>定时器中的闭包：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;nav&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>榴莲<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>臭豆腐<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>鲱鱼罐头<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>大猪蹄子<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 闭包应用-3秒钟之后,打印所有li元素的内容</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> lis = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.nav&#x27;</span>).<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;li&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; lis.<span class="hljs-property">length</span>; i++) &#123;</span><br><span class="language-javascript">            (<span class="hljs-keyword">function</span>(<span class="hljs-params">i</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(lis[i].<span class="hljs-property">innerHTML</span>);</span><br><span class="language-javascript">                &#125;, <span class="hljs-number">3000</span>)</span><br><span class="language-javascript">            &#125;)(i);</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/img/es6/dingshiqi.png" alt="image"></p><h2 id="10、递归"><a href="#10、递归" class="headerlink" title="10、递归"></a>10、递归</h2><p><strong>如果一个函数在内部可以调用其本身，那么这个函数就是递归函数</strong></p><p>简单理解： 函数内部自己调用自己，这个函数就是递归函数</p><p>由于递归很容易发生”栈溢出”错误，所以必须要加<strong>退出条件 return</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs html"><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 递归函数 : 函数内部自己调用自己, 这个函数就是递归函数</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> num = <span class="hljs-number">1</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;我要打印6句话&#x27;</span>);</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (num == <span class="hljs-number">6</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">return</span>; <span class="hljs-comment">// 递归里面必须加退出条件</span></span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            num++;</span><br><span class="language-javascript">            <span class="hljs-title function_">fn</span>();</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-title function_">fn</span>();</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="11、浅拷贝和深拷贝"><a href="#11、浅拷贝和深拷贝" class="headerlink" title="11、浅拷贝和深拷贝"></a>11、浅拷贝和深拷贝</h2><ol><li>浅拷贝只是拷贝一层，更深层次对象级别的只拷贝引用</li><li>深拷贝拷贝多层，每一级别的数据都会拷贝</li><li><code>Object.assign(target,....sources)</code> ES6新增方法可以浅拷贝</li></ol><h3 id="1、浅拷贝"><a href="#1、浅拷贝" class="headerlink" title="1、浅拷贝"></a>1、浅拷贝</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 浅拷贝只是拷贝一层，更深层次对象级别的只拷贝引用</span><br><span class="hljs-keyword">var</span> obj = &#123;<br>    <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;andy&#x27;</span>,<br>    <span class="hljs-attr">msg</span>: &#123;<br>        <span class="hljs-attr">age</span>: <span class="hljs-number">18</span><br>    &#125;<br>&#125;;<br><span class="hljs-keyword">var</span> o = &#123;&#125;<br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> k <span class="hljs-keyword">in</span> obj)&#123;<br>    <span class="hljs-comment">// k是属性名，obj[k]是属性值</span><br>    o[k] = obj.[k];<br>&#125;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(o);<br><span class="hljs-comment">// 浅拷贝语法糖</span><br><span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(o,obj);<br></code></pre></td></tr></table></figure><h3 id="2、深拷贝"><a href="#2、深拷贝" class="headerlink" title="2、深拷贝"></a>2、深拷贝</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 深拷贝拷贝多层，每一级别的数据都会拷贝</span><br><span class="hljs-keyword">var</span> obj = &#123;<br>    <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;andy&#x27;</span>,<br>    <span class="hljs-attr">msg</span>: &#123;<br>        <span class="hljs-attr">age</span>: <span class="hljs-number">18</span><br>    &#125;<br>    <span class="hljs-attr">color</span>: [<span class="hljs-string">&#x27;pink&#x27;</span>,<span class="hljs-string">&#x27;red&#x27;</span>]<br>&#125;;<br><span class="hljs-keyword">var</span> o = &#123;&#125;;<br><span class="hljs-comment">// 封装函数</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">deepCopy</span>(<span class="hljs-params">newobj,oldobj</span>)&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> k <span class="hljs-keyword">in</span> oldobj)&#123;<br>        <span class="hljs-comment">// 判断属性值属于简单数据类型还是复杂数据类型</span><br>        <span class="hljs-comment">// 1.获取属性值   oldobj[k]</span><br>        <span class="hljs-keyword">var</span> item = obldobj[k];<br>        <span class="hljs-comment">// 2.判断这个值是否是数组</span><br>        <span class="hljs-keyword">if</span>(item <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Array</span>)&#123;<br>            newobj[k] = [];<br>            <span class="hljs-title function_">deepCopy</span>(newobj[k],item)<br>        &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (item <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Object</span>)&#123;<br>              <span class="hljs-comment">// 3.判断这个值是否是对象</span><br>            newobj[k] = &#123;&#125;;<br>            <span class="hljs-title function_">deepCopy</span>(newobj[k],item)<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">// 4.属于简单数据类型</span><br>            newobj[k] = item;<br>            <br>        &#125; <br>    &#125;<br>&#125;<br><span class="hljs-title function_">deepCopy</span>(o,obj);<br></code></pre></td></tr></table></figure><h2 id="12、正则表达式"><a href="#12、正则表达式" class="headerlink" title="12、正则表达式"></a>12、正则表达式</h2><p>正则表达式是用于匹配字符串中字符组合的模式。在JavaScript中，正则表达式也是对象。</p><p>正则表通常被用来检索、替换那些符合某个模式（规则）的文本，例如验证表单：用户名表单只能输入英文字母、数字或者下划线， 昵称输入框中可以输入中文(匹配)。此外，正则表达式还常用于过滤掉页面内容中的一些敏感词(替换)，或从字符串中获取我们想要的特定部分(提取)等 。</p><h3 id="1、特点"><a href="#1、特点" class="headerlink" title="1、特点"></a>1、特点</h3><ul><li>实际开发，一般都是直接复制写好的正则表达式</li><li>但是要求会使用正则表达式并且根据自身实际情况修改正则表达式</li></ul><h3 id="2、创建正则表达式"><a href="#2、创建正则表达式" class="headerlink" title="2、创建正则表达式"></a>2、创建正则表达式</h3><p>在JavaScript中，可以通过两种方式创建正则表达式</p><ol><li>通过调用 RegExp 对象的构造函数创建</li><li>通过字面量创建</li></ol><h4 id="1、通过调用-RegExp-对象的构造函数创建"><a href="#1、通过调用-RegExp-对象的构造函数创建" class="headerlink" title="1、通过调用 RegExp 对象的构造函数创建"></a>1、通过调用 RegExp 对象的构造函数创建</h4><ul><li>通过调用 RegExp 对象的构造函数创建</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> 变量名 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(<span class="hljs-regexp">/表达式/</span>);<br></code></pre></td></tr></table></figure><h4 id="2、通过字面量创建"><a href="#2、通过字面量创建" class="headerlink" title="2、通过字面量创建"></a>2、通过字面量创建</h4><ul><li>通过字面量创建</li></ul><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-keyword">var</span> 变量名 = <span class="hljs-regexp">/表达式/</span>;<br></code></pre></td></tr></table></figure><p>注释中间放表达式就是正则字面量</p><h4 id="3、测试正则表达式-test"><a href="#3、测试正则表达式-test" class="headerlink" title="3、测试正则表达式 test"></a>3、测试正则表达式 test</h4><ul><li><code>test()</code>正则对象方法，用于检测字符串是否符合该规则，该对象会返回<code>true</code>或<code>false</code>,其参数是测试字符串</li></ul><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">regexObj<span class="hljs-number">.</span><span class="hljs-keyword">test</span>(<span class="hljs-keyword">str</span>)<br></code></pre></td></tr></table></figure><ul><li><code>regexObj</code> 写的是正则表达式</li><li><code>str</code> 我们要测试的文本</li><li>就是检测<code>str</code>文本是否符合我们写的正则表达式规范</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 正则表达式在js中的使用</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 1. 利用 RegExp对象来创建 正则表达式</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> regexp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(<span class="hljs-regexp">/123/</span>);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(regexp);</span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 2. 利用字面量创建 正则表达式</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> rg = <span class="hljs-regexp">/123/</span>;</span><br><span class="language-javascript">        <span class="hljs-comment">// 3.test 方法用来检测字符串是否符合正则表达式要求的规范</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(rg.<span class="hljs-title function_">test</span>(<span class="hljs-number">123</span>));</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(rg.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;abc&#x27;</span>));</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="3、正则表达式中的特殊在字符"><a href="#3、正则表达式中的特殊在字符" class="headerlink" title="3、正则表达式中的特殊在字符"></a>3、正则表达式中的特殊在字符</h3><h4 id="1、边界符"><a href="#1、边界符" class="headerlink" title="1、边界符"></a>1、边界符</h4><p>正则表达式中的边界符(位置符)用来提示字符所处的位置，主要有两个字符</p><table><thead><tr><th>边界符</th><th>说明</th></tr></thead><tbody><tr><td>^</td><td>表示匹配行首的文本(以谁开始)</td></tr><tr><td>$</td><td>表示匹配行尾的文本(以谁结束)</td></tr></tbody></table><p>如果^ 和 $ 在一起，表示必须是精确匹配</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 边界符 ^ $</span><br><span class="hljs-keyword">var</span> rg = <span class="hljs-regexp">/abc/</span>;   <span class="hljs-comment">//正则表达式里面不需要加引号，不管是数字型还是字符串型</span><br><span class="hljs-comment">// /abc/只要包含有abc这个字符串返回的都是true</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(rg.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;abc&#x27;</span>));<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(rg.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;abcd&#x27;</span>));<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(rg.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;aabcd&#x27;</span>));<br><br><span class="hljs-keyword">var</span> reg = <span class="hljs-regexp">/^abc/</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(reg.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;abc&#x27;</span>));   <span class="hljs-comment">//true</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(reg.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;abcd&#x27;</span>));<span class="hljs-comment">// true</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(reg.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;aabcd&#x27;</span>)); <span class="hljs-comment">// false</span><br><br><span class="hljs-keyword">var</span> reg1 = <span class="hljs-regexp">/^abc$/</span><br><span class="hljs-comment">// 以abc开头，以abc结尾，必须是abc</span><br></code></pre></td></tr></table></figure><h4 id="2、字符类"><a href="#2、字符类" class="headerlink" title="2、字符类"></a>2、字符类</h4><ul><li>字符类表示有一系列字符可供选择，只要匹配其中一个就可以了</li><li>所有可供选择的字符都放在方括号内</li></ul><h5 id="1、-方括号"><a href="#1、-方括号" class="headerlink" title="1、[] 方括号"></a>1、[] 方括号</h5><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/[abc]/</span>.test(<span class="hljs-string">&#x27;andy&#x27;</span>);     <span class="hljs-regexp">//</span> true<br></code></pre></td></tr></table></figure><p>后面的字符串只要包含 abc 中任意一个字符,都返回true</p><h5 id="2、-方括号内部-范围符"><a href="#2、-方括号内部-范围符" class="headerlink" title="2、[-]方括号内部 范围符"></a>2、[-]方括号内部 范围符</h5><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/^[a-z]$/</span>.test()<br></code></pre></td></tr></table></figure><p>方括号内部加上 - 表示范围，这里表示 a - z 26个英文字母都可以</p><h5 id="3、-方括号内部-取反符"><a href="#3、-方括号内部-取反符" class="headerlink" title="3、[^] 方括号内部 取反符 ^"></a>3、[^] 方括号内部 取反符 ^</h5><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/[^abc]/</span>.test(<span class="hljs-string">&#x27;andy&#x27;</span>)   <span class="hljs-regexp">//</span> false<br></code></pre></td></tr></table></figure><p>方括号内部加上 ^ 表示取反，只要包含方括号内的字符，都返回 false</p><p>注意和边界符 ^ 区别，边界符写到方括号外面</p><h5 id="4、字符组合"><a href="#4、字符组合" class="headerlink" title="4、字符组合"></a>4、字符组合</h5><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/[a-z1-9]/</span>.test(<span class="hljs-string">&#x27;andy&#x27;</span>)    <span class="hljs-regexp">//</span> true<br></code></pre></td></tr></table></figure><p>方括号内部可以使用字符组合，这里表示包含 a 到 z的26个英文字母和1到9的数字都可以</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">//var rg = /abc/;  只要包含abc就可以 </span></span><br><span class="language-javascript">        <span class="hljs-comment">// 字符类: [] 表示有一系列字符可供选择，只要匹配其中一个就可以了</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> rg = <span class="hljs-regexp">/[abc]/</span>; <span class="hljs-comment">// 只要包含有a 或者 包含有b 或者包含有c 都返回为true</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(rg.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;andy&#x27;</span>));</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(rg.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;baby&#x27;</span>));</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(rg.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;color&#x27;</span>));</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(rg.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;red&#x27;</span>));</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> rg1 = <span class="hljs-regexp">/^[abc]$/</span>; <span class="hljs-comment">// 三选一 只有是a 或者是 b  或者是c 这三个字母才返回 true</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(rg1.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;aa&#x27;</span>));</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(rg1.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;a&#x27;</span>));</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(rg1.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;b&#x27;</span>));</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(rg1.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;c&#x27;</span>));</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(rg1.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;abc&#x27;</span>));</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;------------------&#x27;</span>);</span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> reg = <span class="hljs-regexp">/^[a-z]$/</span>; <span class="hljs-comment">// 26个英文字母任何一个字母返回 true  - 表示的是a 到z 的范围  </span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(reg.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;a&#x27;</span>));</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(reg.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;z&#x27;</span>));</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(reg.<span class="hljs-title function_">test</span>(<span class="hljs-number">1</span>));</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(reg.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;A&#x27;</span>));</span><br><span class="language-javascript">        <span class="hljs-comment">// 字符组合</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> reg1 = <span class="hljs-regexp">/^[a-zA-Z0-9_-]$/</span>; <span class="hljs-comment">// 26个英文字母(大写和小写都可以)任何一个字母返回 true  </span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(reg1.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;a&#x27;</span>));</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(reg1.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;B&#x27;</span>));</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(reg1.<span class="hljs-title function_">test</span>(<span class="hljs-number">8</span>));</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(reg1.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;-&#x27;</span>));</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(reg1.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;_&#x27;</span>));</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(reg1.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;!&#x27;</span>));</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;----------------&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-comment">// 如果中括号里面有^ 表示取反的意思 千万和 我们边界符 ^ 别混淆</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> reg2 = <span class="hljs-regexp">/^[^a-zA-Z0-9_-]$/</span>;</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(reg2.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;a&#x27;</span>));</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(reg2.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;B&#x27;</span>));</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(reg2.<span class="hljs-title function_">test</span>(<span class="hljs-number">8</span>));</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(reg2.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;-&#x27;</span>));</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(reg2.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;_&#x27;</span>));</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(reg2.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;!&#x27;</span>));</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="3、量词符"><a href="#3、量词符" class="headerlink" title="3、量词符"></a>3、量词符</h4><p>量词符用来设定某个模式出现的次数</p><table><thead><tr><th>量词</th><th>说明</th></tr></thead><tbody><tr><td>*</td><td>重复零次或更多次</td></tr><tr><td>+</td><td>重复一次或更多次</td></tr><tr><td>?</td><td>重复零次或一次</td></tr><tr><td>{n}</td><td>重复n次</td></tr><tr><td>{n,}</td><td>重复n次或更多次</td></tr><tr><td>{n,m}</td><td>重复n到m次</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 量词符: 用来设定某个模式出现的次数</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 简单理解: 就是让下面的a这个字符重复多少次</span></span><br><span class="language-javascript">        <span class="hljs-comment">// var reg = /^a$/;</span></span><br><span class="language-javascript"></span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">//  * 相当于 &gt;= 0 可以出现0次或者很多次 </span></span><br><span class="language-javascript">        <span class="hljs-comment">// var reg = /^a*$/;</span></span><br><span class="language-javascript">        <span class="hljs-comment">// console.log(reg.test(&#x27;&#x27;));</span></span><br><span class="language-javascript">        <span class="hljs-comment">// console.log(reg.test(&#x27;a&#x27;));</span></span><br><span class="language-javascript">        <span class="hljs-comment">// console.log(reg.test(&#x27;aaaa&#x27;));</span></span><br><span class="language-javascript"></span><br><span class="language-javascript"></span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">//  + 相当于 &gt;= 1 可以出现1次或者很多次</span></span><br><span class="language-javascript">        <span class="hljs-comment">// var reg = /^a+$/;</span></span><br><span class="language-javascript">        <span class="hljs-comment">// console.log(reg.test(&#x27;&#x27;)); // false</span></span><br><span class="language-javascript">        <span class="hljs-comment">// console.log(reg.test(&#x27;a&#x27;)); // true</span></span><br><span class="language-javascript">        <span class="hljs-comment">// console.log(reg.test(&#x27;aaaa&#x27;)); // true</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">//  ?  相当于 1 || 0</span></span><br><span class="language-javascript">        <span class="hljs-comment">// var reg = /^a?$/;</span></span><br><span class="language-javascript">        <span class="hljs-comment">// console.log(reg.test(&#x27;&#x27;)); // true</span></span><br><span class="language-javascript">        <span class="hljs-comment">// console.log(reg.test(&#x27;a&#x27;)); // true</span></span><br><span class="language-javascript">        <span class="hljs-comment">// console.log(reg.test(&#x27;aaaa&#x27;)); // false</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">//  &#123;3 &#125; 就是重复3次</span></span><br><span class="language-javascript">        <span class="hljs-comment">// var reg = /^a&#123;3&#125;$/;</span></span><br><span class="language-javascript">        <span class="hljs-comment">// console.log(reg.test(&#x27;&#x27;)); // false</span></span><br><span class="language-javascript">        <span class="hljs-comment">// console.log(reg.test(&#x27;a&#x27;)); // false</span></span><br><span class="language-javascript">        <span class="hljs-comment">// console.log(reg.test(&#x27;aaaa&#x27;)); // false</span></span><br><span class="language-javascript">        <span class="hljs-comment">// console.log(reg.test(&#x27;aaa&#x27;)); // true</span></span><br><span class="language-javascript">        <span class="hljs-comment">//  &#123;3, &#125;  大于等于3</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> reg = <span class="hljs-regexp">/^a&#123;3,&#125;$/</span>;</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(reg.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;&#x27;</span>)); <span class="hljs-comment">// false</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(reg.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;a&#x27;</span>)); <span class="hljs-comment">// false</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(reg.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;aaaa&#x27;</span>)); <span class="hljs-comment">// true</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(reg.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;aaa&#x27;</span>)); <span class="hljs-comment">// true</span></span><br><span class="language-javascript">        <span class="hljs-comment">//  &#123;3,16&#125;  大于等于3 并且 小于等于16</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> reg = <span class="hljs-regexp">/^a&#123;3,6&#125;$/</span>;</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(reg.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;&#x27;</span>)); <span class="hljs-comment">// false</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(reg.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;a&#x27;</span>)); <span class="hljs-comment">// false</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(reg.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;aaaa&#x27;</span>)); <span class="hljs-comment">// true</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(reg.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;aaa&#x27;</span>)); <span class="hljs-comment">// true</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(reg.<span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;aaaaaaa&#x27;</span>)); <span class="hljs-comment">// false</span></span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="4、用户名验证"><a href="#4、用户名验证" class="headerlink" title="4、用户名验证"></a>4、用户名验证</h4><p>功能需求：</p><ol><li>如果用户名输入合法, 则后面提示信息为 : 用户名合法,并且颜色为绿色</li><li>如果用户名输入不合法, 则后面提示信息为: 用户名不符合规范, 并且颜色为绿色</li></ol><p>分析：</p><ol><li>用户名只能为英文字母,数字,下划线或者短横线组成, 并且用户名长度为 6~16位.</li><li>首先准备好这种正则表达式模式 &#x2F;$[a-zA-Z0-9-_]{6,16}^&#x2F;</li><li>当表单失去焦点就开始验证.</li><li>如果符合正则规范, 则让后面的span标签添加 right 类.</li><li>如果不符合正则规范, 则让后面的span标签添加 wrong 类.</li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;uname&quot;</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>请输入用户名<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">//  量词是设定某个模式出现的次数</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> reg = <span class="hljs-regexp">/^[a-zA-Z0-9_-]&#123;6,16&#125;$/</span>; <span class="hljs-comment">// 这个模式用户只能输入英文字母 数字 下划线 短横线但是有边界符和[] 这就限定了只能多选1</span></span><br><span class="language-javascript">        <span class="hljs-comment">// &#123;6,16&#125;  中间不要有空格</span></span><br><span class="language-javascript">        <span class="hljs-comment">// console.log(reg.test(&#x27;a&#x27;));</span></span><br><span class="language-javascript">        <span class="hljs-comment">// console.log(reg.test(&#x27;8&#x27;));</span></span><br><span class="language-javascript">        <span class="hljs-comment">// console.log(reg.test(&#x27;18&#x27;));</span></span><br><span class="language-javascript">        <span class="hljs-comment">// console.log(reg.test(&#x27;aa&#x27;));</span></span><br><span class="language-javascript">        <span class="hljs-comment">// console.log(&#x27;-------------&#x27;);</span></span><br><span class="language-javascript">        <span class="hljs-comment">// console.log(reg.test(&#x27;andy-red&#x27;));</span></span><br><span class="language-javascript">        <span class="hljs-comment">// console.log(reg.test(&#x27;andy_red&#x27;));</span></span><br><span class="language-javascript">        <span class="hljs-comment">// console.log(reg.test(&#x27;andy007&#x27;));</span></span><br><span class="language-javascript">        <span class="hljs-comment">// console.log(reg.test(&#x27;andy!007&#x27;));</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> uname = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.uname&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> span = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;span&#x27;</span>);</span><br><span class="language-javascript">        uname.<span class="hljs-property">onblur</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (reg.<span class="hljs-title function_">test</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>)) &#123;</span><br><span class="language-javascript">                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;正确的&#x27;</span>);</span><br><span class="language-javascript">                span.<span class="hljs-property">className</span> = <span class="hljs-string">&#x27;right&#x27;</span>;</span><br><span class="language-javascript">                span.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">&#x27;用户名格式输入正确&#x27;</span>;</span><br><span class="language-javascript">            &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;错误的&#x27;</span>);</span><br><span class="language-javascript">                span.<span class="hljs-property">className</span> = <span class="hljs-string">&#x27;wrong&#x27;</span>;</span><br><span class="language-javascript">                span.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">&#x27;用户名格式输入不正确&#x27;</span>;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="4、括号总结"><a href="#4、括号总结" class="headerlink" title="4、括号总结"></a>4、括号总结</h3><ol><li>大括号 量词符 里面面表示重复次数</li><li>中括号 字符集合 匹配方括号中的任意字符</li><li>小括号 表示优先级</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 中括号 字符集合 匹配方括号中的任意字符</span><br><span class="hljs-keyword">var</span> reg = <span class="hljs-regexp">/^[abc]$/</span>;<br><span class="hljs-comment">// a || b || c</span><br><span class="hljs-comment">// 大括号 量词符 里面表示重复次数</span><br><span class="hljs-keyword">var</span> reg = <span class="hljs-regexp">/^abc&#123;3&#125;$/</span>;   <span class="hljs-comment">// 它只是让c 重复3次 abccc</span><br><span class="hljs-comment">// 小括号 表示优先级</span><br><span class="hljs-keyword">var</span> reg = <span class="hljs-regexp">/^(abc)&#123;3&#125;$/</span>;  <span class="hljs-comment">//它是让 abc 重复3次</span><br></code></pre></td></tr></table></figure><p>在线测试正则表达式：<a href="https://c.runoob.com/">https://c.runoob.com/</a></p><h3 id="5、预定义类"><a href="#5、预定义类" class="headerlink" title="5、预定义类"></a>5、预定义类</h3><p>预定义类指的是 某些常见模式的简写写法</p><table><thead><tr><th>预定类</th><th>说明</th></tr></thead><tbody><tr><td>\d</td><td>匹配0-9之间的任一数字，相当于[0-9]</td></tr><tr><td>\D</td><td>匹配所有0-9以外的字符，相当于[ ^ 0-9]</td></tr><tr><td>\w</td><td>匹配任意的字母、数字和下划线,相当于[A-Za-z0-9_ ]</td></tr><tr><td>\W</td><td>除所有字母、数字、和下划线以外的字符，相当于[ ^A-Za-z0-9_ ]</td></tr><tr><td>\s</td><td>匹配空格（包括换行符，制表符，空格符等），相当于[\t\t\n\v\f]</td></tr><tr><td>\S</td><td>匹配非空格的字符，相当于[ ^ \t\r\n\v\f]</td></tr></tbody></table><h4 id="1、表单验证"><a href="#1、表单验证" class="headerlink" title="1、表单验证"></a>1、表单验证</h4><p>分析：</p><p>1.手机号码: <code>/^1[3|4|5|7|8][0-9]&#123;9&#125;$/</code></p><p>2.QQ: <code>[1-9][0-9]&#123;4,&#125;</code> (腾讯QQ号从10000开始)</p><p>3.昵称是中文: <code>^[\u4e00-\u9fa5]&#123;2,8&#125;$</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 座机号码验证:  全国座机号码  两种格式:   010-12345678  或者  0530-1234567</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 正则里面的或者 符号  |  </span></span><br><span class="language-javascript">        <span class="hljs-comment">// var reg = /^\d&#123;3&#125;-\d&#123;8&#125;|\d&#123;4&#125;-\d&#123;7&#125;$/;</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> reg = <span class="hljs-regexp">/^\d&#123;3,4&#125;-\d&#123;7,8&#125;$/</span>;</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="6、正则表达式中的替换"><a href="#6、正则表达式中的替换" class="headerlink" title="6、正则表达式中的替换"></a>6、正则表达式中的替换</h3><h4 id="1、replace-替换"><a href="#1、replace-替换" class="headerlink" title="1、replace 替换"></a>1、replace 替换</h4><ul><li><code>replace()</code>方法可以实现替换字符串操作，用来替换的参数可以是一个字符串或是一个正则表达式</li></ul><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-built_in">string</span>Object.replace(regexp/substr,replacement)<br></code></pre></td></tr></table></figure><ol><li>第一个参数: 被替换的字符串或者正则表达式</li><li>第二个参数：替换为的字符串</li><li>返回值是一个替换完毕的新字符串</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 替换 replace</span><br><span class="hljs-keyword">var</span> str = <span class="hljs-string">&#x27;andy和red&#x27;</span>;<br><span class="hljs-keyword">var</span> newStr = str.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;andy&#x27;</span>,<span class="hljs-string">&#x27;baby&#x27;</span>);<br><span class="hljs-keyword">var</span> newStr = str.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/andy/</span>,<span class="hljs-string">&#x27;baby&#x27;</span>);<br></code></pre></td></tr></table></figure><h4 id="2、正则表达式参数"><a href="#2、正则表达式参数" class="headerlink" title="2、正则表达式参数"></a>2、正则表达式参数</h4><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><span class="hljs-regexp">/表达式/</span>[<span class="hljs-keyword">switch</span>]<br></code></pre></td></tr></table></figure><p><code>switch</code>按照什么样的模式来匹配，有三种</p><ul><li><code>g</code>: 全局匹配</li><li><code>i</code>:忽略大小写</li><li><code>gi</code>: 全局匹配 + 忽略大小写</li></ul><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-built_in">replace</span>(<span class="hljs-regexp">/激情/g</span>,<span class="hljs-string">&#x27;**&#x27;</span>);<br></code></pre></td></tr></table></figure><h1 id="ES6"><a href="#ES6" class="headerlink" title="ES6"></a>ES6</h1><blockquote><p>ES全称EcmaScript，是脚本语言的规范，而平时经常编写的JavaScript，是EcmaScript的一种实现，所以ES新特性其实就是指的是JavaScript的新特性</p></blockquote><p><img src="/img/es6/es6.png" alt="image"></p><h2 id="let变量"><a href="#let变量" class="headerlink" title="let变量"></a>let变量</h2><ul><li>声明格式</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">let</span> a;<br><span class="hljs-built_in">let</span> b,c,d;<br><span class="hljs-built_in">let</span> e = 100;<br><span class="hljs-built_in">let</span> f = 32, g = <span class="hljs-string">&#x27;dad&#x27;</span>, h = []<br></code></pre></td></tr></table></figure><blockquote><p>let 允许创建<strong>块级作用域</strong>，ES6 推荐在函数中使用 let 定义变量，而非 var</p><p>let 是在代码块内有效，var 是在全局范围内有效</p></blockquote><p><strong>特点：</strong></p><ul><li><p>变量不能重复声明，只能声明一次</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">let star</span> = <span class="hljs-string">&#x27;妮露&#x27;</span>;<br><span class="hljs-attribute">let star</span> = <span class="hljs-string">&#x27;胡桃&#x27;</span>;<br></code></pre></td></tr></table></figure></li><li><p>块级作用域      全局，函数 eval</p><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs lasso">&#123;<br><span class="hljs-keyword">let</span> star= <span class="hljs-string">&#x27;妮露&#x27;</span>;<br>&#125;<br>consloe.<span class="hljs-keyword">log</span>(star);<span class="hljs-comment">//错误，let是块级作用域，不能使用。var是全局作用域</span><br></code></pre></td></tr></table></figure></li><li><p>不存在变量提升</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(star);<br>let star = <span class="hljs-string">&#x27;妮露&#x27;</span>;<span class="hljs-comment">//错误，先声明才能调用，没有变量提升。var可以</span><br></code></pre></td></tr></table></figure></li><li><p>不影响作用域链</p><figure class="highlight zephir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs zephir">&#123;<br><span class="hljs-keyword">let</span> star = <span class="hljs-string">&#x27;妮露&#x27;</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fn</span><span class="hljs-params">()</span> </span>&#123;<br>         console.log(star);<br>    &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">fn</span><span class="hljs-params">()</span></span>;<br></code></pre></td></tr></table></figure></li><li><p>for 循环计数器很适合用 let</p></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;<br>  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(i);<br>  &#125;)<br>&#125;<br><span class="hljs-comment">// 输出十个 10</span><br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">10</span>; j++) &#123;<br>  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(j);<br>  &#125;)<br>&#125;<br><span class="hljs-comment">// 输出 0123456789</span><br></code></pre></td></tr></table></figure><ul><li>变量 i 是用 var 声明的，在全局范围内有效，所以全局中只有一个变量 i, 每次循环时，setTimeout 定时器里面的 i 指的是全局变量 i ，而循环里的十个 setTimeout 是在循环结束后才执行，所以此时的 i 都是 10。</li><li>变量 j 是用 let 声明的，当前的 j 只在本轮循环中有效，每次循环的 j 其实都是一个新的变量，所以 setTimeout 定时器里面的 j 其实是不同的变量，即最后输出 12345。（若每次循环的变量 j 都是重新声明的，如何知道前一个循环的值？这是因为 JavaScript 引擎内部会记住前一个循环的值）。</li></ul><h2 id="const变量"><a href="#const变量" class="headerlink" title="const变量"></a>const变量</h2><p>同样在块级作用域有效的另一个变量声明方式是 const，它可以声明一个常量。ES6 中，const 声明的常量类似于指针，<strong>它指向某个引用，也就是说这个「常量」并非一成不变的</strong>，如：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js">&#123;<br>  <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">ARR</span> = [<span class="hljs-number">5</span>,<span class="hljs-number">6</span>];<br>  <span class="hljs-variable constant_">ARR</span>.<span class="hljs-title function_">push</span>(<span class="hljs-number">7</span>);<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable constant_">ARR</span>); <span class="hljs-comment">// [5,6,7]</span><br>  <span class="hljs-variable constant_">ARR</span> = <span class="hljs-number">10</span>; <span class="hljs-comment">// TypeError</span><br>&#125;<br></code></pre></td></tr></table></figure><p>有几个点需要注意：</p><ul><li>let 和 const 声明只在最靠近的一个块中（花括号内）有效</li><li>当使用常量 const 声明时，请使用<strong>大写变量</strong>，如：CAPITAL_CASING(一般都是大写)</li><li>const <strong>在声明时必须被赋值</strong></li><li>常量的值不能修改</li><li>块级作用域</li><li>对于数组和对象的元素修改，不算做对常量的修改，不会报错</li></ul><h2 id="变量的解构赋值"><a href="#变量的解构赋值" class="headerlink" title="变量的解构赋值"></a>变量的解构赋值</h2><ul><li>解构可以避免在对象赋值时产生中间变量</li></ul><h4 id="1、数组的解构"><a href="#1、数组的解构" class="headerlink" title="1、数组的解构"></a>1、数组的解构</h4><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs arcade">const F4 = [<span class="hljs-string">&#x27;妮露&#x27;</span>,<span class="hljs-string">&#x27;申鹤&#x27;</span>,<span class="hljs-string">&#x27;胡桃&#x27;</span>,<span class="hljs-string">&#x27;甘雨&#x27;</span>];<br>let [ni, shen, hu, gan] = F4;<span class="hljs-comment">//数组需要中括号</span><br><span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(ni);<br><span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(shen);<br><span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(hu);<br><span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(gan);<br></code></pre></td></tr></table></figure><h4 id="2、对象的解构"><a href="#2、对象的解构" class="headerlink" title="2、对象的解构"></a>2、对象的解构</h4><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs arcade">const ni =  &#123;<br><span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;妮露&#x27;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">20</span>,<br>    <span class="hljs-attr">tiaowu</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(<span class="hljs-string">&quot;花神之舞&quot;</span>);<br>    &#125;<br>&#125;<br>let &#123;name, age, tiaowu&#125; = ni;<span class="hljs-comment">//对象需要花括号</span><br><span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(name);<br><span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(age);<br><span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(tiaowu);<br></code></pre></td></tr></table></figure><h2 id="模板字符串"><a href="#模板字符串" class="headerlink" title="模板字符串"></a>模板字符串</h2><p>ES6 中有一种十分简洁的方法组装一堆字符串和变量。</p><ul><li>${ … } 用来渲染一个变量</li><li>&#96; 作为分隔符</li></ul><h4 id="1、声明"><a href="#1、声明" class="headerlink" title="1、声明"></a>1、声明</h4><figure class="highlight openscad"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs openscad"><span class="hljs-built_in">let</span> <span class="hljs-built_in">str</span> = `字符串!`;<br>console.<span class="hljs-built_in">log</span>(<span class="hljs-built_in">str</span>, typeof <span class="hljs-built_in">str</span>);<br></code></pre></td></tr></table></figure><h4 id="2、内容中可以直接出现换行符"><a href="#2、内容中可以直接出现换行符" class="headerlink" title="2、内容中可以直接出现换行符"></a>2、内容中可以直接出现换行符</h4><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xquery"><span class="hljs-keyword">let</span> str = `<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span></span><br><span class="language-xml"></span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>妮露<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><span class="language-xml"></span><br><span class="language-xml">    </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>申鹤<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><span class="language-xml"></span><br><span class="language-xml">    </span><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>胡桃<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><span class="language-xml"></span><br><span class="language-xml">           <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span>`;<br>console.log(str);<br></code></pre></td></tr></table></figure><h4 id="3、变量拼接"><a href="#3、变量拼接" class="headerlink" title="3、变量拼接"></a>3、变量拼接</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> lover = <span class="hljs-string">&#x27;妮露&#x27;</span>;<br><span class="hljs-keyword">let</span> wife = <span class="hljs-string">`<span class="hljs-subst">$&#123;lover&#125;</span>是我的老婆`</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(wife);<br></code></pre></td></tr></table></figure><h2 id="简化对象写法"><a href="#简化对象写法" class="headerlink" title="简化对象写法"></a>简化对象写法</h2><ul><li>ES6 允许声明在对象字面量时使用<strong>简写语法</strong>，来初始化属性变量和函数的定义方法，并且允许在对象属性中进行计算操作</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getCar</span>(<span class="hljs-params">make, model, value</span>) &#123;<br>  <span class="hljs-keyword">return</span> &#123;<br>    <span class="hljs-comment">// 简写变量</span><br>    make,  <span class="hljs-comment">// 等同于 make: make</span><br>    model, <span class="hljs-comment">// 等同于 model: model</span><br>    value, <span class="hljs-comment">// 等同于 value: value</span><br> <br>    <span class="hljs-comment">// 属性可以使用表达式计算值</span><br>    [<span class="hljs-string">&#x27;make&#x27;</span> + make]: <span class="hljs-literal">true</span>,<br> <br>    <span class="hljs-comment">// 忽略 `function` 关键词简写对象函数</span><br>    <span class="hljs-title function_">depreciate</span>(<span class="hljs-params"></span>) &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> -= <span class="hljs-number">2500</span>;<br>    &#125;<br>  &#125;;<br>&#125;<br> <br><span class="hljs-keyword">let</span> car = <span class="hljs-title function_">getCar</span>(<span class="hljs-string">&#x27;Barret&#x27;</span>, <span class="hljs-string">&#x27;Lee&#x27;</span>, <span class="hljs-number">40000</span>);<br> <br><span class="hljs-comment">// output: &#123;</span><br><span class="hljs-comment">//     make: &#x27;Barret&#x27;,</span><br><span class="hljs-comment">//     model:&#x27;Lee&#x27;,</span><br><span class="hljs-comment">//     value: 40000,</span><br><span class="hljs-comment">//     makeBarret: true,</span><br><span class="hljs-comment">//     depreciate: [Function: depreciate]</span><br><span class="hljs-comment">// &#125;</span><br></code></pre></td></tr></table></figure><h2 id="箭头函数"><a href="#箭头函数" class="headerlink" title="箭头函数"></a>箭头函数</h2><p>声明：</p><figure class="highlight zephir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs zephir"><span class="hljs-keyword">let</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> = <span class="hljs-title">function</span><span class="hljs-params">()</span> </span>&#123;<span class="hljs-comment">//以前的声明一个函数</span><br><br>&#125;<br><br><span class="hljs-keyword">let</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> = <span class="hljs-params">(a, b)</span> =&gt; </span>&#123;<span class="hljs-comment">//现在可以省略function，改为 =&gt;</span><br>    <span class="hljs-keyword">return</span> a + b;<br>&#125;<br><span class="hljs-keyword">let</span> result = <span class="hljs-function"><span class="hljs-keyword">fn</span><span class="hljs-params">(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)</span></span><br><span class="hljs-function"><span class="hljs-title">console</span>.<span class="hljs-title">log</span><span class="hljs-params">(result)</span></span>;<br></code></pre></td></tr></table></figure><h4 id="1、this是静态的"><a href="#1、this是静态的" class="headerlink" title="1、this是静态的"></a>1、this是静态的</h4><blockquote><p>this 始终指向函数声明时所在作用域下的this的值</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getName</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>);<br>&#125;<br><span class="hljs-keyword">let</span> <span class="hljs-title function_">getName1</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>);<br>&#125;<br><span class="hljs-comment">// 设置window对象的name属性</span><br><span class="hljs-variable language_">window</span>.<span class="hljs-property">name</span> = <span class="hljs-string">&#x27;妮露&#x27;</span>;<br><span class="hljs-keyword">const</span> wife = &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;胡桃&#x27;</span><br>&#125;<br><span class="hljs-comment">//  直接调用</span><br><span class="hljs-title function_">getName</span>();  <span class="hljs-comment">//  妮露</span><br><span class="hljs-title function_">getName1</span>(); <span class="hljs-comment">//  妮露</span><br><br><span class="hljs-comment">//  call方法</span><br>getName.<span class="hljs-title function_">call</span>(wife);  <span class="hljs-comment">//  胡桃</span><br>getName1.<span class="hljs-title function_">call</span>(wife); <span class="hljs-comment">//  妮露</span><br></code></pre></td></tr></table></figure><h4 id="2、不能作为构造实例化对象"><a href="#2、不能作为构造实例化对象" class="headerlink" title="2、不能作为构造实例化对象"></a>2、不能作为构造实例化对象</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> <span class="hljs-title function_">Person</span> = (<span class="hljs-params">name, age</span>) =&gt; &#123;<span class="hljs-comment">//出现错误，因为Person不是一个构造函数</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;<br>&#125;<br><span class="hljs-keyword">let</span> wife = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&#x27;妮露&#x27;</span>,<span class="hljs-number">20</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(wife);<br></code></pre></td></tr></table></figure><h4 id="3、不能使用-arguments-变量"><a href="#3、不能使用-arguments-变量" class="headerlink" title="3、不能使用 arguments 变量"></a>3、不能使用 arguments 变量</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php">let <span class="hljs-function"><span class="hljs-keyword">fn</span> = (<span class="hljs-params"></span>) =&gt;</span> &#123;<span class="hljs-comment">//错误，不能使用这个变量</span><br>    console.<span class="hljs-title function_ invoke__">log</span>(arguments);<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">fn</span>(<span class="hljs-params"><span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span></span>)</span>;<br></code></pre></td></tr></table></figure><h4 id="4、箭头函数的简写"><a href="#4、箭头函数的简写" class="headerlink" title="4、箭头函数的简写"></a>4、箭头函数的简写</h4><ul><li>省略小括号——当形参有且只有一个的时候</li></ul><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs arcade">let add = <span class="hljs-function"><span class="hljs-params">n</span> =&gt;</span> &#123;<br><span class="hljs-keyword">return</span> n + n;<br>&#125;<br><span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(<span class="hljs-number">9</span>);<span class="hljs-comment">//结果为18</span><br></code></pre></td></tr></table></figure><ul><li>省略花括号——当代码体只有一条语句的时候，此时 <code>return</code>必须省略，而且语句的执行结果就是函数的返回值</li></ul><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs arcade">let <span class="hljs-built_in">pow</span> = <span class="hljs-function"><span class="hljs-params">n</span> =&gt;</span> n * n;<br><span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(<span class="hljs-built_in">pow</span>(<span class="hljs-number">8</span>));<span class="hljs-comment">//结果为64</span><br></code></pre></td></tr></table></figure><h2 id="函数参数默认值"><a href="#函数参数默认值" class="headerlink" title="函数参数默认值"></a>函数参数默认值</h2><ul><li>允许给函数参数赋值初始化</li></ul><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a,b,c=<span class="hljs-number">10</span></span>) &#123;<br><span class="hljs-keyword">return</span> a + b + c;<br>&#125;<br>let result = add(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>);<span class="hljs-comment">//只传前面两个数，c为10。如果传3个数，则c的值就会被传过去的替换掉</span><br>let result1 = add(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>);<br><span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(result);<span class="hljs-comment">//结果为13</span><br><span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(result1);<span class="hljs-comment">//结果为6</span><br></code></pre></td></tr></table></figure><ul><li>与解构赋值结合</li></ul><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">function</span> <span class="hljs-keyword">connect</span>(&#123;<span class="hljs-type">name</span>=<span class="hljs-string">&#x27;胡桃&#x27;</span>,age&#125;)&#123;<br>    console.log(<span class="hljs-type">name</span>);<br>    console.log(age);<br>&#125;<br><span class="hljs-keyword">connect</span>(&#123;<br>    <span class="hljs-type">name</span>: <span class="hljs-string">&#x27;妮露&#x27;</span>,//如果没有<span class="hljs-type">name</span>这个属性，那么输出显示的<span class="hljs-type">name</span>就是初始化的胡桃了，有了就会替换掉原有的<br>    age: <span class="hljs-number">20</span><br>&#125;)<br></code></pre></td></tr></table></figure><h2 id="Spread、rest"><a href="#Spread、rest" class="headerlink" title="Spread、rest"></a>Spread、rest</h2><p>Spread &#x2F; Rest 操作符指的是 …，具体是 Spread 还是 Rest 需要看上下文语境。</p><ul><li>当被用于迭代器中时，它是一个 Spread 操作符</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">x,y,z</span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(x,y,z);<br>&#125;<br> <br><span class="hljs-keyword">let</span> arr = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>];<br><span class="hljs-title function_">foo</span>(...arr); <span class="hljs-comment">// 1 2 3</span><br></code></pre></td></tr></table></figure><ul><li>当被用于函数传参时，是一个 Rest 操作符</li></ul><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs actionscript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span><span class="hljs-params">(<span class="hljs-rest_arg">...args</span>)</span> &#123;<br>  console.log(args);<br>&#125;<br>foo( <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>); <span class="hljs-comment">// [1, 2, 3, 4, 5]，一个素组，那么就可以使用数组中的一些方法 some、filter</span><br></code></pre></td></tr></table></figure><ul><li>rest  参数必须要放到参数最后</li></ul><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs actionscript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span><span class="hljs-params">(a,b,<span class="hljs-rest_arg">...args</span>)</span> &#123;<br>console.log(a);<br>console.log(b);<br>  console.log(args);<br>&#125;<br>foo( <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>);<span class="hljs-comment">// 12[3,4,5]</span><br></code></pre></td></tr></table></figure><h2 id="扩展运算符"><a href="#扩展运算符" class="headerlink" title="扩展运算符"></a>扩展运算符</h2><ul><li>… 扩展运算符能将数组转换成逗号分隔的参数序列</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> wives = [<span class="hljs-string">&#x27;妮露&#x27;</span>,<span class="hljs-string">&#x27;申鹤&#x27;</span>,<span class="hljs-string">&#x27;胡桃&#x27;</span>,<span class="hljs-string">&#x27;宵宫&#x27;</span>];<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">chu</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">arguments</span>);<br>&#125;<br><span class="hljs-title function_">chu</span>(...wives);<br></code></pre></td></tr></table></figure><p><img src="/img/es6/kuozhangyunsuanfu.png" alt="image"></p><h4 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h4><h5 id="1、数组的合并"><a href="#1、数组的合并" class="headerlink" title="1、数组的合并"></a>1、数组的合并</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> wife1 = [<span class="hljs-string">&#x27;妮露&#x27;</span>,<span class="hljs-string">&#x27;申鹤&#x27;</span>];<br><span class="hljs-keyword">const</span> wife2 = [<span class="hljs-string">&#x27;胡桃&#x27;</span>,<span class="hljs-string">&#x27;宵宫&#x27;</span>];<br><span class="hljs-keyword">const</span> wife = [...wife1,...wife2];<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(wife);<br></code></pre></td></tr></table></figure><p><img src="/img/es6/shuzuhebing.png" alt="image"></p><h5 id="2、数组的克隆浅拷贝"><a href="#2、数组的克隆浅拷贝" class="headerlink" title="2、数组的克隆浅拷贝"></a>2、数组的克隆<strong>浅拷贝</strong></h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> wife1 = [<span class="hljs-string">&#x27;妮露&#x27;</span>,<span class="hljs-string">&#x27;申鹤&#x27;</span>];<br><span class="hljs-keyword">const</span> wife = [...wife1];<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(wife);<br></code></pre></td></tr></table></figure><p><img src="/img/es6/kelong.png" alt="image"></p><h5 id="3、将伪数组转为真正的数组"><a href="#3、将伪数组转为真正的数组" class="headerlink" title="3、将伪数组转为真正的数组"></a>3、将伪数组转为真正的数组</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> divs = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;div&#x27;</span>);<br><span class="hljs-keyword">const</span> divArr = [...divs];<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(divArr);    <span class="hljs-comment">//  [div,div,div]</span><br></code></pre></td></tr></table></figure><h2 id="symbol"><a href="#symbol" class="headerlink" title="symbol"></a>symbol</h2><p><img src="/img/es6/symbol.png" alt="image"></p><h4 id="1、创建"><a href="#1、创建" class="headerlink" title="1、创建"></a>1、创建</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> s = <span class="hljs-title class_">Symbol</span>();<br><span class="hljs-keyword">let</span> s1 = <span class="hljs-title class_">Symbol</span>(<span class="hljs-string">&#x27;妮露&#x27;</span>);<br><span class="hljs-keyword">let</span> s2 = <span class="hljs-title class_">Symbol</span>.<span class="hljs-title function_">for</span>(<span class="hljs-string">&#x27;胡桃&#x27;</span>);<br></code></pre></td></tr></table></figure><ul><li>不能与其他数据进行运算</li></ul><h4 id="2、使用"><a href="#2、使用" class="headerlink" title="2、使用"></a>2、使用</h4><ul><li>给<strong>对象</strong>添加<strong>方法和属性</strong></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//  向对象中添加方法 up down</span><br><span class="hljs-keyword">let</span> game = &#123;<br>    <span class="hljs-attr">up</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;上升!&quot;</span>);<br>    &#125;,<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;妮露&#x27;</span>,<br>    <span class="hljs-attr">down</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;下降!&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-comment">//  声明一个对象</span><br><span class="hljs-keyword">let</span> methods = &#123;<br>    <span class="hljs-attr">up</span>: <span class="hljs-title class_">Symbol</span>(),<br>    <span class="hljs-attr">down</span>: <span class="hljs-title class_">Symbol</span>()<br>&#125;<br><span class="hljs-comment">//  添加方式</span><br>game[methods.<span class="hljs-property">up</span>] = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;上升~!&quot;</span>);<br>&#125;<br>game[methods.<span class="hljs-property">down</span>] = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;下降~!&quot;</span>);<br>&#125;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(game);<br></code></pre></td></tr></table></figure><p><img src="/img/es6/shiyong.png" alt="image"></p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs arcade">let game = &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;妮露&#x27;</span>,<br>    [Symbol(<span class="hljs-string">&#x27;up&#x27;</span>)]: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(<span class="hljs-string">&quot;上升~&quot;</span>);<br>    &#125;,<br>    [Symbol(<span class="hljs-string">&#x27;down&#x27;</span>)]: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(<span class="hljs-string">&quot;下降~&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(game);<br></code></pre></td></tr></table></figure><p><img src="/img/es6/shiyong2.png" alt="image"></p><h4 id="3、内置属性"><a href="#3、内置属性" class="headerlink" title="3、内置属性"></a>3、内置属性</h4><h2 id="迭代器iterator"><a href="#迭代器iterator" class="headerlink" title="迭代器iterator"></a>迭代器iterator</h2><p><img src="/img/es6/diedaiqi.png" alt="image-20221107225835384"></p><ul><li>iterator接口——就是对象里面的一个属性</li></ul><h4 id="for-of和for-in区别"><a href="#for-of和for-in区别" class="headerlink" title="for-of和for-in区别"></a>for-of和for-in区别</h4><ul><li>for-of——保存的键值</li><li>for-in——保存的键名</li></ul><h4 id="工作原理"><a href="#工作原理" class="headerlink" title="工作原理"></a>工作原理</h4><p><img src="/img/es6/yuanli.png" alt="image"></p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs autoit"><span class="hljs-keyword">const</span> wife = [<span class="hljs-string">&#x27;妮露&#x27;</span>,<span class="hljs-string">&#x27;胡桃&#x27;</span>,<span class="hljs-string">&#x27;宵宫&#x27;</span>,<span class="hljs-string">&#x27;申鹤&#x27;</span>]<span class="hljs-comment">;</span><br>let iterator = wife[Symbol.iterator]()<span class="hljs-comment">;</span><br>// 调用对象的<span class="hljs-keyword">next</span>方法<br>console.<span class="hljs-built_in">log</span>(iterator.<span class="hljs-keyword">next</span>())<span class="hljs-comment">;</span><br>console.<span class="hljs-built_in">log</span>(iterator.<span class="hljs-keyword">next</span>())<span class="hljs-comment">;</span><br>console.<span class="hljs-built_in">log</span>(iterator.<span class="hljs-keyword">next</span>())<span class="hljs-comment">;</span><br>console.<span class="hljs-built_in">log</span>(iterator.<span class="hljs-keyword">next</span>())<span class="hljs-comment">;</span><br>console.<span class="hljs-built_in">log</span>(iterator.<span class="hljs-keyword">next</span>())<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><p><img src="/img/es6/yuanli2.png" alt="image"></p><h4 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 声明一个对象</span><br><span class="hljs-keyword">const</span> wife = &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;原神&quot;</span>,<br>    <span class="hljs-attr">stus</span>:[<span class="hljs-string">&#x27;妮露&#x27;</span>,<span class="hljs-string">&#x27;胡桃&#x27;</span>,<span class="hljs-string">&#x27;宵宫&#x27;</span>,<span class="hljs-string">&#x27;申鹤&#x27;</span>],<br>    [<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">iterator</span>]()&#123;<br>        <span class="hljs-comment">// 索引变量</span><br>        <span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span>;<br>        <span class="hljs-comment">// this 指向wife，这里作为保存，以防止后面的this发生改变时使用</span><br>        <span class="hljs-keyword">let</span> _this = <span class="hljs-variable language_">this</span>;<br>        <span class="hljs-keyword">return</span> &#123;<br>            <span class="hljs-attr">next</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>                <span class="hljs-comment">// 现在这个this指向的式 return 里面的对象的,所以需要在外声明一个变量作为保存</span><br>                <span class="hljs-comment">// 以确保this指向的是 wife 这个对象</span><br>                <span class="hljs-keyword">if</span>(index &lt;_this.<span class="hljs-property">stus</span>.<span class="hljs-property">length</span>) &#123;<br>                    <span class="hljs-comment">// 返回 属性值  done：false 表示没有完成，需要继续指向  true，完成，表示结束    </span><br>                    <span class="hljs-keyword">const</span> result = &#123;<span class="hljs-attr">value</span>: _this.<span class="hljs-property">stus</span>[index], <span class="hljs-attr">done</span>: <span class="hljs-literal">false</span>&#125;;<br>                    <span class="hljs-comment">// 下标自增</span><br>                    index++;<br>                    <span class="hljs-comment">// 返回结果</span><br>                    <span class="hljs-keyword">return</span> result;<br>                &#125;<span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-keyword">return</span> &#123;<span class="hljs-attr">value</span>: <span class="hljs-literal">undefined</span>, <span class="hljs-attr">done</span>: <span class="hljs-literal">true</span>&#125;;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">// 遍历这个对象</span><br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> v <span class="hljs-keyword">of</span> wife) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(v);<br>&#125;<br><br>结果:<br>妮露<br>胡桃<br>宵宫<br>申鹤<br></code></pre></td></tr></table></figure><h2 id="生成器Generator"><a href="#生成器Generator" class="headerlink" title="生成器Generator"></a>生成器Generator</h2><p>传统的编程语言，早有异步编程的解决方案（其实是多任务的解决方案）。其中有一种叫做”协程”（coroutine），意思是多个线程互相协作，完成异步任务。</p><p>协程有点像函数，又有点像线程。它的运行流程大致如下。</p><ul><li>第一步，协程<code>A</code>开始执行。</li><li>第二步，协程<code>A</code>执行到一半，进入暂停，执行权转移到协程<code>B</code>。</li><li>第三步，（一段时间后）协程<code>B</code>交还执行权。</li><li>第四步，协程<code>A</code>恢复执行。</li></ul><p>上面流程的协程<code>A</code>，就是异步任务，因为它分成两段（或多段）执行。</p><blockquote><p>Generator 函数是协程在 ES6 的实现，最大特点就是可以交出函数的执行权（即暂停执行）</p></blockquote><p>整个 Generator 函数就是一个封装的异步任务，或者说是异步任务的容器。异步操作需要暂停的地方，都用<code>yield</code>语句注明。Generator 函数的执行方法如下。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 关键字yield可以让生成器停止和开始</span><br><span class="hljs-keyword">function</span>* <span class="hljs-title function_">gen</span>(<span class="hljs-params"></span>) &#123;<span class="hljs-comment">//* 固定存在</span><br><span class="hljs-comment">//   console.log(111);</span><br>  <span class="hljs-keyword">yield</span> <span class="hljs-string">&#x27;qeer&#x27;</span>; <span class="hljs-comment">//yield  函数代码的分隔符</span><br><span class="hljs-comment">//   console.log(222);</span><br>  <span class="hljs-keyword">yield</span> <span class="hljs-string">&#x27;asdf&#x27;</span>;<br><span class="hljs-comment">//   console.log(333);</span><br>  <span class="hljs-keyword">yield</span> <span class="hljs-string">&#x27;zxcv&#x27;</span>;<br><span class="hljs-comment">//   console.log(444);</span><br>&#125;<br><span class="hljs-keyword">let</span> iterator = <span class="hljs-title function_">gen</span>();<br>iterator.<span class="hljs-title function_">next</span>();    <span class="hljs-comment">//  必须使用next调用才能运行</span><br>iterator.<span class="hljs-title function_">next</span>(); <br>iterator.<span class="hljs-title function_">next</span>(); <br>iterator.<span class="hljs-title function_">next</span>(); <br><span class="hljs-comment">// 遍历</span><br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> v <span class="hljs-keyword">of</span> <span class="hljs-title function_">gen</span>()) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(v);<br>&#125;<br><span class="hljs-comment">// 返回的结果为</span><br><span class="hljs-comment">// qeer</span><br><span class="hljs-comment">// asdf</span><br><span class="hljs-comment">// zxcv</span><br></code></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> * <span class="hljs-title function_">gen</span>(<span class="hljs-params">x</span>) &#123;<br>  <span class="hljs-keyword">var</span> y = <span class="hljs-keyword">yield</span> x + <span class="hljs-number">2</span>;<br>  <span class="hljs-keyword">return</span> y;<br>&#125;;<br><br><span class="hljs-keyword">var</span> g = <span class="hljs-title function_">gen</span>(<span class="hljs-number">1</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(g.<span class="hljs-title function_">next</span>()); <span class="hljs-comment">// &#123; value: 3, done: false &#125;</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(g.<span class="hljs-title function_">next</span>()); <span class="hljs-comment">// &#123; value: undefined, done: true &#125;</span><br></code></pre></td></tr></table></figure><p>上面代码中，调用 Generator 函数，会返回一个内部指针（即遍历器）<code>g</code>。这是 Generator 函数不同于普通函数的另一个地方，即执行它不会返回结果，返回的是指针对象。调用指针<code>g</code>的<code>next</code>方法，会移动内部指针（即执行异步任务的第一段），指向第一个遇到的<code>yield</code>语句，上例是执行到<code>x + 2</code>为止。</p><p>换言之，<code>next</code>方法的作用是分阶段执行<code>Generator</code>函数。每次调用<code>next</code>方法，会返回一个对象，表示当前阶段的信息（<code>value</code>属性和<code>done</code>属性）。<code>value</code>属性是<code>yield</code>语句后面表达式的值，表示当前阶段的值；<code>done</code>属性是一个布尔值，表示 Generator 函数是否执行完毕，即是否还有下一个阶段。</p><h4 id="实例1"><a href="#实例1" class="headerlink" title="实例1"></a>实例1</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span> 异步编程 文件操作 网络操作(ajax,request) 数据库操作<br><span class="hljs-regexp">//</span> <span class="hljs-number">1</span>s后控制台输出<span class="hljs-number">111</span> <span class="hljs-number">2</span>s后输出<span class="hljs-number">222</span> <span class="hljs-number">3</span>秒后输出<span class="hljs-number">333</span>   总共<span class="hljs-number">6</span>秒<br><span class="hljs-regexp">//</span> 回调地狱 一直回调,一层套一层,不断往前缩进<br><span class="hljs-regexp">//</span> setTimeout(() =&gt; &#123;<br><span class="hljs-regexp">//</span>     console.log(<span class="hljs-number">111</span>);<br><span class="hljs-regexp">//</span>     setTimeout(() =&gt; &#123;<br><span class="hljs-regexp">//</span>         console.log(<span class="hljs-number">222</span>);<br><span class="hljs-regexp">//</span>         setTimeout(() =&gt; &#123;<br><span class="hljs-regexp">//</span>             console.log(<span class="hljs-number">333</span>);<br><span class="hljs-regexp">//</span>         &#125;,<span class="hljs-number">3000</span>)<br><span class="hljs-regexp">//</span>     &#125;, <span class="hljs-number">2000</span>)<br><span class="hljs-regexp">//</span> &#125;, <span class="hljs-number">1000</span>)<br><br>        <span class="hljs-regexp">//</span> 解决方法<br>        <span class="hljs-keyword">function</span> one() &#123;<br>            setTimeout(() =&gt; &#123;<br>                console.log(<span class="hljs-number">111</span>);<br>                iterator.<span class="hljs-keyword">next</span>();<br>            &#125;, <span class="hljs-number">1000</span>)<br>        &#125;<br>        <span class="hljs-keyword">function</span> two() &#123;<br>            setTimeout(() =&gt; &#123;<br>                console.log(<span class="hljs-number">222</span>);<br>                iterator.<span class="hljs-keyword">next</span>();<br>            &#125;, <span class="hljs-number">2000</span>)<br>        &#125;<br>        <span class="hljs-keyword">function</span> three() &#123;<br>            setTimeout(() =&gt; &#123;<br>                console.log(<span class="hljs-number">333</span>);<br>                iterator.<span class="hljs-keyword">next</span>();<br>            &#125;, <span class="hljs-number">3000</span>)<br>        &#125;<br>        <span class="hljs-regexp">//</span> 生成器<br>        <span class="hljs-keyword">function</span>* gen()&#123;<br>            yield one();<br>            yield two();<br>            yield three();<br>        &#125;<br>        <span class="hljs-regexp">//</span> 调用生成器函数<br>        let iterator = gen();<br>        <span class="hljs-regexp">//</span> 这样只会执行第一个,但后面的不能执行,因为有 yiled 它会停止生成器的运行<br>        <span class="hljs-regexp">//</span> 所以需要在每个方法里面添加 iterator.<span class="hljs-keyword">next</span>(); 以确保生成器运行<br>        iterator.<span class="hljs-keyword">next</span>();<br></code></pre></td></tr></table></figure><h4 id="实例2"><a href="#实例2" class="headerlink" title="实例2"></a>实例2</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 模拟获取 用户数据 订单数据 商品数据 </span><br>        <span class="hljs-keyword">function</span> <span class="hljs-title function_">getUsers</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>                <span class="hljs-keyword">let</span> data = <span class="hljs-string">&#x27;用户数据&#x27;</span>;<br>                iterator.<span class="hljs-title function_">next</span>(data);<br>            &#125;, <span class="hljs-number">1000</span>)<br>        &#125;<br>        <span class="hljs-keyword">function</span> <span class="hljs-title function_">getOrders</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>                <span class="hljs-keyword">let</span> data = <span class="hljs-string">&#x27;订单数据&#x27;</span>;<br>                iterator.<span class="hljs-title function_">next</span>(data);<br>            &#125;, <span class="hljs-number">1000</span>)<br>        &#125;<br>        <span class="hljs-keyword">function</span> <span class="hljs-title function_">getGoods</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>                <span class="hljs-keyword">let</span> data = <span class="hljs-string">&#x27;商品数据&#x27;</span>;<br>                iterator.<span class="hljs-title function_">next</span>(data);<br>            &#125;, <span class="hljs-number">1000</span>)<br>        &#125;<br>        <span class="hljs-comment">// 生成器</span><br>        <span class="hljs-keyword">function</span>* <span class="hljs-title function_">gen</span>(<span class="hljs-params"></span>)&#123;<br>            <span class="hljs-keyword">let</span> users = <span class="hljs-keyword">yield</span> <span class="hljs-title function_">getUsers</span>();<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(users);<br>            <span class="hljs-keyword">let</span> orders = <span class="hljs-keyword">yield</span> <span class="hljs-title function_">getOrders</span>();<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(orders);<br>            <span class="hljs-keyword">let</span> goods = <span class="hljs-keyword">yield</span> <span class="hljs-title function_">getGoods</span>();<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(goods);<br>        &#125;<br>        <span class="hljs-comment">// 调用生成器函数</span><br>        <span class="hljs-keyword">let</span> iterator = <span class="hljs-title function_">gen</span>();<br>        iterator.<span class="hljs-title function_">next</span>();<br></code></pre></td></tr></table></figure><ul><li>和同步很像,但实际上是异步的</li></ul><h2 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h2><ul><li>Promise是ES6引入的<strong>异步编程的新解决方案</strong></li><li><code>Promise</code>对象代表一个异步操作，有三种状态：<code>pending</code>（进行中）、<code>fulfilled</code>（已成功）和<code>rejected</code>（已失败）</li></ul><blockquote><p>语法上，Promise是一个<strong>构造函数</strong>，用来封装异步操作并可以获取其成功或失败的结果</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Promise</span> 构造函数:<span class="hljs-title class_">Promise</span>(excutor) &#123;&#125;<br><span class="hljs-title class_">Promise</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">then</span> 方法<br><span class="hljs-title class_">Promise</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">catch</span> 方法<br></code></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 实例化 Promise 对象</span><br><span class="hljs-keyword">const</span> p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">resolve,reject</span>) &#123;<br>    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-comment">// let data = &#x27;数据库中的用户数据&#x27;;</span><br>        <span class="hljs-comment">// resolve(data);</span><br><br>        <span class="hljs-keyword">let</span> err = <span class="hljs-string">&#x27;读取数据失败&#x27;</span>;<br>        <span class="hljs-title function_">reject</span>(err);<br>    &#125;,<span class="hljs-number">1000</span>)<br>&#125;);<br><span class="hljs-comment">// 调用 Promise 对象的 thne 方法</span><br>p.<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>)&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value);<br>&#125;,<span class="hljs-keyword">function</span>(<span class="hljs-params">reason</span>)&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(reason);<br>&#125;) <br></code></pre></td></tr></table></figure><ul><li>resolve——将<code>Promise</code>对象的状态从“未完成”变为“成功”（即从 pending 变为 resolved），在异步操作<strong>成功</strong>时调用，并将异步操作的结果，作为参数传递出去</li><li>reject——将<code>Promise</code>对象的状态从“未完成”变为“失败”（即从 pending 变为 rejected），在异步操作<strong>失败</strong>时调用，并将异步操作报出的错误，作为参数传递出去。</li><li><code>Promise</code>实例生成以后，可以用<code>then</code>方法分别指定<code>resolved</code>状态和<code>rejected</code>状态的回调函数。<code>then</code>方法可以接受<strong>两个回调函数</strong>作为参数</li><li>第一个回调函数是<code>Promise</code>对象的状态变为<code>resolved</code>时调用。默认写<code>value</code></li><li>二个回调函数是<code>Promise</code>对象的状态变为<code>rejected</code>时调用。默认写<code>reason</code></li></ul><h3 id="读取文件1"><a href="#读取文件1" class="headerlink" title="读取文件1"></a>读取文件1</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 1.引入 fs 模块node.js</span><br><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>);<br><br><span class="hljs-comment">// 2.调用方法读取文件</span><br>fs.<span class="hljs-title function_">readFile</span>(<span class="hljs-string">&#x27;为学.md&#x27;</span>,<span class="hljs-function">(<span class="hljs-params">err, data</span>) =&gt;</span>&#123;<br>    <span class="hljs-comment">// 如果失败,则抛出错误</span><br>    <span class="hljs-keyword">if</span>(err) <span class="hljs-keyword">throw</span> err;<br>    <span class="hljs-comment">// 如果没有出错,则输出内容</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data.<span class="hljs-title function_">toString</span>());<br>&#125;);<br></code></pre></td></tr></table></figure><h3 id="Promise封装获取文件2"><a href="#Promise封装获取文件2" class="headerlink" title="Promise封装获取文件2"></a>Promise封装获取文件2</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 1.引入 fs 模块</span><br><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>);<br><br><span class="hljs-comment">// 3.使用 Promise 封装</span><br><span class="hljs-keyword">const</span> p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">resolve,reject</span>)&#123;<br>    fs.<span class="hljs-title function_">readFile</span>(<span class="hljs-string">&#x27;为学.md&#x27;</span>,<span class="hljs-function">(<span class="hljs-params">err, data</span>) =&gt;</span>&#123;<br>        <span class="hljs-comment">// 判断如果失败,则改变 Promise 的状态为失败,失败的值为这个错误对象</span><br>        <span class="hljs-keyword">if</span>(err) <span class="hljs-title function_">reject</span>(err);<br>        <span class="hljs-comment">// 如果成功</span><br>        <span class="hljs-title function_">resolve</span>(data);<br>    &#125;)<br>&#125;);<br>p.<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>)&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value.<span class="hljs-title function_">toString</span>());<br>&#125;, <span class="hljs-keyword">function</span>(<span class="hljs-params">reason</span>)&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;读取失败&quot;</span>);<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="ajax请求"><a href="#ajax请求" class="headerlink" title="ajax请求"></a>ajax请求</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 1.创建对象</span><br><span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();<br><br><span class="hljs-comment">// 2.初始化</span><br>xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">&quot;GET&quot;</span>,<span class="hljs-string">&quot;http://api.apiopen.top/getJoke&quot;</span>);<br>        <br><span class="hljs-comment">// 3.发送</span><br>xhr.<span class="hljs-title function_">send</span>();<br><br><span class="hljs-comment">// 4.绑定事件,处理响应结果</span><br>xhr.<span class="hljs-property">onreadystatechange</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br><span class="hljs-comment">// 判断</span><br>    <span class="hljs-keyword">if</span>(xhr.<span class="hljs-property">readyState</span> == <span class="hljs-number">4</span>)&#123;<br>    <span class="hljs-comment">// 判断响应状态码 200-299</span><br>        <span class="hljs-keyword">if</span>(xhr.<span class="hljs-property">status</span> &gt;= <span class="hljs-number">200</span> &amp;&amp; xhr.<span class="hljs-property">status</span> &lt; <span class="hljs-number">300</span>) &#123;<br>        <span class="hljs-comment">// 表示成功</span><br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(xhr.<span class="hljs-property">response</span>);<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-comment">// 如果失败</span><br>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(xhr.<span class="hljs-property">status</span>);<br>            &#125;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="Promise封装ajax请求"><a href="#Promise封装ajax请求" class="headerlink" title="Promise封装ajax请求"></a>Promise封装ajax请求</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>    <span class="hljs-comment">// 1.创建对象</span><br>    <span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();<br><br>    <span class="hljs-comment">// 2.初始化</span><br>    xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">&quot;GET&quot;</span>, <span class="hljs-string">&quot;https://api.apiopen.top/getJoke&quot;</span>);<br><br>    <span class="hljs-comment">// 3.发送</span><br>    xhr.<span class="hljs-title function_">send</span>();<br><br>    <span class="hljs-comment">// 4.绑定事件,处理响应结果</span><br>    xhr.<span class="hljs-property">onreadystatechange</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-comment">// 判断</span><br>        <span class="hljs-keyword">if</span> (xhr.<span class="hljs-property">readyState</span> == <span class="hljs-number">4</span>) &#123;<br>            <span class="hljs-comment">// 判断响应状态码 200-299</span><br>            <span class="hljs-keyword">if</span> (xhr.<span class="hljs-property">status</span> &gt;= <span class="hljs-number">200</span> &amp;&amp; xhr.<span class="hljs-property">status</span> &lt; <span class="hljs-number">300</span>) &#123;<br>                <span class="hljs-comment">// 表示成功</span><br>                <span class="hljs-title function_">resolve</span>(xhr.<span class="hljs-property">response</span>);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-comment">// 如果失败</span><br>                <span class="hljs-title function_">reject</span>(xhr.<span class="hljs-property">status</span>);<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;)<br><span class="hljs-comment">// 指定回调</span><br>p.<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>)&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value);<br>&#125;, <span class="hljs-keyword">function</span>(<span class="hljs-params">reason</span>)&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(reason);<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="Promise-prototype-then"><a href="#Promise-prototype-then" class="headerlink" title="Promise.prototype.then()"></a>Promise.prototype.then()</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 创建 Promise 对象</span><br><span class="hljs-keyword">const</span> p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve,reject</span>) =&gt;</span> &#123;<br>    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-title function_">resolve</span>(<span class="hljs-string">&#x27;用户数据&#x27;</span>);<br>        <span class="hljs-comment">// reject(&#x27;错误!&#x27;);</span><br>    &#125;, <span class="hljs-number">1000</span>);<br>&#125;);<br><span class="hljs-comment">// 调用 then 方法   then返回结果是 Promise对象,对象状态由回调函数的执行结果决定</span><br><span class="hljs-comment">// 省略function,直接箭头函数</span><br><span class="hljs-keyword">const</span> result = p.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value);<br>    <span class="hljs-comment">// 1.返回的是 非Promise 类型,状态为成功,放回值为对象的成功的值</span><br>    <span class="hljs-comment">// return &#x27;成功~&#x27;</span><br>    <span class="hljs-comment">// 2.返回的是 Promise 对象</span><br>    <span class="hljs-comment">// return new Promise((resolve, reject) =&gt; &#123;</span><br>    <span class="hljs-comment">//     // resolve(&#x27;ok&#x27;);</span><br>    <span class="hljs-comment">//     reject(&#x27;error&#x27;);</span><br>    <span class="hljs-comment">// &#125;)</span><br>    <span class="hljs-comment">// 3.抛出错误</span><br>    <span class="hljs-keyword">throw</span> <span class="hljs-string">&#x27;错误~&#x27;</span>;<br>&#125;, <span class="hljs-function"><span class="hljs-params">reason</span> =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(reason);<br>&#125;)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result);<br></code></pre></td></tr></table></figure><ul><li>返回的是 非Promise 类型，fulfilled就是成功</li></ul><p><img src="/img/es6/promise1.png" alt="image"></p><ul><li>返回的是 Promise 对象，对象的状态为成功</li></ul><p><img src="/img/es6/promise2.png" alt="image"></p><ul><li>返回的是 Promise 对象，对象的状态为失败</li></ul><p><img src="/img/es6/promise3.png" alt="image"></p><ul><li>抛出错误</li></ul><p><img src="/img/es6/promise4.png" alt="image"></p><h3 id="链式调用"><a href="#链式调用" class="headerlink" title="链式调用"></a>链式调用</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js">p.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span>&#123;<br><br>&#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> &#123;<br><br>&#125;);<br></code></pre></td></tr></table></figure><ul><li>解决回调地狱问题</li><li>错误reason可以不写</li></ul><h3 id="读取多个文件"><a href="#读取多个文件" class="headerlink" title="读取多个文件"></a>读取多个文件</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;fs&quot;</span>);<br><br><span class="hljs-comment">// 但这个文件一多,就会下陷,产生回调地狱,而且函数形参重名,不易发现,这个是回调地狱的问题</span><br>fs.<span class="hljs-title function_">readFile</span>(<span class="hljs-string">&#x27;为学.md&#x27;</span>,<span class="hljs-function">(<span class="hljs-params">err, data1</span>) =&gt;</span>&#123;<br>    fs.<span class="hljs-title function_">readFile</span>(<span class="hljs-string">&#x27;李白.md&#x27;</span>,<span class="hljs-function">(<span class="hljs-params">err, data2</span>) =&gt;</span>&#123;<br>        fs.<span class="hljs-title function_">readFile</span>(<span class="hljs-string">&#x27;杜甫.md&#x27;</span>,<span class="hljs-function">(<span class="hljs-params">err, data3</span>) =&gt;</span>&#123;<br>            <span class="hljs-comment">// 因为做了运算(+) 就会自动转换字符串</span><br>            <span class="hljs-keyword">let</span> result = data1 + <span class="hljs-string">&#x27;\r\n&#x27;</span> + data2 + <span class="hljs-string">&#x27;\r\n&#x27;</span> + data3;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(result);<br>        &#125;);<br>    &#125;);<br>&#125;);<br></code></pre></td></tr></table></figure><h3 id="Promise多个文件"><a href="#Promise多个文件" class="headerlink" title="Promise多个文件"></a>Promise多个文件</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;fs&quot;</span>);<br><br><span class="hljs-comment">// 使用 Promise 实现</span><br><span class="hljs-keyword">const</span> p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">reslove, reject</span>) =&gt;</span> &#123;<br>    fs.<span class="hljs-title function_">readFile</span>(<span class="hljs-string">&#x27;为学.md&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">err, data</span>) =&gt;</span> &#123;<br>        <span class="hljs-title function_">reslove</span>(data);<br>    &#125;);<br>&#125;);<br><br><br>p.<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">reslove, reject</span>) =&gt;</span> &#123;<br>        fs.<span class="hljs-title function_">readFile</span>(<span class="hljs-string">&#x27;李白.md&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">err, data</span>) =&gt;</span> &#123;<br>            <span class="hljs-title function_">reslove</span>([value, data]);<br>        &#125;);<br>    &#125;)<br>&#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">reslove, reject</span>) =&gt;</span> &#123;<br>        fs.<span class="hljs-title function_">readFile</span>(<span class="hljs-string">&#x27;杜甫.md&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">err, data</span>) =&gt;</span> &#123;<br>            <span class="hljs-comment">// 压入</span><br>            value.<span class="hljs-title function_">push</span>(data);<br>            <span class="hljs-title function_">reslove</span>(value);<br>        &#125;);<br>    &#125;)<br>&#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value.<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;\r\n&#x27;</span>));<br>&#125;);<br></code></pre></td></tr></table></figure><h3 id="catch方法"><a href="#catch方法" class="headerlink" title="catch方法"></a>catch方法</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> p = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-comment">// 设置 p 对象的状态为失败,并设置失败的值</span><br>        <span class="hljs-title function_">reject</span>(<span class="hljs-string">&quot;错误~&quot;</span>);<br>    &#125;, <span class="hljs-number">1000</span>);<br>&#125;)<br>p.<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">value</span>)&#123;&#125;, <span class="hljs-keyword">function</span>(<span class="hljs-params">reason</span>)&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(reason);<br>&#125;)<br>p.<span class="hljs-title function_">catch</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">reason</span>)&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(reason);<br>&#125;);<br></code></pre></td></tr></table></figure><p><img src="/img/es6/cuowu.png" alt="image"></p><h2 id="集合Set"><a href="#集合Set" class="headerlink" title="集合Set"></a>集合Set</h2><p><img src="/img/es6/set.png" alt="image"></p><ul><li><code>Set</code>本身是一个构造函数，用来生成 Set 数据结构</li><li>Set  执行完返回一个对象</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 声明一个 set</span><br><span class="hljs-keyword">let</span> s = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>();<br><span class="hljs-comment">// 可迭代数据   一般传入数组    自动去重</span><br><span class="hljs-keyword">let</span> s2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([<span class="hljs-string">&#x27;妮露&#x27;</span>,<span class="hljs-string">&#x27;胡桃&#x27;</span>,<span class="hljs-string">&#x27;申鹤&#x27;</span>,<span class="hljs-string">&#x27;宵宫&#x27;</span>,<span class="hljs-string">&#x27;胡桃&#x27;</span>]);<br><br><span class="hljs-comment">//  元素个数</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(s2.<span class="hljs-property">size</span>);   <span class="hljs-comment">//  4</span><br><span class="hljs-comment">// 添加新的元素</span><br>s2.<span class="hljs-title function_">add</span>(<span class="hljs-string">&#x27;莫娜&#x27;</span>);     <span class="hljs-comment">// &#123;&#x27;妮露&#x27;, &#x27;胡桃&#x27;, &#x27;申鹤&#x27;, &#x27;宵宫&#x27;, &#x27;莫娜&#x27;&#125;</span><br><span class="hljs-comment">// 删除元素</span><br>s2.<span class="hljs-title function_">delete</span>(<span class="hljs-string">&#x27;莫娜&#x27;</span>);  <span class="hljs-comment">//  &#123;&#x27;妮露&#x27;, &#x27;胡桃&#x27;, &#x27;申鹤&#x27;, &#x27;宵宫&#x27;&#125;</span><br><span class="hljs-comment">// 检测</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(s2.<span class="hljs-title function_">has</span>(<span class="hljs-string">&#x27;妮露&#x27;</span>));    <span class="hljs-comment">//  true</span><br><span class="hljs-comment">// 清空</span><br>s2.<span class="hljs-title function_">clear</span>();     <span class="hljs-comment">//  Set(0)</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(s2);    <span class="hljs-comment">// &#123;&#x27;妮露&#x27;, &#x27;胡桃&#x27;, &#x27;申鹤&#x27;, &#x27;宵宫&#x27;&#125;</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(s, <span class="hljs-keyword">typeof</span> s);   <span class="hljs-comment">//  object</span><br></code></pre></td></tr></table></figure><h2 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h2><p><img src="/img/es6/map.png" alt="image"></p><ul><li>它类似于对象，也是键值对的集合，但是“键”的范围不限于字符串，各种类型的值（包括对象）都可以当作键</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 声明 Map</span><br><span class="hljs-keyword">let</span> m = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();<br><br><span class="hljs-comment">// 添加元素</span><br>m.<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;name&#x27;</span>,<span class="hljs-string">&#x27;妮露&#x27;</span>);<br>m.<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;change&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;改变~&quot;</span>);<br>&#125;);<br><span class="hljs-keyword">let</span> key = &#123;<br>    school : <span class="hljs-string">&#x27;提瓦特&#x27;</span><br>&#125;;<br>m.<span class="hljs-title function_">set</span>(key,[<span class="hljs-string">&#x27;蒙德&#x27;</span>,<span class="hljs-string">&#x27;璃月&#x27;</span>,<span class="hljs-string">&#x27;稻妻&#x27;</span>]);<br><br><span class="hljs-comment">// size</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(m.<span class="hljs-property">size</span>);    <span class="hljs-comment">//  3</span><br><span class="hljs-comment">// 删除</span><br><span class="hljs-comment">// m.delete(&#x27;name&#x27;);</span><br><span class="hljs-comment">// 获取</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(m.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;change&#x27;</span>));   <span class="hljs-comment">//  f() &#123; console.log(&quot;改变~&quot;); &#125;</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(m.<span class="hljs-title function_">get</span>(key));    <span class="hljs-comment">//  [&#x27;蒙德&#x27;, &#x27;璃月&#x27;, &#x27;稻妻&#x27;]</span><br><span class="hljs-comment">// 清空</span><br><span class="hljs-comment">// m.clear();</span><br><span class="hljs-comment">// 遍历</span><br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> v <span class="hljs-keyword">of</span> m) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(v);     <span class="hljs-comment">//  键值对</span><br>&#125;<br><span class="hljs-comment">// console.log(m);</span><br></code></pre></td></tr></table></figure><p><img src="/img/es6/map2.png" alt="image"></p><h2 id="数值扩展"><a href="#数值扩展" class="headerlink" title="数值扩展"></a>数值扩展</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 0、Number.EPSILON 是 JavaScript 表示的最小精度</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">equal</span>(<span class="hljs-params">a, b</span>) &#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(a - b) &lt; <span class="hljs-title class_">Number</span>.<span class="hljs-property">EPSILON</span>)&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">0.1</span> + <span class="hljs-number">0.2</span> === <span class="hljs-number">0.3</span>); <span class="hljs-comment">//false</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">equal</span>(<span class="hljs-number">0.1</span> + <span class="hljs-number">0.2</span>, <span class="hljs-number">0.3</span>)); <span class="hljs-comment">//true</span><br><br><span class="hljs-comment">// 1、二进制和八进制</span><br><span class="hljs-keyword">let</span> a = <span class="hljs-number">0b1010</span>; <span class="hljs-comment">//  二进制  0b前缀</span><br><span class="hljs-keyword">let</span> b = <span class="hljs-number">0o222</span>;  <span class="hljs-comment">//  八进制  0o前缀</span><br><span class="hljs-comment">// 如果要将0b和0o前缀的字符串数值转为十进制，要使用Number方法</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a); <span class="hljs-comment">//  10</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(b); <span class="hljs-comment">//  146</span><br><br><span class="hljs-comment">// 2、Number.isFinite   检测一个数值是否为有限数</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Number</span>.<span class="hljs-built_in">isFinite</span>(<span class="hljs-number">100</span>));  <span class="hljs-comment">//  true</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Number</span>.<span class="hljs-built_in">isFinite</span>(<span class="hljs-number">100</span>/<span class="hljs-number">0</span>));    <span class="hljs-comment">//  false</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Number</span>.<span class="hljs-built_in">isFinite</span>(<span class="hljs-title class_">Infinity</span>)); <span class="hljs-comment">//  false</span><br><br><span class="hljs-comment">// 3、Number.isNaN  检测一个数值是否为NaN</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Number</span>.<span class="hljs-built_in">isNaN</span>(<span class="hljs-number">123</span>));  <span class="hljs-comment">//  false</span><br><br><span class="hljs-comment">// 4、Number.parseInt  Number.parseFloat  字符串转整数</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Number</span>.<span class="hljs-built_in">parseInt</span>(<span class="hljs-string">&#x27;1223da&#x27;</span>)); <span class="hljs-comment">//  1223</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Number</span>.<span class="hljs-built_in">parseFloat</span>(<span class="hljs-string">&#x27;3.214深&#x27;</span>));   <span class="hljs-comment">//  3.214</span><br><br><span class="hljs-comment">// 5、Number.isInteger  检测一个数值是否为整数</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Number</span>.<span class="hljs-title function_">isInteger</span>(<span class="hljs-number">4</span>)); <span class="hljs-comment">//  true</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Number</span>.<span class="hljs-title function_">isInteger</span>(<span class="hljs-number">2.3</span>));   <span class="hljs-comment">//  false</span><br><br><span class="hljs-comment">// 6、Math.trunc 将数字的小数部分抹去</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">trunc</span>(<span class="hljs-number">2.1</span>));   <span class="hljs-comment">//  2</span><br><br><span class="hljs-comment">// 7、Math.sign 判断一个是是正数    负数    还是零</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sign</span>(<span class="hljs-number">19</span>)); <span class="hljs-comment">//  1</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sign</span>(<span class="hljs-number">0</span>));  <span class="hljs-comment">//  0</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sign</span>(-<span class="hljs-number">21</span>));    <span class="hljs-comment">//  -1</span><br></code></pre></td></tr></table></figure><h2 id="对象方法扩展"><a href="#对象方法扩展" class="headerlink" title="对象方法扩展"></a>对象方法扩展</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 1、Object.is 判断两个值是否完全相等</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">is</span>(<span class="hljs-number">120</span>,<span class="hljs-number">120</span>));    <span class="hljs-comment">//  true </span><br><span class="hljs-comment">// 相当于全等号 ===     不过有区别</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">NaN</span> === <span class="hljs-title class_">NaN</span>);   <span class="hljs-comment">//  false</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">is</span>(<span class="hljs-title class_">NaN</span>,<span class="hljs-title class_">NaN</span>));    <span class="hljs-comment">//  true </span><br><br><span class="hljs-comment">// 2、Object.assign 对象的合并</span><br><span class="hljs-keyword">const</span> wife1 = &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;妮露&#x27;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">20</span>,<br>    <span class="hljs-attr">test</span>: <span class="hljs-string">&#x27;test&#x27;</span><br>&#125;<br><span class="hljs-keyword">const</span> wife2 = &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;胡桃&#x27;</span><br>&#125;<br><span class="hljs-comment">//  后面的会覆盖前面的，也就说wife2会覆盖wife1相同属性的</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(wife1,wife2));    <br><span class="hljs-comment">//&#123;name: &#x27;胡桃&#x27;, age: 20, test: &#x27;test&#x27;&#125;</span><br><br><span class="hljs-comment">// 3、Object.setPrototypeOf 设置原型对象    Object.getPrototypeOf</span><br><span class="hljs-comment">// 不建议这样做</span><br><span class="hljs-keyword">const</span> wife = &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;妮露&#x27;</span><br>&#125;<br><span class="hljs-keyword">const</span> ele = &#123;<br>    <span class="hljs-attr">yuanshu</span>: [<span class="hljs-string">&#x27;火&#x27;</span>,<span class="hljs-string">&#x27;水&#x27;</span>,<span class="hljs-string">&#x27;雷&#x27;</span>]<br>&#125;<br><span class="hljs-title class_">Object</span>.<span class="hljs-title function_">setPrototypeOf</span>(wife,ele);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getPrototypeOf</span>(wife));<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ele);<br></code></pre></td></tr></table></figure><h2 id="模块化"><a href="#模块化" class="headerlink" title="模块化"></a>模块化</h2><p>模块化是指将一个大的程序文件，拆分成许多小的文件，然后将小文件组合起来 </p><p>优势:</p><ul><li>防止命名冲突</li><li>代码复用</li><li>高维护性</li></ul><p>模块功能主要由两个命令构成：<code>export</code>和<code>import</code></p><ul><li>export——用于规定模块的对外接口</li><li>import——用于输入其他模块提供的功能</li></ul><h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a><strong>使用</strong></h3><p><strong>m1.js&#x2F;&#x2F;文件名</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">let</span> wife = <span class="hljs-string">&#x27;妮露&#x27;</span>;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">dance</span>(<span class="hljs-params"></span>) &#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;花神之舞~~~&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>index.htm&#x2F;&#x2F;文件名</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;module&quot;</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 引入 m1.js 模块内容</span></span><br><span class="language-javascript">        <span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> m1 <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./src/js/m1.js&quot;</span>;<span class="hljs-comment">//这里要注意路径</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(m1);</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/img/es6/mokuaihua.png" alt="image"></p><h3 id="暴露数据语法"><a href="#暴露数据语法" class="headerlink" title="暴露数据语法"></a>暴露数据语法</h3><p><strong>统一暴露</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> wife = <span class="hljs-string">&#x27;妮露&#x27;</span>;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">dance</span>(<span class="hljs-params"></span>) &#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;花神之舞~~~&quot;</span>);<br>&#125;<br><span class="hljs-keyword">export</span> &#123;wife,dance&#125;;<br></code></pre></td></tr></table></figure><p><strong>默认暴露</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>wife : <span class="hljs-string">&#x27;妮露&#x27;</span>,<br><span class="hljs-attr">dance</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;花神之舞~~~&quot;</span>);<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="引入"><a href="#引入" class="headerlink" title="引入"></a>引入</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 1、通用</span><br><span class="hljs-comment">// 引入 m1.js 模块内容</span><br><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> m1 <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./src/js/m1.js&quot;</span>;<br><br><span class="hljs-comment">// 2、解构赋值形式</span><br><span class="hljs-keyword">import</span> &#123;name, dance&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./src/js/m1.js&quot;</span>;<br><span class="hljs-comment">// 名字重复，可以设置别名</span><br><span class="hljs-keyword">import</span> &#123;name <span class="hljs-keyword">as</span> nilu, dance <span class="hljs-keyword">as</span> tiaowu&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./src/js/m2.js&quot;</span>;<br><span class="hljs-comment">// 针对默认暴露 必须设置别名</span><br><span class="hljs-keyword">import</span> &#123;<span class="hljs-keyword">default</span> <span class="hljs-keyword">as</span> m3&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./src/js/m3.js&quot;</span>;<br><br><span class="hljs-comment">// 3、简便形式  只能针对默认暴露</span><br><span class="hljs-keyword">import</span> m3 <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../src/js/m3.js&quot;</span>;<br></code></pre></td></tr></table></figure><h3 id="入口文件"><a href="#入口文件" class="headerlink" title="入口文件"></a>入口文件</h3><p>当引入过多时，我们可以单独写一个js文件作为模块引入的入口文件，这样我们只需要引入一个js文件即可</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;script src=<span class="hljs-string">&quot;./src/js/app.js&quot;</span> type=<span class="hljs-string">&quot;module&quot;</span>&gt;&lt;/script&gt;<br></code></pre></td></tr></table></figure><p>app.js&#x2F;&#x2F;文件名</p><figure class="highlight capnproto"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs capnproto"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> m1 <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./src/js/m1.js&quot;</span>;<br><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> m2 <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./src/js/m2.js&quot;</span>;<br><span class="hljs-keyword">import</span> m3 <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./src/js/m3.js&quot;</span>;<br></code></pre></td></tr></table></figure><h3 id="项目实际"><a href="#项目实际" class="headerlink" title="项目实际"></a>项目实际</h3>]]></content>
    
    
    <categories>
      
      <category>笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>javascript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>dom-bom</title>
    <link href="/2023/03/22/%E7%AC%94%E8%AE%B0/dom&amp;bom/"/>
    <url>/2023/03/22/%E7%AC%94%E8%AE%B0/dom&amp;bom/</url>
    
    <content type="html"><![CDATA[<h1 id="DOM-BOM"><a href="#DOM-BOM" class="headerlink" title="DOM  BOM"></a>DOM  BOM</h1><h4 id="js组成"><a href="#js组成" class="headerlink" title="js组成"></a>js组成</h4><p>ECMAScript（JavaScript语句）</p><p>DOM（页面文档对象模型）</p><p>BOM（浏览器对象模型）</p><h4 id="API"><a href="#API" class="headerlink" title="API"></a>API</h4><p>API是一些预先定义的函数，目的是提供应用程序与开发人员基于某软件或硬件得以访问一组例程的能力，而有无需访问源码，或理解内部工作机制的细节。</p><p><strong>简单理解：</strong>API是给程序员提供的一种工具，以便能更轻松的实现想要完成的功能。</p><h4 id="Web-API"><a href="#Web-API" class="headerlink" title="Web API"></a>Web API</h4><p>Web API是浏览器提供的一套操作浏览器功能和页面元素的API（BOM和DOM）</p><h4 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h4><ol><li>API是为我们程序员提供的一个接口，帮助我们实现某种功能，我们会使用就可以了，不必纠结内部如何实现</li><li>Web API主要是针对于浏览器提供的接口，主要针对于浏览器做交互效果</li><li>Web API一般都有输入和输出（函数的传参和返回值），Web API很多都是方法（函数）</li><li>学习Web API可以结合前面学习内置对象方法的思路学习</li></ol><h2 id="DOM"><a href="#DOM" class="headerlink" title="DOM"></a>DOM</h2><h3 id="1、简介"><a href="#1、简介" class="headerlink" title="1、简介"></a>1、简介</h3><p>文档对象模型，是W3C组织推荐的处理可扩展标记语言（HTML或者XML）的标准<strong>编程接口。</strong></p><p>通过这些DOM接口可以改变网页的内容、结构和样式。</p><h4 id="DOM树"><a href="#DOM树" class="headerlink" title="DOM树"></a>DOM树</h4><ul><li>文档：一个页面就是一个文档，DOM中使用document表示</li><li>元素：页面中的所有标签都是元素，DOM中使用element表示</li><li>节点：网页中的所有内容都是节点（标签、属性、文本、注释等），DOM中使用node表示</li></ul><p><img src="/img/dom-bom/dom.png" alt="image"></p><h3 id="2、获取元素"><a href="#2、获取元素" class="headerlink" title="2、获取元素"></a>2、获取元素</h3><h4 id="1、根据ID获取"><a href="#1、根据ID获取" class="headerlink" title="1、根据ID获取"></a>1、根据ID获取</h4><p>get–获得，element–元素，by–通过，驼峰命名法</p><p>使用  </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> a = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;id&#x27;</span>);<br></code></pre></td></tr></table></figure><p>返回一个匹配特定ID的元素。参数 id 是大小写敏感的字符串，返回的是一个元素对象</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">dir</span>();<br><span class="hljs-comment">//打印我们返回的元素对象，更好的查看里面的属性和方法</span><br></code></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;ie=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;time&quot;</span>&gt;</span>2019-9-9<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">//1、因为我们文档页面从上往下加载，所以我们script写到标签下面</span></span><br><span class="language-javascript">        <span class="hljs-comment">//2、get 获得element 元素 by 通过 驼峰命名法</span></span><br><span class="language-javascript">        <span class="hljs-comment">//3、参数 id 是大小写敏感的字符串</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> timer = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;time&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(timer);</span><br><span class="language-javascript">        <span class="hljs-comment">//4、返回的是一个元素对象</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">typeof</span> timer);</span><br><span class="language-javascript">        <span class="hljs-comment">//5、console.dir 打印我们返回的元素对象  更好的查看里面的属性和方法</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">dir</span>(timer);</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="2、根据标签名获取"><a href="#2、根据标签名获取" class="headerlink" title="2、根据标签名获取"></a>2、根据标签名获取</h4><p>使用getElementsByTagName() 方法可以返回带有指定标签名的对象的集合</p><p>返回的是 获取过来元素对象的集合，以伪数组的形式存储</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html">var a = document.getElementsByTagName(&#x27;标签名&#x27;);<br></code></pre></td></tr></table></figure><p><strong>注意：</strong></p><p>1、因为得到的是一个对象的结合，所以我们想要操作里面的元素就需要遍历</p><p>2、得到元素对象是动态的</p><p>还可以获取某个元素（父元素） 内部所以指定标签名的子元素</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html">element.getElementsByTagName(&#x27;标签名&#x27;);<br></code></pre></td></tr></table></figure><p><strong>注意：</strong></p><p>父元素必须是单个对象（必须指明是哪一个元素对象），获取的时候不包括父元素自己</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>我喜欢你<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>我喜欢你<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>我喜欢你<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>我喜欢你<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">ol</span> <span class="hljs-attr">id</span> = <span class="hljs-string">&#x27;ol&#x27;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>没有结果<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>没有结果<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>没有结果<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>没有结果<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">ol</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">//1、返回的是获取过来元素对象的集合 以伪数组的形式存储的</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> lis = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementsByTagName</span>(<span class="hljs-string">&#x27;li&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(lis);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(lis[<span class="hljs-number">0</span>]);</span><br><span class="language-javascript">        <span class="hljs-comment">//2、我们想要依次打印里面的元素对象  可以采取遍历的方式</span></span><br><span class="language-javascript">        <span class="hljs-comment">//3、如果页面中只有一个li，返回的还是伪数组的形式</span></span><br><span class="language-javascript">        <span class="hljs-comment">//4、如果页面中没有这个元素，返回的是空的伪数组的形式</span></span><br><span class="language-javascript">        <span class="hljs-comment">//5、elemnet.getElementsByTagName(&#x27;标签名&#x27;);  父元素必须是指定的单个元素</span></span><br><span class="language-javascript">        <span class="hljs-comment">// var ol = document.getElementsByTagName(&#x27;ol&#x27;); // [ol]</span></span><br><span class="language-javascript">        <span class="hljs-comment">// console.log(ol[0].getElementsByTagName(&#x27;li&#x27;));</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> ol = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;ol&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ol.<span class="hljs-title function_">getElementsByTagName</span>(<span class="hljs-string">&#x27;li&#x27;</span>));</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="3、H5新增获取元素方式"><a href="#3、H5新增获取元素方式" class="headerlink" title="3、H5新增获取元素方式"></a>3、H5新增获取元素方式</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs html">document.getElementsByClassName(&#x27;类名&#x27;); //根据类名返回元素对象集合<br>document.querySelector(&#x27;选择器&#x27;); //根据指定选择器返回第一个元素对象<br>document.querySelectorAll(&#x27;选择器&#x27;); //根据指定选择器返回<br><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;box&quot;</span>&gt;</span>盒子1<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;box&quot;</span>&gt;</span>盒子2<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;nav&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>首页<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>产品<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">//1、getElementsByClassName 根据类名获取某些元素</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> boxs = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementsByClassName</span>(<span class="hljs-string">&#x27;box&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(boxs);</span><br><span class="language-javascript">        <span class="hljs-comment">//2、querySelector 返回指定选择器的第一个元素对象  切记 里面的选择器需要加符号  .box   #nav</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> firstBox = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.box&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(firstBox);</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> nav = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#nav&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(nav);</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> li = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;li&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(li);</span><br><span class="language-javascript">        <span class="hljs-comment">//3、querySelectorAll() 返回指定选择器的所以元素对象集合</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> allBox = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;.box&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(allBox);</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> lis = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;li&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(lis);</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="4、获取特殊元素"><a href="#4、获取特殊元素" class="headerlink" title="4、获取特殊元素"></a>4、获取特殊元素</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">//1、获取body元素</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> bodyEle = <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>;</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">dir</span>(bodyEle);</span><br><span class="language-javascript">        <span class="hljs-comment">//2、获取html元素</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> htmlEle = <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>;</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(htmlEle);</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="3、事件基础"><a href="#3、事件基础" class="headerlink" title="3、事件基础"></a>3、事件基础</h3><p>JavaScript使我们有能力创建动态页面，而事件是可以被JavaScript侦测到的行为</p><p><strong>简单理解</strong>      触发 – 响应机制</p><p>网页中的每个元素都可以产生某些可以触发JavaScript的事件，例如，我们可以在用户点击某按钮时产生一个事件，如何去执行某些操作</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;btn&quot;</span>&gt;</span>铠甲合体<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">//点击一个按钮，弹出一个对话框</span></span><br><span class="language-javascript">        <span class="hljs-comment">//1、事件是有三部分组成的 事件源  事件类型  事件处理程序  我们也称为事件三要素</span></span><br><span class="language-javascript">        <span class="hljs-comment">//(1) 事件源 事件被触发的对象  按钮</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;btn&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-comment">//(2) 事件类型 如何触发 什么事件  比如鼠标点击(onclick) 还是鼠标经过  还是键盘按下</span></span><br><span class="language-javascript">        <span class="hljs-comment">//(3) 事件处理程序  通过一个函数赋值的方式完成</span></span><br><span class="language-javascript">        btn.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;炎龙铠甲合体成功！&#x27;</span>);</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p><strong>执行事件的步骤</strong></p><p>1、获取事件源</p><p>2、注册事件（绑定事件）</p><p>3、添加事件处理程序（采取函数赋值形式）</p><h5 id="常见的鼠标事件"><a href="#常见的鼠标事件" class="headerlink" title="常见的鼠标事件"></a>常见的鼠标事件</h5><p><img src="/img/dom-bom/mouse.png" alt="image"></p><h3 id="4、操作元素"><a href="#4、操作元素" class="headerlink" title="4、操作元素"></a>4、操作元素</h3><p>JavaScript的DOM操作可以改变网页内容、结构和样式，我们可以利用DOM操作元素来改变元素里面的内容、属性等</p><h4 id="1、改变元素内容"><a href="#1、改变元素内容" class="headerlink" title="1、改变元素内容"></a>1、改变元素内容</h4><p><strong>element.innerText</strong></p><p>从起始位置到终止位置的内容，但它去除html标签，同时空格和换行也会去掉</p><p>也就是不识别html标签</p><p><strong>element.innerHTML</strong></p><p>起始位置到终止位置的全部内容，包括html标签，同时保留空格和换行</p><p>W3C标准</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><br><span class="language-css">        <span class="hljs-selector-tag">div</span>,<span class="hljs-selector-tag">p</span> &#123;</span><br><span class="language-css">            <span class="hljs-attribute">width</span>: <span class="hljs-number">300px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">height</span>: <span class="hljs-number">30px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">line-height</span>: <span class="hljs-number">30px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">color</span>: <span class="hljs-number">#fff</span>;</span><br><span class="language-css">            <span class="hljs-attribute">background-color</span>: pink;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>显示当前系统时间<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>某个时间<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>时间<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">//当我们点击了按钮，div里面的文字会发生变化</span></span><br><span class="language-javascript">        <span class="hljs-comment">//1、获取元素</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;button&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;div&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-comment">//2、注册事件</span></span><br><span class="language-javascript">        btn.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">// div.innerText = &#x27;2021-11-16&#x27;;</span></span><br><span class="language-javascript">            div.<span class="hljs-property">innerText</span> = <span class="hljs-title function_">getDate</span>();</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">getDate</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">var</span> date = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>();</span><br><span class="language-javascript">            <span class="hljs-keyword">var</span> year = date.<span class="hljs-title function_">getFullYear</span>();</span><br><span class="language-javascript">            <span class="hljs-keyword">var</span> month = date.<span class="hljs-title function_">getMonth</span>() + <span class="hljs-number">1</span>;</span><br><span class="language-javascript">            <span class="hljs-keyword">var</span> dates = date.<span class="hljs-title function_">getDate</span>();</span><br><span class="language-javascript">            <span class="hljs-keyword">var</span> arr = [<span class="hljs-string">&#x27;星期日&#x27;</span>,<span class="hljs-string">&#x27;星期一&#x27;</span>,<span class="hljs-string">&#x27;星期二&#x27;</span>,<span class="hljs-string">&#x27;星期三&#x27;</span>,<span class="hljs-string">&#x27;星期四&#x27;</span>,<span class="hljs-string">&#x27;星期五&#x27;</span>,<span class="hljs-string">&#x27;星期六&#x27;</span>];</span><br><span class="language-javascript">            <span class="hljs-keyword">var</span> day = date.<span class="hljs-title function_">getDay</span>();</span><br><span class="language-javascript">            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;今天是&#x27;</span> + year + <span class="hljs-string">&#x27;年&#x27;</span> + month + <span class="hljs-string">&#x27;月&#x27;</span> + dates + <span class="hljs-string">&#x27;日&#x27;</span> + arr[day];</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">//我们元素可以不用添加事件</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> p = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;p&#x27;</span>);</span><br><span class="language-javascript">        p.<span class="hljs-property">innerText</span> = <span class="hljs-title function_">getDate</span>();</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>    <br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="2、常用元素的属性操作"><a href="#2、常用元素的属性操作" class="headerlink" title="2、常用元素的属性操作"></a>2、常用元素的属性操作</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><br><span class="language-css">        <span class="hljs-selector-tag">button</span> &#123;</span><br><span class="language-css">            <span class="hljs-attribute">width</span>: <span class="hljs-number">50px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">height</span>: <span class="hljs-number">50px</span>;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">        <span class="hljs-selector-tag">img</span> &#123;</span><br><span class="language-css">            <span class="hljs-attribute">width</span>: <span class="hljs-number">100ex</span>;</span><br><span class="language-css">            <span class="hljs-attribute">height</span>: <span class="hljs-number">100ex</span>;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;e&quot;</span>&gt;</span>恶<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;shan&quot;</span>&gt;</span>善<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./img/dom-bom/e.jpg&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&#x27;恶&#x27;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">//修改元素属性</span></span><br><span class="language-javascript">        <span class="hljs-comment">//1、获取元素</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> e = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;e&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> shan = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;shan&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> img = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;img&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-comment">//2、注册事件  处理程序</span></span><br><span class="language-javascript">        e.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            img.<span class="hljs-property">src</span> = <span class="hljs-string">&#x27;./img/dom-bom/e.jpg&#x27;</span>;</span><br><span class="language-javascript">            img.<span class="hljs-property">title</span> = <span class="hljs-string">&#x27;恶&#x27;</span>;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        shan.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            img.<span class="hljs-property">src</span> = <span class="hljs-string">&#x27;./img/dom-bom/shan.jpg&#x27;</span>;</span><br><span class="language-javascript">            img.<span class="hljs-property">title</span> = <span class="hljs-string">&#x27;善&#x27;</span>;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="3、修改表单属性"><a href="#3、修改表单属性" class="headerlink" title="3、修改表单属性"></a>3、修改表单属性</h4><p>利用DOM可以操作如下表单元素的属性：</p><p>type、value、checked、selected、disabled</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>按钮<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;输入内容&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">//1、获取元素</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;button&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> input = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;input&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-comment">//2、注册事件  处理程序</span></span><br><span class="language-javascript">        btn.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">// input.innerHTML = &#x27;被点击了&#x27;;   这个是普通盒子   比如 div 标签里面的内容</span></span><br><span class="language-javascript">            <span class="hljs-comment">//表单里面的值 文字内容是通过value 来修改的</span></span><br><span class="language-javascript">            input.<span class="hljs-property">value</span> = <span class="hljs-string">&#x27;被点击了&#x27;</span>;</span><br><span class="language-javascript">            <span class="hljs-comment">//如果想要某个表单被禁用 不能再点击 disabled 我们想要这个按钮 button 禁用</span></span><br><span class="language-javascript">            <span class="hljs-comment">// btn.disabled = true;</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">disabled</span> = <span class="hljs-literal">true</span>;</span><br><span class="language-javascript">            <span class="hljs-comment">//this 指向的事件函数的调用者  也就是 btn</span></span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><h5 id="显示隐藏密钥明文案例"><a href="#显示隐藏密钥明文案例" class="headerlink" title="显示隐藏密钥明文案例"></a>显示隐藏密钥明文案例</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><br><span class="language-css">        <span class="hljs-selector-class">.box</span> &#123;</span><br><span class="language-css">            <span class="hljs-attribute">width</span>: <span class="hljs-number">400px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#ccc</span>;</span><br><span class="language-css">            <span class="hljs-attribute">margin</span>: <span class="hljs-number">100px</span> auto;</span><br><span class="language-css">        &#125;</span><br><span class="language-css"></span><br><span class="language-css">        <span class="hljs-selector-class">.box</span> <span class="hljs-selector-tag">input</span> &#123;</span><br><span class="language-css">            <span class="hljs-attribute">width</span>: <span class="hljs-number">370px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">height</span>: <span class="hljs-number">30px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">border</span>: <span class="hljs-number">0</span>;</span><br><span class="language-css">            <span class="hljs-attribute">outline</span>: none;</span><br><span class="language-css">        &#125;</span><br><span class="language-css"></span><br><span class="language-css">        <span class="hljs-selector-class">.box</span> <span class="hljs-selector-tag">img</span> &#123;</span><br><span class="language-css">            <span class="hljs-attribute">position</span>: absolute;</span><br><span class="language-css">            <span class="hljs-attribute">top</span>: <span class="hljs-number">99px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">right</span>: <span class="hljs-number">800px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">width</span>: <span class="hljs-number">15px</span>;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;box&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./img/dom-bom/e.jpg&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;e&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;pwd&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> e = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;e&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> pwd = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;pwd&#x27;</span>);</span><br><span class="language-javascript">        e.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (pwd.<span class="hljs-property">type</span> == <span class="hljs-string">&#x27;password&#x27;</span>) &#123;</span><br><span class="language-javascript">                pwd.<span class="hljs-property">type</span> = <span class="hljs-string">&#x27;text&#x27;</span>;</span><br><span class="language-javascript">                e.<span class="hljs-property">src</span> = <span class="hljs-string">&#x27;./img/dom-bom/shan.jpg&#x27;</span>;</span><br><span class="language-javascript">            &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                pwd.<span class="hljs-property">type</span> = <span class="hljs-string">&#x27;password&#x27;</span>;</span><br><span class="language-javascript">                e.<span class="hljs-property">src</span> = <span class="hljs-string">&#x27;./img/dom-bom/e.jpg&#x27;</span>;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="4、修改样式属性"><a href="#4、修改样式属性" class="headerlink" title="4、修改样式属性"></a>4、修改样式属性</h4><p>我们可以通过JS修改元素的大小、颜色、位置等样式</p><ol><li>element.style  行内样式操作</li><li>element.className    类名样式操作</li></ol><p><strong>注意：</strong></p><p>1、js里面的样式采取驼峰命名法， 比如 fontSize 、 backgroundColor</p><p>2、js修改style 样式操作，产生的是行内样式，css权重比较高</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><br><span class="language-css">        <span class="hljs-selector-tag">div</span> &#123;</span><br><span class="language-css">            <span class="hljs-attribute">width</span>: <span class="hljs-number">200px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">height</span>: <span class="hljs-number">200px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">background-color</span>: pink;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;div&#x27;</span>);</span><br><span class="language-javascript">        div.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">style</span>.<span class="hljs-property">backgroundColor</span> = <span class="hljs-string">&#x27;black&#x27;</span>;</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">style</span>.<span class="hljs-property">width</span> = <span class="hljs-string">&#x27;300px&#x27;</span>;</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">style</span>.<span class="hljs-property">height</span> = <span class="hljs-string">&#x27;400px&#x27;</span>;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>淘宝关闭二维码案例</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><br><span class="language-css">        <span class="hljs-selector-class">.box</span> &#123;</span><br><span class="language-css">            <span class="hljs-attribute">position</span>: relative;</span><br><span class="language-css">            <span class="hljs-attribute">width</span>: <span class="hljs-number">74px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">height</span>: <span class="hljs-number">88px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#ccc</span>;</span><br><span class="language-css">            <span class="hljs-attribute">margin</span>: <span class="hljs-number">100px</span> auto;</span><br><span class="language-css">            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">12px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">text-align</span>: center;</span><br><span class="language-css">            <span class="hljs-attribute">color</span>: <span class="hljs-number">#f40</span>;</span><br><span class="language-css">        &#125;</span><br><span class="language-css"></span><br><span class="language-css">        <span class="hljs-selector-class">.box</span> <span class="hljs-selector-tag">img</span> &#123;</span><br><span class="language-css">            <span class="hljs-attribute">width</span>: <span class="hljs-number">60px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">height</span>: <span class="hljs-number">60px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">5px</span>;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">        <span class="hljs-selector-class">.close-btn</span> &#123;</span><br><span class="language-css">            <span class="hljs-attribute">position</span>: absolute;</span><br><span class="language-css">            <span class="hljs-attribute">top</span>: -<span class="hljs-number">1px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">left</span>: -<span class="hljs-number">16px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">width</span>: <span class="hljs-number">14px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">height</span>: <span class="hljs-number">14px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#ccc</span>;</span><br><span class="language-css">            <span class="hljs-attribute">line-height</span>: <span class="hljs-number">14px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">font-family</span>: Arial,Helvetica,sans-serif;</span><br><span class="language-css">            <span class="hljs-attribute">cursor</span>: pointer;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;box&quot;</span>&gt;</span><br>        淘宝二维码<br>        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./img/dom-bom/shan.jpg&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;close-btn&quot;</span>&gt;</span>x<span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.close-btn&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> box = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.box&#x27;</span>);</span><br><span class="language-javascript"></span><br><span class="language-javascript">        btn.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            box.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">&#x27;none&#x27;</span>;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><h5 id="循环精灵图"><a href="#循环精灵图" class="headerlink" title="循环精灵图"></a>循环精灵图</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;ie=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><br><span class="language-css">        * &#123;</span><br><span class="language-css">            <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;</span><br><span class="language-css">            <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">        </span><br><span class="language-css">        <span class="hljs-selector-tag">li</span> &#123;</span><br><span class="language-css">            <span class="hljs-attribute">list-style-type</span>: none;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">        </span><br><span class="language-css">        <span class="hljs-selector-class">.box</span> &#123;</span><br><span class="language-css">            <span class="hljs-attribute">width</span>: <span class="hljs-number">250px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">margin</span>: <span class="hljs-number">100px</span> auto;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">        </span><br><span class="language-css">        <span class="hljs-selector-class">.box</span> <span class="hljs-selector-tag">li</span> &#123;</span><br><span class="language-css">            <span class="hljs-attribute">float</span>: left;</span><br><span class="language-css">            <span class="hljs-attribute">width</span>: <span class="hljs-number">24px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">height</span>: <span class="hljs-number">24px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">background-color</span>: pink;</span><br><span class="language-css">            <span class="hljs-attribute">margin</span>: <span class="hljs-number">15px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(<span class="hljs-string">./img/dom-bom/sprite.png</span>) no-repeat;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;box&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 1. 获取元素 所有的小li </span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> lis = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;li&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; lis.<span class="hljs-property">length</span>; i++) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">// 让索引号 乘以 44 就是每个li 的背景y坐标  index就是我们的y坐标</span></span><br><span class="language-javascript">            <span class="hljs-keyword">var</span> index = i * <span class="hljs-number">44</span>;</span><br><span class="language-javascript">            lis[i].<span class="hljs-property">style</span>.<span class="hljs-property">backgroundPosition</span> = <span class="hljs-string">&#x27;0 -&#x27;</span> + index + <span class="hljs-string">&#x27;px&#x27;</span>;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><h5 id="显示隐藏文本框内容"><a href="#显示隐藏文本框内容" class="headerlink" title="显示隐藏文本框内容"></a>显示隐藏文本框内容</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;ie=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><br><span class="language-css">        <span class="hljs-selector-tag">input</span> &#123;</span><br><span class="language-css">            <span class="hljs-attribute">color</span>: <span class="hljs-number">#999</span>;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;手机&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 1.获取元素</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> text = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;input&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-comment">// 2.注册事件 获得焦点事件 onfocus </span></span><br><span class="language-javascript">        text.<span class="hljs-property">onfocus</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-comment">// console.log(&#x27;得到了焦点&#x27;);</span></span><br><span class="language-javascript">                <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> === <span class="hljs-string">&#x27;手机&#x27;</span>) &#123;</span><br><span class="language-javascript">                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-string">&#x27;&#x27;</span>;</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">                <span class="hljs-comment">// 获得焦点需要把文本框里面的文字颜色变黑</span></span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">style</span>.<span class="hljs-property">color</span> = <span class="hljs-string">&#x27;#333&#x27;</span>;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-comment">// 3. 注册事件 失去焦点事件 onblur</span></span><br><span class="language-javascript">        text.<span class="hljs-property">onblur</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">// console.log(&#x27;失去了焦点&#x27;);</span></span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> === <span class="hljs-string">&#x27;&#x27;</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-string">&#x27;手机&#x27;</span>;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-comment">// 失去焦点需要把文本框里面的文字颜色变浅色</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">style</span>.<span class="hljs-property">color</span> = <span class="hljs-string">&#x27;#999&#x27;</span>;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><h5 id="通过className修改元素属性"><a href="#通过className修改元素属性" class="headerlink" title="通过className修改元素属性"></a>通过className修改元素属性</h5><p><strong>注意</strong></p><p>1、如果修改样式较多，可以采取操作类名方式更改元素样式</p><p>2、class因为是保留字，因此使用className来操作元素类名属性</p><p>3、className 会直接更改元素的类名，会覆盖原先的类名</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;ie=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><br><span class="language-css">        <span class="hljs-selector-tag">div</span> &#123;</span><br><span class="language-css">            <span class="hljs-attribute">width</span>: <span class="hljs-number">100px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">background-color</span>: pink;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">        </span><br><span class="language-css">        <span class="hljs-selector-class">.change</span> &#123;</span><br><span class="language-css">            <span class="hljs-attribute">background-color</span>: purple;</span><br><span class="language-css">            <span class="hljs-attribute">color</span>: <span class="hljs-number">#fff</span>;</span><br><span class="language-css">            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">25px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">100px</span>;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><br><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;first&quot;</span>&gt;</span>文本<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 1. 使用 element.style 获得修改元素样式  如果样式比较少 或者 功能简单的情况下使用</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> test = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;div&#x27;</span>);</span><br><span class="language-javascript">        test.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">// this.style.backgroundColor = &#x27;purple&#x27;;</span></span><br><span class="language-javascript">            <span class="hljs-comment">// this.style.color = &#x27;#fff&#x27;;</span></span><br><span class="language-javascript">            <span class="hljs-comment">// this.style.fontSize = &#x27;25px&#x27;;</span></span><br><span class="language-javascript">            <span class="hljs-comment">// this.style.marginTop = &#x27;100px&#x27;;</span></span><br><span class="language-javascript">            <span class="hljs-comment">// 让我们当前元素的类名改为了 change</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 2. 我们可以通过 修改元素的className更改元素的样式 适合于样式较多或者功能复杂的情况</span></span><br><span class="language-javascript">            <span class="hljs-comment">// this.className = &#x27;change&#x27;;</span></span><br><span class="language-javascript">            <span class="hljs-comment">// 3. 如果想要保留原先的类名，我们可以这么做 多类名选择器</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">className</span> = <span class="hljs-string">&#x27;first change&#x27;</span>;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><h5 id="密码框验证信息"><a href="#密码框验证信息" class="headerlink" title="密码框验证信息"></a>密码框验证信息</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;ie=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><br><span class="language-css">        <span class="hljs-selector-tag">div</span> &#123;</span><br><span class="language-css">            <span class="hljs-attribute">width</span>: <span class="hljs-number">600px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">margin</span>: <span class="hljs-number">100px</span> auto;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">        </span><br><span class="language-css">        <span class="hljs-selector-class">.message</span> &#123;</span><br><span class="language-css">            <span class="hljs-attribute">display</span>: inline-block;</span><br><span class="language-css">            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">12px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">color</span>: <span class="hljs-number">#999</span>;</span><br><span class="language-css">            <span class="hljs-attribute">background</span>: <span class="hljs-built_in">url</span>(<span class="hljs-string">./img/dom-bom/mess.png</span>) no-repeat left center;</span><br><span class="language-css">            <span class="hljs-attribute">padding-left</span>: <span class="hljs-number">20px</span>;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">        </span><br><span class="language-css">        <span class="hljs-selector-class">.wrong</span> &#123;</span><br><span class="language-css">            <span class="hljs-attribute">color</span>: red;</span><br><span class="language-css">            <span class="hljs-attribute">background-image</span>: <span class="hljs-built_in">url</span>(<span class="hljs-string">./img/dom-bom/wrong.png</span>);</span><br><span class="language-css">        &#125;</span><br><span class="language-css">        </span><br><span class="language-css">        <span class="hljs-selector-class">.right</span> &#123;</span><br><span class="language-css">            <span class="hljs-attribute">color</span>: green;</span><br><span class="language-css">            <span class="hljs-attribute">background-image</span>: <span class="hljs-built_in">url</span>(<span class="hljs-string">./img/dom-bom/right.png</span>);</span><br><span class="language-css">        &#125;</span><br><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;register&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;ipt&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;message&quot;</span>&gt;</span>请输入6~16位密码<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 首先判断的事件是表单失去焦点 onblur</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 如果输入正确则提示正确的信息颜色为绿色小图标变化</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 如果输入不是6到16位，则提示错误信息颜色为红色 小图标变化</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 因为里面变化样式较多，我们采取className修改样式</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 1.获取元素</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> ipt = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.ipt&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> message = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.message&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-comment">//2. 注册事件 失去焦点</span></span><br><span class="language-javascript">        ipt.<span class="hljs-property">onblur</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">// 根据表单里面值的长度 ipt.value.length</span></span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>.<span class="hljs-property">length</span> &lt; <span class="hljs-number">6</span> || <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">16</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-comment">// console.log(&#x27;错误&#x27;);</span></span><br><span class="language-javascript">                message.<span class="hljs-property">className</span> = <span class="hljs-string">&#x27;message wrong&#x27;</span>;</span><br><span class="language-javascript">                message.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">&#x27;您输入的位数不对要求6~16位&#x27;</span>;</span><br><span class="language-javascript">            &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                message.<span class="hljs-property">className</span> = <span class="hljs-string">&#x27;message right&#x27;</span>;</span><br><span class="language-javascript">                message.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">&#x27;您输入的正确&#x27;</span>;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><h5 id="开关灯"><a href="#开关灯" class="headerlink" title="开关灯"></a>开关灯</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;ie=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;btn&quot;</span>&gt;</span>开关灯<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;btn&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-comment">// var btn = document.querySelector(&#x27;button&#x27;);</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> flag = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">        btn.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (flag == <span class="hljs-number">0</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-property">style</span>.<span class="hljs-property">backgroundColor</span> = <span class="hljs-string">&#x27;black&#x27;</span>;</span><br><span class="language-javascript">                flag = <span class="hljs-number">1</span>;</span><br><span class="language-javascript">            &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-property">style</span>.<span class="hljs-property">backgroundColor</span> = <span class="hljs-string">&#x27;#fff&#x27;</span>;</span><br><span class="language-javascript">                flag = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="操作元素小结"><a href="#操作元素小结" class="headerlink" title="操作元素小结"></a>操作元素小结</h4><p><img src="/img/dom-bom/element.png" alt="image"></p><h4 id="5、排他思想"><a href="#5、排他思想" class="headerlink" title="5、排他思想"></a>5、排他思想</h4><p>干掉其他人，再设置自己的样式</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>按钮1<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>按钮2<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>按钮3<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>按钮4<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>按钮5<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">//1、获取所有元素按钮</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> btns = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementsByTagName</span>(<span class="hljs-string">&#x27;button&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-comment">//btns得到的是伪数组 里面的每一个元素为 btns[i]</span></span><br><span class="language-javascript">        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; btns.<span class="hljs-property">length</span>; i++) &#123;</span><br><span class="language-javascript">            btns[i].<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">                 <span class="hljs-comment">//（1）先把所有的按钮背景颜色去掉</span></span><br><span class="language-javascript">                 <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; btns.<span class="hljs-property">length</span>; i++) &#123;</span><br><span class="language-javascript">                    btns[i].<span class="hljs-property">style</span>.<span class="hljs-property">backgroundColor</span> = <span class="hljs-string">&#x27;&#x27;</span>;</span><br><span class="language-javascript">                 &#125;</span><br><span class="language-javascript">                <span class="hljs-comment">//（2）然后才让当前的元素背景颜色为红色</span></span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">style</span>.<span class="hljs-property">backgroundColor</span> = <span class="hljs-string">&#x27;red&#x27;</span>;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-comment">//2、首先排除其他人，然后再设置自己的样式，这种排除其他人的思想为排他思想</span></span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="6、自定义属性值"><a href="#6、自定义属性值" class="headerlink" title="6、自定义属性值"></a>6、自定义属性值</h4><h5 id="1、获取属性值"><a href="#1、获取属性值" class="headerlink" title="1、获取属性值"></a>1、获取属性值</h5><ul><li>获取内置属性值（元素自身自带的属性）</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">element.属性;<br></code></pre></td></tr></table></figure><ul><li>获取自定义的属性值</li></ul><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xquery"><span class="hljs-type">element</span>.getAttribute(<span class="hljs-string">&#x27;属性&#x27;</span>);<br></code></pre></td></tr></table></figure><h5 id="2、设置属性值"><a href="#2、设置属性值" class="headerlink" title="2、设置属性值"></a>2、设置属性值</h5><ul><li>设置内置属性值</li></ul><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xquery"><span class="hljs-type">element</span>.属性 = <span class="hljs-string">&#x27;值&#x27;</span>;<br></code></pre></td></tr></table></figure><ul><li>设置自定义的属性</li></ul><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xquery"><span class="hljs-type">element</span>.setAttribute(<span class="hljs-string">&#x27;属性&#x27;</span>,<span class="hljs-string">&#x27;值&#x27;</span>);<br></code></pre></td></tr></table></figure><h5 id="3、移除属性"><a href="#3、移除属性" class="headerlink" title="3、移除属性"></a>3、移除属性</h5><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xquery"><span class="hljs-type">element</span>.removeAttribute(<span class="hljs-string">&#x27;属性&#x27;</span>);<br></code></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;demo&quot;</span> <span class="hljs-attr">index</span>=<span class="hljs-string">&quot;1&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;nav&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;div&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-comment">// 1. 获取元素的属性值</span></span><br><span class="language-javascript">        <span class="hljs-comment">// (1) element.属性</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(div.<span class="hljs-property">id</span>);</span><br><span class="language-javascript">        <span class="hljs-comment">//(2) element.getAttribute(&#x27;属性&#x27;)  get得到获取 attribute 属性的意思 我们程序员自己添加的属性我们称为自定义属性 index</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(div.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;id&#x27;</span>));</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(div.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;index&#x27;</span>));</span><br><span class="language-javascript">        <span class="hljs-comment">// 2. 设置元素属性值</span></span><br><span class="language-javascript">        <span class="hljs-comment">// (1) element.属性= &#x27;值&#x27;</span></span><br><span class="language-javascript">        div.<span class="hljs-property">id</span> = <span class="hljs-string">&#x27;test&#x27;</span>;</span><br><span class="language-javascript">        div.<span class="hljs-property">className</span> = <span class="hljs-string">&#x27;navs&#x27;</span>;</span><br><span class="language-javascript">        <span class="hljs-comment">// (2) element.setAttribute(&#x27;属性&#x27;, &#x27;值&#x27;);  主要针对于自定义属性</span></span><br><span class="language-javascript">        div.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&#x27;index&#x27;</span>, <span class="hljs-number">2</span>);</span><br><span class="language-javascript">        div.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&#x27;class&#x27;</span>, <span class="hljs-string">&#x27;footer&#x27;</span>); <span class="hljs-comment">// class 特殊  这里面写的就是class 不是className</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 3 移除属性 removeAttribute(属性)    </span></span><br><span class="language-javascript">        div.<span class="hljs-title function_">removeAttribute</span>(<span class="hljs-string">&#x27;index&#x27;</span>);</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="7、H5自定义属性"><a href="#7、H5自定义属性" class="headerlink" title="7、H5自定义属性"></a>7、H5自定义属性</h4><p>目的：</p><ul><li>保存并保存数据，有些数据可以保存到页面中而不用保存到数据库中</li><li>有些自定义属性很容易引起歧义，不容易判断到底是内置属性还是自定义的，所以H5有了规定</li></ul><h5 id="1、设置H5自定义属性"><a href="#1、设置H5自定义属性" class="headerlink" title="1、设置H5自定义属性"></a>1、设置H5自定义属性</h5><p>H5规定自定义属性 <code>data-</code>开头作为属性名并赋值</p><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs axapta">&lt;<span class="hljs-keyword">div</span> data-<span class="hljs-keyword">index</span> = <span class="hljs-string">&quot;1&quot;</span>&gt;&lt;/&gt;<br><span class="hljs-comment">// 或者使用JavaScript设置</span><br><span class="hljs-keyword">div</span>.setAttribute(<span class="hljs-string">&#x27;data-index&#x27;</span>,<span class="hljs-number">1</span>);<br></code></pre></td></tr></table></figure><h5 id="2、-获取H5自定义属性"><a href="#2、-获取H5自定义属性" class="headerlink" title="2、 获取H5自定义属性"></a>2、 获取H5自定义属性</h5><ul><li><p>兼容性获取 <code>element.getAttribute(&#39;data-index&#39;)</code></p></li><li><p>H5新增的：<code>element.dataset.index</code> 或<code>element.dataset[&#39;index&#39;]</code> IE11才开始支持</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">getTime</span>=<span class="hljs-string">&quot;20&quot;</span> <span class="hljs-attr">data-index</span>=<span class="hljs-string">&quot;2&quot;</span> <span class="hljs-attr">data-list-name</span>=<span class="hljs-string">&quot;andy&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;div&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(div.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;getTime&#x27;</span>));</span><br><span class="language-javascript">        div.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&#x27;data-time&#x27;</span>, <span class="hljs-number">20</span>);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(div.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;data-index&#x27;</span>));</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(div.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;data-list-name&#x27;</span>));</span><br><span class="language-javascript">        <span class="hljs-comment">// h5新增的获取自定义属性的方法 它只能获取data-开头的</span></span><br><span class="language-javascript">        <span class="hljs-comment">// dataset 是一个集合里面存放了所有以data开头的自定义属性</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(div.<span class="hljs-property">dataset</span>);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(div.<span class="hljs-property">dataset</span>.<span class="hljs-property">index</span>);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(div.<span class="hljs-property">dataset</span>[<span class="hljs-string">&#x27;index&#x27;</span>]);</span><br><span class="language-javascript">        <span class="hljs-comment">// 如果自定义属性里面有多个-链接的单词，我们获取的时候采取 驼峰命名法</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(div.<span class="hljs-property">dataset</span>.<span class="hljs-property">listName</span>);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(div.<span class="hljs-property">dataset</span>[<span class="hljs-string">&#x27;listName&#x27;</span>]);</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="5、节点操作"><a href="#5、节点操作" class="headerlink" title="5、节点操作"></a>5、节点操作</h3><p>获取元素通常使用两种方式：</p><p><img src="/img/dom-bom/jiedian.png" alt="image"></p><h4 id="1、节点概述"><a href="#1、节点概述" class="headerlink" title="1、节点概述"></a>1、节点概述</h4><p>一般的，节点至少拥有三个基本属性</p><ul><li>nodeType：节点类型</li><li>nodeName：节点名称</li><li>nodeValue：节点值</li></ul><p>元素节点nodeType为1</p><p>属性节点nodeType为2</p><p>文本节点nodeType为3</p><blockquote><p>节点操作主要操作的是元素节点</p></blockquote><h4 id="2、父级节点"><a href="#2、父级节点" class="headerlink" title="2、父级节点"></a>2、父级节点</h4><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xquery"><span class="hljs-type">node</span>.parentNode<br></code></pre></td></tr></table></figure><ul><li><code>parentNode</code>属性可以返回某节点的父结点，注意是最近的一个父结点</li><li>如果指定的节点没有父结点则返回null</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- 节点的优点 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>我是div<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>我是span<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>我是li<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>我是li<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>我是li<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>我是li<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;demo&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;box&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;erweima&quot;</span>&gt;</span>×<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 1. 父节点 parentNode</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> erweima = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.erweima&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-comment">// var box = document.querySelector(&#x27;.box&#x27;);</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 得到的是离元素最近的父级节点(亲爸爸) 如果找不到父节点就返回为 null</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(erweima.<span class="hljs-property">parentNode</span>);</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="3、子节点"><a href="#3、子节点" class="headerlink" title="3、子节点"></a>3、子节点</h4><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">parentNode.child<span class="hljs-constructor">Nodes(标准)</span><br></code></pre></td></tr></table></figure><ul><li><code>parentNode.childNodes</code> 返回包含指定节点的子节点的集合，该集合为即时更新的集合</li><li>返回值包含了所有的子结点，包括元素节点，文本节点等</li><li>如果只想要获得里面的元素节点，则需要专门处理。所以我们一般不提倡使用<code>childNodes</code></li></ul><figure class="highlight openscad"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs openscad">parentNode.<span class="hljs-built_in">children</span>(非标准)<br></code></pre></td></tr></table></figure><ul><li><code>parentNode.children</code> 是一个只读属性，返回所有的子元素节点</li><li>它只返回子元素节点，其余节点不返回 （<strong>这个是我们重点掌握的</strong>）</li><li>虽然 children 是一个非标准，但是得到了各个浏览器的支持，因此我们可以放心使用</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>我是li<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>我是li<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>我是li<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>我是li<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">ol</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>我是li<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>我是li<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>我是li<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>我是li<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">ol</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// DOM 提供的方法（API）获取</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> ul = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;ul&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> lis = ul.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;li&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-comment">// 1. 子节点  childNodes 所有的子节点 包含 元素节点 文本节点等等</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ul.<span class="hljs-property">childNodes</span>);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ul.<span class="hljs-property">childNodes</span>[<span class="hljs-number">0</span>].<span class="hljs-property">nodeType</span>);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ul.<span class="hljs-property">childNodes</span>[<span class="hljs-number">1</span>].<span class="hljs-property">nodeType</span>);</span><br><span class="language-javascript">        <span class="hljs-comment">// 2. children 获取所有的子元素节点 也是我们实际开发常用的</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ul.<span class="hljs-property">children</span>);</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h5 id="1、第一个子结点"><a href="#1、第一个子结点" class="headerlink" title="1、第一个子结点"></a>1、第一个子结点</h5><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">parentNode.firstChild<br></code></pre></td></tr></table></figure><ul><li><code>firstChild</code> 返回第一个子节点，找不到则返回null</li><li>同样，也是包含所有的节点</li></ul><h5 id="2、最后一个子结点"><a href="#2、最后一个子结点" class="headerlink" title="2、最后一个子结点"></a>2、最后一个子结点</h5><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">parentNode.lastChild<br></code></pre></td></tr></table></figure><ul><li><code>lastChild</code> 返回最后一个子节点，找不到则返回null</li><li>同样，也是包含所有的节点</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">ol</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>我是li1<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>我是li2<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>我是li3<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>我是li4<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>我是li5<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">ol</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> ol = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;ol&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-comment">// 1. firstChild 第一个子节点 不管是文本节点还是元素节点</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ol.<span class="hljs-property">firstChild</span>);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ol.<span class="hljs-property">lastChild</span>);</span><br><span class="language-javascript">        <span class="hljs-comment">// 2. firstElementChild 返回第一个子元素节点 ie9才支持</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ol.<span class="hljs-property">firstElementChild</span>);</span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ol.<span class="hljs-property">lastElementChild</span>);</span><br><span class="language-javascript">        <span class="hljs-comment">// 3. 实际开发的写法  既没有兼容性问题又返回第一个子元素</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ol.<span class="hljs-property">children</span>[<span class="hljs-number">0</span>]);<span class="hljs-comment">//第一个子元素节点</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ol.<span class="hljs-property">children</span>[ol.<span class="hljs-property">children</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>]);<span class="hljs-comment">//最后一个子元素节点</span></span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="4、兄弟节点"><a href="#4、兄弟节点" class="headerlink" title="4、兄弟节点"></a>4、兄弟节点</h4><h5 id="1、下一个兄弟节点"><a href="#1、下一个兄弟节点" class="headerlink" title="1、下一个兄弟节点"></a>1、下一个兄弟节点</h5><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xquery"><span class="hljs-type">node</span>.nextSibling<br></code></pre></td></tr></table></figure><ul><li><code>nextSibling</code> 返回当前元素的下一个兄弟元素节点，找不到则返回null</li><li>同样，也是包含所有的节点</li></ul><h5 id="2、上一个兄弟节点"><a href="#2、上一个兄弟节点" class="headerlink" title="2、上一个兄弟节点"></a>2、上一个兄弟节点</h5><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xquery"><span class="hljs-type">node</span>.previousSibling<br></code></pre></td></tr></table></figure><ul><li><code>previousSibling</code> 返回当前元素上一个兄弟元素节点，找不到则返回null</li><li>同样，也是包含所有的节点</li></ul><h5 id="3、下一个兄弟节点-兼容性"><a href="#3、下一个兄弟节点-兼容性" class="headerlink" title="3、下一个兄弟节点(兼容性)"></a>3、下一个兄弟节点(兼容性)</h5><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xquery"><span class="hljs-type">node</span>.nextElementSibling<br></code></pre></td></tr></table></figure><ul><li><code>nextElementSibling</code> 返回当前元素下一个兄弟元素节点，找不到则返回null</li><li>有兼容性问题，IE9才支持</li></ul><h5 id="4、上一个兄弟节点-兼容性"><a href="#4、上一个兄弟节点-兼容性" class="headerlink" title="4、上一个兄弟节点(兼容性)"></a>4、上一个兄弟节点(兼容性)</h5><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xquery"><span class="hljs-type">node</span>.previousElementSibling<br></code></pre></td></tr></table></figure><ul><li><code>previousElementSibling</code> 返回当前元素上一个兄弟元素节点，找不到则返回null</li><li>有兼容性问题，IE9才支持</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>我是div<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>我是span<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;div&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-comment">// 1.nextSibling 下一个兄弟节点 包含元素节点或者 文本节点等等</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(div.<span class="hljs-property">nextSibling</span>);<span class="hljs-comment">// #text</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(div.<span class="hljs-property">previousSibling</span>);<span class="hljs-comment">// #text</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 2. nextElementSibling 得到下一个兄弟元素节点</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(div.<span class="hljs-property">nextElementSibling</span>);<span class="hljs-comment">//&lt;span&gt;我是span&lt;/span&gt;</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(div.<span class="hljs-property">previousElementSibling</span>);<span class="hljs-comment">//null</span></span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><p><strong>解决兼容性问题</strong>：自己封装一个兼容性的函数</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getNextElementSibling</span>(<span class="hljs-params">element</span>) &#123;<br>    <span class="hljs-keyword">var</span> el = element;<br>    <span class="hljs-keyword">while</span>(el = el.<span class="hljs-property">nextSibling</span>) &#123;<br>        <span class="hljs-keyword">if</span>(el.<span class="hljs-property">nodeType</span> === <span class="hljs-number">1</span>)&#123;<br>            <span class="hljs-keyword">return</span> el;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="5、创建节点"><a href="#5、创建节点" class="headerlink" title="5、创建节点"></a>5、创建节点</h4><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">&#x27;tagName&#x27;</span>);<br></code></pre></td></tr></table></figure><ul><li><code>document.createElement()</code> 方法创建由 tagName 指定的HTML 元素</li><li>因为这些元素原先不存在，是根据我们的需求动态生成的，所以我们也称为<strong>动态创建元素节点</strong></li></ul><h5 id="1、添加节点"><a href="#1、添加节点" class="headerlink" title="1、添加节点"></a>1、添加节点</h5><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">node.append<span class="hljs-constructor">Child(<span class="hljs-params">child</span>)</span><br></code></pre></td></tr></table></figure><ul><li><code>node.appendChild()</code> 方法将一个节点添加到指定父节点的子节点列表<strong>末尾</strong>。类似于 CSS 里面的 after 伪元素。</li></ul><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">node.insert<span class="hljs-constructor">Before(<span class="hljs-params">child</span>,指定元素)</span><br></code></pre></td></tr></table></figure><ul><li><code>node.insertBefore()</code> 方法将一个节点添加到父节点的指定子节点<strong>前面</strong>。类似于 CSS 里面的 before 伪元素。</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>123<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 1. 创建节点元素节点</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> li = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;li&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-comment">// 2. 添加节点 node.appendChild(child)  node 父级  child 是子级 后面追加元素  类似于数组中的push</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 先获取父亲ul</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> ul = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;ul&#x27;</span>);</span><br><span class="language-javascript">        ul.<span class="hljs-title function_">appendChild</span>(li);</span><br><span class="language-javascript">        <span class="hljs-comment">// 3. 添加节点 node.insertBefore(child, 指定元素);</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> lili = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;li&#x27;</span>);</span><br><span class="language-javascript">        ul.<span class="hljs-title function_">insertBefore</span>(lili, ul.<span class="hljs-property">children</span>[<span class="hljs-number">0</span>]);</span><br><span class="language-javascript">        <span class="hljs-comment">// 4. 我们想要页面添加一个新的元素分两步: 1. 创建元素 2. 添加元素</span></span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h5 id="2、删除节点"><a href="#2、删除节点" class="headerlink" title="2、删除节点"></a>2、删除节点</h5><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">node.remove<span class="hljs-constructor">Child(<span class="hljs-params">child</span>)</span><br></code></pre></td></tr></table></figure><ul><li><code>node.removeChild()</code>方法从 DOM 中删除一个子节点，返回删除的节点</li></ul><h5 id="3、复制节点"><a href="#3、复制节点" class="headerlink" title="3、复制节点"></a>3、复制节点</h5><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">node.clone<span class="hljs-constructor">Node()</span><br></code></pre></td></tr></table></figure><ul><li><code>node.cloneNode()</code>方法返回调用该方法的节点的一个副本。 也称为克隆节点&#x2F;拷贝节点</li><li>如果括号参数为空或者为 false ，则是浅拷贝，即只克隆复制节点本身，不克隆里面的子节点</li><li>如果括号参数为 true ，则是深度拷贝，会复制节点本身以及里面所有的子节点</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>1111<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>2<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>3<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> ul = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;ul&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-comment">// 1. node.cloneNode(); 括号为空或者里面是false 浅拷贝 只复制标签不复制里面的内容</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 2. node.cloneNode(true); 括号为true 深拷贝 复制标签复制里面的内容</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> lili = ul.<span class="hljs-property">children</span>[<span class="hljs-number">0</span>].<span class="hljs-title function_">cloneNode</span>(<span class="hljs-literal">true</span>);</span><br><span class="language-javascript">        ul.<span class="hljs-title function_">appendChild</span>(lili);</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h5 id="6、三种动态创建元素的区别"><a href="#6、三种动态创建元素的区别" class="headerlink" title="6、三种动态创建元素的区别"></a>6、三种动态创建元素的区别</h5><ul><li><code>document.write()</code> 是直接将内容写入页面的内容流，但是文档流执行完毕，则它会导致页面全部重绘</li><li><code>innerHTML</code> 是将内容写入某个 DOM 节点，不会导致页面全部重绘</li><li><code>innerHTML</code> 创建多个元素效率更高（不要拼接字符串，采取数组形式拼接），结构稍微复杂</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;innner&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;create&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 2. innerHTML 创建元素</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> inner = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.inner&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-comment">// 2.1 innerHTML 用拼接字符串方法</span></span><br><span class="language-javascript">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">100</span>; i++) &#123;</span><br><span class="language-javascript">            inner.<span class="hljs-property">innerHTML</span> += <span class="hljs-string">&#x27;&lt;a href=&quot;#&quot;&gt;百度&lt;/a&gt;&#x27;</span>;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-comment">// 2.2 innerHTML 用数组形式拼接</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> arr = [];</span><br><span class="language-javascript">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">100</span>; i++) &#123;</span><br><span class="language-javascript">            arr.<span class="hljs-title function_">push</span>(<span class="hljs-string">&#x27;&lt;a href=&quot;#&quot;&gt;百度&lt;/a&gt;&#x27;</span>);</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        inner.<span class="hljs-property">innerHTML</span> = arr.<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;&#x27;</span>);</span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 3.document.createElement() 创建元素</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> create = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.create&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> a = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;a&#x27;</span>);</span><br><span class="language-javascript">        create.<span class="hljs-title function_">appendChild</span>(a);</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="6、DOM核心"><a href="#6、DOM核心" class="headerlink" title="6、DOM核心"></a>6、DOM核心</h3><p>对于DOM操作，我们主要针对子元素的操作，主要有</p><p>创建、增、删、改、查、属性操作、时间操作</p><h5 id="1、创建"><a href="#1、创建" class="headerlink" title="1、创建"></a>1、创建</h5><ol><li>document.write</li><li>innerHTML</li><li>createElement</li></ol><h5 id="2、增"><a href="#2、增" class="headerlink" title="2、增"></a>2、增</h5><ol><li>appendChild</li><li>insertBefore</li></ol><h5 id="3、删"><a href="#3、删" class="headerlink" title="3、删"></a>3、删</h5><ol><li>removeChild</li></ol><h5 id="4、改"><a href="#4、改" class="headerlink" title="4、改"></a>4、改</h5><ul><li>主要修改dom的元素属性，dom元素的内容、属性、表单的值等</li></ul><ol><li>修改元素属性：src、href、title 等</li><li>修改普通元素内容：innerHTML、innerText</li><li>修改表单元素：value、type、disabled</li><li>修改元素样式：style、className</li></ol><h5 id="5、查"><a href="#5、查" class="headerlink" title="5、查"></a>5、查</h5><p>主要获取查询dom的元素<br>DOM提供的API方法：getElementById、getElementsByTagName (古老用法，不推荐)<br>H5提供的新方法：querySelector、querySelectorAll (提倡)<br>利用节点操作获取元素：父(parentNode)、子(children)、兄(previousElementSibling、nextElementSibling) 提倡</p><h5 id="6、属性操作"><a href="#6、属性操作" class="headerlink" title="6、属性操作"></a>6、属性操作</h5><ul><li>主要针对于自定义属性</li></ul><ol><li>setAttribute：设置dom的属性值</li><li>getAttribute：得到dom的属性值</li><li>removeAttribute：移除属性</li></ol><h5 id="7、事件操作"><a href="#7、事件操作" class="headerlink" title="7、事件操作"></a>7、事件操作</h5><p><img src="/img/dom-bom/shijian.png" alt="image"></p><h3 id="7、事件高级"><a href="#7、事件高级" class="headerlink" title="7、事件高级"></a>7、事件高级</h3><h4 id="1、注册事件"><a href="#1、注册事件" class="headerlink" title="1、注册事件"></a>1、注册事件</h4><p>给元素添加事件，称为注册事件或者绑定事件。</p><p>注册事件有两种方式：<strong>传统方式</strong>和<strong>方法监听注册方式</strong></p><table><thead><tr><th>传统注册方式</th><th>方法监听注册方式</th></tr></thead><tbody><tr><td>利用on开头的事件onlick</td><td>w3c 标准推荐方式</td></tr><tr><td>&lt;button onclick &#x3D; “alert(“hi”)”&gt;</button></td><td>addEventListener() 它是一个方法</td></tr><tr><td>btn.onclick &#x3D; function() {}</td><td>IE9 之前的 IE 不支持此方法，可使用 attachEvent() 代替</td></tr><tr><td>特点：注册事件的<strong>唯一性</strong></td><td>特点：同一个元素同一个事件可以注册多个监听器</td></tr><tr><td>同一个元素同一个事件只能设置一个处理函数，最后注册的处理函数将会覆盖前面注册的处理函数</td><td>按注册顺序依次执行</td></tr></tbody></table><h5 id="addEventListener事件监听方式"><a href="#addEventListener事件监听方式" class="headerlink" title="addEventListener事件监听方式"></a>addEventListener事件监听方式</h5><ul><li><code>eventTarget.addEventListener()</code>方法将指定的监听器注册到 eventTarget（目标对象）上</li><li>当该对象触发指定的事件时，就会执行事件处理函数</li></ul><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">eventTarget.add<span class="hljs-constructor">EventListener(<span class="hljs-params">type</span>,<span class="hljs-params">listener</span>[,<span class="hljs-params">useCapture</span>])</span><br></code></pre></td></tr></table></figure><p>该方法接收三个参数：</p><ul><li><code>type</code>:事件类型字符串，比如click,mouseover,注意这里不要带on</li><li><code>listener</code>：事件处理函数，事件发生时，会调用该监听函数</li><li><code>useCapture</code>：可选参数，是一个布尔值，默认是 false。</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>传统注册事件<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>方法监听注册事件<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>ie9 attachEvent<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> btns = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;button&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-comment">// 1. 传统方式注册事件</span></span><br><span class="language-javascript">        btns[<span class="hljs-number">0</span>].<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;hi&#x27;</span>);</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        btns[<span class="hljs-number">0</span>].<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;hao a u&#x27;</span>);</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-comment">// 2. 事件监听注册事件 addEventListener </span></span><br><span class="language-javascript">            <span class="hljs-comment">// (1) 里面的事件类型是字符串 所以加引号 而且不带on</span></span><br><span class="language-javascript">            <span class="hljs-comment">// (2) 同一个元素 同一个事件可以添加多个侦听器（事件处理程序）</span></span><br><span class="language-javascript">        btns[<span class="hljs-number">1</span>].<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-title function_">alert</span>(<span class="hljs-number">22</span>);</span><br><span class="language-javascript">        &#125;)</span><br><span class="language-javascript">        btns[<span class="hljs-number">1</span>].<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-title function_">alert</span>(<span class="hljs-number">33</span>);</span><br><span class="language-javascript">            &#125;)</span><br><span class="language-javascript">            <span class="hljs-comment">// 3. attachEvent ie9以前的版本支持</span></span><br><span class="language-javascript">        btns[<span class="hljs-number">2</span>].<span class="hljs-title function_">attachEvent</span>(<span class="hljs-string">&#x27;onclick&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-title function_">alert</span>(<span class="hljs-number">11</span>);</span><br><span class="language-javascript">        &#125;)</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h5 id="attachEvent事件监听方式-兼容"><a href="#attachEvent事件监听方式-兼容" class="headerlink" title="attachEvent事件监听方式(兼容)"></a>attachEvent事件监听方式(兼容)</h5><ul><li><code>eventTarget.attachEvent()</code>方法将指定的监听器注册到 eventTarget（目标对象） 上</li><li>当该对象触发指定的事件时，指定的回调函数就会被执行</li></ul><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">eventTarget.attach<span class="hljs-constructor">Event(<span class="hljs-params">eventNameWithOn</span>,<span class="hljs-params">callback</span>)</span><br></code></pre></td></tr></table></figure><p>该方法接收两个参数：</p><ul><li><code>eventNameWithOn</code>：事件类型字符串，比如 onclick 、onmouseover ，这里要带 on</li><li><code>callback</code>： 事件处理函数，当目标触发事件时回调函数被调用</li><li>ie9以前的版本支持。但ie已经寄了</li></ul><h4 id="2、删除事件"><a href="#2、删除事件" class="headerlink" title="2、删除事件"></a>2、删除事件</h4><p>解绑事件</p><h5 id="1、removeEventListener删除事件方式"><a href="#1、removeEventListener删除事件方式" class="headerlink" title="1、removeEventListener删除事件方式"></a>1、removeEventListener删除事件方式</h5><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">eventTarget.remove<span class="hljs-constructor">EventListener(<span class="hljs-params">type</span>,<span class="hljs-params">listener</span>[,<span class="hljs-params">useCapture</span>])</span>;<br></code></pre></td></tr></table></figure><p>该方法接收三个参数：</p><ul><li><code>type</code>:事件类型字符串，比如click,mouseover,注意这里不要带on</li><li><code>listener</code>：事件处理函数，事件发生时，会调用该监听函数</li><li><code>useCapture</code>：可选参数，是一个布尔值，默认是 false。</li></ul><h5 id="2、detachEvent删除事件方式-兼容"><a href="#2、detachEvent删除事件方式-兼容" class="headerlink" title="2、detachEvent删除事件方式(兼容)"></a>2、detachEvent删除事件方式(兼容)</h5><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">eventTarget.detach<span class="hljs-constructor">Event(<span class="hljs-params">eventNameWithOn</span>,<span class="hljs-params">callback</span>)</span>;<br></code></pre></td></tr></table></figure><p>该方法接收两个参数：</p><ul><li><code>eventNameWithOn</code>：事件类型字符串，比如 onclick 、onmouseover ，这里要带 on</li><li><code>callback</code>： 事件处理函数，当目标触发事件时回调函数被调用</li><li>ie9以前的版本支持</li></ul><h5 id="3、传统事件删除方式"><a href="#3、传统事件删除方式" class="headerlink" title="3、传统事件删除方式"></a>3、传统事件删除方式</h5><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">eventTarget.onclick</span> = null<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>2<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>3<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> divs = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;div&#x27;</span>);</span><br><span class="language-javascript">        divs[<span class="hljs-number">0</span>].<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-title function_">alert</span>(<span class="hljs-number">11</span>);</span><br><span class="language-javascript">            <span class="hljs-comment">// 1. 传统方式删除事件</span></span><br><span class="language-javascript">            divs[<span class="hljs-number">0</span>].<span class="hljs-property">onclick</span> = <span class="hljs-literal">null</span>;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-comment">// 2.removeEventListener 删除事件</span></span><br><span class="language-javascript">        divs[<span class="hljs-number">1</span>].<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>,fn);   <span class="hljs-comment">//里面的fn不需要调用加小括号</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"></span>)&#123;</span><br><span class="language-javascript">            <span class="hljs-title function_">alert</span>(<span class="hljs-number">22</span>);</span><br><span class="language-javascript">            divs[<span class="hljs-number">1</span>].<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>,fn);</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-comment">// 3.IE9 中的删除事件方式</span></span><br><span class="language-javascript">        divs[<span class="hljs-number">2</span>].<span class="hljs-title function_">attachEvent</span>(<span class="hljs-string">&#x27;onclick&#x27;</span>,fn1);</span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn1</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-title function_">alert</span>(<span class="hljs-number">33</span>);</span><br><span class="language-javascript">            divs[<span class="hljs-number">2</span>].<span class="hljs-title function_">detachEvent</span>(<span class="hljs-string">&#x27;onclick&#x27;</span>,fn1);</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="3、DOM事件流"><a href="#3、DOM事件流" class="headerlink" title="3、DOM事件流"></a>3、DOM事件流</h4><p>事件流描述的是从页面中接收事件的顺序<br>事件发生时会在元素节点之间按照特定的顺序传播，这个传播过程即DOM事件流</p><p><img src="/img/dom-bom/shijianliu.png" alt="image"></p><p>事件冒泡： IE 最早提出，事件开始时由最具体的元素接收，然后逐级向上传播到到 DOM 最顶层节点的过程。</p><p>事件捕获： 网景最早提出，由 DOM 最顶层节点开始，然后逐级向下传播到到最具体的元素接收的过程。</p><p><strong>加深理解</strong>：</p><p>我们向水里面扔一块石头，首先它会有一个下降的过程，这个过程就可以理解为从最顶层向事件发生的最具体元素（目标点）的捕获过程；之后会产生泡泡，会在最低点（ 最具体元素）之后漂浮到水面上，这个过程相当于事件冒泡。</p><p><img src="/img/dom-bom/lijie.png" alt="image"></p><h5 id="1、捕获阶段"><a href="#1、捕获阶段" class="headerlink" title="1、捕获阶段"></a>1、捕获阶段</h5><ul><li>document -&gt; html -&gt; body -&gt; father -&gt; son</li></ul><p>两个盒子嵌套，一个父盒子一个子盒子，我们的需求是当点击父盒子时弹出 father ，当点击子盒子时弹出 son</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;father&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;son&quot;</span>&gt;</span>son盒子<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// dom 事件流 三个阶段</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 1. JS 代码中只能执行捕获或者冒泡其中的一个阶段。</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 2. onclick 和 attachEvent（ie） 只能得到冒泡阶段。</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 3. 捕获阶段 如果addEventListener 第三个参数是 true 那么则处于捕获阶段  document -&gt; html -&gt; body -&gt; father -&gt; son</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> son = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.son&#x27;</span>);</span><br><span class="language-javascript">        son.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">             <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;son&#x27;</span>);</span><br><span class="language-javascript">        &#125;, <span class="hljs-literal">true</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> father = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.father&#x27;</span>);</span><br><span class="language-javascript">        father.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;father&#x27;</span>);</span><br><span class="language-javascript">        &#125;, <span class="hljs-literal">true</span>);</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><p>这是因为捕获阶段由 DOM 最顶层节点开始，然后逐级向下传播到到最具体的元素接收</p><ul><li>document -&gt; html -&gt; body -&gt; father -&gt; son</li><li>先看 document 的事件，没有；再看 html 的事件，没有；再看 body 的事件，没有；再看 father 的事件，有就先执行；再看 son 的事件，再执行。</li></ul><h5 id="2、冒泡阶段"><a href="#2、冒泡阶段" class="headerlink" title="2、冒泡阶段"></a>2、冒泡阶段</h5><ul><li>son -&gt; father -&gt;body -&gt; html -&gt; document</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;father&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;son&quot;</span>&gt;</span>son盒子<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-comment">// 4. 冒泡阶段 如果addEventListener 第三个参数是 false 或者 省略 那么则处于冒泡阶段  son -&gt; father -&gt;body -&gt; html -&gt; document</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> son = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.son&#x27;</span>);</span><br><span class="language-javascript">        son.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;son&#x27;</span>);</span><br><span class="language-javascript">        &#125;, <span class="hljs-literal">false</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> father = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.father&#x27;</span>);</span><br><span class="language-javascript">        father.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;father&#x27;</span>);</span><br><span class="language-javascript">        &#125;, <span class="hljs-literal">false</span>);</span><br><span class="language-javascript">        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;document&#x27;</span>);</span><br><span class="language-javascript">        &#125;)</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><p>这是因为冒泡阶段开始时由最具体的元素接收，然后逐级向上传播到到 DOM 最顶层节点</p><ul><li>son -&gt; father -&gt;body -&gt; html -&gt; document</li></ul><h5 id="3、小结"><a href="#3、小结" class="headerlink" title="3、小结"></a>3、小结</h5><ul><li>JS 代码中只能执行捕获或者冒泡其中的一个阶段</li><li><code>onclick</code> 和 <code>attachEvent</code>只能得到冒泡阶段</li><li><code>addEventListener(type,listener[,useCapture])</code>第三个参数如果是 true，表示在事件捕获阶段调用事件处理程序；如果是 false (不写默认就是false),表示在事件冒泡阶段调用事件处理程序</li><li><strong>实际开发中我们很少使用事件捕获，我们更关注事件冒泡。</strong></li><li><strong>有些事件是没有冒泡的，比如 onblur、onfocus、onmouseenter、onmouseleave</strong></li></ul><h4 id="4、事件对象"><a href="#4、事件对象" class="headerlink" title="4、事件对象"></a>4、事件对象</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js">eventTarget.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) &#123;<br>   <span class="hljs-comment">// 这个 event 就是事件对象，我们还喜欢的写成 e 或者 evt </span><br>&#125; <br>eventTarget.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) &#123;<br>   <span class="hljs-comment">// 这个 event 就是事件对象，我们还喜欢的写成 e 或者 evt  </span><br>&#125;)<br></code></pre></td></tr></table></figure><ul><li>官方解释：event 对象代表事件的状态，比如键盘按键的状态、鼠标的位置、鼠标按钮的状态</li><li>简单理解：<ul><li>事件发生后，跟事件相关的一系列信息数据的集合都放到这个对象里面</li><li>这个对象就是事件对象 event，它有很多属性和方法，比如“<ul><li>谁绑定了这个事件</li><li>鼠标触发事件的话，会得到鼠标的相关信息，如鼠标位置</li><li>键盘触发事件的话，会得到键盘的相关信息，如按了哪个键</li></ul></li></ul></li><li>这个 event 是个形参，系统帮我们设定为事件对象，不需要传递实参过去</li><li>当我们注册事件时， event 对象就会被系统自动创建，并依次传递给事件监听器（事件处理函数）</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;body&gt;<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>123<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">// 事件对象</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">var</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;div&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">        div.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-comment">// console.log(e);</span></span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-comment">// console.log(window.event);</span></span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-comment">// e = e || window.event;</span></span></span><br><span class="language-javascript"><span class="language-xml">                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e);</span></span><br><span class="language-javascript"><span class="language-xml"></span></span><br><span class="language-javascript"><span class="language-xml"></span></span><br><span class="language-javascript"><span class="language-xml">            &#125;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">// 1. event 就是一个事件对象 写到我们侦听函数的 小括号里面 当形参来看</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">// 2. 事件对象只有有了事件才会存在，它是系统给我们自动创建的，不需要我们传递参数</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">// 3. 事件对象 是 我们事件的一系列相关数据的集合 跟事件相关的 比如鼠标点击里面就包含了鼠标的相关信息，鼠标坐标啊，如果是键盘事件里面就包含的键盘事件的信息 比如 判断用户按下了那个键</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">// 4. 这个事件对象我们可以自己命名 比如 event 、 evt、 e</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">// 5. 事件对象也有兼容性问题 ie678 通过 window.event 兼容性的写法  e = e || window.event;</span></span></span><br><span class="language-javascript"><span class="language-xml">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br>&lt;/body&gt;<br></code></pre></td></tr></table></figure><h5 id="1、事件对象的常见属性和方法"><a href="#1、事件对象的常见属性和方法" class="headerlink" title="1、事件对象的常见属性和方法"></a>1、事件对象的常见属性和方法</h5><p><img src="/img/dom-bom/shijianduixiang.png" alt="image"></p><p>e.target 和 this 的区别：</p><ul><li>this 是事件绑定的元素， 这个函数的调用者（绑定这个事件的元素）</li><li>e.target 是事件触发的元素。</li></ul><h5 id="2、事件对象阻止默认行为"><a href="#2、事件对象阻止默认行为" class="headerlink" title="2、事件对象阻止默认行为"></a>2、事件对象阻止默认行为</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>123<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;http://www.baidu.com&quot;</span>&gt;</span>百度<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;http://www.baidu.com&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;提交&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;sub&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 常见事件对象的属性和方法</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 1. 返回事件类型</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;div&#x27;</span>);</span><br><span class="language-javascript">        div.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, fn);</span><br><span class="language-javascript">        div.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;mouseover&#x27;</span>, fn);</span><br><span class="language-javascript">        div.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;mouseout&#x27;</span>, fn);</span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params">e</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e.<span class="hljs-property">type</span>);</span><br><span class="language-javascript"></span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-comment">// 2. 阻止默认行为（事件） 让链接不跳转 或者让提交按钮不提交</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> a = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;a&#x27;</span>);</span><br><span class="language-javascript">        a.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;</span><br><span class="language-javascript">                e.<span class="hljs-title function_">preventDefault</span>(); <span class="hljs-comment">//  dom 标准写法</span></span><br><span class="language-javascript">            &#125;)</span><br><span class="language-javascript">            <span class="hljs-comment">// 3. 传统的注册方式</span></span><br><span class="language-javascript">        a.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">// 普通浏览器 e.preventDefault();  方法</span></span><br><span class="language-javascript">            <span class="hljs-comment">// e.preventDefault();</span></span><br><span class="language-javascript">            <span class="hljs-comment">// 低版本浏览器 ie678  returnValue  属性</span></span><br><span class="language-javascript">            <span class="hljs-comment">// e.returnValue;</span></span><br><span class="language-javascript">            <span class="hljs-comment">// 我们可以利用return false 也能阻止默认行为 没有兼容性问题 特点： return 后面的代码不执行了， 而且只限于传统的注册方式</span></span><br><span class="language-javascript">            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;</span><br><span class="language-javascript">            <span class="hljs-title function_">alert</span>(<span class="hljs-number">11</span>);</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h5 id="3、阻止事件冒泡"><a href="#3、阻止事件冒泡" class="headerlink" title="3、阻止事件冒泡"></a>3、阻止事件冒泡</h5><p>事件冒泡：开始时由最具体的元素接收，然后逐级向上传播到到 DOM 最顶层节点</p><p>事件冒泡本身的特性，会带来的坏处，也会带来的好处，需要我们灵活掌握。</p><ul><li>标准写法</li></ul><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">e.stopPropagation()<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;father&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;son&quot;</span>&gt;</span>son儿子<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 常见事件对象的属性和方法</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 阻止冒泡  dom 推荐的标准 stopPropagation() </span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> son = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.son&#x27;</span>);</span><br><span class="language-javascript">        son.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;son&#x27;</span>);</span><br><span class="language-javascript">            e.<span class="hljs-title function_">stopPropagation</span>(); <span class="hljs-comment">// stop 停止  Propagation 传播</span></span><br><span class="language-javascript">            e.<span class="hljs-property">cancelBubble</span> = <span class="hljs-literal">true</span>; <span class="hljs-comment">// 非标准 cancel 取消 bubble 泡泡</span></span><br><span class="language-javascript">        &#125;, <span class="hljs-literal">false</span>);</span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> father = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.father&#x27;</span>);</span><br><span class="language-javascript">        father.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;father&#x27;</span>);</span><br><span class="language-javascript">        &#125;, <span class="hljs-literal">false</span>);</span><br><span class="language-javascript">        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;document&#x27;</span>);</span><br><span class="language-javascript">        &#125;)</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h5 id="4、事件委托"><a href="#4、事件委托" class="headerlink" title="4、事件委托"></a>4、事件委托</h5><ul><li><p>事件委托也称为事件代理，在 jQuery 里面称为事件委派</p></li><li><p>事件委托的原理</p><ul><li><strong>不是每个子节点单独设置事件监听器，而是事件监听器设置在其父节点上，然后利用冒泡原理影响设置每个子节点</strong></li></ul></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>知否知否，点我应有弹框在手！<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>知否知否，点我应有弹框在手！<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>知否知否，点我应有弹框在手！<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>知否知否，点我应有弹框在手！<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>知否知否，点我应有弹框在手！<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 事件委托的核心原理：给父节点添加侦听器， 利用事件冒泡影响每一个子节点</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> ul = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;ul&#x27;</span>);</span><br><span class="language-javascript">        ul.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">// alert(&#x27;知否知否，点我应有弹框在手！&#x27;);</span></span><br><span class="language-javascript">            <span class="hljs-comment">// e.target 这个可以得到我们点击的对象</span></span><br><span class="language-javascript">            e.<span class="hljs-property">target</span>.<span class="hljs-property">style</span>.<span class="hljs-property">backgroundColor</span> = <span class="hljs-string">&#x27;pink&#x27;</span>;</span><br><span class="language-javascript">            <span class="hljs-comment">// 点了谁，就让谁的style里面的backgroundColor颜色变为pink</span></span><br><span class="language-javascript">        &#125;)</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><p>以上案例：给 ul 注册点击事件，然后利用事件对象的 target 来找到当前点击的 li，因为点击 li，事件会冒泡到 ul 上， ul 有注册事件，就会触发事件监听器。</p><h4 id="5、鼠标事件"><a href="#5、鼠标事件" class="headerlink" title="5、鼠标事件"></a>5、鼠标事件</h4><p><img src="/img/dom-bom/mouse.png" alt="image"></p><h5 id="1、禁止鼠标右键与鼠标选中"><a href="#1、禁止鼠标右键与鼠标选中" class="headerlink" title="1、禁止鼠标右键与鼠标选中"></a>1、禁止鼠标右键与鼠标选中</h5><ul><li><p><code>contextmenu</code>主要控制应该何时显示上下文菜单，主要用于程序员取消默认的上下文菜单</p></li><li><p><code>selectstart</code> 禁止鼠标选中</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>我是一段不愿意分享的文字<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 1. contextmenu 我们可以禁用右键菜单</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;contextmenu&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;</span><br><span class="language-javascript">                e.<span class="hljs-title function_">preventDefault</span>(); <span class="hljs-comment">// 阻止默认行为</span></span><br><span class="language-javascript">            &#125;)</span><br><span class="language-javascript">            <span class="hljs-comment">// 2. 禁止选中文字 selectstart</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;selectstart&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;</span><br><span class="language-javascript">            e.<span class="hljs-title function_">preventDefault</span>();</span><br><span class="language-javascript"></span><br><span class="language-javascript">        &#125;)</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h5 id="2、鼠标事件对象"><a href="#2、鼠标事件对象" class="headerlink" title="2、鼠标事件对象"></a>2、鼠标事件对象</h5><ul><li><p><strong>event</strong>对象代表事件的状态，跟事件相关的一系列信息的集合</p></li><li><p>现阶段我们主要是用鼠标事件对象 <strong>MouseEvent</strong> 和键盘事件对象 <strong>KeyboardEvent。</strong></p></li></ul><p><img src="/img/dom-bom/shubiaoshijianduixiang.png" alt="image"></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 鼠标事件对象 MouseEvent</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">// 1. client 鼠标在可视区的x和y坐标也就是相对于可见区域，不管其他</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e.<span class="hljs-property">clientX</span>);</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e.<span class="hljs-property">clientY</span>);</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;---------------------&#x27;</span>);</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 2. page 鼠标在页面文档的x和y坐标</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e.<span class="hljs-property">pageX</span>);</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e.<span class="hljs-property">pageY</span>);</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;---------------------&#x27;</span>);</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 3. screen 鼠标在电脑屏幕的x和y坐标</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e.<span class="hljs-property">screenX</span>);</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e.<span class="hljs-property">screenY</span>);</span><br><span class="language-javascript"></span><br><span class="language-javascript">        &#125;)</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="6、键盘事件"><a href="#6、键盘事件" class="headerlink" title="6、键盘事件"></a>6、键盘事件</h4><table><thead><tr><th>键盘事件对象 <strong>属性</strong></th><th>说明</th></tr></thead><tbody><tr><td>keyCode</td><td>返回该<strong>键</strong>值的ASCII值</td></tr></tbody></table><ul><li><p><code>onkeydown</code>和 <code>onkeyup</code> 不区分字母大小写，<code>onkeypress</code> 区分字母大小写。</p></li><li><p>我们实际开发中，我们更多的使用keydown和keyup， 它能识别所有的键（包括功能键）</p></li><li><p><code>Keypress</code> 不识别功能键，但是<code>keyCode</code>属性能区分大小写，返回不同的ASCII值</p></li></ul><p><img src="/img/dom-bom/jianpanshijian.png" alt="image"></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 键盘事件对象中的keyCode属性可以得到相应键的ASCII码值</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 1. 我们的keyup 和keydown事件不区分字母大小写  a 和 A 得到的都是65</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 2. 我们的keypress 事件 区分字母大小写  a  97 和 A 得到的是65</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;keyup&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;up:&#x27;</span> + e.<span class="hljs-property">keyCode</span>);</span><br><span class="language-javascript">            <span class="hljs-comment">// 我们可以利用keycode返回的ASCII码值来判断用户按下了那个键</span></span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (e.<span class="hljs-property">keyCode</span> === <span class="hljs-number">65</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;您按下的a键&#x27;</span>);</span><br><span class="language-javascript">            &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;您没有按下a键&#x27;</span>)</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">        &#125;)</span><br><span class="language-javascript">        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;keypress&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;press:&#x27;</span> + e.<span class="hljs-property">keyCode</span>);</span><br><span class="language-javascript">        &#125;)</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="BOM"><a href="#BOM" class="headerlink" title="BOM"></a>BOM</h2><h3 id="1、简介-1"><a href="#1、简介-1" class="headerlink" title="1、简介"></a>1、简介</h3><ul><li><p>BOM &#x3D; Browser Object Model 👉浏览器对象模型</p></li><li><p>它提供了独立于内容而与浏览器窗口进行交互的对象，其核心对象是 window</p></li><li><p>BOM 由一系列相关的对象构成，并且每个对象都提供了很多方法与属性</p></li><li><p>BOM 缺乏标准，JavaScript 语法的标准化组织是 ECMA, DOM 的标准化组织是 W3C, BOM最初是Netscape 浏览器标准的一部分</p></li></ul><table><thead><tr><th>DOM</th><th>BOM</th></tr></thead><tbody><tr><td>文档对象模型</td><td>浏览器对象模型</td></tr><tr><td>DOM 就是把 文档 当作一个对象来看待</td><td>把 浏览器当作一个对象来看待</td></tr><tr><td>DOM 的顶级对象是 document</td><td>BOM 的顶级对象是 window</td></tr><tr><td>DOM 主要学习的是操作页面元素</td><td>BOM 学习的是浏览器窗口交互的一些对象</td></tr><tr><td>DOM 是 W3C 标准规范</td><td>BOM 是浏览器厂商在各自浏览器上定义的，兼容性较差</td></tr></tbody></table><h4 id="1、BOM的构成"><a href="#1、BOM的构成" class="headerlink" title="1、BOM的构成"></a>1、BOM的构成</h4><p><img src="/img/dom-bom/bom.png" alt="image"></p><ul><li><p>BOM 比 DOM 更大。它包含 DOM。</p></li><li><p>window 对象是浏览器的顶级对象，它具有双重角色</p></li><li><p>它是 JS 访问浏览器窗口的一个接口</p></li><li><p>它是一个<strong>全局对象</strong>。定义在全局作用域中的变量、函数都会变成 window 对象的属性和方法</p></li><li><p>在调用的时候可以省略 window，前面学习的对话框都属于 window 对象方法，如 <code>alert()、prompt()</code>等。</p></li><li><p><strong>注意</strong>：window下的一个特殊属性 window.name</p></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 定义在全局作用域中的变量会变成window对象的属性</span><br><span class="hljs-keyword">var</span> num = <span class="hljs-number">10</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">num</span>);<br><span class="hljs-comment">// 10</span><br><br><span class="hljs-comment">// 定义在全局作用域中的函数会变成window对象的方法</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">11</span>);<br>&#125;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">fn</span>();<br><span class="hljs-comment">// 11</span><br><br><span class="hljs-keyword">var</span> name = <span class="hljs-number">10</span>;  <span class="hljs-comment">//不要用这个name变量,window下有一个特殊属性window.name</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">num</span>);<br></code></pre></td></tr></table></figure><h3 id="2、window对象的常见事件"><a href="#2、window对象的常见事件" class="headerlink" title="2、window对象的常见事件"></a>2、window对象的常见事件</h3><h4 id="1、窗口加载事件"><a href="#1、窗口加载事件" class="headerlink" title="1、窗口加载事件"></a>1、窗口加载事件</h4><p><code>window.onload</code>是窗口（页面）加载事件，当文档内容完全加载完成会触发该事件（包括图像，脚本文件，CSS文件等），就调用的处理函数</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">window</span>.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>    <br>&#125;;<br><br><span class="hljs-comment">// 或者</span><br><span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;load&quot;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;&#125;);<br></code></pre></td></tr></table></figure><ul><li><p>有了<code>window.onload</code>就可以把JS代码写到页面元素的上方</p></li><li><p>因为<code>onload</code>是等页面内容全部加载完毕，再去执行处理函数</p></li><li><p><code>window.onload</code> 传统注册事件方式，只能写一次</p></li><li><p>如果有多个，会以最后一个<code>window.onload</code>为准</p></li><li><p><strong>如果使用addEventListener 则没有限制</strong></p></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;DOMContentLoaded&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;&#125;)<br></code></pre></td></tr></table></figure><p>接收两个参数：</p><ul><li><p>DOMCountentLoaded事件触发时，仅当DOM加载完成，不包括样式表，图片，flash等等</p></li><li><p>如果页面的图片很多的话, 从用户访问到onload触发可能需要较长的时间</p></li><li><p>交互效果就不能实现，必然影响用户的体验，此时用 <code>DOMContentLoaded</code>事件比较合适。</p></li></ul><p><strong>二者区别</strong></p><ul><li><code>load</code>等页面内容全部加载完毕，包括页面dom元素，图片，flash，css等</li><li><code>DOMContentLoaded</code> 是DOM加载完毕，不包含图片 flash css 等就可以执行，加载速度比load更快一些</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-comment">// window.onload = function() &#123;</span></span><br><span class="language-javascript">    <span class="hljs-comment">//     var btn = document.querySelector(&#x27;button&#x27;);</span></span><br><span class="language-javascript">    <span class="hljs-comment">//     btn.addEventListener(&#x27;click&#x27;, function() &#123;</span></span><br><span class="language-javascript">    <span class="hljs-comment">//         alert(&#x27;点击我&#x27;);</span></span><br><span class="language-javascript">    <span class="hljs-comment">//     &#125;)</span></span><br><span class="language-javascript">    <span class="hljs-comment">// &#125;</span></span><br><span class="language-javascript">    <span class="hljs-comment">// window.onload = function() &#123;</span></span><br><span class="language-javascript">    <span class="hljs-comment">//     alert(22);</span></span><br><span class="language-javascript">    <span class="hljs-comment">// &#125;</span></span><br><span class="language-javascript">    </span><br><span class="language-javascript">    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;load&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;button&#x27;</span>);</span><br><span class="language-javascript">        btn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;点击我&#x27;</span>);</span><br><span class="language-javascript">        &#125;)</span><br><span class="language-javascript">    &#125;)</span><br><span class="language-javascript">    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;load&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-title function_">alert</span>(<span class="hljs-number">22</span>);</span><br><span class="language-javascript">    &#125;)</span><br><span class="language-javascript">    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;DOMContentLoaded&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-title function_">alert</span>(<span class="hljs-number">33</span>);</span><br><span class="language-javascript">        &#125;)</span><br><span class="language-javascript">        <span class="hljs-comment">// load 等页面内容全部加载完毕，包含页面dom元素 图片 flash  css 等等</span></span><br><span class="language-javascript">        <span class="hljs-comment">// DOMContentLoaded 是DOM 加载完毕，不包含图片 falsh css 等就可以执行 加载速度比 load更快一些</span></span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="2、调整窗口大小事件"><a href="#2、调整窗口大小事件" class="headerlink" title="2、调整窗口大小事件"></a>2、调整窗口大小事件</h4><p><code>window.onresize</code> 是调整窗口大小加载事件，当触发时就调用的处理函数</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">window</span>.<span class="hljs-property">onresize</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;&#125;<br><br><span class="hljs-comment">// 或者</span><br><span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;resize&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;&#125;);<br></code></pre></td></tr></table></figure><ul><li>只要窗口大小发生像素变化，就会触发这个事件</li><li>我们经常利用这个事件完成响应式布局。<code>window.innerWidth</code> 当前屏幕的宽度</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;load&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">var</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;div&#x27;</span>);</span><br><span class="language-javascript">            <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;resize&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">innerWidth</span>);</span><br><span class="language-javascript"></span><br><span class="language-javascript">                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;变化了&#x27;</span>);</span><br><span class="language-javascript">                <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">window</span>.<span class="hljs-property">innerWidth</span> &lt;= <span class="hljs-number">800</span>) &#123;</span><br><span class="language-javascript">                    div.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">&#x27;none&#x27;</span>; <span class="hljs-comment">//隐藏</span></span><br><span class="language-javascript">                &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                    div.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">&#x27;block&#x27;</span>;<span class="hljs-comment">//显示</span></span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            &#125;)</span><br><span class="language-javascript">        &#125;)</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="3、定时器"><a href="#3、定时器" class="headerlink" title="3、定时器"></a>3、定时器</h3><p>window 对象给我们提供了两个定时器</p><ul><li><code>setTimeout()</code></li><li><code>setInterval()</code></li></ul><h5 id="1、setTimeout-定时器"><a href="#1、setTimeout-定时器" class="headerlink" title="1、setTimeout()定时器"></a>1、setTimeout()定时器</h5><p><code>setTimeout()</code>方法用于设置一个定时器，该定时器在定时器到期后执行调用函数。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">window</span>.<span class="hljs-built_in">setTimeout</span>(调用函数,[延迟的毫秒数]);<br></code></pre></td></tr></table></figure><p><strong>注意</strong>：</p><ul><li><p><code>window</code>可以省略</p></li><li><p>这个调用函数</p><ul><li>可以直接写函数</li><li>或者写函数名</li><li>或者采取字符串 <strong>‘函数名()’</strong> （不推荐）</li></ul></li><li><p>延迟的毫秒数省略默认是0，如果写，必须是毫秒</p></li><li><p>因为定时器可能有很多，所以我们经常给定时器赋值一个标识符</p></li><li><p><code>setTimeout()</code> 这个调用函数我们也称为<strong>回调函数</strong> callback</p></li><li><p>普通函数是按照代码顺序直接调用，而这个函数，需要等待事件，事件到了才会去调用这个函数，因此称为回调函数。</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 1. setTimeout </span></span><br><span class="language-javascript">        <span class="hljs-comment">// 语法规范：  window.setTimeout(调用函数, 延时时间);</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 1. 这个window在调用的时候可以省略</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 2. 这个延时时间单位是毫秒 但是可以省略，如果省略默认的是0</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 3. 这个调用函数可以直接写函数 还可以写 函数名 还有一个写法 &#x27;函数名()&#x27;</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 4. 页面中可能有很多的定时器，我们经常给定时器加标识符 （名字)</span></span><br><span class="language-javascript">        <span class="hljs-comment">// setTimeout(function() &#123;</span></span><br><span class="language-javascript">        <span class="hljs-comment">//     console.log(&#x27;时间到了&#x27;);</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// &#125;, 2000);</span></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">callback</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;爆炸了&#x27;</span>);</span><br><span class="language-javascript"></span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> timer1 = <span class="hljs-built_in">setTimeout</span>(callback, <span class="hljs-number">3000</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> timer2 = <span class="hljs-built_in">setTimeout</span>(callback, <span class="hljs-number">5000</span>);</span><br><span class="language-javascript">        <span class="hljs-comment">// setTimeout(&#x27;callback()&#x27;, 3000); // 我们不提倡这个写法</span></span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h5 id="2、clearTimeout-停止定时器"><a href="#2、clearTimeout-停止定时器" class="headerlink" title="2、clearTimeout()停止定时器"></a>2、clearTimeout()停止定时器</h5><ul><li><code>clearTimeout()</code>方法取消了先前通过调用 <code>setTimeout()</code>建立的定时器</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">window</span>.<span class="hljs-built_in">clearTimeout</span>(timeoutID)<br></code></pre></td></tr></table></figure><p><strong>注意</strong>：</p><ul><li><code>window</code>可以省略</li><li>里面的参数就是定时器的标识符</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>点击停止定时器<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;button&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> timer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;爆炸了&#x27;</span>);</span><br><span class="language-javascript">        &#125;, <span class="hljs-number">5000</span>);</span><br><span class="language-javascript">        btn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-built_in">clearTimeout</span>(timer);</span><br><span class="language-javascript">        &#125;)</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h5 id="3、setInterval-定时器"><a href="#3、setInterval-定时器" class="headerlink" title="3、setInterval()定时器"></a>3、setInterval()定时器</h5><ul><li><code>setInterval()</code>方法重复调用一个函数，每隔这个时间，就去调用一次回调函数</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">window</span>.<span class="hljs-built_in">setInterval</span>(回调函数,[间隔的毫秒数]);<br></code></pre></td></tr></table></figure><ul><li><p><code>window</code>可以省略</p></li><li><p>这个回调函数:</p><ul><li>可以直接写函数</li><li>或者写函数名</li><li>或者采取字符 ‘函数名()’</li></ul></li><li><p>第一次执行也是间隔毫秒数之后执行，之后每隔毫秒数就执行一次</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 1. setInterval </span></span><br><span class="language-javascript">        <span class="hljs-comment">// 语法规范：  window.setInterval(调用函数, 延时时间);</span></span><br><span class="language-javascript">        <span class="hljs-built_in">setInterval</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;继续输出&#x27;</span>);</span><br><span class="language-javascript"></span><br><span class="language-javascript">        &#125;, <span class="hljs-number">1000</span>);</span><br><span class="language-javascript">        <span class="hljs-comment">// 2. setTimeout  延时时间到了，就去调用这个回调函数，只调用一次 就结束了这个定时器</span></span><br><span class="language-javascript">        <span class="hljs-comment">// 3. setInterval  每隔这个延时时间，就去调用这个回调函数，会调用很多次，重复调用这个函数</span></span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h5 id="4、clearInterval-停止定时器"><a href="#4、clearInterval-停止定时器" class="headerlink" title="4、clearInterval()停止定时器"></a>4、clearInterval()停止定时器</h5><ul><li><code>clearInterval ( )</code> 方法取消了先前通过调用 <code>setInterval()</code> 建立的定时器</li></ul><p><strong>注意：</strong></p><ul><li><code>window</code>可以省略</li><li>里面的参数就是定时器的标识符</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;begin&quot;</span>&gt;</span>开启定时器<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;stop&quot;</span>&gt;</span>停止定时器<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> begin = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.begin&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> stop = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.stop&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> timer = <span class="hljs-literal">null</span>; <span class="hljs-comment">// 全局变量  null是一个空对象</span></span><br><span class="language-javascript">        begin.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            timer = <span class="hljs-built_in">setInterval</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;ni hao ma&#x27;</span>);</span><br><span class="language-javascript"></span><br><span class="language-javascript">            &#125;, <span class="hljs-number">1000</span>);</span><br><span class="language-javascript">        &#125;)</span><br><span class="language-javascript">        stop.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-built_in">clearInterval</span>(timer);</span><br><span class="language-javascript">        &#125;)</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h5 id="5、this指向"><a href="#5、this指向" class="headerlink" title="5、this指向"></a>5、this指向</h5><ul><li><code>this</code>的指向在函数定义的时候是确定不了的，只有函数执行的时候才能确定<code>this</code>到底指向谁</li></ul><p><strong>this指向：</strong></p><ul><li>全局作用域或者普通函数中<code>this</code>指向全局对象<code>window</code>(注意定时器里面的this指向window)</li><li>方法调用中谁调用<code>this</code>指向谁</li><li>构造函数中<code>this</code>指向构造函数实例</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>点击<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// this 指向问题 一般情况下this的最终指向的是那个调用它的对象</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// 1. 全局作用域或者普通函数中this指向全局对象window（ 注意定时器里面的this指向window）</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);</span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);</span><br><span class="language-javascript"></span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">fn</span>();</span><br><span class="language-javascript">        <span class="hljs-variable language_">window</span>.<span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);</span><br><span class="language-javascript"></span><br><span class="language-javascript">        &#125;, <span class="hljs-number">1000</span>);</span><br><span class="language-javascript">        <span class="hljs-comment">// 2. 方法调用中谁调用this指向谁</span></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> o = &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">sayHi</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>); <span class="hljs-comment">// this指向的是 o 这个对象</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        o.<span class="hljs-title function_">sayHi</span>();</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;button&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-comment">// btn.onclick = function() &#123;</span></span><br><span class="language-javascript">        <span class="hljs-comment">//     console.log(this); // this指向的是btn这个按钮对象</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-comment">// &#125;</span></span><br><span class="language-javascript">        btn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>); <span class="hljs-comment">// this指向的是btn这个按钮对象</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">            &#125;)</span><br><span class="language-javascript">            <span class="hljs-comment">// 3. 构造函数中this指向构造函数的实例</span></span><br><span class="language-javascript">        <span class="hljs-keyword">function</span> <span class="hljs-title function_">Fun</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>); <span class="hljs-comment">// this 指向的是fun 实例对象</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> fun = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Fun</span>();</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="4、JS指向机制"><a href="#4、JS指向机制" class="headerlink" title="4、JS指向机制"></a>4、JS指向机制</h3><h4 id="1、Js是单线程"><a href="#1、Js是单线程" class="headerlink" title="1、Js是单线程"></a>1、Js是单线程</h4><ul><li>JavaScript 语言的一大特点就是单线程，也就是说，同一个时间只能做一件事。这是因为 Javascript 这门脚本语言诞生的使命所致——JavaScript 是为处理页面中用户的交互，以及操作 DOM 而诞生的。比如我们对某个 DOM 元素进行添加和删除操作，不能同时进行。 应该先进行添加，之后再删除。</li><li>单线程就意味着，所有任务需要排队，前一个任务结束，才会执行后一个任务。这样所导致的问题是： 如果 JS 执行的时间过长，这样就会造成页面的渲染不连贯，导致页面渲染加载阻塞的感觉。</li></ul><h4 id="2、同步和异步"><a href="#2、同步和异步" class="headerlink" title="2、同步和异步"></a>2、同步和异步</h4><ul><li><p>为了解决这个问题，利用多核 CPU 的计算能力，HTML5 提出 Web Worker 标准，允许 JavaScript 脚本创建多个线程</p></li><li><p>于是，JS 中出现了同步和异步。</p></li><li><p>同步：前一个任务结束后再执行后一个任务</p><ul><li>同步任务都在主线程上执行，形成一个 <strong>执行栈</strong></li></ul></li><li><p>异步：在做这件事的同时，你还可以去处理其他事情</p><ul><li>JS中的异步是通过回调函数实现的</li><li>异步任务有以下三种类型<ul><li>普通事件，如<code>click</code>,<code>resize</code>等</li><li>资源加载，如<code>load</code>,<code>error</code>等</li><li>定时器，包括<code>setInterval</code>,<code>setTimeout</code>等</li></ul></li></ul></li><li><p>异步任务相关回调函数添加到任务队列（也称消息队列）中</p></li></ul><p><img src="/img/dom-bom/tongbu.png" alt="image"></p><p><strong>执行机制</strong></p><ol><li>先执行执行栈中的<strong>同步</strong>任务</li><li><strong>异步任务</strong>(回调函数)放入任务队列中</li><li>一旦执行栈中的所有同步任务执行完毕，系统就会<strong>按次序读取</strong>任务队列中的异步任务，于是被读取的异步任务<strong>结束等待状态</strong>，<strong>进入执行栈</strong>，开始执行</li></ol><p><img src="/img/dom-bom/jizhi.png" alt="image"></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">1</span>);<br><span class="hljs-variable language_">document</span>.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;click&#x27;</span>);<br>&#125;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">2</span>);<br><span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">3</span>)<br>&#125;, <span class="hljs-number">3000</span>)<br></code></pre></td></tr></table></figure><p>执行结果为1、2、3，如果点击了屏幕，那么久根据时间关系，在3秒内点击就click显示在3之前，在3秒后点击click就显示在3之后</p><p><img src="/img/dom-bom/zhixing.png" alt="image"></p><p>同步任务放在执行栈中执行，异步任务由异步进程处理放到任务队列中，执行栈中的任务执行完毕会去任务队列中查看是否有异步任务执行，由于主线程不断的重复获得任务、执行任务、再获取任务、再执行，所以这种机制被称为<strong>事件循环</strong>（ event loop）。</p><h3 id="5、location对象"><a href="#5、location对象" class="headerlink" title="5、location对象"></a>5、location对象</h3><ul><li>window 对象给我们提供了一个 <code>location</code>属性用于获取或者设置窗体的url，并且可以解析url。因为这个属性返回的是一个对象，所以我们将这个属性也称为 location 对象。</li></ul><h4 id="1、url"><a href="#1、url" class="headerlink" title="1、url"></a>1、url</h4><p>统一资源定位符（uniform resouce locator，URL）是互联网上标准资源的地址。互联网上的每个文件都有一个唯一的 URL，它包含的信息指出文件的位置以及浏览器应该怎么处理它。</p><p>url 的一般语法格式为：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">protocol</span>:<span class="hljs-comment">//host[:port]/path/[?query]#fragment</span><br><br><span class="hljs-attr">http</span>:<span class="hljs-comment">//www.itcast.cn/index.html?name=andy&amp;age=18#link</span><br></code></pre></td></tr></table></figure><table><thead><tr><th>组成</th><th>说明</th></tr></thead><tbody><tr><td>protocol</td><td>通信协议 常用的http,ftp,maito等</td></tr><tr><td>host</td><td>主机(域名) <a href="http://www.itheima.com/">www.itheima.com</a></td></tr><tr><td>port</td><td>端口号，可选</td></tr><tr><td>path</td><td>路径 由零或多个<code>&#39;/&#39;</code>符号隔开的字符串</td></tr><tr><td>query</td><td>参数 以键值对的形式，通过<code>&amp;</code>符号分隔开来</td></tr><tr><td>fragment</td><td>片段 <code>#</code>后面内容 常见于链接 锚点</td></tr></tbody></table><h4 id="2、location对象属性"><a href="#2、location对象属性" class="headerlink" title="2、location对象属性"></a>2、location对象属性</h4><table><thead><tr><th>location对象属性</th><th>返回值</th></tr></thead><tbody><tr><td><strong>location.href</strong></td><td>获取或者设置整个URL</td></tr><tr><td>location.host</td><td>返回主机（域名）<a href="http://www.baidu.com/">www.baidu.com</a></td></tr><tr><td>location.port</td><td>返回端口号，如果未写返回空字符串</td></tr><tr><td>location.pathname</td><td>返回路径</td></tr><tr><td><strong>location.search</strong></td><td>返回参数</td></tr><tr><td>location.hash</td><td>返回片段 #后面内容常见于链接 锚点</td></tr></tbody></table><p><strong>5s之后跳转页面</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>点击<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;button&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;div&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> timer = <span class="hljs-number">5</span>;</span><br><span class="language-javascript">        <span class="hljs-built_in">setInterval</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (timer == <span class="hljs-number">0</span>) &#123;</span><br><span class="language-javascript">                location.<span class="hljs-property">href</span> = <span class="hljs-string">&#x27;http://www.itcast.cn&#x27;</span>;</span><br><span class="language-javascript">            &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                div.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">&#x27;您将在&#x27;</span> + timer + <span class="hljs-string">&#x27;秒钟之后跳转到首页&#x27;</span>;</span><br><span class="language-javascript">                timer--;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">        &#125;, <span class="hljs-number">1000</span>);</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="3、location对象方法"><a href="#3、location对象方法" class="headerlink" title="3、location对象方法"></a>3、location对象方法</h4><table><thead><tr><th>location对象方法</th><th>返回值</th></tr></thead><tbody><tr><td>location.assign()</td><td>跟href一样，可以跳转页面（也称为重定向页面）</td></tr><tr><td>location.replace()</td><td>替换当前页面，因为不记录历史，所以不能后退页面</td></tr><tr><td>location.reload()</td><td>重新加载页面，相当于刷新按钮或者 f5 ，如果参数为true 强制刷新 ctrl+f5</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>点击<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;button&#x27;</span>);</span><br><span class="language-javascript">        btn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">// 记录浏览历史，所以可以实现后退功能</span></span><br><span class="language-javascript">            <span class="hljs-comment">// location.assign(&#x27;http://www.itcast.cn&#x27;);</span></span><br><span class="language-javascript">            <span class="hljs-comment">// 不记录浏览历史，所以不可以实现后退功能</span></span><br><span class="language-javascript">            <span class="hljs-comment">// location.replace(&#x27;http://www.itcast.cn&#x27;);</span></span><br><span class="language-javascript">            location.<span class="hljs-title function_">reload</span>(<span class="hljs-literal">true</span>);</span><br><span class="language-javascript">        &#125;)</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="6、navigator对象"><a href="#6、navigator对象" class="headerlink" title="6、navigator对象"></a>6、navigator对象</h3><ul><li>navigator 对象包含有关浏览器的信息，它有很多属性</li><li>我们常用的是<code>userAgent</code>,该属性可以返回由客户机发送服务器的<code>user-agent</code>头部的值</li></ul><p>下面前端代码可以判断用户是用哪个终端打开页面的，如果是用 PC 打开的，我们就跳转到 PC 端的页面，如果是用手机打开的，就跳转到手机端页面</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">if</span>((navigator.<span class="hljs-property">userAgent</span>.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i</span>))) &#123;<br>    <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span> = <span class="hljs-string">&quot;&quot;</span>;     <span class="hljs-comment">//手机</span><br> &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span> = <span class="hljs-string">&quot;&quot;</span>;     <span class="hljs-comment">//电脑</span><br> &#125;<br></code></pre></td></tr></table></figure><h3 id="7、history对象"><a href="#7、history对象" class="headerlink" title="7、history对象"></a>7、history对象</h3><ul><li>window 对象给我们提供了一个 history 对象，与浏览器历史记录进行交互</li><li>该对象包含用户（在浏览器窗口中）访问过的 URL。</li></ul><table><thead><tr><th>history对象方法</th><th>作用</th></tr></thead><tbody><tr><td>back()</td><td>可以后退功能</td></tr><tr><td>forward()</td><td>前进功能</td></tr><tr><td>go(参数)</td><td>前进后退功能，参数如果是 1 前进1个页面 如果是 -1 后退1个页面</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;list.html&quot;</span>&gt;</span>点击我去往列表页<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>前进<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;button&#x27;</span>);</span><br><span class="language-javascript">        btn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">// history.forward();</span></span><br><span class="language-javascript">            history.<span class="hljs-title function_">go</span>(<span class="hljs-number">1</span>);</span><br><span class="language-javascript">        &#125;)</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>javascript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>javascript</title>
    <link href="/2023/03/22/%E7%AC%94%E8%AE%B0/javascript/"/>
    <url>/2023/03/22/%E7%AC%94%E8%AE%B0/javascript/</url>
    
    <content type="html"><![CDATA[<h1 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a>JavaScript</h1><h3 id="JS组成"><a href="#JS组成" class="headerlink" title="JS组成"></a>JS组成</h3><ul><li>ECMAScript——JavaScript语法</li><li>DOM——页面文档对象模型</li><li>BOM——浏览器对象模型</li></ul><h3 id="书写位置"><a href="#书写位置" class="headerlink" title="书写位置"></a>书写位置</h3><ol><li><p>行内式</p><p>直接写在元素的内部</p><p>很少使用，比较少见，一般在特殊情况下使用</p></li><li><p>内嵌式</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">写在<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>内部<br></code></pre></td></tr></table></figure><p>最常用的写法</p></li><li><p>外部式</p><p>和css一样，写在一个js文件中，通过</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;文件名&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><p>引用，一般适用于代码量较大的情况下</p></li></ol><h2 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h2><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs actionscript"><span class="hljs-comment">//  单行注释   ctrl+/</span><br><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">    多行注释   shift + alt + a</span><br><span class="hljs-comment">*/</span><br></code></pre></td></tr></table></figure><h2 id="输入和输出"><a href="#输入和输出" class="headerlink" title="输入和输出"></a>输入和输出</h2><h3 id="alert-msg"><a href="#alert-msg" class="headerlink" title="alert(msg)"></a>alert(msg)</h3><p>控制浏览器弹出一个警告框</p><h3 id="console-log-msg"><a href="#console-log-msg" class="headerlink" title="console.log(msg)"></a>console.log(msg)</h3><p>向控制台输出一个内容</p><h3 id="prompt-info"><a href="#prompt-info" class="headerlink" title="prompt(info)"></a>prompt(info)</h3><p>浏览器弹出输入框，用户可以输入</p><p>获得的数据是字符串类型</p><h2 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h2><p>存放数据的容器<br>内存里的一块空间，用于存放数据</p><h3 id="声明变量与赋值"><a href="#声明变量与赋值" class="headerlink" title="声明变量与赋值"></a>声明变量与赋值</h3><p>基本上都是 <strong>var</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> age;  <span class="hljs-comment">//声明了age变量</span><br>age = <span class="hljs-number">10</span>;  <span class="hljs-comment">//age变量赋值</span><br>or<br><span class="hljs-keyword">var</span> age = <span class="hljs-number">10</span>； <span class="hljs-comment">//声明并赋值（变量的初始化）</span><br></code></pre></td></tr></table></figure><h3 id="使用变量为存储用户输入的信息"><a href="#使用变量为存储用户输入的信息" class="headerlink" title="使用变量为存储用户输入的信息"></a>使用变量为存储用户输入的信息</h3><p>先获得输入框内用户输入的信息</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> myName = <span class="hljs-title function_">prompt</span>(<span class="hljs-string">&#x27;请输入您的名字：&#x27;</span>);<br></code></pre></td></tr></table></figure><p>输出用户输入的信息</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title function_">alert</span>(myName + <span class="hljs-string">&#x27;，你好！&#x27;</span>);<br></code></pre></td></tr></table></figure><p><strong>注意</strong></p><ol><li>更新变量后原有值会给覆盖</li><li>可同时声明多个变量，多个变量名之间使用英文逗号隔开</li><li>声明不赋值，输出<strong>undefined</strong> 即未定义</li><li>不声明不赋值，使用报错</li><li>赋值不声明，可以使用，但不提倡</li></ol><h3 id="命名规范"><a href="#命名规范" class="headerlink" title="命名规范"></a>命名规范</h3><ul><li>由字母、数字、下划线、美元符号组成</li><li>严格区分大小写，var app 和 var APP 是两个不同的变量</li><li>不能以数字开头，18age是错误的</li><li>不能以关键字、保留字，比如：var、for、while</li><li>变量名必须有意义，</li><li>遵守驼峰命名发，首字母小写，后面单词的首字母需要大写，myFirstName</li></ul><h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2><p>不同数据占用内存的空间是不同的，把数据分为存储空间不同的数据，以充分利用存储空间，这便是不同的数据类型</p><p><strong>JS 的变量数据类型是只有在程序运行过程中，根据等号右边的值来确定的</strong></p><p><strong>JS 是动态语言，这意味着不用提前声明变量的类型，也就是相同的变量可用作不同的类型</strong></p><p>简单数据类型（基本数据类型）：Number、Boolean、String、Undefined、Null</p><h3 id="Number"><a href="#Number" class="headerlink" title="Number"></a>Number</h3><h4 id="数字型进制"><a href="#数字型进制" class="headerlink" title="数字型进制"></a>数字型进制</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//输出时默认转换为十进制</span><br><span class="hljs-keyword">var</span> num1 = <span class="hljs-number">010</span>  <span class="hljs-comment">//数字8，数字前面加0，表示八进制</span><br><span class="hljs-keyword">var</span> num2 = <span class="hljs-number">0xa</span>  <span class="hljs-comment">//数字10，数字前面加0x，表示十六进制（0~f）</span><br></code></pre></td></tr></table></figure><h4 id="数字型范围（最大值-amp-最小值）"><a href="#数字型范围（最大值-amp-最小值）" class="headerlink" title="数字型范围（最大值&amp;最小值）"></a>数字型范围（最大值&amp;最小值）</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Number</span>.<span class="hljs-property">MAX_VALUE</span>);  <span class="hljs-comment">//输出最大值</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Number</span>.<span class="hljs-property">MIN_VALUE</span>);  <span class="hljs-comment">//输出最小值</span><br></code></pre></td></tr></table></figure><h4 id="特殊值"><a href="#特殊值" class="headerlink" title="特殊值"></a>特殊值</h4><p>无穷大：Infinity；超过最大值范围<br>无穷大：-Infinity；超过最小值范围<br>NaN：非数值</p><h5 id="isNaN-方法"><a href="#isNaN-方法" class="headerlink" title="isNaN()方法"></a>isNaN()方法</h5><p>用来判断非数字，是数字返回false，不是数字返回true</p><h3 id="String"><a href="#String" class="headerlink" title="String"></a>String</h3><p>字符串类型，在js里，字符串都带双引号或者单引号， 默认值为””</p><h4 id="引号嵌套"><a href="#引号嵌套" class="headerlink" title="引号嵌套"></a>引号嵌套</h4><p>可以用双引号在外，单引号在内进行镶嵌（反过来也可以）</p><h4 id="转义字符"><a href="#转义字符" class="headerlink" title="转义字符"></a>转义字符</h4><p>以 \ 开头，且写在引号里面</p><ul><li>换行：  \n</li><li>斜杠：  \\</li><li>单引号：  \‘</li><li>双引号：  \“</li><li>缩进：   \t</li><li>空格：  \b</li></ul><h4 id="长度"><a href="#长度" class="headerlink" title="长度"></a>长度</h4><p>检测获取字符串长度用length</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">a = str.<span class="hljs-property">length</span>;  <span class="hljs-comment">//a的数值为str字符串长度</span><br></code></pre></td></tr></table></figure><h4 id="拼接"><a href="#拼接" class="headerlink" title="拼接"></a>拼接</h4><p>字符串 ＋ 其他类型 &#x3D; 新的字符串</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title function_">alert</span>(myname + <span class="hljs-string">&#x27;早上好&#x27;</span> + <span class="hljs-number">233</span>);<br><br><span class="hljs-title function_">alert</span>(<span class="hljs-number">123</span> + <span class="hljs-number">233</span>);               <span class="hljs-comment">//这样输出的数字之和</span><br><span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;12&#x27;</span> + <span class="hljs-number">12</span>);               <span class="hljs-comment">//这样输入的是1212，因为第一个是字符串，第二个是数字类型</span><br></code></pre></td></tr></table></figure><h3 id="Boolean"><a href="#Boolean" class="headerlink" title="Boolean"></a>Boolean</h3><p>仅有两个值，true和false</p><p>布尔型数字型相加的时候，true的值为1.false的值为0</p><h3 id="Undefined"><a href="#Undefined" class="headerlink" title="Undefined"></a><strong>Undefined</strong></h3><p>未定义值</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> a;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a + <span class="hljs-string">&#x27;a&#x27;</span>);   <span class="hljs-comment">//输出字符串 undefineda</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a + <span class="hljs-number">1</span>);     <span class="hljs-comment">//输出NaN ，非数字</span><br></code></pre></td></tr></table></figure><h3 id="Null"><a href="#Null" class="headerlink" title="Null"></a><strong>Null</strong></h3><p>空值 (学习对象时会深入)</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> a = <span class="hljs-literal">null</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a + <span class="hljs-string">&#x27;a&#x27;</span>);   <span class="hljs-comment">//输出字符串 nulla</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a + <span class="hljs-number">1</span>);     <span class="hljs-comment">//输出1</span><br></code></pre></td></tr></table></figure><h3 id="typeof检测"><a href="#typeof检测" class="headerlink" title="typeof检测"></a>typeof检测</h3><p>typeof 可以检测获取变量的数据类型</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">typeof</span> num); <span class="hljs-comment">//输出变量类型</span><br><br><span class="hljs-keyword">var</span> a = <span class="hljs-literal">null</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">typeof</span> a); <span class="hljs-comment">//输出的不是null，而是object。</span><br></code></pre></td></tr></table></figure><blockquote><p>控制台颜色也可以看出变量类型，数字：蓝色，字符串：黑色，布尔：淡蓝色，undefined和null为灰色</p></blockquote><h3 id="数据类型的转换"><a href="#数据类型的转换" class="headerlink" title="数据类型的转换"></a>数据类型的转换</h3><h4 id="转字符串"><a href="#转字符串" class="headerlink" title="转字符串"></a>转字符串</h4><ol><li>toString（）</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//数字转字符串</span><br><span class="hljs-keyword">var</span> num =<span class="hljs-number">10</span>;<br><span class="hljs-keyword">var</span> str = num.<span class="hljs-title function_">toString</span>();<br></code></pre></td></tr></table></figure><ol><li>String（）&#x2F;&#x2F;强制转换</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//数字转字符串</span><br><span class="hljs-keyword">var</span> num =<span class="hljs-number">10</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">String</span>(num));<br></code></pre></td></tr></table></figure><ol><li>加号拼接字符串   &#x2F;&#x2F;隐式转换</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//数字转字符串</span><br><span class="hljs-keyword">var</span> num =<span class="hljs-number">10</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num + <span class="hljs-string">&#x27;&#x27;</span>);<br></code></pre></td></tr></table></figure><h4 id="转数字"><a href="#转数字" class="headerlink" title="转数字"></a>转数字</h4><p>1、parseInt（）转整数<br>转整数,不会进1，会去掉后面字母，若前面有字母则输出NaN</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> str = <span class="hljs-string">&#x27;10&#x27;</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-built_in">parseInt</span>(a));<br></code></pre></td></tr></table></figure><p>2、parseFloat（）<br>转浮点,会去掉后面字母，若前面有字母则输出NaN</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> str = <span class="hljs-string">&#x27;1.9&#x27;</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-built_in">parseFloat</span>(a));<br></code></pre></td></tr></table></figure><p>3、Number（）转数值</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> str = <span class="hljs-string">&#x27;10&#x27;</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Number</span>(a));<br></code></pre></td></tr></table></figure><p>4、隐式转换 （- &#x2F; *）</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> str = <span class="hljs-string">&#x27;10&#x27;</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a - <span class="hljs-number">0</span>); <br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a * <span class="hljs-number">1</span>); <br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a / <span class="hljs-number">1</span>);<br></code></pre></td></tr></table></figure><h4 id="转布尔"><a href="#转布尔" class="headerlink" title="转布尔"></a>转布尔</h4><p>Boolean（）</p><p>表示空、否定的值会被转换为false</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//输出false</span><br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Boolean</span>(<span class="hljs-string">&#x27;&#x27;</span>));   <br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Boolean</span>(<span class="hljs-number">0</span>));    <br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Boolean</span>(<span class="hljs-title class_">NaN</span>));  <br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Boolean</span>(<span class="hljs-literal">null</span>)); <br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Boolean</span>(<span class="hljs-literal">undefined</span>));<br><br><span class="hljs-comment">//其余的均输出true</span><br></code></pre></td></tr></table></figure><h2 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h2><p>也被成为操作符，是用于实现赋值、比较和执行算数运算等功能的符号</p><h3 id="算数运算符"><a href="#算数运算符" class="headerlink" title="算数运算符"></a>算数运算符</h3><p>就是加减乘除以及取余</p><h3 id="递增和递减运算符"><a href="#递增和递减运算符" class="headerlink" title="递增和递减运算符"></a>递增和递减运算符</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js">num = num +<span class="hljs-number">1</span>;<br>num++;<br>++num;<br></code></pre></td></tr></table></figure><h3 id="比较运算符"><a href="#比较运算符" class="headerlink" title="比较运算符"></a>比较运算符</h3><p><img src="/img/javascript/bijiao.png" alt="image"></p><h3 id="逻辑运算符"><a href="#逻辑运算符" class="headerlink" title="逻辑运算符"></a>逻辑运算符</h3><p><img src="/img/javascript/luoji.png" alt="image"></p><h3 id="赋值运算符"><a href="#赋值运算符" class="headerlink" title="赋值运算符"></a>赋值运算符</h3><p><img src="/img/javascript/fuzhi.png" alt="image"></p><h3 id="运算符优先级"><a href="#运算符优先级" class="headerlink" title="运算符优先级"></a>运算符优先级</h3><p><img src="/img/javascript/youxianji.png" alt="image"></p><h2 id="流程控制"><a href="#流程控制" class="headerlink" title="流程控制"></a>流程控制</h2><h3 id="if语句"><a href="#if语句" class="headerlink" title="if语句"></a>if语句</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">if</span>(条件表达式) &#123;<br>    执行语句<br>&#125;  <span class="hljs-keyword">else</span> &#123;<br>    执行语句<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="三元表达式"><a href="#三元表达式" class="headerlink" title="三元表达式"></a>三元表达式</h3><p>如果表达式结果为真则返回表达式1的值， 如果为假，则返回表达式2的值</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">条件表达式 ？ 表达式<span class="hljs-number">1</span> : 表达式<span class="hljs-number">2</span><br></code></pre></td></tr></table></figure><h3 id="switch语句"><a href="#switch语句" class="headerlink" title="switch语句"></a>switch语句</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">switch</span>(表达式) &#123;<br>   <span class="hljs-keyword">case</span> <span class="hljs-attr">value1</span>:<br>       执行语句<span class="hljs-number">1</span>;<br>       <span class="hljs-keyword">break</span>;<br>   <span class="hljs-keyword">case</span> <span class="hljs-attr">value1</span>:<br>       执行语句<span class="hljs-number">1</span>;<br>       <span class="hljs-keyword">break</span>;<br>   ...<br>   <span class="hljs-attr">default</span>:<br>       执行最后的语句;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="循环导读"><a href="#循环导读" class="headerlink" title="循环导读"></a>循环导读</h2><h3 id="for循环-双重for循环"><a href="#for循环-双重for循环" class="headerlink" title="for循环  双重for循环"></a>for循环  双重for循环</h3><p>其实循环和java的一样</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">for</span>(初始化变量; 条件表达式; 操作表达式)&#123;<br>  循环体;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="while循环-do-while循环"><a href="#while循环-do-while循环" class="headerlink" title="while循环  do while循环"></a>while循环  do while循环</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">while</span>(条件表达式) &#123;<br>   循环体;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="continue-break"><a href="#continue-break" class="headerlink" title="continue break"></a>continue break</h3><p>continue是退出本次循环，继续下一次循环，</p><p>而break则是退出循环</p><h2 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h2><h3 id="创建方式"><a href="#创建方式" class="headerlink" title="创建方式"></a>创建方式</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> arr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>();<br><span class="hljs-keyword">var</span> arr = [];<br></code></pre></td></tr></table></figure><h4 id="数组的索引"><a href="#数组的索引" class="headerlink" title="数组的索引"></a>数组的索引</h4><p>数组可以通过索引来访、设置、修改对应的数组元素，我们可以通过**数组名[索引]**的形式来获取数组中的元素。</p><p><strong>数组的长度：数组名.length</strong></p><h3 id="数组新增元素"><a href="#数组新增元素" class="headerlink" title="数组新增元素"></a>数组新增元素</h3><ol><li><p>修改length长度</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">数组名.length <span class="hljs-operator">=</span> 长度<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure></li><li><p>修改索引号，追加数组元素</p><p>如果数组索引原有，追加的就会变成替换其中的元素</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">arr[i] = 元素;<br></code></pre></td></tr></table></figure></li></ol><h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><p>函数就是封装了一段可被重复调用执行的代码块，通过代码块可以实现大量代码的重复使用</p><h4 id="函数使用"><a href="#函数使用" class="headerlink" title="函数使用"></a>函数使用</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> 函数名(形参) &#123;  <span class="hljs-comment">//声明函数</span><br>   函数体;<br>&#125;<br><span class="hljs-keyword">var</span> 变量名 = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;  <span class="hljs-comment">//匿名函数函数没有名字</span><br>   函数体; <br>&#125;<br>函数名(实参);   <span class="hljs-comment">//调用函数</span><br></code></pre></td></tr></table></figure><p>形参是接收方，实参是传递方</p><p>函数表达式声明方式跟声明变量差不多，只不过变量里面存的是值，而函数表达式里面存的是函数</p><p>函数名一般是动词</p><h4 id="return语句"><a href="#return语句" class="headerlink" title="return语句"></a>return语句</h4><p>函数需要有返回值，最终的结果需要返回给函数的调用者</p><p>函数名（）通过return 实现</p><h3 id="arguments的使用"><a href="#arguments的使用" class="headerlink" title="arguments的使用"></a>arguments的使用</h3><p>当我们不确定有多少个参数传递的时候，可以用arguments来获取。在JavaScript在，arguments实际上它是当前函数的一个内置对象，索引函数都内置了一个arguments对象，arguments对象中存储了传递的<strong>所有实参</strong>。</p><p><strong>arguments展示形式是一个伪数组</strong>，因此可以进行遍历。伪数组具有如下特点：</p><p>具有length属性</p><p>按索引方式储存数据</p><p>不具有数组的push、pop等方法</p><h2 id="作用域"><a href="#作用域" class="headerlink" title="作用域"></a>作用域</h2><p>作用域的使用提高了程序逻辑的局部性，增强了程序的可靠性，减少了名字冲突。</p><h4 id="全局变量"><a href="#全局变量" class="headerlink" title="全局变量"></a>全局变量</h4><p>在全局作用域下的变量，在全局下都可以使用</p><p>整个script标签，或者单独一个js文件</p><h4 id="局部变量"><a href="#局部变量" class="headerlink" title="局部变量"></a>局部变量</h4><p>在局部作用域下的变量，只能在函数内部使用，或者在一个局部域中</p><h2 id="预解析"><a href="#预解析" class="headerlink" title="预解析"></a>预解析</h2><p>js引擎运行js分两步：预解析代码执行</p><ul><li>预解析：js引擎会把js里面所有的var和function提升到当前作用域的最前面</li><li>代码执行：按顺序，从上到下</li></ul><h4 id="预解析-1"><a href="#预解析-1" class="headerlink" title="预解析"></a>预解析</h4><ol><li>变量预解析（变量提升）：把所有的变量声明提升到当前作用域的最前面，但不提升赋值操作</li><li>函数预解析（函数提升）：把所有的函数声明提升到当前作用域的最前面</li></ol><h2 id="对象"><a href="#对象" class="headerlink" title="对象"></a>对象</h2><h3 id="创建对象"><a href="#创建对象" class="headerlink" title="创建对象"></a>创建对象</h3><ol><li><p>利用字面量创建对象</p><p>对象字面量：就是花括号{ }里面包含了表达这个具体事物（对象）的属性和方法。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> obj = &#123;<br>    <span class="hljs-attr">uname</span>: <span class="hljs-string">&#x27;张三&#x27;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>,<br>    <span class="hljs-attr">sex</span>:<span class="hljs-string">&#x27;男&#x27;</span>,<br>    <span class="hljs-attr">sayHi</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>        表达式;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>多个属性或者方法中间使用逗号分开</p><p>方法冒号后面跟的是一个匿名函数</p><p><strong>使用对象：</strong></p><ol><li>对象名.属性名</li><li>对象名[‘属性名’]</li><li>对象名.方法名()</li></ol></li><li><p>利用new Object创建对象</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> obj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();<br>obj.<span class="hljs-property">uname</span> = <span class="hljs-string">&#x27;张三&#x27;</span>;<br>obj.<span class="hljs-property">age</span> = <span class="hljs-number">18</span>;<br></code></pre></td></tr></table></figure></li><li><p>利用构造函数创建对象</p><p>是一种特殊的函数，主要用来初始化对象，即为对象成员变量赋初始值，它总与new运算符一起使用，我们可以把对象中的一些公共属性和方法抽取出来，然后封装到这个函数中。</p></li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> 构造函数名()&#123;<br><span class="hljs-variable language_">this</span>.属性 = 值;<br><span class="hljs-variable language_">this</span>.方法 = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;&#125;<br>&#125;<br><span class="hljs-keyword">new</span> 沟站函数名();<span class="hljs-comment">//调用时需要加new</span><br></code></pre></td></tr></table></figure><ul><li>构造函数名字首字母需要大写</li><li>不需要return就可以返回结果</li><li>调用构造函数时需要加new</li></ul><h3 id="遍历对象"><a href="#遍历对象" class="headerlink" title="遍历对象"></a>遍历对象</h3><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> k in obj)&#123;<br><span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(k);<span class="hljs-comment">//k 遍历 输出 得到的是属性名</span><br><span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(obj[k]);<span class="hljs-comment">//obj[k] 得到的是属性值</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="new关键字"><a href="#new关键字" class="headerlink" title="new关键字"></a>new关键字</h3><p>执行过程</p><ol><li>在内存中创建一个新的空对象</li><li>让this指向这个新的对象</li><li>执行构造函数里面的代码，给这个新对象添加属性和方法</li><li>返回这新对象（所以构造函里面不需要添加return）</li></ol><h2 id="内置对象"><a href="#内置对象" class="headerlink" title="内置对象"></a>内置对象</h2><p>就是js语言自带的一些对象，这些对象供开发者使用，并提供了一些常用的或是最基本而必要的功能（属性和方法）</p><h3 id="Math对象"><a href="#Math对象" class="headerlink" title="Math对象"></a>Math对象</h3><p>Math对象不是一个构造函数，所以我们不需要new来调用，而是直接使用里面的属性和方法即可</p><h3 id="Date对象"><a href="#Date对象" class="headerlink" title="Date对象"></a>Date对象</h3><p>Date() 日期对象是一个构造函数，必须使用new来调用</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> date = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>();  <span class="hljs-comment">//没有参数，放回当前系统的当前时间</span><br><span class="hljs-keyword">var</span> date = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">&#x27;2020-10-1 5:5:5&#x27;</span>); <span class="hljs-comment">//返回参数里面的时间</span><br></code></pre></td></tr></table></figure><blockquote><p>月份注意：从0开始，也就是输入1月，但输出为2月，所以需要减1</p></blockquote><h4 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h4><ul><li><p>getFullYear()  –  返回当前日期的年</p></li><li><p>getMonth()  –  返回月份小1个月，也就是如果是7月则返回6月，所以需要+1</p></li><li><p>getDate()  –  返回的是几号</p></li><li><p>getDay()  –  返回的是星期，周一返回1，周六返回6，周日返回0</p></li><li><p>getHours()  –  获取当前小时</p></li><li><p>getMinutes()  –  获取当前分钟</p></li><li><p>getSeconds()  –  获取当前秒钟</p></li></ul><blockquote><p>时间戳</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript">倒计时：<br><span class="hljs-keyword">var</span> nowTime = +<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>();<span class="hljs-comment">//返回的是当前时间总的毫秒数</span><br><span class="hljs-keyword">var</span> inputTime = +<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(time);<span class="hljs-comment">//返回的是输入时间总的毫秒数</span><br><span class="hljs-keyword">var</span> times = (inputTime - nowTime) / <span class="hljs-number">1000</span>;<span class="hljs-comment">//剩余时间总的秒数</span><br><span class="hljs-keyword">var</span> d = <span class="hljs-built_in">parseInt</span>(times / <span class="hljs-number">60</span> / <span class="hljs-number">60</span> / <span class="hljs-number">24</span>);<span class="hljs-comment">//天</span><br><span class="hljs-keyword">var</span> h = <span class="hljs-built_in">parseInt</span>(times / <span class="hljs-number">60</span> / <span class="hljs-number">60</span> % <span class="hljs-number">24</span>);<span class="hljs-comment">//时</span><br><span class="hljs-keyword">var</span> m = <span class="hljs-built_in">parseInt</span>(times / <span class="hljs-number">60</span> % <span class="hljs-number">60</span>);<span class="hljs-comment">//分</span><br><span class="hljs-keyword">var</span> d = <span class="hljs-built_in">parseInt</span>(times % <span class="hljs-number">60</span>);<span class="hljs-comment">//秒</span><br><br></code></pre></td></tr></table></figure></blockquote><h3 id="数组对象"><a href="#数组对象" class="headerlink" title="数组对象"></a>数组对象</h3><h5 id="检测是否为数组"><a href="#检测是否为数组" class="headerlink" title="检测是否为数组"></a>检测是否为数组</h5><ul><li>instanceof    运算符  它可以用来检测是否为数组</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Array</span>);<br></code></pre></td></tr></table></figure><ul><li>Array.isArray()  函数</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(arr));<br></code></pre></td></tr></table></figure><h5 id="添加删除数组元素"><a href="#添加删除数组元素" class="headerlink" title="添加删除数组元素"></a>添加删除数组元素</h5><ul><li>push()——在数组的末尾添加一个或者多个元素，在push的()中直接写需要添加的数组元素</li><li>unshift()——在数组的开头添加一个或者多个数组元素</li><li>pop()——删除数组的最后一个元素，但只能删除一个，同时，返回的是被删除的元素</li><li>shift()——删除数组的第一个元素，但只能删除一个，同时，返回的是被删除的元素</li></ul><h5 id="数组排序"><a href="#数组排序" class="headerlink" title="数组排序"></a>数组排序</h5><ul><li>reverse()  翻转数组</li><li>sort()  冒泡排序，进行数组排序</li></ul><p>但存在缺陷。所以需要新增参数</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript">arr.<span class="hljs-title function_">sort</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">a , b</span>)&#123;<br>  <span class="hljs-keyword">return</span> a-b;<span class="hljs-comment">//按照升序的顺序排序</span><br>  <span class="hljs-keyword">return</span> b-a;<span class="hljs-comment">//按照降序的顺序排序</span><br>&#125;);<br></code></pre></td></tr></table></figure><h5 id="数组索引方法"><a href="#数组索引方法" class="headerlink" title="数组索引方法"></a>数组索引方法</h5><ul><li>indexOf()  数组中查找给定元素的第一个索引</li></ul><p>如果存在返回索引号，如果不存在，则返回-1</p><ul><li>lastindexOf() 在数组的最后一个的索引</li></ul><p>如果存在返回索引号，如果不存在，则返回-1</p><h5 id="数组转换为字符串"><a href="#数组转换为字符串" class="headerlink" title="数组转换为字符串"></a>数组转换为字符串</h5><ul><li>tostring()  将数组转换为字符串，都好分隔每一项</li><li>join(f分隔符)，把数组所有元素转换成一个字符串（添加分隔符）</li></ul><h3 id="字符串对象"><a href="#字符串对象" class="headerlink" title="字符串对象"></a>字符串对象</h3><h4 id="包装类型"><a href="#包装类型" class="headerlink" title="包装类型"></a>包装类型</h4><p>基本包装类型，就是简单数据类型包装成为了复杂数据类型</p><h4 id="根据字符返回位置"><a href="#根据字符返回位置" class="headerlink" title="根据字符返回位置"></a>根据字符返回位置</h4><ul><li><p>indexOf()  返回指定内容在元字符串中的位置，如果找不到就返回-1</p><p>开始的位置是index索引号</p></li><li><p>lastindexOf() 从后往前找，只找第一个匹配的</p></li></ul><h4 id="根据位置返回字符"><a href="#根据位置返回字符" class="headerlink" title="根据位置返回字符"></a>根据位置返回字符</h4><ul><li>charAt(index)  返回指定位置的字符(index字符串的索引号)</li><li>charCodeAt(index)   获取指定位置处字符的ASCI码(index索引号)</li><li>str[index]   获取指定位置处字符</li></ul><h4 id="字符串操作方法"><a href="#字符串操作方法" class="headerlink" title="字符串操作方法"></a>字符串操作方法</h4><ul><li>concat(str1, str2, str3, …)  用于连接两个或多个字符串，拼接字符串，等效于+，+更常用</li><li>substr(start, length)   从start位置开始(索引号)，length 取的个数</li><li>slice(start, end)  从start位置开始，截取到end位置，但end取不到</li><li>substring(start, end)   从start位置开始，截取到end位置，但end取不到，基本个slice一样，但不接受负值</li></ul><h4 id="替换字符replace"><a href="#替换字符replace" class="headerlink" title="替换字符replace"></a>替换字符replace</h4><ul><li>replace(str1,str2)将第一个字符替换成第二个字符</li></ul><h4 id="字符转换为数组split"><a href="#字符转换为数组split" class="headerlink" title="字符转换为数组split"></a>字符转换为数组split</h4><ul><li>split(分隔符)将字符分割成数组，根据字符中原有的分隔符进行分割</li></ul><h2 id="简单类型与复杂类型"><a href="#简单类型与复杂类型" class="headerlink" title="简单类型与复杂类型"></a>简单类型与复杂类型</h2><h3 id="简单类型与复杂类型-1"><a href="#简单类型与复杂类型-1" class="headerlink" title="简单类型与复杂类型"></a>简单类型与复杂类型</h3><blockquote><p>简单类型又叫做基本数据类型或者值类型，复杂类型又叫做引用类型</p></blockquote><p>值类型：简单数据类型&#x2F;基本数据类型，在存储时变量中存储的是值本身</p><p>string、number、boolean、undefined、null</p><p>引用类型：复杂数据类型，在存储时变量中存储的仅仅是地址</p><p>通过new关键字创建的对象（系统、自定义对象）</p><p>Object、Array、Date</p><h3 id="堆和栈"><a href="#堆和栈" class="headerlink" title="堆和栈"></a>堆和栈</h3><p><img src="/img/javascript/duihezhang.png" alt="image"></p><h3 id="内存分配"><a href="#内存分配" class="headerlink" title="内存分配"></a>内存分配</h3><p>简单类型：存放到栈里面，里面直接开辟一个空间存放的值</p><p>复杂类型：首先在栈里面存放地址，十六进制表示，然后这个地址指向堆里面的数据</p><h3 id="传参"><a href="#传参" class="headerlink" title="传参"></a>传参</h3><p>简单类型：函数的形参可以看作是一个变量，当我们把一个值类型变量作为参数传给函数的形参时，其实是把变量在栈空间里面的值<strong>复制</strong>一份给形参，那么在方法内部对形参做任何修改，都不会影响到外部变量。</p><p>复杂类型：函数的形参可以看作是一个变量，当我们把一个值类型变量作为参数传给函数的形参时，其实是把变量在栈空间里面的堆地址<strong>复制</strong>一份给形参，形参和实参其实保存的是同一个堆地址，所以操作的是同一个对象。</p>]]></content>
    
    
    <categories>
      
      <category>笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>javascript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>css</title>
    <link href="/2023/03/22/%E7%AC%94%E8%AE%B0/css/"/>
    <url>/2023/03/22/%E7%AC%94%E8%AE%B0/css/</url>
    
    <content type="html"><![CDATA[<h1 id="css"><a href="#css" class="headerlink" title="css"></a>css</h1><h2 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h2><h3 id="行内样式"><a href="#行内样式" class="headerlink" title="行内样式"></a>行内样式</h3><p>在开始标签内添加style样式</p><p>配合js使用</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;color:red&quot;</span>&gt;</span>内容<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="嵌入样式"><a href="#嵌入样式" class="headerlink" title="嵌入样式"></a>嵌入样式</h3><p>放在 head 标签里面的</p><p>其中 type 可以不写，但写了就不能写错</p><p>多用于当前页面，小案例</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs HTML"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/css&quot;</span>&gt;</span><br>样式<br><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="外部样式"><a href="#外部样式" class="headerlink" title="外部样式"></a>外部样式</h3><p>放在一个css文件里面，需要讲引用它的 link 标签放在 head 标签里面</p><p>其中， href 就是css文件所在地址</p><p>rel&#x3D;”stylesheet”——关系为样式表</p><p>多个页面，项目</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;XXX.css&quot;</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/css&quot;</span>/&gt;</span><br></code></pre></td></tr></table></figure><h3 id="导入式"><a href="#导入式" class="headerlink" title="导入式"></a>导入式</h3><p>放在 head 标签里面的 style 标签里面</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html">@import url(&quot;文件地址&quot;);<br></code></pre></td></tr></table></figure><h2 id="选择器"><a href="#选择器" class="headerlink" title="选择器"></a>选择器</h2><h3 id="标签选择器"><a href="#标签选择器" class="headerlink" title="标签选择器"></a>标签选择器</h3><p>以 HTML标签作为选择器</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs html">div&#123;<br>样式<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="类选择器"><a href="#类选择器" class="headerlink" title="类选择器"></a>类选择器</h3><p>在HTML标签里面添加class属性</p><p>注意前面需要增加一个点</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;cube&quot;</span>&gt;</span>内容<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>.cube&#123;<br>样式<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="id选择器"><a href="#id选择器" class="headerlink" title="id选择器"></a>id选择器</h3><p>在HTML标签中添加id属性</p><ul><li><p>id只能使用一次，即每一个标签只有一个id，为一一对应关系</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">diV</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;only&quot;</span>&gt;</span><br>    内容<br><span class="hljs-tag">&lt;/<span class="hljs-name">diV</span>&gt;</span><br><br>#only&#123;<br>样式<br>&#125;<br></code></pre></td></tr></table></figure></li></ul><h3 id="全局选择器"><a href="#全局选择器" class="headerlink" title="全局选择器"></a>全局选择器</h3><p>设置全部标签样式</p><ul><li>很少使用</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs HTML">*&#123;<br>样式<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="子元素选择器"><a href="#子元素选择器" class="headerlink" title="子元素选择器"></a>子元素选择器</h3><p>和后代类似，但是只能获得子元素，中间使用小于号隔开</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;first&quot;</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;second&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">em</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;third&quot;</span>&gt;</span>内容<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>.first &gt; .second &gt; .third&#123;//第一种<br>样式<br>&#125;<br>div &gt; div &gt;em&#123;//第二种<br>样式<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="后代选择器"><a href="#后代选择器" class="headerlink" title="后代选择器"></a>后代选择器</h3><p>类似于路劲，找到符合要求的标签，会匹配所有的后代标签，之间用空格隔开</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs HTML"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;first&quot;</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;second&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">em</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;third&quot;</span>&gt;</span>内容<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br><br>div div em&#123;<br>  样式<br>&#125;<br><br>.first div em&#123;<br>  样式<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="分组选择器"><a href="#分组选择器" class="headerlink" title="分组选择器"></a>分组选择器</h3><p>可以将多种选择器结合到一起使用，用于统一设计样式</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs html">div,#id,.a&#123;<br>样式<br>&#125;<br></code></pre></td></tr></table></figure><p>同时满足多个选择器的标签</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><span class="hljs-keyword">div</span>.box&#123;<br>样式<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="伪类选择器"><a href="#伪类选择器" class="headerlink" title="伪类选择器"></a>伪类选择器</h3><ul><li>只有一个：</li></ul><h4 id="动态伪类"><a href="#动态伪类" class="headerlink" title="动态伪类"></a>动态伪类</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html">link 还未被访问的链接<br>visited 已经访问的链接<br>hover 鼠标悬浮在元素上的效果<br>active 鼠标点中元素一瞬间的效果<br></code></pre></td></tr></table></figure><p>在 CSS 定义中，a:hover 必须被置于 a:link 和 a:visited 之后，才是有效的，a:active 必须被置于 a:hover 之后，才是有效的。（love and hate法则）</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs html">//当链接没有点击时，设a标签文字为黑色<br>a:link&#123;<br>    color:black;<br>&#125;<br>//当链接已经点击时，设a标签文字变为绿色<br>a:visited &#123;<br>    color: green;<br>&#125;<br>//鼠标悬浮在a标签上时，文字变为红色<br>a:hover&#123;<br>    color: red;<br>&#125;<br>//鼠标点击的一瞬间背景颜色变为蓝色<br>a:active&#123;<br>    background-color: blue;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="结构类伪类"><a href="#结构类伪类" class="headerlink" title="结构类伪类"></a>结构类伪类</h4><h5 id="first类和last类"><a href="#first类和last类" class="headerlink" title="first类和last类"></a>first类和last类</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html">:first-child 所有父标签的第一个子元素如果是某元素，则被选中。<br>:first-of-type 所有父标签中某元素的第一个子元素。 <br>:last-child 所有父标签的最后一个子元素如果是某元素，则被选中。<br>:last-of-type 所有父标签中某元素的最后一个子元素。<br></code></pre></td></tr></table></figure><h5 id="nth类"><a href="#nth类" class="headerlink" title="nth类"></a>nth类</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html">:only-child 父标签中只有一个标签，并且是某标签才会被选中<br>:only-of-type 所有父标签只有一个某标签时才会被选中<br></code></pre></td></tr></table></figure><h5 id="not类"><a href="#not类" class="headerlink" title="not类"></a>not类</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html">:not选择器匹配非指定元素/选择器的每个元素 （不是这个元素的其他元素）<br></code></pre></td></tr></table></figure><h4 id="状态伪类"><a href="#状态伪类" class="headerlink" title="状态伪类"></a>状态伪类</h4><p>通常与form和input中的属性使用</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs html">:focus 获得焦点的时候<br>:disabled 不可选的<br>:enabled 可选的<br>:in-range 值在指定区间内<br>:out-of-range 值超出区间<br>:optional 元素可选时，无必须填写属性<br>:required 必须填写项<br>:read-only 只读<br>:read-write 读写<br>:valid 输入值有效，符合要求<br>:invalid 输入值无效 ，不符合要求<br></code></pre></td></tr></table></figure><h3 id="伪元素选择器"><a href="#伪元素选择器" class="headerlink" title="伪元素选择器"></a>伪元素选择器</h3><ul><li>有两个：</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs html">::first-line 用于向文本的首行设置特殊样式，只能用于块级元素。<br>::first-letter 用于向文本的首字母设置特殊样式。只能用于块级元素。<br>::after 可以在元素的内容之后插入新内容。<br>::before 可在元素的内容前面插入新内容。默认地，这个伪元素是行内元素，可使用属性 display 改变这一点。<br>::selection 可用来匹配突出显示的文本。浏览器默认情况下，选择网站文本是深蓝背景白色字体。<br></code></pre></td></tr></table></figure><ul><li>伪类和伪元素的根本区别在于：它们是否创造了新的元素(抽象)。伪类是在既有元素上添加类别（在逻辑上存在，但并不实际存在于文档树中），而伪类选择器则是添加新元素。</li></ul><h3 id="继承、层叠与优先级"><a href="#继承、层叠与优先级" class="headerlink" title="继承、层叠与优先级"></a>继承、层叠与优先级</h3><h4 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h4><p>父元素设置的样式，子元素可以继承</p><p>若子元素自己有，就生成自己的，没有才需要继承父元素</p><h4 id="层叠"><a href="#层叠" class="headerlink" title="层叠"></a>层叠</h4><ul><li><p>在不冲突的时候多个样式可以层叠</p></li><li><p>冲突的时候按不同样式<strong>优先级</strong>来应用样式</p></li></ul><p><strong>按照就近原则</strong>，也就是写在最后的生效</p><h4 id="优先级"><a href="#优先级" class="headerlink" title="优先级"></a>优先级</h4><p>公式：！important &gt; 行内样式 &gt; id选择器 &gt; 类选择器 &gt; 标签选择器 &gt; 通配符选择器（全局） &gt; 继承</p><ol><li><p>一般优先级：id &gt; 类 &gt;标签</p></li><li><p>优先级规则：权值相同就近选择，权值不同区权值高的</p></li><li><p>权值：</p><p>标签选择器 – 1；</p><p>类和伪类选择器 – 10；</p><p>id选择器 – 100；</p><p>行内样式 – 1000；</p></li><li><p>可使用“！important”来调整优先级</p></li></ol><h2 id="Emmet语法"><a href="#Emmet语法" class="headerlink" title="Emmet语法"></a>Emmet语法</h2><p>其实就是快捷键</p><ol><li>快速生成HTML结构语法<ol><li>生成标签直接输入标签名按tab键即可，比如 div 然后按 tab 键，就可以生成<div></div></li><li>如果想要生成多个相同标签，加上 * 就可以了，比如 div*4 就可以快速生成4个div了</li><li>如果有父子级关系的标签，可以用&gt;，比如 ul&gt;li 就可以生成了</li><li>如果有兄弟关系的标签，用+就可以了，比如 div+p</li><li>如果生成带有类名或者id名字的，直接写 .demo 或者 #two tab键就可以了</li><li>如果生成的div类名是有顺序的，可以用自增符号$</li><li>如果想要在生成的标签内部写内容可以用 {} 表示</li></ol></li><li>快速生成css样式语法<ul><li>基本采取简写形式即可</li></ul></li></ol><h2 id="字体样式"><a href="#字体样式" class="headerlink" title="字体样式"></a>字体样式</h2><h3 id="字体属性"><a href="#字体属性" class="headerlink" title="字体属性"></a>字体属性</h3><h4 id="font-family"><a href="#font-family" class="headerlink" title="font-family"></a>font-family</h4><p>字体类型</p><ul><li>设置多字体方式（使其能够适应更多的计算机和设备）</li><li>引号的问题（有的字体中间有空格，必须用引号引起来）</li></ul><p>font-size：字体大小（默认大小16px），字体大小一般为偶数</p><table><thead><tr><th>属性取值</th><th>字体大小</th></tr></thead><tbody><tr><td>xx-small</td><td>最小</td></tr><tr><td>x-small</td><td>较小</td></tr><tr><td>small</td><td>小</td></tr><tr><td>medium</td><td>正常（默认值）</td></tr><tr><td>large</td><td>大</td></tr><tr><td>x-large</td><td>较大</td></tr><tr><td>xx-large</td><td>最大</td></tr></tbody></table><h4 id="font-weight"><a href="#font-weight" class="headerlink" title="font-weight"></a>font-weight</h4><p>字体粗细（单词[normal正常、bold加粗]； 数字[100-500正常、600-900加粗]）</p><h4 id="font-style"><a href="#font-style" class="headerlink" title="font-style"></a>font-style</h4><p>字体样式（normal正常、italic斜体[italic所有带有倾斜字体的可以设置；oblique没有倾斜属性的字体也可以设置倾斜]）</p><h4 id="color"><a href="#color" class="headerlink" title="color"></a>color</h4><p>字体颜色</p><p>复合样式：<code>font:weight style size family</code>、<code>font:style weight size family</code>、<code>font:weight style size/line-height family</code></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">p</span>&#123;<br>    <span class="hljs-attribute">font-family</span>: sans-serif;   <span class="hljs-comment">/*设置字体*/</span><br>    <span class="hljs-attribute">font-size</span>: large;          <span class="hljs-comment">/*设置字体大小*/</span><br>    <span class="hljs-attribute">font-weight</span>: bold;          <span class="hljs-comment">/*设置字体粗细*/</span><br>    <span class="hljs-attribute">font-style</span>: normal;         <span class="hljs-comment">/*设置字体样式*/</span><br>    <span class="hljs-attribute">font-variant</span>: normal;       <span class="hljs-comment">/*设置字体变形*/</span>    <br>    <span class="hljs-attribute">color</span>: white;             <span class="hljs-comment">/*字体颜色*/</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="文本样式"><a href="#文本样式" class="headerlink" title="文本样式"></a>文本样式</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">p</span>&#123;<br>    <span class="hljs-attribute">text-align</span>: center;             <span class="hljs-comment">/*字体对齐方式*/</span><br>    <span class="hljs-attribute">line-height</span>: normal;            <span class="hljs-comment">/*行高*/</span><br>    <span class="hljs-attribute">vertical-align</span>: middle;         <span class="hljs-comment">/*内容垂直方式*/</span><br>    <span class="hljs-attribute">word-spacing</span>: normal;           <span class="hljs-comment">/*单词间距*/</span><br>    <span class="hljs-attribute">letter-spacing</span>: normal;         <span class="hljs-comment">/*字母间距*/</span><br>    <span class="hljs-attribute">text-transform</span>: none;           <span class="hljs-comment">/*大小写*/</span><br>    <span class="hljs-attribute">text-decoration</span>: none;          <span class="hljs-comment">/*元素内文本装饰*/</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="颜色表示"><a href="#颜色表示" class="headerlink" title="颜色表示"></a>颜色表示</h3><ul><li>单词表示法</li><li>十六进制表示法</li><li>RGB三原色表示法（范围0-255）</li></ul><h3 id="盒子模型"><a href="#盒子模型" class="headerlink" title="盒子模型"></a>盒子模型</h3><h4 id="盒子模型基本属性"><a href="#盒子模型基本属性" class="headerlink" title="盒子模型基本属性"></a>盒子模型基本属性</h4><ul><li>conten——内容区域</li><li>padding——内边距区域</li><li>border——边框区域</li><li>margin——外边距区域</li></ul><p><img src="/img/css/box.gif" alt="image"></p><h5 id="margin（外边距）"><a href="#margin（外边距）" class="headerlink" title="margin（外边距）"></a>margin（外边距）</h5><blockquote><p>1、垂直布局的块级元素，上下的margin会合并</p><p>：只需要给一个盒子设置margin即可</p><p>2、互相嵌套的块级元素，子元素的margin-top会作用在父元素上</p><ul><li>给父元素设置border-top或者paddding-top</li><li>给父元素设置overflow：hidden</li><li>转换成行内块元素</li><li>设置浮动</li></ul></blockquote><ul><li>margin-top：上边距（auto–水平居中）</li><li>margin-buttom：下边距</li><li>margin-left：左边距</li><li>margin-right：右边距</li></ul><h5 id="padding（内边距）"><a href="#padding（内边距）" class="headerlink" title="padding（内边距）"></a>padding（内边距）</h5><ul><li>padding-top：上部填充</li><li>padding-bottom：下部填充</li><li>padding-left：左部填充</li><li>padding-right：右部填充</li><li>padding：X  （上下左右均为X）</li><li>padding：X Y （上下为X，左右为Y）</li><li>padding：X Y Z （上，左右，下）</li><li>padding：X Y Z W （上，右，下，左）</li></ul><h5 id="border（边界）"><a href="#border（边界）" class="headerlink" title="border（边界）"></a>border（边界）</h5><ul><li><p>border-top：上边界（<strong>也可以单独对一个边界使用width，style，color</strong>）</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html">border-top-color:red<br></code></pre></td></tr></table></figure></li><li><p>border-bottom：下边界</p></li><li><p>border-left：左边界</p></li><li><p>border-right：右边界</p></li><li><p>border-width：边界宽度</p></li><li><p>border-style：边界样式(<strong>常用 soild–实线边框；dashed–虚线边框；dotted–电线边框</strong>)</p></li><li><p>border-color：边界颜色</p></li><li><p>border-radius：角设置</p></li><li><p>border-collapse:collapse;表示相邻边框合并在一起</p></li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-comment">/*没有顺序*/</span><br><span class="hljs-attribute">border</span>:<span class="hljs-number">1px</span> solid red;<br></code></pre></td></tr></table></figure><p><strong>复合样式</strong>，为border-width，border-color，border-style组合使用</p><h5 id="width-amp-height（内容的长与高）"><a href="#width-amp-height（内容的长与高）" class="headerlink" title="width&amp;height（内容的长与高）"></a>width&amp;height（内容的长与高）</h5><ul><li>max-height：最大高度</li><li>min-weith：最小宽度</li></ul><h5 id="清除内外边距"><a href="#清除内外边距" class="headerlink" title="清除内外边距"></a>清除内外边距</h5><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs css">* &#123;<br>    paddomh:<span class="hljs-number">0</span>;<span class="hljs-comment">/*清除内边距*/</span><br>    <span class="hljs-attribute">margin</span>:<span class="hljs-number">0</span>;<span class="hljs-comment">/*清除外边距*/</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="盒子模型高度与宽度"><a href="#盒子模型高度与宽度" class="headerlink" title="盒子模型高度与宽度"></a>盒子模型高度与宽度</h3><p>总元素的宽度&#x3D;宽度+左填充+右填充+左边框+右边框+左边距+右边距</p><p>总元素的高度&#x3D;高度+顶部填充+底部填充+上边框+下边框+上边距+下边距</p><p>添加这句话，可以使前面的传统盒子模型变成css3的盒子模型</p><p><strong>边框、边距不会撑大盒子</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">box-sizing</span>:border-box;<br></code></pre></td></tr></table></figure><h3 id="特殊样式"><a href="#特殊样式" class="headerlink" title="特殊样式"></a>特殊样式</h3><p><img src="/img/css/teshu.png" alt="image"></p><h2 id="元素"><a href="#元素" class="headerlink" title="元素"></a>元素</h2><p>元素之间可以转化，比如行级元素转化成块级元素， display：block，这样就可以了</p><h3 id="行级元素、内联元素"><a href="#行级元素、内联元素" class="headerlink" title="行级元素、内联元素"></a>行级元素、内联元素</h3><ul><li>inline</li></ul><p>feature：内容觉得元素所占位置</p><p>不可以通过css改变宽高</p><p>span、strong、em、a、del</p><h3 id="块级元素"><a href="#块级元素" class="headerlink" title="块级元素"></a>块级元素</h3><ul><li>block</li></ul><p>feature：独占一行</p><p>可以通过css改变宽高</p><p>div、p、ul、ol、form、address</p><h3 id="行级块元素"><a href="#行级块元素" class="headerlink" title="行级块元素"></a>行级块元素</h3><ul><li>inline-block</li></ul><p>feature：内容觉得大小</p><p>可以改变宽高</p><p>img</p><h2 id="背景-background"><a href="#背景-background" class="headerlink" title="背景 background"></a>背景 background</h2><p><strong>background</strong>：背景颜色  背景图片地址  背景平铺  背景图像滚动  背景图片位置；</p><p>在实际开发中，更加提倡这一种写法，减少了许多代码。</p><p><strong>backgroun  d-color</strong>：（颜色）＋颜色名&#x2F;rgb&#x2F;十六进制&#x2F;rgba；</p><p><strong>background-image</strong>：url(图片位置)&#x2F;none；</p><p><strong>background-repeat</strong>：（背景图片的重复方式，平铺）＋repeat&#x2F;no-repeat&#x2F;repeat-x&#x2F;repeat-y；</p><p><strong>background-attachment</strong>：（背景图片的显示方式）scroll&#x2F;fixed;</p><ul><li><p>scroll:默认值，图片随滚动条滚动</p></li><li><p>fixed：其他页面滚动时，图片不会滚动</p></li></ul><p><strong>background-position</strong>：（背景位置，长度，百分比）</p><h2 id="列表"><a href="#列表" class="headerlink" title="列表"></a>列表</h2><p><strong>list-style-type</strong>：（设置标记样式）关键字&#x2F;none；<br>关键字：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-comment">/*有序列表*/</span><br><span class="hljs-attribute">list-style-type</span>:decimal;        <span class="hljs-comment">/*从1开始的整数*/</span><br><span class="hljs-attribute">list-style-type</span>:lower-roman;    <span class="hljs-comment">/*小写罗马数字*/</span><br><span class="hljs-attribute">list-style-type</span>:upper-roman;    <span class="hljs-comment">/*大写罗马数字*/</span><br><span class="hljs-attribute">list-style-type</span>:lower-alpha;    <span class="hljs-comment">/*小写英文字母*/</span><br><span class="hljs-attribute">list-style-type</span>:upper-alpha;    <span class="hljs-comment">/*大写英文字母*/</span><br><span class="hljs-comment">/*无序列表*/</span><br><span class="hljs-attribute">list-style-type</span>:disc;           <span class="hljs-comment">/*实心圆点*/</span><br><span class="hljs-attribute">list-style-type</span>:circle;           <span class="hljs-comment">/*空心圆点*/</span><br><span class="hljs-attribute">list-style-type</span>:square;         <span class="hljs-comment">/*实心方块*/</span><br></code></pre></td></tr></table></figure><p><strong>list-style-image</strong>：（设置图片标记）url&#x2F;none；</p><p><strong>list-style-position</strong>：（设置标记位置）inside&#x2F;outside；</p><h2 id="float属性（浮动）"><a href="#float属性（浮动）" class="headerlink" title="float属性（浮动）"></a>float属性（浮动）</h2><p><strong>特点</strong></p><ol><li>浮动元素会脱离标准流，在标准流中不占位置</li><li>浮动元素比标准流高半个级别，可以覆盖标准流中的元素</li><li>浮动找浮动，下一个浮动元素会在上一个浮动元素后面左右浮动</li></ol><p><strong>基础</strong></p><p>float：left；靠左浮动</p><p>float：none；不用浮动</p><p><strong>清除浮动</strong></p><p>clear：none&#x2F;left&#x2F;right&#x2F;both；</p><p>clear只会影响自身，不会影响相邻元素；</p><p><strong>清除浮动的基础方法</strong></p><ul><li>在父元素内容的最后添加一个块级元素，给添加的块级元素（class&#x3D;”clearfix”）设置clear：both</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs css">- 在浮动后面加一个空元素 &lt;<span class="hljs-selector-tag">div</span> class=&quot;claer&quot;&gt;&lt;/<span class="hljs-selector-tag">div</span>&gt;<br>- 在浮动元素的容器里面加 overflowe：hidden； <br>- 使用CSS3的：after伪元素<br>  clearfix：after&#123;<br>       <span class="hljs-attribute">content</span>:<span class="hljs-string">&quot;.&#x27;;</span><br><span class="hljs-string">       display:block;</span><br><span class="hljs-string">       height:0;</span><br><span class="hljs-string">       visibility:hidden;</span><br><span class="hljs-string">       clear:both;</span><br><span class="hljs-string">   &#125;</span><br></code></pre></td></tr></table></figure><h2 id="定位position"><a href="#定位position" class="headerlink" title="定位position"></a>定位position</h2><h3 id="position-staric-静态定位"><a href="#position-staric-静态定位" class="headerlink" title="position:staric(静态定位)"></a><strong>position:staric</strong>(静态定位)</h3><p>作用：使元素定位于常规&#x2F;自然流之中<br>特点：</p><ol><li><p>忽略top、bottom、left、right或者z-index的声明</p></li><li><p>两个相邻远的元素都设置外边距则最终外边距&#x3D;两个外边距最大的</p></li><li><p>具有固定的width和height值的元素，把左右外边距设置为auto，会使这个块水平居中</p></li></ol><h3 id="position-relative-相对定位"><a href="#position-relative-相对定位" class="headerlink" title="position:relative(相对定位)"></a><strong>position:relative</strong>(相对定位)</h3><p>作用：相对定位作用，是一个可定位的元素<br>特点：</p><ol><li><p>可以使用top、bottom、left、right或者z-index进行相对定位</p></li><li><p>相对定位元素不会离开常规流</p></li><li><p>任何元素都可以设置为relative，他的绝对定位后代都可以对他进行绝对定位</p></li><li><p>可以使浮动元素发生偏移，并控制他们的堆叠顺序</p></li></ol><h3 id="position-absolute-绝对定位"><a href="#position-absolute-绝对定位" class="headerlink" title="position:absolute(绝对定位)"></a><strong>position:absolute</strong>(绝对定位)</h3><p>作用：绝对定位作用，使元素脱离常规流<br>特点：</p><ol><li><p>设置百分比尺寸会定位父元素</p></li><li><p>left、right、top、bottom设置为0，他将对齐到最近定位父元素的个边</p></li><li><p>left、right、top、bottom设置为auto变回原形</p></li></ol><h3 id="position-fixed-固定定位"><a href="#position-fixed-固定定位" class="headerlink" title="position:fixed(固定定位)"></a><strong>position:fixed</strong>(固定定位)</h3><p>作用：固定定位使其不会随窗口滚动而滚动，并继承absolute的特点</p><h3 id="position-stick"><a href="#position-stick" class="headerlink" title="position:stick"></a><strong>position:stick</strong></h3><p>作用：吸附定位作用，会与relavitive＋fixed结合造成吸附效果<br>特点：</p><ol><li><p>即使产生位移，原位置还是在常规流中</p></li><li><p>最近的父元素有滚动，则偏移至最近的父元素</p></li><li><p>父元素没有滚动则偏移标准使窗口</p></li><li><p>上下左右偏移标准</p></li></ol><h3 id="元素的显示与隐藏"><a href="#元素的显示与隐藏" class="headerlink" title="元素的显示与隐藏"></a>元素的显示与隐藏</h3><h4 id="display属性"><a href="#display属性" class="headerlink" title="display属性"></a>display属性</h4><p>display属性用于设置一个元素如何显示</p><ul><li>display:none; 隐藏对象（最常用的）</li><li>display:block;  处理转换为块级元素之外，同时还有显示元素的意思</li></ul><p>display隐藏元素后，不再占有原来的位置</p><h4 id="visibility可见性"><a href="#visibility可见性" class="headerlink" title="visibility可见性"></a>visibility可见性</h4><ul><li>visibility:visible;    元素可视</li><li>visibility:visible;    元素隐藏</li></ul><p>visibility隐藏元素后，继续占有原来的位置</p><h4 id="overflow-溢出"><a href="#overflow-溢出" class="headerlink" title="overflow 溢出"></a>overflow 溢出</h4><p>overflow:visible;   不剪切内容也不添加滚动条  </p><p>overflow:hidden;   不显示超过内容尺寸的内容，超出的部分直接隐藏掉</p><p>overflow:scroll;   不管超出内容否，总会显示滚动条</p><p>overflow:auto;   超出自动显示滚动条，不超出不显示滚动条  </p><h4 id="文本溢出"><a href="#文本溢出" class="headerlink" title="文本溢出"></a>文本溢出</h4><p>单行文本溢出：</p><ol><li><p>强制一行内显示文本（会超出文本框）</p><p>white-space：nowrap</p></li><li><p>超出隐藏</p><p>overflow：hidden</p></li><li><p>超出的部分用省略号代替</p><p> text-overflow：ellipsis</p></li></ol><p>多行文本溢出：</p><h2 id="边框与圆角"><a href="#边框与圆角" class="headerlink" title="边框与圆角"></a>边框与圆角</h2><h3 id="圆角"><a href="#圆角" class="headerlink" title="圆角"></a>圆角</h3><p>border-radius 属性是一个简写属性，用于设置四个 border-*-radius 属性。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">border-radius</span>: <span class="hljs-number">1</span>-<span class="hljs-number">4</span> length|% / <span class="hljs-number">1</span>-<span class="hljs-number">4</span> length|%;<br></code></pre></td></tr></table></figure><blockquote><p>length:定义圆角的形状。<br>%:以百分比定义圆角的形状。</p></blockquote><h3 id="盒阴影"><a href="#盒阴影" class="headerlink" title="盒阴影"></a>盒阴影</h3><p>box-shadow 属性向框添加一个或多个阴影。不占用空间的</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">box-shadow</span>: h-shadow v-shadow blur spread color inset;<br></code></pre></td></tr></table></figure><blockquote><p>h-shadow:必需。水平阴影的位置。允许负值。<br>v-shadow:必需。垂直阴影的位置。允许负值。<br>blur:可选。模糊距离。<br>spread:可选。阴影的尺寸。<br>color:可选。阴影的颜色。<br>inset:可选。将外部阴影 (outset) 改为内部阴影</p></blockquote><h3 id="文字阴影"><a href="#文字阴影" class="headerlink" title="文字阴影"></a>文字阴影</h3><p>text-shadow属性将阴影应用于文本</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">text-shadow</span>:h-shadow v-shadow blur color;<br></code></pre></td></tr></table></figure><p>h-shadow:必需。水平阴影的位置。允许负值。<br>v-shadow:必需。垂直阴影的位置。允许负值。<br>blur:可选。模糊距离。<br>color:可选。阴影的颜色。</p><h3 id="边界图片"><a href="#边界图片" class="headerlink" title="边界图片"></a>边界图片</h3><p>border-image属性使用图片作为对象的边界。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">border-image</span>:border-image-source;  //用在边框的图片的路径<br><br><span class="hljs-attribute">border-image</span>:border-image-slice;  //图片边框向内偏移<br><br><span class="hljs-attribute">border-image</span>:border-image-width;  //图片边框的宽度<br><br><span class="hljs-attribute">border-image</span>:border-image-outset;  //边框图像区域超出边框的量<br><br><span class="hljs-attribute">border-image</span>:border-image-repeat;  //图像边框是否应平铺(repeated)、铺满(rounded)或拉伸(stretched)<br></code></pre></td></tr></table></figure><h2 id="背景（精灵图）"><a href="#背景（精灵图）" class="headerlink" title="背景（精灵图）"></a>背景（精灵图）</h2><h3 id="背景图像区域"><a href="#背景图像区域" class="headerlink" title="背景图像区域"></a>背景图像区域</h3><p>background-clip属性指定背景绘制区域。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">background-clip</span>: border-box;  //默认值。背景绘制在边框方框内（剪切成边框方框）<br><br><span class="hljs-attribute">background-clip</span>:padding-box;  //背景绘制在衬距方框内（剪切成衬距方框）<br><br><span class="hljs-attribute">background-clip</span>:content-box;  //背景绘制在内容方框内（剪切成内容方框）<br></code></pre></td></tr></table></figure><h3 id="背景图片定位"><a href="#背景图片定位" class="headerlink" title="背景图片定位"></a>背景图片定位</h3><p>background-origin 属性规定 background-position 属性相对于什么位置来定位。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">background-origin</span>: padding-box;  //背景图像相对于内边距框来定位<br><br><span class="hljs-attribute">background-origin</span>: border-box;  //背景图像相对于边框盒来定位<br><br><span class="hljs-attribute">background-origin</span>: content-box;  //背景图像相对于内容框来定位<br></code></pre></td></tr></table></figure><blockquote><p>注意：如果背景图像的 background-attachment 属性为 “fixed”，则该属性没有效果。</p></blockquote><h3 id="背景图片大小"><a href="#背景图片大小" class="headerlink" title="背景图片大小"></a>背景图片大小</h3><p>background-size 属性规定背景图像的尺寸。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">background-size</span>: length;  //设置背景图像的高度和宽度。第一个值设置宽度，第二个值设置高度。如果只设置一个值，则第二个值会被设置为 “auto”。<br><br><span class="hljs-attribute">background-size</span>: percentage;  //以父元素的百分比来设置背景图像的宽度和高度。第一个值设置宽度，第二个值设置高度。如果只设置一个值，则第二个值会被设置为 “auto”。<br><br><span class="hljs-attribute">background-size</span>: cover;  //把背景图像扩展至足够大，以使背景图像完全覆盖背景区域。背景图像的某些部分也许无法显示在背景定位区域中。<br><br><span class="hljs-attribute">background-size</span>: contain;  //把图像图像扩展至最大尺寸，以使其宽度和高度完全适应内容区域<br></code></pre></td></tr></table></figure><h2 id="css用户界面样式"><a href="#css用户界面样式" class="headerlink" title="css用户界面样式"></a>css用户界面样式</h2><h3 id="鼠标样式-cursor"><a href="#鼠标样式-cursor" class="headerlink" title="鼠标样式 cursor"></a>鼠标样式 cursor</h3><p>设置或检索在对象上移动的鼠标指针采用何种系统预定义的光标形状</p><p>style属性</p><ul><li>cursor:default;   默认</li><li>cursor:pointer;    小手</li><li>cursor:move;     移动</li><li>cursor:text;     文本</li><li>cursor:not-allowed;    禁止</li></ul><h4 id="轮廓线-outline"><a href="#轮廓线-outline" class="headerlink" title="轮廓线 outline"></a>轮廓线 outline</h4><p>outline:none;  取消轮廓线</p><h4 id="取消拖拽文本域-resize"><a href="#取消拖拽文本域-resize" class="headerlink" title="取消拖拽文本域  resize"></a>取消拖拽文本域  resize</h4><p>resize:none;  </p><h4 id="vertical-align属性应用"><a href="#vertical-align属性应用" class="headerlink" title="vertical-align属性应用"></a>vertical-align属性应用</h4><p>设置图片或者表单和文字垂直对齐</p><p>vertical-align：middle</p><h2 id="渐变"><a href="#渐变" class="headerlink" title="渐变"></a>渐变</h2><h3 id="线性渐变"><a href="#线性渐变" class="headerlink" title="线性渐变"></a>线性渐变</h3><p>为了创建一个线性渐变，你必须至少定义两种颜色结点。颜色结点即你想要呈现平稳过渡的颜色。同时，你也可以设置一个起点和一个方向（或一个角度）。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">background-image</span>: <span class="hljs-built_in">linear-gradient</span>(direction, color-stop1, color-stop2, ...);<br></code></pre></td></tr></table></figure><blockquote><p>color用rgba可调整透明度</p></blockquote><h4 id="上下"><a href="#上下" class="headerlink" title="上下"></a>上下</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">background-image</span>: <span class="hljs-built_in">linear-gradient</span>(color-stop1, color-stop2);<br></code></pre></td></tr></table></figure><h4 id="左右"><a href="#左右" class="headerlink" title="左右"></a>左右</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">background-image</span>: <span class="hljs-built_in">linear-gradient</span>(to right,color-stop1, color-stop2);<br></code></pre></td></tr></table></figure><h4 id="对角"><a href="#对角" class="headerlink" title="对角"></a>对角</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">background-image</span>: <span class="hljs-built_in">linear-gradient</span>(to bottom right,color-stop1, color-stop2);<br></code></pre></td></tr></table></figure><h4 id="角度"><a href="#角度" class="headerlink" title="角度"></a>角度</h4><p>角度是指水平线和渐变线之间的角度，逆时针方向计算。换句话说，0deg 将创建一个从下到上的渐变，90deg 将创建一个从左到右的渐变。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">background-image</span>: <span class="hljs-built_in">linear-gradient</span>(<span class="hljs-number">90deg</span>,color-stop1, color-stop2);<br></code></pre></td></tr></table></figure><p><img src="/img/css/diaodu.jpg" alt="image"></p><h4 id="多颜色结点"><a href="#多颜色结点" class="headerlink" title="多颜色结点"></a>多颜色结点</h4><p>彩虹色：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">background-image</span>: <span class="hljs-built_in">linear-gradient</span>(to right, red,orange,yellow,green,blue,indigo,violet);<br></code></pre></td></tr></table></figure><h4 id="重复线性渐变"><a href="#重复线性渐变" class="headerlink" title="重复线性渐变"></a>重复线性渐变</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">background-image</span>: <span class="hljs-built_in">repeating-linear-gradient</span>(red, yellow <span class="hljs-number">10%</span>, green <span class="hljs-number">20%</span>);<br></code></pre></td></tr></table></figure><h3 id="径向渐变"><a href="#径向渐变" class="headerlink" title="径向渐变"></a>径向渐变</h3><p>径向渐变由它的中心定义。<br>为了创建一个径向渐变，你也必须至少定义两种颜色结点。颜色结点即你想要呈现平稳过渡的颜色。同时，你也可以指定渐变的中心、形状（圆形或椭圆形）、大小。默认情况下，渐变的中心是 center（表示在中心点），渐变的形状是 ellipse（表示椭圆形），渐变的大小是 farthest-corner（表示到最远的角落）。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">background-image</span>: <span class="hljs-built_in">radial-gradient</span>(shape size at position, start-color, ..., last-color);<br></code></pre></td></tr></table></figure><h4 id="颜色节点均匀分布"><a href="#颜色节点均匀分布" class="headerlink" title="颜色节点均匀分布"></a>颜色节点均匀分布</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">background-image</span>: <span class="hljs-built_in">radial-gradient</span>(color1, color2, color3);<br></code></pre></td></tr></table></figure><h4 id="颜色节点不均匀分"><a href="#颜色节点不均匀分" class="headerlink" title="颜色节点不均匀分"></a>颜色节点不均匀分</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">background-image</span>: <span class="hljs-built_in">radial-gradient</span>(color1 <span class="hljs-number">5%</span>, color2 <span class="hljs-number">15%</span>, color3 <span class="hljs-number">60%</span>);<br></code></pre></td></tr></table></figure><h4 id="形状"><a href="#形状" class="headerlink" title="形状"></a>形状</h4><p>shape 参数定义了形状。它可以是值 circle 或 ellipse。其中，circle 表示圆形，ellipse 表示椭圆形。默认值是 ellipse。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">background-image</span>: <span class="hljs-built_in">radial-gradient</span>(circle,color1, color2, color3);<br></code></pre></td></tr></table></figure><h4 id="不同尺寸的关键字"><a href="#不同尺寸的关键字" class="headerlink" title="不同尺寸的关键字"></a>不同尺寸的关键字</h4><p>size 参数定义了渐变的大小。它可以是以下四个值：</p><blockquote><p>closest-side：最近边<br>farthest-side：最远边<br>closest-corner：最近角<br>farthest-corner：最远角</p></blockquote><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">background-image</span>: <span class="hljs-built_in">radial-gradient</span>(closest-side at <span class="hljs-number">60%</span> <span class="hljs-number">55%</span>,color1, color2, color3);<br></code></pre></td></tr></table></figure><h4 id="重复径向渐变"><a href="#重复径向渐变" class="headerlink" title="重复径向渐变"></a>重复径向渐变</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">background-image</span>: <span class="hljs-built_in">repeating-radial-gradient</span>(color1 <span class="hljs-number">5%</span>, color2 <span class="hljs-number">15%</span>, color3 <span class="hljs-number">60%</span>);<br></code></pre></td></tr></table></figure><h2 id="2D转换"><a href="#2D转换" class="headerlink" title="2D转换"></a>2D转换</h2><p>顺序问题：移动放在最前</p><h3 id="旋转"><a href="#旋转" class="headerlink" title="旋转"></a>旋转</h3><p>rotate()方法，在一个给定度数顺时针旋转的元素。负值是允许的，这样是元素逆时针旋转。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">transform</span>: <span class="hljs-built_in">rotate</span>(Xdeg);  度数<br></code></pre></td></tr></table></figure><h3 id="转换中心点"><a href="#转换中心点" class="headerlink" title="转换中心点"></a>转换中心点</h3><p>设置元素转换的中心点</p><ul><li>方位：left bottom</li><li>元素的中心点（百分比，百分比）</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">transform</span>-orgin:x y;<br></code></pre></td></tr></table></figure><h3 id="移动"><a href="#移动" class="headerlink" title="移动"></a>移动</h3><p>translate()方法，根据左(X轴)和顶部(Y轴)位置给定的参数，从当前元素位置移动。</p><p>百分比单位是相对于自身元素的百分比</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translate</span>(Xpx,Ypx);<br><span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(n);<br><span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(n);<br></code></pre></td></tr></table></figure><h3 id="缩放"><a href="#缩放" class="headerlink" title="缩放"></a>缩放</h3><p>scale()方法，该元素增加或减少的大小，取决于宽度（X轴）和高度（Y轴）的参数：</p><p>可以设置转换中心，默认以中心点缩放，不会影响其他盒子</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">transform</span>: <span class="hljs-built_in">scale</span>(X,Y);<br></code></pre></td></tr></table></figure><h3 id="扭曲"><a href="#扭曲" class="headerlink" title="扭曲"></a>扭曲</h3><p>skew() 方法,包含两个参数值，分别表示X轴和Y轴倾斜的角度，如果第二个参数为空，则默认为0，参数为负表示向相反方向倾斜。</p><blockquote><p>skewX();表示只在X轴(水平方向)倾斜。<br>skewY();表示只在Y轴(垂直方向)倾斜。</p></blockquote><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">transform</span>: <span class="hljs-built_in">skew</span>(Xdeg,Ydeg);<br></code></pre></td></tr></table></figure><h2 id="3D转换"><a href="#3D转换" class="headerlink" title="3D转换"></a>3D转换</h2><h3 id="旋转-1"><a href="#旋转-1" class="headerlink" title="旋转"></a>旋转</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">transform</span>: <span class="hljs-built_in">rotate3d</span>(x,y,z,angle);  //x,y,z代表方向<br></code></pre></td></tr></table></figure><ul><li>rotateX()方法，围绕其在一个给定度数X轴旋转的元素。</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">transform</span>: <span class="hljs-built_in">rotateX</span>(Xdeg);<br></code></pre></td></tr></table></figure><ul><li>rotateY()方法，围绕其在一个给定度数Y轴旋转的元素。</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">transform</span>: <span class="hljs-built_in">rotateY</span>(Ydeg);<br></code></pre></td></tr></table></figure><ul><li>rotateZ()方法，围绕其在一个给定度数Z轴旋转的元素。单位一般为px</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">transform</span>: <span class="hljs-built_in">rotateZ</span>(Zdeg);<br></code></pre></td></tr></table></figure><h3 id="平移"><a href="#平移" class="headerlink" title="平移"></a>平移</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translate3d</span>(Xpx,Ypx,Zpx);<br></code></pre></td></tr></table></figure><h3 id="缩放-1"><a href="#缩放-1" class="headerlink" title="缩放"></a>缩放</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">transform</span>: <span class="hljs-built_in">scale3d</span>(X,Y,Z);<br></code></pre></td></tr></table></figure><h2 id="扩展属性"><a href="#扩展属性" class="headerlink" title="扩展属性"></a>扩展属性</h2><h3 id="坐标系统"><a href="#坐标系统" class="headerlink" title="坐标系统"></a>坐标系统</h3><p>transform-Origin属性允许更改转换元素的位置。</p><blockquote><p>注意：2D转换元素可以改变元素的X和Y轴。 3D转换元素，还可以更改元素的Z轴。使用此属性必须先使用transform 属性。</p></blockquote><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">transform-origin</span>: x-axis y-axis z-axis;<br></code></pre></td></tr></table></figure><blockquote><p>x-axis:定义视图被置于 X 轴的何处。可能的值：left、center、right、length、%</p><p>y-axis:定义视图被置于 Y 轴的何处。可能的值：top、center、bottom、length、%</p><p>z-axis:<br>定义视图被置于 Z 轴的何处。可能的值：length</p></blockquote><h3 id="CSS3矩阵"><a href="#CSS3矩阵" class="headerlink" title="CSS3矩阵"></a>CSS3矩阵</h3><p>基本格式：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">transform</span>: <span class="hljs-built_in">matrix</span>(a,b,c,d,e,f);<br></code></pre></td></tr></table></figure><p>其中abcdef为</p><p><img src="/img/css/juzhen1.png" alt="avatar"> </p><p>应用中为</p><p><img src="/img/css/juzhen2.png" alt="avatar"><br>其中:<br>ax+cy+e &#x3D; 横坐标<br>bx+dy+f &#x3D; 纵坐标</p><p><strong>translate 矩阵</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">transform</span>: <span class="hljs-built_in">matrix</span>(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, X, Y); // X 横向平移, Y 纵向平移<br></code></pre></td></tr></table></figure><p><strong>scale 矩阵</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">transform</span>: <span class="hljs-built_in">matrix</span>(<span class="hljs-built_in">matrix</span>(A, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, B, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>); // 将 X 轴缩放 <span class="hljs-selector-tag">A</span> 倍,将 Y 轴缩放 <span class="hljs-selector-tag">B</span> 倍<br></code></pre></td></tr></table></figure><p><strong>skew 矩阵</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">transform</span>: <span class="hljs-built_in">matrix</span>(<span class="hljs-number">1</span>,<span class="hljs-built_in">tan</span>(A),<span class="hljs-built_in">tan</span>(B),<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>); // 将 Y 轴向 X 轴倾斜 <span class="hljs-selector-tag">A</span>°, 将 X 轴向 Y 轴倾斜 <span class="hljs-selector-tag">B</span>°<br></code></pre></td></tr></table></figure><p><strong>3D变换矩阵</strong><br>矩阵有变化</p><p><img src="/img/css/3djuzhen.png" alt="avatar"> </p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">transform</span>: <span class="hljs-built_in">matrix3d</span>(sx, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, sy, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, sz, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><h3 id="transfrom-style"><a href="#transfrom-style" class="headerlink" title="transfrom-style"></a>transfrom-style</h3><p>写给父盒子</p><p>transform–style属性指定嵌套元素是怎样在三维空间中呈现。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">transform-style</span>: flat;<br><span class="hljs-attribute">transform-style</span>: preserve-<span class="hljs-number">3</span>d;<br></code></pre></td></tr></table></figure><blockquote><p>flat:表示所有子元素在2D平面呈现。<br>preserve-3d:表示所有子元素在3D空间中呈现。</p></blockquote><h3 id="perspective"><a href="#perspective" class="headerlink" title="perspective"></a>perspective</h3><p>perspective 属性允许设置3D元素的透视关系。</p><blockquote><p>注意：perspective 属性只影响 3D 转换元素，与 perspective-origin 属性一同使用</p></blockquote><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">perspective</span>: number|none;<br></code></pre></td></tr></table></figure><blockquote><p>number:元素距离视图的距离，以像素计。<br>none:默认值。与 0 相同。不设置透视。</p></blockquote><h3 id="perspective-origin"><a href="#perspective-origin" class="headerlink" title="perspective-origin"></a>perspective-origin</h3><p>perspective-origin 属性定义 3D 元素所基于的 X 轴和 Y 轴标准。</p><blockquote><p>注意：它是一个元素的子元素，透视图，而不是元素本身。常与perspective属性组合使用。</p></blockquote><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">perspective-origin</span>: x-axis y-axis;<br></code></pre></td></tr></table></figure><blockquote><p>x-axis:定义该视图在 x 轴上的位置。默认值：50%。<br>可能的值： left 、 center 、right 、 length 、 %</p></blockquote><blockquote><p>y-axis:定义该视图在 y 轴上的位置。默认值：50%。<br>可能的值： top 、 center 、 bottom 、 length 、 %</p></blockquote><h3 id="backface-visibility"><a href="#backface-visibility" class="headerlink" title="backface-visibility"></a>backface-visibility</h3><p>backface-visibility 属性定义当元素不面向屏幕时是否可见。</p><blockquote><p>注意：如果在旋转元素不希望看到其背面时，该属性很有用处。</p></blockquote><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">backface-visibility</span>: visible|hidden;<br></code></pre></td></tr></table></figure><blockquote><p>visible:背面是可见的。<br>hidden:背面是不可见的。</p></blockquote><h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><p>使用过程中记得考虑兼容性</p><table><thead><tr><th>前缀</th><th>浏览器</th></tr></thead><tbody><tr><td>-webkit-</td><td>chrome、safari</td></tr><tr><td>-moz-</td><td>firefox</td></tr><tr><td>-ms-</td><td>IE</td></tr><tr><td>-o-</td><td>opera</td></tr></tbody></table><h2 id="图片模糊处理"><a href="#图片模糊处理" class="headerlink" title="图片模糊处理"></a>图片模糊处理</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">filter</span>:函数();<br><span class="hljs-attribute">filter</span>:<span class="hljs-built_in">blur</span>(<span class="hljs-number">5px</span>);blur 模糊处理，数值越大越模糊<br></code></pre></td></tr></table></figure><h2 id="计算盒子宽度calc"><a href="#计算盒子宽度calc" class="headerlink" title="计算盒子宽度calc"></a>计算盒子宽度calc</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">width</span>:<span class="hljs-built_in">calc</span>(<span class="hljs-number">100%</span> -<span class="hljs-number">80px</span>);<br></code></pre></td></tr></table></figure><h2 id="CSS3过渡"><a href="#CSS3过渡" class="headerlink" title="CSS3过渡"></a>CSS3过渡</h2><p>过渡动画：是从一个状态渐渐过渡到另外一个状态</p><p>通常和<code>:hover</code>一起使用</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">transition</span>: 要过度的属性 花费时间 运动曲线 何时开始;<br></code></pre></td></tr></table></figure><ul><li>属性：想要变化的css属性，宽度高度、背景颜色、内外边距都可以。所有属性写all</li><li>花费时间：单位是秒（必须要写单位）</li><li>运动曲线：默认是ease（可以省略）</li><li>何时开始：单位是秒（必须写单位），可以设置延迟触发事件，默认为0s，可以省略</li></ul><h4 id="1、transition-property"><a href="#1、transition-property" class="headerlink" title="1、transition-property"></a><strong>1、transition-property</strong></h4><p>说明：检索或者设置对象中的参与过渡的属性<br><code>transition-property:none/all/property;</code></p><blockquote><p>none：无属性改变<br>all：全属性改变。默认值<br>property：元素属性名</p></blockquote><h4 id="2、transition-duration"><a href="#2、transition-duration" class="headerlink" title="2、transition-duration"></a><strong>2、transition-duration</strong></h4><p>说明：检索或者设置对象过渡的持续时间<br><code>transition-duration：time；</code></p><blockquote><p>time：规定完成过渡效果需要花费的时间</p></blockquote><h4 id="3、transition-timing-function"><a href="#3、transition-timing-function" class="headerlink" title="3、transition-timing-function"></a><strong>3、transition-timing-function</strong></h4><p>说明：检索或者设置对象中过渡的动画类型</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">transition-timing-function</span>: linear; //线性过渡，贝塞尔曲线（<span class="hljs-number">0.0</span>，<span class="hljs-number">0.0</span>，<span class="hljs-number">1.0</span>，<span class="hljs-number">1.0</span>）<br><span class="hljs-attribute">transition-timing-function</span>: ease; //平滑过渡，贝塞尔曲线（<span class="hljs-number">0.25</span>，<span class="hljs-number">0.1</span>，<span class="hljs-number">0.25</span>，<span class="hljs-number">1.0</span>）<br><span class="hljs-attribute">transition-timing-function</span>: ease-in; //由慢到快，贝塞尔曲线（<span class="hljs-number">0.42</span>，<span class="hljs-number">0</span>，<span class="hljs-number">1.0</span>，<span class="hljs-number">1.0</span>）<br><span class="hljs-attribute">transition-timing-function</span>: ease-out; //由快到慢，贝塞尔曲线（<span class="hljs-number">0</span>，<span class="hljs-number">0</span>，<span class="hljs-number">0.58</span>，<span class="hljs-number">1.0</span>）<br><span class="hljs-attribute">transition-timing-function</span>: ease-in-out; //由慢到快再到慢，贝塞尔曲线（<span class="hljs-number">0.42</span>，<span class="hljs-number">0</span>，<span class="hljs-number">0.58</span>，<span class="hljs-number">1.0</span>）<br><span class="hljs-attribute">transition-timing-function</span>:<span class="hljs-built_in">cubic-bezier</span>(n,n,n,n); //贝塞尔曲线<br></code></pre></td></tr></table></figure><h4 id="4、transition-delay"><a href="#4、transition-delay" class="headerlink" title="4、transition-delay"></a><strong>4、transition-delay</strong></h4><p>说明：检索或者设置对象延迟过渡时间<br><code>transition-delay：time；</code></p><blockquote><p>time：切换效果开始前要等待的时间</p></blockquote><h2 id="动画"><a href="#动画" class="headerlink" title="动画"></a>动画</h2><ol><li>定义动画</li><li>调用动画</li></ol><h3 id="创建动画"><a href="#创建动画" class="headerlink" title="创建动画"></a>创建动画</h3><p><strong>@keyframes规则</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-keyword">@keyframes</span> animationname &#123;<br>    keyframes-selector &#123;css-styles;&#125;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><p>animationname:必需的。定义animation的名称。</p></li><li><p>keyframes-selector:必需的。动画持续时间的百分比。合法值：**0-100%**。  其中from (和0%相同)，to (和100%相同)</p></li></ul><blockquote><p>可以用一个动画keyframes-selectors。</p></blockquote><ul><li>css-styles:必需的。一个或多个合法的CSS样式属性</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-comment">/* from to 相当于 0% 到 100% */</span><br><span class="hljs-comment">/*定义淡出动画*/</span><br><span class="hljs-keyword">@keyframes</span> fadein &#123;<br>         <span class="hljs-number">0%</span>&#123;<br>    <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;     <br>    &#125;<br><br>        <span class="hljs-number">50%</span> &#123;<br>    <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>; <br>    &#125;<br>        <span class="hljs-number">100%</span> &#123;<br>    <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>; <br>    &#125; <br>&#125;<br></code></pre></td></tr></table></figure><h3 id="CSS3动画"><a href="#CSS3动画" class="headerlink" title="CSS3动画"></a>CSS3动画</h3><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">animation:</span> 动画名称 持续时间 运动曲线 播放次数 是否反方向 动画起始或者结束的状态<br></code></pre></td></tr></table></figure><h4 id="1、animation-name"><a href="#1、animation-name" class="headerlink" title="1、animation-name"></a>1、<strong>animation-name</strong></h4><p>说明：属性检索或者设置对象所应用的动画名称<br><code>animation-name: keyframename/none;</code></p><blockquote><p>keyframename：指定要绑定到选择器的关键帧的名称；<br>none：指定有没有动画（可用于覆盖从级联的动画）；</p></blockquote><h4 id="2、animation-duration"><a href="#2、animation-duration" class="headerlink" title="2、animation-duration"></a>2、<strong>animation-duration</strong></h4><p>说明：属性检索或者设置对象动画的持续时间<br><code>animation-duration: time;</code></p><blockquote><p>time：指定动画播放完成花费的时间<br>注意：如果只设置动画播放一次，该属性将不起作用。</p></blockquote><h4 id="3、animation-timing-function"><a href="#3、animation-timing-function" class="headerlink" title="3、animation-timing-function"></a>3、<strong>animation-timing-function</strong></h4><p>说明：检索或者设置对象动画的过渡类型</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs css">  <span class="hljs-attribute">animation-timing-function</span>: linear; //线性过渡，贝塞尔曲线（<span class="hljs-number">0.0</span>，<span class="hljs-number">0.0</span>，<span class="hljs-number">1.0</span>，<span class="hljs-number">1.0</span>）<br>  <span class="hljs-attribute">animation-timing-function</span>: ease; //平滑过渡，贝塞尔曲线（<span class="hljs-number">0.25</span>，<span class="hljs-number">0.1</span>，<span class="hljs-number">0.25</span>，<span class="hljs-number">1.0</span>）<br>  <span class="hljs-attribute">animation-timing-function</span>: ease-in; //由慢到快，贝塞尔曲线（<span class="hljs-number">0.42</span>，<span class="hljs-number">0</span>，<span class="hljs-number">1.0</span>，<span class="hljs-number">1.0</span>）<br>  <span class="hljs-attribute">animation-timing-function</span>: ease-out; //由快到慢，贝塞尔曲线（<span class="hljs-number">0</span>，<span class="hljs-number">0</span>，<span class="hljs-number">0.58</span>，<span class="hljs-number">1.0</span>）<br>  <span class="hljs-attribute">animation-timing-function</span>: ease-in-out; //由慢到快再到慢，贝塞尔曲线（<span class="hljs-number">0.42</span>，<span class="hljs-number">0</span>，<span class="hljs-number">0.58</span>，<span class="hljs-number">1.0</span>）<br>  <span class="hljs-attribute">animation-timing-function</span>:<span class="hljs-built_in">cubic-bezier</span>(n,n,n,n); //贝塞尔曲线<br><span class="hljs-attribute">animation-timing-function</span>:<span class="hljs-built_in">steps</span>();//指定了时间函数中的间隔数量（步长）<br></code></pre></td></tr></table></figure><h4 id="4、animation-delay"><a href="#4、animation-delay" class="headerlink" title="4、animation-delay"></a><strong>4、animation-delay</strong></h4><p>说明：属性检索或者设置对象动画延迟时间<br><code>animation-delay: time;</code></p><blockquote><p>animation-delay 值单位可以是秒（s）或毫秒（ms）。<br>允许负值，-3s 是跳过前3s动画</p></blockquote><h4 id="5、animation-iteration-count"><a href="#5、animation-iteration-count" class="headerlink" title="5、animation-iteration-count"></a><strong>5、animation-iteration-count</strong></h4><p>说明：属性检索或者设置对象的循环次数<br><code>animation-iteration-count: value;</code></p><blockquote><p>value：一个数字，定义应该播放多少次动画<br>infinite：指定动画应该播放无限次（永远）</p></blockquote><h4 id="6、animation-direction"><a href="#6、animation-direction" class="headerlink" title="6、animation-direction"></a><strong>6、animation-direction</strong></h4><p>说明：检索或者设置对象动画在循环中是否反向运动<br><code>animation-direction: normal/reverse/alternate/alternate-reverse/initial/inherit;</code></p><blockquote><p>normal：默认值。动画按正常播放。</p><p>reverse：动画反向播放。</p><p>alternate：动画在奇数次（1、3、5…）正向播放，在偶数次（2、4、6…）反向播放。</p><p>alternate-reverse：动画在奇数次（1、3、5…）反向播放，在偶数次（2、4、6…）正向播放。</p><p>initial：设置该属性为它的默认值。</p><p>inherit：从父元素继承该属性。</p></blockquote><h4 id="7、animation-fill-mode"><a href="#7、animation-fill-mode" class="headerlink" title="7、animation-fill-mode"></a><strong>7、animation-fill-mode</strong></h4><p>说明：规定当动画不播放的时候，应用的元素样式<br><code>animation-fill-mode: none/forwards/backwards/both/initial/inherit;</code></p><blockquote><p>none：默认值。动画在动画执行之前和之后不会应用任何样式到目标元素。</p><p>forwards：在动画结束后（由 animation-iteration-count 决定），动画将应用该属性值。</p><p>backwards：动画将应用在 animation-delay定义期间启动动画的第一次迭代的关键帧中定义的属性值。这些都是 from 关键帧中的值（当 animation-direction 为 “normal” 或 “alternate” 时）或 to 关键帧中的值（当 animation-direction 为 “reverse” 或 “alternate-reverse” 时）。</p><p>both：动画遵循 forwards 和 backwards 的规则。也就是说，动画会在两个方向上扩展动画属性。</p><p>initial：设置该属性为它的默认值。</p><p>inherit：从父元素继承该属性。</p></blockquote><h4 id="8、animation-play-state"><a href="#8、animation-play-state" class="headerlink" title="8、animation-play-state"></a><strong>8、animation-play-state</strong></h4><p>说明：属性指定动画是否正在运行或者已停止<br><code>animation-play-state: paused/running;</code></p><blockquote><p>paused：指定暂停动画<br>running：指定正在运行的动画</p></blockquote><h2 id="流式布局"><a href="#流式布局" class="headerlink" title="流式布局"></a>流式布局</h2><p>很少用</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">section</span> <span class="hljs-selector-tag">div</span>&#123;<br>样式<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="flexbox布局"><a href="#flexbox布局" class="headerlink" title="flexbox布局"></a>flexbox布局</h2><h3 id="容器属性"><a href="#容器属性" class="headerlink" title="容器属性"></a>容器属性</h3><p>主轴、侧轴  相当于x轴、y轴或行和列</p><h4 id="flex-direction"><a href="#flex-direction" class="headerlink" title="flex-direction"></a>flex-direction</h4><p>flex-direction 属性指定了弹性子元素在父容器中的位置。</p><p>设置主轴的方向</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">flex-direction</span>: row;                //横向从左到右排列（左对齐），默认的排列方式。从左到右<br><span class="hljs-attribute">flex-direction</span>: row-reverse;        //反转横向排列（右对齐，从后往前排，最后一项排在最前面。)从右到左<br><span class="hljs-attribute">flex-direction</span>: column;             //纵向排列。从上到下<br><span class="hljs-attribute">flex-direction</span>: column-reverse;     //反转纵向排列，从后往前排，最后一项排在最上面。从下到上<br></code></pre></td></tr></table></figure><h4 id="justify-content"><a href="#justify-content" class="headerlink" title="justify-content"></a>justify-content</h4><p>内容对齐（justify-content）属性应用在弹性容器上，把弹性项沿着弹性容器的主轴线（main axis）对齐。</p><p>设置主轴上的子元素排列方式</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">justify-content</span>: flex-start;        //弹性项目向行头紧挨着填充。默认从头部开始，如果主轴是x轴，则从左到右<br><span class="hljs-attribute">justify-content</span>: flex-end;          //弹性项目向行尾紧挨着填充。从尾部开始排列<br><span class="hljs-attribute">justify-content</span>: center;            //弹性项目居中紧挨着填充.在主轴剧中对齐,如果主轴是x轴，则水平居中<br><span class="hljs-attribute">justify-content</span>: space-between;     //弹性项目平均分布在该行上。先两边贴边，再平分剩余空间<br><span class="hljs-attribute">justify-content</span>: space-around;      //弹性项目平均分布在该行上，两边留有一半的间隔空间。平分剩余空间<br></code></pre></td></tr></table></figure><h4 id="align-items"><a href="#align-items" class="headerlink" title="align-items"></a>align-items</h4><p>align-items 设置或检索弹性盒子元素在侧轴（纵轴）方向上的对齐方式。</p><p>设置侧轴上的子元素的排列方式（单行） </p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">align-items</span>: flex-start;//从上到下<br><span class="hljs-attribute">align-items</span>: flex-end;//从下到上<br><span class="hljs-attribute">align-items</span>: center;//垂直居中<br><span class="hljs-attribute">align-items</span>: baseline;          //如弹性盒子元素的行内轴与侧轴为同一条，则该值与&#x27;<span class="hljs-attribute">flex</span>-start&#x27;等效。其它情况下，该值将参与基线对齐。<br><span class="hljs-attribute">align-items</span>: stretch;//拉伸，子盒子不给高度      //如果指定侧轴大小的属性值为&#x27;auto&#x27;，则其值会使项目的边距盒的尺寸尽可能接近所在行的尺寸，但同时会遵照&#x27;min/<span class="hljs-attribute">max-width</span>/<span class="hljs-attribute">height</span>&#x27;属性的限制。<br></code></pre></td></tr></table></figure><h4 id="flex-wrap"><a href="#flex-wrap" class="headerlink" title="flex-wrap"></a>flex-wrap</h4><p>flex-wrap 属性用于指定弹性盒子的子元素换行方式。</p><p>设置子元素是否换行</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">flex-wrap</span>: nowrap;                  //默认单行<br><span class="hljs-attribute">flex-wrap</span>: wrap;                    //多行            <br><span class="hljs-attribute">flex-wrap</span>: wrap-reverse;            //反转 wrap 排列。<br></code></pre></td></tr></table></figure><h4 id="flex-flow"><a href="#flex-flow" class="headerlink" title="flex-flow"></a>flex-flow</h4><p>符合属性，相当于同时设置了flex-direction和flex-wrap</p><p>flex-flow属性是flex-direction属性和flex-wrap属性的简写形式，默认值为row nowrap。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.box</span> &#123;<br>  <span class="hljs-attribute">flex-flow</span>: &lt;flex-direction&gt; || &lt;flex-wrap&gt;;<br>&#125;<br><span class="hljs-selector-class">.box</span> &#123;<br>  <span class="hljs-attribute">flex-flow</span>: row nowrap;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="align-content"><a href="#align-content" class="headerlink" title="align-content"></a>align-content</h4><p>align-content 属性用于修改 flex-wrap 属性的行为。类似于 align-items, 但它不是设置弹性子元素的对齐，而是设置各个行的对齐。</p><p>设置侧轴上的子元素的排列方式（多行）</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">align-content</span>: flex-start | flex-end | center | space-between | space-around | stretch;<br></code></pre></td></tr></table></figure><blockquote><p>stretch - 默认。各行将会伸展以占用剩余的空间。</p></blockquote><blockquote><p>flex-start - 各行向弹性盒容器的起始位置堆叠。</p></blockquote><blockquote><p>flex-end - 各行向弹性盒容器的结束位置堆叠。</p></blockquote><blockquote><p>center -各行向弹性盒容器的中间位置堆叠。</p></blockquote><blockquote><p>space-between -各行在弹性盒容器中平均分布。</p></blockquote><blockquote><p>space-around - 各行在弹性盒容器中平均分布，两端保留子元素与子元素之间间距大小的一半。</p></blockquote><h3 id="子元素属性"><a href="#子元素属性" class="headerlink" title="子元素属性"></a>子元素属性</h3><h4 id="1-order-1"><a href="#1-order-1" class="headerlink" title="1. order : 1"></a>1. <strong>order : 1</strong></h4><p>用整数值来定义排列顺序，数值小的排在前面。可以为负值。</p><h4 id="2-align-self"><a href="#2-align-self" class="headerlink" title="2. align-self"></a>2. <strong>align-self</strong></h4><p>控制子项自己在侧轴上的排列方式</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">align-self</span>: auto | flex-start | flex-end | center | baseline | stretch;<br></code></pre></td></tr></table></figure><blockquote><p>auto：如果’align-self’的值为’auto’，则其计算值为元素的父元素的’align-items’值，如果其没有父元素，则计算值为’stretch’。<br>flex-start：弹性盒子元素的侧轴（纵轴）起始位置的边界紧靠住该行的侧轴起始边界。<br>flex-end：弹性盒子元素的侧轴（纵轴）起始位置的边界紧靠住该行的侧轴结束边界。<br>center：弹性盒子元素在该行的侧轴（纵轴）上居中放置。（如果该行的尺寸小于弹性盒子元素的尺寸，则会向两个方向溢出相同的长度）。<br>baseline：如弹性盒子元素的行内轴与侧轴为同一条，则该值与’flex-start’等效。其它情况下，该值将参与基线对齐。<br>stretch：如果指定侧轴大小的属性值为’auto’，则其值会使项目的边距盒的尺寸尽可能接近所在行的尺寸，但同时会遵照’min&#x2F;max-width&#x2F;height’属性的限制。</p></blockquote><h4 id="3-flex：1"><a href="#3-flex：1" class="headerlink" title="3. flex：1"></a>3. <strong>flex</strong>：1</h4><p>flex 属性用于指定弹性子元素如何分配空间。</p><p>flex属性定义子项目分配剩余空间，用flex来表示占多少份数</p><figure class="highlight sml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sml">.item &#123;<br>  flex: none | [ &lt;<span class="hljs-symbol">&#x27;flex</span>-grow&#x27;&gt; &lt;<span class="hljs-symbol">&#x27;flex</span>-shrink&#x27;&gt;? || &lt;<span class="hljs-symbol">&#x27;flex</span>-basis&#x27;&gt; ]<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="4-flex-grow"><a href="#4-flex-grow" class="headerlink" title="4. flex-grow"></a>4. flex-grow</h4><p>flex-grow属性定义项目的放大比例，默认为0，即如果存在剩余空间，也不放大。</p><h4 id="5-flex-shrink"><a href="#5-flex-shrink" class="headerlink" title="5. flex-shrink"></a>5. flex-shrink</h4><p>flex-shrink属性定义了项目的缩小比例，默认为1，即如果空间不足，该项目将缩小。</p><h4 id="6-flex-basis"><a href="#6-flex-basis" class="headerlink" title="6. flex-basis"></a>6. flex-basis</h4><p>flex-basis属性定义了在分配多余空间之前，项目占据的主轴空间（main size）。浏览器根据这个属性，计算主轴是否有多余空间。它的默认值为auto，即项目的本来大小</p><p><img src="/img/css/flex.png" alt="avatar"> </p><p>Adblocker</p><h2 id="Grid布局"><a href="#Grid布局" class="headerlink" title="Grid布局"></a>Grid布局</h2><p>即网格布局</p><h3 id="容器"><a href="#容器" class="headerlink" title="容器"></a>容器</h3><p>和flex类似，需要给个容器</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">div</span> &#123;<br>  <span class="hljs-attribute">display</span>: grid;<br>&#125;<br></code></pre></td></tr></table></figure><p>对于网格布局<br>如图</p><p><img src="/img/css/wangge.png" alt="avatar"> </p><h3 id="grid-template"><a href="#grid-template" class="headerlink" title="grid-template"></a>grid-template</h3><h3 id="行与列"><a href="#行与列" class="headerlink" title="行与列"></a>行与列</h3><p>设置行宽与宽高，单位可以用px、%、fr、em、还有<code>repeat()</code>进行方便改写</p><blockquote><p>列 : <code>grid-template-columns</code><br>行 : <code>grid-template-rows</code></p></blockquote><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.container</span> &#123;<br>  <span class="hljs-attribute">display</span>: grid;<br>  <span class="hljs-attribute">grid-template-columns</span>: <span class="hljs-number">100px</span> <span class="hljs-number">100px</span> <span class="hljs-number">100px</span>;<br>  <span class="hljs-attribute">grid-template-rows</span>: <span class="hljs-number">100px</span> <span class="hljs-number">100px</span> <span class="hljs-number">100px</span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.container</span> &#123;<br>  <span class="hljs-attribute">display</span>: grid;<br>  <span class="hljs-attribute">grid-template-columns</span>: <span class="hljs-number">1</span>fr <span class="hljs-number">1</span>fr;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.container</span> &#123;<br>  <span class="hljs-attribute">display</span>: grid;<br>  <span class="hljs-attribute">grid-template-columns</span>: <span class="hljs-built_in">repeat</span>(<span class="hljs-number">3</span>, <span class="hljs-number">33.33%</span>);<br>  <span class="hljs-attribute">grid-template-rows</span>: <span class="hljs-built_in">repeat</span>(<span class="hljs-number">3</span>, <span class="hljs-number">33.33%</span>);<br><br>  //或者重复某一模式 <span class="hljs-attribute">grid-template-columns</span>: <span class="hljs-built_in">repeat</span>(<span class="hljs-number">2</span>, <span class="hljs-number">100px</span> <span class="hljs-number">20px</span> <span class="hljs-number">80px</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>自动填充列数可以用<code>auto-fill</code>关键字</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.container</span> &#123;<br>  <span class="hljs-attribute">display</span>: grid;<br>  <span class="hljs-attribute">grid-template-columns</span>: <span class="hljs-built_in">repeat</span>(auto-fill, <span class="hljs-number">100px</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>定义长度范围<code>minmax()</code></strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">grid-template-columns</span>: <span class="hljs-number">1</span>fr <span class="hljs-number">1</span>fr <span class="hljs-built_in">minmax</span>(<span class="hljs-number">100px</span>, <span class="hljs-number">1</span>fr);<br></code></pre></td></tr></table></figure><p><strong>自动填充长度<code>auto</code></strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">grid-template-columns</span>: <span class="hljs-number">100px</span> auto <span class="hljs-number">100px</span>;<br></code></pre></td></tr></table></figure><h3 id="网格线命名"><a href="#网格线命名" class="headerlink" title="网格线命名"></a>网格线命名</h3><p><code>grid-template-columns</code>属性和<code>grid-template-rows</code>属性里面，还可以使用方括号，指定每一根网格线的名字，方便以后的引用。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.container</span> &#123;<br>  <span class="hljs-attribute">display</span>: grid;<br>  <span class="hljs-attribute">grid-template-columns</span>: [c1] <span class="hljs-number">100px</span> [c2] <span class="hljs-number">100px</span> [c3] auto [c4];<br>  <span class="hljs-attribute">grid-template-rows</span>: [r1] <span class="hljs-number">100px</span> [r2] <span class="hljs-number">100px</span> [r3] auto [r4];<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="grid-template-1"><a href="#grid-template-1" class="headerlink" title="grid-template"></a>grid-template</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-comment">/* 为 grid-template-rows / grid-template-columns */</span><br>  <span class="hljs-attribute">grid-template</span>: <span class="hljs-number">1</span>fr <span class="hljs-number">1</span>fr/ifr <span class="hljs-number">1</span>fr;<br></code></pre></td></tr></table></figure><h3 id="grid-gap"><a href="#grid-gap" class="headerlink" title="grid-gap"></a>grid-gap</h3><p>设置间隔</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.container</span> &#123;<br>  <span class="hljs-attribute">grid-row</span>-<span class="hljs-attribute">gap</span>: <span class="hljs-number">20px</span>;<br>  <span class="hljs-attribute">grid-column</span>-<span class="hljs-attribute">gap</span>: <span class="hljs-number">20px</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>又或者<code>grid-gap: &lt;grid-row-gap&gt; &lt;grid-column-gap&gt;;</code></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.container</span> &#123;<br>  <span class="hljs-attribute">grid-gap</span>: <span class="hljs-number">20px</span> <span class="hljs-number">20px</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="grid-template-areas"><a href="#grid-template-areas" class="headerlink" title="grid-template-areas"></a>grid-template-areas</h3><p>设置区域</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.container</span> &#123;<br>  <span class="hljs-attribute">display</span>: grid;<br>  <span class="hljs-attribute">grid-template-columns</span>: <span class="hljs-number">100px</span> <span class="hljs-number">100px</span> <span class="hljs-number">100px</span>;<br>  <span class="hljs-attribute">grid-template-rows</span>: <span class="hljs-number">100px</span> <span class="hljs-number">100px</span> <span class="hljs-number">100px</span>;<br>  <span class="hljs-attribute">grid-template-areas</span>: <span class="hljs-string">&#x27;a b c&#x27;</span><br>                       <span class="hljs-string">&#x27;d e f&#x27;</span><br>                       <span class="hljs-string">&#x27;g h i&#x27;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>有区域不用时，用<code>.</code>表示</p></blockquote><h3 id="grid-auto-flow"><a href="#grid-auto-flow" class="headerlink" title="grid-auto-flow"></a>grid-auto-flow</h3><p>设置顺序</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-attribute">grid-auto-flow</span>: row;        //默认。先行后列<br><span class="hljs-attribute">grid-auto-flow</span>: column;         //先列后行<br><span class="hljs-attribute">grid-auto-flow</span>: row dense;      //先行后列，并且尽可能紧密填满，尽量不出现空格。<br><span class="hljs-attribute">grid-auto-flow</span>: column dense;       //先列后行，并且尽可能紧密填满，尽量不出现空格。<br></code></pre></td></tr></table></figure><h3 id="items"><a href="#items" class="headerlink" title="items"></a>items</h3><p>分<code>justify-items</code>、<code>align-items</code>和<code>place-items</code></p><p>设置单元格内容的位置</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.container</span> &#123;<br>  justify-items: start | end | center | stretch;<br>  <span class="hljs-attribute">align-items</span>: start | end | center | stretch;<br>&#125;<br></code></pre></td></tr></table></figure><p>其中</p><ul><li><p>start：对齐单元格的起始边缘。</p></li><li><p>end：对齐单元格的结束边缘。</p></li><li><p>center：单元格内部居中。</p></li><li><p>stretch：拉伸，占满单元格的整个宽度（默认值）。</p></li></ul><p><code>place-items</code>即简写</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">place-items: &lt;align-items&gt; &lt;justify-items&gt;;<br></code></pre></td></tr></table></figure><h3 id="content"><a href="#content" class="headerlink" title="content"></a>content</h3><p>分<code>justify-content</code>、<code>align-content</code>和<code>place-content</code></p><p>设置内容的位置</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.container</span> &#123;<br>  <span class="hljs-attribute">justify-content</span>: start | end | center | stretch | space-around | space-between | space-evenly;<br>  <span class="hljs-attribute">align-content</span>: start | end | center | stretch | space-around | space-between | space-evenly;  <br>&#125;<br></code></pre></td></tr></table></figure><ul><li><p>start - 对齐容器的起始边框。</p></li><li><p>end - 对齐容器的结束边框。</p></li><li><p>center - 容器内部居中。</p></li><li><p>stretch - 项目大小没有指定时，拉伸占据整个网格容器。</p></li><li><p>space-around - 每个项目两侧的间隔相等。所以，项目之间的间隔比项目与容器边框的间隔大一倍。</p></li><li><p>space-between - 项目与项目的间隔相等，项目与容器边框之间没有间隔。</p></li><li><p>space-evenly - 项目与项目的间隔相等，项目与容器边框之间也是同样长度的间隔。</p></li></ul><p><code>place-content</code>即简写</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">place-<span class="hljs-attribute">content</span>: &lt;align-content&gt; &lt;justify-content&gt;；<br></code></pre></td></tr></table></figure><h2 id="rem布局"><a href="#rem布局" class="headerlink" title="rem布局"></a>rem布局</h2><h3 id="rem单位"><a href="#rem单位" class="headerlink" title="rem单位"></a>rem单位</h3><p>rem是一个相对单位，类似于em，em是相对于父元素字体大小</p><blockquote><p>rem的基准是相对于html的字体大小</p><p>优点：可以通过修改html里面的字体大小来改变页面中元素的大小，可以整体控制</p></blockquote><h3 id="媒体查询"><a href="#媒体查询" class="headerlink" title="媒体查询"></a>媒体查询</h3><ul><li>使用@media查询，可以针对不同的媒体类型定义不同的样式</li><li>@media可以针对不同的屏幕尺寸设置不同的样式</li><li>当你重置浏览器大小的过程中，页面会根据浏览器的宽高重新渲染页面</li><li>目前针对很多苹果手机、安卓手机，平板等设备都用得到多媒体查询</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-keyword">@media</span> mediatype <span class="hljs-keyword">and</span>|<span class="hljs-keyword">not</span>|<span class="hljs-keyword">only</span> (media feature)&#123;<br>样式<br>&#125;<br></code></pre></td></tr></table></figure><p>@media 开头</p><p><strong>mediatype媒体类型</strong></p><ul><li>all——所有设备</li><li>print——打印机和打印预览</li><li>scree——电脑屏幕、平板电脑、智能手机等</li></ul><p><strong>关键字</strong></p><ul><li>and——多个媒体特性连接到一起</li><li>not——排除某个媒体类型</li><li>only——指定某个特定的媒体类型，可以省略</li></ul><p><strong>media feature</strong>媒体特性，必须要小括号包含</p><ul><li>width——定义输出设备中页面可见区域的宽度</li><li>min-width——定义输出设备中页面最小可见宽度</li><li>max-width——定义输出设备中页面最大可见宽度</li></ul><h3 id="媒体查询引入资源"><a href="#媒体查询引入资源" class="headerlink" title="媒体查询引入资源"></a>媒体查询引入资源</h3><blockquote><p>其实就是针对不同的屏幕尺寸，调用不同的css</p></blockquote><p>link</p><h2 id="less"><a href="#less" class="headerlink" title="less"></a>less</h2><p>css扩展语言，也称为css预处理器</p><p>在css的基础上，引入变量，Mixin，运算及函数等、</p><p>文件后缀为less</p><h3 id="less基础"><a href="#less基础" class="headerlink" title="less基础"></a>less基础</h3><h4 id="1、less变量"><a href="#1、less变量" class="headerlink" title="1、less变量"></a>1、less变量</h4><p>变量是指没有固定的值，可以改变的</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">@变量名:值;<br></code></pre></td></tr></table></figure><blockquote><p>变量名：不能包含特殊字符、不能以数字开头、大小写敏感</p></blockquote><h4 id="2、less编译"><a href="#2、less编译" class="headerlink" title="2、less编译"></a>2、less编译</h4><p>保存，就可以生成一个css</p><h4 id="3、less嵌套"><a href="#3、less嵌套" class="headerlink" title="3、less嵌套"></a>3、less嵌套</h4><ul><li>子元素的样式直接写到父元素的样式里面即可</li></ul><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-selector-id">#header</span> &#123;<br><span class="hljs-selector-class">.logo</span> &#123;<br><span class="hljs-attribute">width</span>:<span class="hljs-number">300px</span>;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>如果遇到（交集|伪类|伪元素选择器）</p><ul><li>内层选择器的前面没有**&amp;**符号，则它被解析为父选择器的后代</li><li>如果有**&amp;**符号，它就被解析为父元素自身或父元素的伪类</li></ul><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-selector-id">#header</span> &#123;<br><span class="hljs-selector-class">.logo</span> &#123;<br><span class="hljs-selector-tag">&amp;</span><span class="hljs-selector-pseudo">:hover</span> &#123;<br><span class="hljs-attribute">color</span>:bule;<br>&#125;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="4、less运算"><a href="#4、less运算" class="headerlink" title="4、less运算"></a>4、less运算</h4><p>任何数字、颜色或者变量都可以进行运算</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@width:</span> <span class="hljs-number">20px</span> -<span class="hljs-number">50</span>;<br></code></pre></td></tr></table></figure><ul><li>运算符的左右两侧必须空格隔开</li><li>两个数参与运算，如果只有一个数有单位，则结果以这个单位为准</li><li>如果两个数都有单位，则结果以第一个单位为准</li></ul><h3 id="rem适配方案"><a href="#rem适配方案" class="headerlink" title="rem适配方案"></a>rem适配方案</h3><p>1、rem+媒体查询+less技术</p><p>2、flexible.js+rem</p><p><img src="/img/css/remstyle.png" alt="avatar"> </p><h2 id="项目属性"><a href="#项目属性" class="headerlink" title="项目属性"></a>项目属性</h2><h3 id="定位"><a href="#定位" class="headerlink" title="定位"></a>定位</h3><p><code>grid-column-start</code> 属性</p><blockquote><p>左边框所在的垂直网格线</p></blockquote><p><code>grid-column-end</code> 属性</p><blockquote><p>右边框所在的垂直网格线</p></blockquote><p><code>grid-row-start</code> 属性</p><blockquote><p>上边框所在的水平网格线</p></blockquote><p><code>grid-row-end</code> 属性</p><blockquote><p>下边框所在的水平网格线</p></blockquote><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.item-1</span> &#123;<br>  <span class="hljs-attribute">grid-column-start</span>: <span class="hljs-number">1</span>;<br>  <span class="hljs-attribute">grid-column-end</span>: <span class="hljs-number">3</span>;<br>  <span class="hljs-attribute">grid-row-start</span>: <span class="hljs-number">2</span>;<br>  <span class="hljs-attribute">grid-row-end</span>: <span class="hljs-number">4</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>span代表跨域</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.item-1</span> &#123;<br>  <span class="hljs-attribute">grid-column-start</span>: span <span class="hljs-number">2</span>;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>会产生重叠</p></blockquote><p><strong>简写</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.item-1</span> &#123;<br>  <span class="hljs-attribute">grid-column</span>: <span class="hljs-number">1</span> / <span class="hljs-number">3</span>;<br>  <span class="hljs-attribute">grid-row</span>: <span class="hljs-number">1</span> / <span class="hljs-number">2</span>;<br>&#125;<br><span class="hljs-comment">/* 等同于 */</span><br><span class="hljs-selector-class">.item-1</span> &#123;<br>  <span class="hljs-attribute">grid-column-start</span>: <span class="hljs-number">1</span>;<br>  <span class="hljs-attribute">grid-column-end</span>: <span class="hljs-number">3</span>;<br>  <span class="hljs-attribute">grid-row-start</span>: <span class="hljs-number">1</span>;<br>  <span class="hljs-attribute">grid-row-end</span>: <span class="hljs-number">2</span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.item-1</span> &#123;<br>  <span class="hljs-attribute">grid-column</span>: <span class="hljs-number">1</span> / <span class="hljs-number">3</span>;<br>  <span class="hljs-attribute">grid-row</span>: <span class="hljs-number">1</span> / <span class="hljs-number">3</span>;<br>&#125;<br><span class="hljs-comment">/* 等同于 */</span><br><span class="hljs-selector-class">.item-1</span> &#123;<br>  <span class="hljs-attribute">grid-column</span>: <span class="hljs-number">1</span> / span <span class="hljs-number">2</span>;<br>  <span class="hljs-attribute">grid-row</span>: <span class="hljs-number">1</span> / span <span class="hljs-number">2</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p> <strong>grid-area</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.item</span> &#123;<br>  <span class="hljs-attribute">grid-area</span>: &lt;row-start&gt; / &lt;column-start&gt; / &lt;row-end&gt; / &lt;column-end&gt;;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="位置"><a href="#位置" class="headerlink" title="位置"></a>位置</h3><p><code>justify-self</code>属性设置单元格内容的水平位置（左中右），跟<code>justify-items</code>属性的用法完全一致，但只作用于单个项目。</p><p><code>align-self</code>属性设置单元格内容的垂直位置（上中下），跟<code>align-items</code>属性的用法完全一致，也是只作用于单个项目。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.item</span> &#123;<br>  justify-self: start | end | center | stretch;<br>  <span class="hljs-attribute">align-self</span>: start | end | center | stretch;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>place-self简写</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">place-self: &lt;align-self&gt; &lt;justify-self&gt;;<br></code></pre></td></tr></table></figure><h2 id="CSS-滑动栏样式"><a href="#CSS-滑动栏样式" class="headerlink" title="CSS 滑动栏样式"></a>CSS 滑动栏样式</h2><blockquote><p>::-webkit-scrollbar-corner 边角<br>::-webkit-resizer 定义右下角拖动块的样式</p></blockquote><h3 id="1、-webkit-scrollbar"><a href="#1、-webkit-scrollbar" class="headerlink" title="1、::-webkit-scrollbar"></a>1、::-webkit-scrollbar</h3><p>定义了滚动条整体的样式；如宽度啥的</p><blockquote><p>::-webkit-scrollbar-button 滚动条两端的按钮</p></blockquote><h3 id="2、-webkit-scrollbar-thumb"><a href="#2、-webkit-scrollbar-thumb" class="headerlink" title="2、::-webkit-scrollbar-thumb"></a>2、::-webkit-scrollbar-thumb</h3><p>滑块部分；</p><blockquote><p>::-webkit-scrollbar-track-piece  内层滚动槽&#x3D;</p></blockquote><h3 id="3、-webkit-scrollbar-track"><a href="#3、-webkit-scrollbar-track" class="headerlink" title="3、::-webkit-scrollbar-track"></a>3、::-webkit-scrollbar-track</h3><p>轨道部分；</p><h3 id="简易样式1"><a href="#简易样式1" class="headerlink" title="简易样式1"></a>简易样式1</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.test-1</span>::-webkit-scrollbar &#123;<span class="hljs-comment">/*滚动条整体样式*/</span><br>        <span class="hljs-attribute">width</span>: <span class="hljs-number">10px</span>;     <span class="hljs-comment">/*高宽分别对应横竖滚动条的尺寸*/</span><br>        <span class="hljs-attribute">height</span>: <span class="hljs-number">1px</span>;<br>&#125;<br><span class="hljs-selector-class">.test-1</span>::-webkit-scrollbar-thumb &#123;<span class="hljs-comment">/*滚动条里面小方块*/</span><br>        <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">10px</span>;<br>         -webkit-<span class="hljs-attribute">box-shadow</span>: inset <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">5px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0.2</span>);<br>        <span class="hljs-attribute">background</span>: <span class="hljs-number">#535353</span>;<br>&#125;<br><span class="hljs-selector-class">.test-1</span>::-webkit-scrollbar-track &#123;<span class="hljs-comment">/*滚动条里面轨道*/</span><br>        -webkit-<span class="hljs-attribute">box-shadow</span>: inset <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">5px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0.2</span>);<br>        <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">10px</span>;<br>        <span class="hljs-attribute">background</span>: <span class="hljs-number">#EDEDED</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="简易样式2"><a href="#简易样式2" class="headerlink" title="简易样式2"></a>简易样式2</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.test-5</span>::-webkit-scrollbar &#123;<span class="hljs-comment">/*滚动条整体样式*/</span><br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">10px</span>;     <span class="hljs-comment">/*高宽分别对应横竖滚动条的尺寸*/</span><br>    <span class="hljs-attribute">height</span>: <span class="hljs-number">1px</span>;<br>&#125;<br><span class="hljs-selector-class">.test-5</span>::-webkit-scrollbar-thumb &#123;<span class="hljs-comment">/*滚动条里面小方块*/</span><br>        <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">10px</span>;<br>        <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#F90</span>;<br>        <span class="hljs-attribute">background-image</span>: <span class="hljs-built_in">-webkit-linear-gradient</span>(<span class="hljs-number">45deg</span>, <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, .<span class="hljs-number">2</span>) <span class="hljs-number">25%</span>, transparent <span class="hljs-number">25%</span>, transparent <span class="hljs-number">50%</span>, <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, .<span class="hljs-number">2</span>) <span class="hljs-number">50%</span>, <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, .<span class="hljs-number">2</span>) <span class="hljs-number">75%</span>, transparent <span class="hljs-number">75%</span>, transparent);<br>&#125;<br><span class="hljs-selector-class">.test-5</span>::-webkit-scrollbar-track &#123;<span class="hljs-comment">/*滚动条里面轨道*/</span><br>        -webkit-<span class="hljs-attribute">box-shadow</span>: inset <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">5px</span> <span class="hljs-built_in">rgba</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0.2</span>);<br>        <span class="hljs-comment">/*border-radius: 10px;*/</span><br>        <span class="hljs-attribute">background</span>: <span class="hljs-number">#EDEDED</span>;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>css</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>html</title>
    <link href="/2023/03/20/%E7%AC%94%E8%AE%B0/html/"/>
    <url>/2023/03/20/%E7%AC%94%E8%AE%B0/html/</url>
    
    <content type="html"><![CDATA[<h1 id="html"><a href="#html" class="headerlink" title="html"></a>html</h1><h2 id="基本标签"><a href="#基本标签" class="headerlink" title="基本标签"></a>基本标签</h2><h3 id="1-标题标签"><a href="#1-标题标签" class="headerlink" title="1.标题标签"></a>1.标题标签</h3><h4 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h4><p>分行，加粗</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>标题<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>标题<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>标题<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>标题<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h5</span>&gt;</span>标题<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h6</span>&gt;</span>标题<span class="hljs-tag">&lt;/<span class="hljs-name">h6</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="2-段落标签"><a href="#2-段落标签" class="headerlink" title="2.段落标签"></a>2.段落标签</h3><h4 id="功能-1"><a href="#功能-1" class="headerlink" title="功能"></a>功能</h4><p>是内容成段分行展示，独占一行</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>成段<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="3-字体标签"><a href="#3-字体标签" class="headerlink" title="3.字体标签"></a>3.字体标签</h3><h4 id="下斜线"><a href="#下斜线" class="headerlink" title="下斜线"></a>下斜线</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">ins</span>&gt;</span>下斜线<span class="hljs-tag">&lt;/<span class="hljs-name">ins</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="加粗"><a href="#加粗" class="headerlink" title="加粗"></a>加粗</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>加粗<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="斜体"><a href="#斜体" class="headerlink" title="斜体"></a>斜体</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>斜体<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="划掉"><a href="#划掉" class="headerlink" title="划掉"></a>划掉</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">del</span>&gt;</span>划掉<span class="hljs-tag">&lt;/<span class="hljs-name">del</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="4-地址标签"><a href="#4-地址标签" class="headerlink" title="4.地址标签"></a>4.地址标签</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">address</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">address</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="5-容器"><a href="#5-容器" class="headerlink" title="5.容器"></a>5.容器</h3><h4 id="div"><a href="#div" class="headerlink" title="div"></a>div</h4><p>独占一行，行级元素</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="sqan"><a href="#sqan" class="headerlink" title="sqan"></a>sqan</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="6-特殊符号"><a href="#6-特殊符号" class="headerlink" title="6.特殊符号"></a>6.特殊符号</h3><p>&amp;lt为&lt;   &amp;gt为&gt;</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs 1c"><span class="hljs-meta">&amp;lt;</span><br><span class="hljs-meta">&amp;gt;</span><br></code></pre></td></tr></table></figure><h3 id="7-html编码"><a href="#7-html编码" class="headerlink" title="7.html编码"></a>7.html编码</h3><p>&amp;nbsp;&#x3D;&#x3D;一个空格文本</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html">你好<span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-symbol">&amp;nbsp;</span><span class="hljs-symbol">&amp;nbsp;</span>呀<br></code></pre></td></tr></table></figure><h3 id="8-单标签"><a href="#8-单标签" class="headerlink" title="8.单标签"></a>8.单标签</h3><h4 id="br"><a href="#br" class="headerlink" title="br"></a>br</h4><p>回车&#x3D;&#x3D;<br>换行 单独出现，单标签</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html">a<span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span>b<span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="9-列表"><a href="#9-列表" class="headerlink" title="9.列表"></a>9.列表</h3><h4 id="有序列表"><a href="#有序列表" class="headerlink" title="有序列表"></a>有序列表</h4><p>不常用，或者基本用不到</p><ul><li>reversed  –  倒排序</li><li>type  –  显示</li><li>start   –  从哪一个开始，为阿拉伯数字</li></ul><p><strong>type属性值</strong></p><ul><li><p>1 – 数字1、2</p></li><li><p>a – 小写字母a、b</p></li><li><p>A – 大写字母A、B</p></li><li><p>i – 小写罗马数字</p></li><li><p>I – 大写罗马数字</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">ol</span>&gt;</span><br>     <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>内容<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>内容<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>内容<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>     <span class="hljs-tag">&lt;/<span class="hljs-name">ol</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="无序列表"><a href="#无序列表" class="headerlink" title="无序列表"></a>无序列表</h4><p>最常用的列表，只能放<code>li</code></p><p><strong>type数字值</strong></p><ul><li><p>disc  – 原点（默认）</p></li><li><p>square – 正方形</p></li><li><p>circle –  空心圆</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>内容<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>内容<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>内容<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="自定义列表"><a href="#自定义列表" class="headerlink" title="自定义列表"></a>自定义列表</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs html">// dl里面只能有dt和dd 一个dt对应多个dd<br><span class="hljs-tag">&lt;<span class="hljs-name">dl</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dt</span>&gt;</span>名词1<span class="hljs-tag">&lt;/<span class="hljs-name">dt</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dd</span>&gt;</span>名词1解释1<span class="hljs-tag">&lt;/<span class="hljs-name">dd</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dd</span>&gt;</span>名词1解释2<span class="hljs-tag">&lt;/<span class="hljs-name">dd</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dl</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="10-img属性"><a href="#10-img属性" class="headerlink" title="10.img属性"></a>10.img属性</h3><h5 id="src"><a href="#src" class="headerlink" title="src"></a>src</h5><ul><li><p>网上url  </p></li><li><p>本地的绝对路径:\</p></li><li><p>本地的相对路径</p></li><li><p>下一级路径：&#x2F;</p></li><li><p>上一级路径：..&#x2F;</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure><h5 id="alt"><a href="#alt" class="headerlink" title="alt"></a>alt</h5><p>图片占位符，替换文版，图像不能显示的文字</p><h5 id="title"><a href="#title" class="headerlink" title="title"></a>title</h5><p>图片提示符，提示文本，鼠标放在图像上，显示的文字</p><h5 id="width"><a href="#width" class="headerlink" title="width"></a>width</h5><p>给图像设置宽度</p><h5 id="height"><a href="#height" class="headerlink" title="height"></a>height</h5><p>给图像设定高度</p><h5 id="border"><a href="#border" class="headerlink" title="border"></a>border</h5><p>给图像设定边框</p><h3 id="11-超链接"><a href="#11-超链接" class="headerlink" title="11.超链接"></a>11.超链接</h3><h4 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h4><h5 id="href"><a href="#href" class="headerlink" title="href"></a>href</h5><ul><li>超文本引用，目标地址</li><li>也可以#id名称，类似于导航栏</li><li>href&#x3D;”#”，空链接</li><li>href&#x3D;””，文件或者压缩包，点击就会下载该文件或压缩包</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span>超链接<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br></code></pre></td></tr></table></figure><h5 id="target属性值"><a href="#target属性值" class="headerlink" title="target属性值"></a>target属性值</h5><ul><li><p>_blank  ： 在新窗 口中打开</p></li><li><p>parent ： 在当前的父窗口中打开，如果不存在父窗口，此选项的行为方式与 self 等同</p></li><li><p>_self ： 当前窗口打开（默认）</p></li><li><p>_top ： 在整个窗口中打开</p></li><li><p>framename ： 在指定的框架中打开</p></li></ul><h4 id="功能-2"><a href="#功能-2" class="headerlink" title="功能"></a>功能</h4><p>1.超链接</p><p>2.锚点：设置属性值为#名字，同时也要设置id&#x3D;名字</p><p>3.打电话和发邮箱</p><ul><li>tel：电话号码</li><li>mailto：邮箱地址</li></ul><p>4.协议限定符</p><h2 id="表单"><a href="#表单" class="headerlink" title="表单"></a>表单</h2><h3 id="表格"><a href="#表格" class="headerlink" title="表格"></a>表格</h3><p>table：表格整体</p><p>tr：表格每行</p><p>td：表格单元格</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">table</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>单元格内的文字<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>单元格内的文字<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span><br></code></pre></td></tr></table></figure><h5 id="表头单元格标签"><a href="#表头单元格标签" class="headerlink" title="表头单元格标签"></a>表头单元格标签</h5><p>加粗并居中显示</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>姓名<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><br></code></pre></td></tr></table></figure><h5 id="表格结构标签"><a href="#表格结构标签" class="headerlink" title="表格结构标签"></a>表格结构标签</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html">// <span class="hljs-tag">&lt;<span class="hljs-name">thead</span>&gt;</span>内部必须拥有<span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>标签，一般是位于第一行<br><span class="hljs-tag">&lt;<span class="hljs-name">thead</span>&gt;</span>表格的头部标签<span class="hljs-tag">&lt;/<span class="hljs-name">thead</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">tbody</span>&gt;</span>表格的主体标签<span class="hljs-tag">&lt;/<span class="hljs-name">tbody</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">tfoot</span>&gt;</span>表格的底部标签<span class="hljs-tag">&lt;/<span class="hljs-name">tfoot</span>&gt;</span><br></code></pre></td></tr></table></figure><h5 id="合并单元格"><a href="#合并单元格" class="headerlink" title="合并单元格"></a>合并单元格</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">colspan</span>=<span class="hljs-string">&quot;2&quot;</span>&gt;</span>跨列合并，两个合并为一个<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">rowspan</span>=<span class="hljs-string">&quot;2&quot;</span>&gt;</span>跨行合并，两个合并为一个<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="form"><a href="#form" class="headerlink" title="form"></a>form</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;get&quot;</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><br>username:<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><br> password:<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br></code></pre></td></tr></table></figure><p>发送数据</p><h4 id="method"><a href="#method" class="headerlink" title="method"></a>method</h4><p>发送数据的方式</p><ul><li>get    </li><li>post</li></ul><h4 id="action"><a href="#action" class="headerlink" title="action"></a>action</h4><p>发送给谁的地址</p><h3 id="input标签"><a href="#input标签" class="headerlink" title="input标签"></a>input标签</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;类型属性&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;名称&quot;</span><span class="hljs-attr">...</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="text-–-文本域"><a href="#text-–-文本域" class="headerlink" title="text  –  文本域"></a>text  –  文本域</h4><ul><li><p>name：文本域名称</p></li><li><p>maxlength：指定用户输入最大字符长度</p></li><li><p>size：指定文本框宽度，以字符个数为单位</p></li><li><p>value：指定文本框的默认值</p></li><li><p>placeholder：规定用户填写输入字段的提示，占位符</p></li></ul><h4 id="password-–-密码域"><a href="#password-–-密码域" class="headerlink" title="password  –   密码域"></a>password  –   密码域</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;密码&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;..&quot;</span>   <span class="hljs-attr">checked</span>/&gt;</span><br></code></pre></td></tr></table></figure><p>在控制台查看输入的密码<strong>（不懂）</strong></p><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs axapta"><span class="hljs-built_in">var</span> <span class="hljs-keyword">div</span> = document.getElementsByTagName(<span class="hljs-string">&#x27;input&#x27;</span>)[<span class="hljs-number">1</span>];<br></code></pre></td></tr></table></figure><h4 id="checkbox-–-复选域"><a href="#checkbox-–-复选域" class="headerlink" title="checkbox –  复选域"></a>checkbox –  复选域</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;名字&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;名字&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="radio-–-单选域"><a href="#radio-–-单选域" class="headerlink" title="radio –  单选域"></a>radio –  单选域</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;名字&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;名字&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;sex&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;male&quot;</span> <span class="hljs-attr">checked</span>=<span class="hljs-string">&quot;checked&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;sex&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;female&quot;</span>&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure><p>checked&#x3D;”checked”  –  默认选这个 </p><h4 id="button-–-按钮"><a href="#button-–-按钮" class="headerlink" title="button  –  按钮"></a>button  –  按钮</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;button&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="submit-–-提交按钮"><a href="#submit-–-提交按钮" class="headerlink" title="submit  –  提交按钮"></a>submit  –  提交按钮</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="reset-–-重置按钮"><a href="#reset-–-重置按钮" class="headerlink" title="reset-  –  重置按钮"></a>reset-  –  重置按钮</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;reset&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="label-–-定义标注"><a href="#label-–-定义标注" class="headerlink" title="label – 定义标注"></a>label – 定义标注</h4><p>name——分组</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;sex&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;sex&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;sex&quot;</span>&gt;</span>男<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="hidden-–-隐藏域"><a href="#hidden-–-隐藏域" class="headerlink" title="hidden  –  隐藏域"></a>hidden  –  隐藏域</h4><h4 id="image-–-图像域"><a href="#image-–-图像域" class="headerlink" title="image  –  图像域"></a>image  –  图像域</h4><h4 id="file-–-文件域"><a href="#file-–-文件域" class="headerlink" title="file  –  文件域"></a>file  –  文件域</h4><p>属性名：</p><ul><li>multiple——多文件选择</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;多选&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;..&quot;</span>   <span class="hljs-attr">checked</span>/&gt;</span><br></code></pre></td></tr></table></figure><h4 id="button标签"><a href="#button标签" class="headerlink" title="button标签"></a>button标签</h4><p>type属性</p><ul><li>submit——提交</li><li>reset——重置</li><li>button——普通按钮，一般不用写</li></ul><h3 id="select标签"><a href="#select标签" class="headerlink" title="select标签"></a>select标签</h3><p>select——下拉菜单的整体</p><p>option——下拉菜单的每一项</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">select</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;...&quot;</span>&gt;</span>选项1<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;...&quot;</span>&gt;</span>选项2<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;...&quot;</span>&gt;</span>选项3<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="select-下拉菜单和列表标签"><a href="#select-下拉菜单和列表标签" class="headerlink" title="select 下拉菜单和列表标签"></a><strong>select</strong> 下拉菜单和列表标签</h4><ul><li><p>name ： 设置下拉菜单和列表名称</p></li><li><p>multiple ： 设置可选择多个选项</p></li><li><p>size ： 设置列表中可见选项的数目</p></li></ul><h4 id="option-下拉菜单和列表项目标签"><a href="#option-下拉菜单和列表项目标签" class="headerlink" title="option 下拉菜单和列表项目标签"></a><strong>option</strong> 下拉菜单和列表项目标签</h4><ul><li><p>selected ： 设置选项初始选中状态，默认选中</p></li><li><p>value ： 定义送往服务器的选项值</p></li></ul><h4 id="optgroup-下拉菜单和列表项目分组标签"><a href="#optgroup-下拉菜单和列表项目分组标签" class="headerlink" title="optgroup 下拉菜单和列表项目分组标签"></a><strong>optgroup</strong> 下拉菜单和列表项目分组标签</h4><h4 id="textarea-–-多行文本输入"><a href="#textarea-–-多行文本输入" class="headerlink" title="textarea – 多行文本输入"></a>textarea – 多行文本输入</h4><p>cols——可见宽度</p><p>rows——可见行数</p><p><strong>一般使用css设置</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">textarea</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot; &quot;</span> <span class="hljs-attr">rows</span>=<span class="hljs-string">&quot; &quot;</span> <span class="hljs-attr">cols</span>=<span class="hljs-string">&quot; &quot;</span>&gt;</span>内容<span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="行内元素"><a href="#行内元素" class="headerlink" title="行内元素"></a>行内元素</h2><p><strong>常用标签</strong><br>a(锚点)</p><p>b(粗体）</p><p>span(常用内联容器，定义文本内区块)</p><p>img(图片)</p><p>input(输入框)</p><p>select(项目选择)</p><p>strong(粗体强调)</p><p>label(表格标签)</p><p>cite (引用)</p><p>big（字体加大）</p><p>i（斜体）</p><p>small（字体变小）</p><p>tt（等宽文本效果）</p><p>abbr（缩写）</p><p>acronym（首字母缩写）</p><p>code（引用）</p><p>dfn（定义字段）</p><p>em（强调）</p><p>kbd（定义文本）</p><p>samp（标识计算机程序输出）</p><p>var（变量）</p><p>br（换行）</p><p>q（引用短文本）</p><p>sub（下标）</p><p>sup（上标）</p><p>button（按钮）</p><p>textarea（多行文本输入框）</p><h2 id="块状元素"><a href="#块状元素" class="headerlink" title="块状元素"></a>块状元素</h2><p><strong>常用标签</strong></p><p>ul(无序列表)</p><p>ol(有序列表)</p><p>dl(定义列表)</p><p>table(表格)</p><p>form(表单)</p><p>h1-6 (标题)</p><p>p(段落)</p><p>pre(预格式化)</p><p>blockquote（块引用）</p><p>address（联系方式信息）</p><p>dd（定义列表中定义条目描述）</p><p>div（文档分区）</p><p>fieldset（表单元素分组）</p><p>hr（水平分割线）</p><p>noscript（不支持脚本或禁用脚本时显示的内容）</p><p>tfoot（表脚注）</p><h2 id="区别"><a href="#区别" class="headerlink" title="区别"></a>区别</h2><table><thead><tr><th align="center">行内元素</th><th align="center">块状元素</th><th align="center">行内块元素</th></tr></thead><tbody><tr><td align="center">不换行</td><td align="center">换行</td><td align="center">不换行</td></tr><tr><td align="center">默认宽高</td><td align="center">可设宽高，若不设则默认父级100%</td><td align="center">可设宽高</td></tr><tr><td align="center"><img src="https://images2015.cnblogs.com/blog/1182077/201706/1182077-20170629143724961-1354049426.png" alt="image"></td><td align="center"><img src="https://images2015.cnblogs.com/blog/1182077/201706/1182077-20170629143743461-521811079.png" alt="image"></td><td align="center"><img src="https://images2015.cnblogs.com/blog/1182077/201706/1182077-20170629143817071-627975201.png" alt="image"></td></tr></tbody></table><h2 id="转换"><a href="#转换" class="headerlink" title="转换"></a>转换</h2><p><strong>行</strong></p><p>通过display：inline标签转换</p><p><strong>块</strong></p><p>通过display：block标签转换</p><p><strong>行内块</strong></p><p>通过display：inline-block标签转换</p><h1 id="html5"><a href="#html5" class="headerlink" title="html5"></a>html5</h1><h2 id="结构标签"><a href="#结构标签" class="headerlink" title="结构标签"></a>结构标签</h2><ol><li><p><strong>article</strong><br>article 标签用于定义一篇文章，与页面其它部分无关。</p></li><li><p><strong>aside</strong><br>aside 标签定义侧边栏，通常是网页的说明、提示、引用、附加注释、相关链接、广告等内容。</p></li><li><p><strong>data</strong><br>data 标签将一个指定内容和机器可读的翻译联系在一起。</p></li><li><p><strong>details</strong><br>details 标签用于定义用户可见的或者隐藏的需求的补充细节。</p></li></ol><blockquote><p>details 元素的内容对用户是不可见的，除非设置了 open 属性。<br>与 <code>&lt;summary&gt;</code> 标签配合使用可以为 details 定义标题。标题是可见的，用户点击标题时，会显示出 details。</p></blockquote><h2 id="语义化标签"><a href="#语义化标签" class="headerlink" title="语义化标签"></a>语义化标签</h2><ul><li>header——头部标签</li><li>nav——导航标签</li><li>article——内容标签</li><li>section——定义文档某个区域</li><li>aside——侧边栏标签</li><li>footer——尾部标签</li></ul><p><img src="/img/html/yuyihuabiaoqian.png" alt="image-20221103162609343"></p><ol><li><strong>dialog</strong><br>dialog 标签定义一个对话框、确认框或窗口。</li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">dialog</span> <span class="hljs-attr">open</span>&gt;</span>我是一个对话框<span class="hljs-tag">&lt;/<span class="hljs-name">dialog</span>&gt;</span><br></code></pre></td></tr></table></figure><blockquote><p>open：规定 dialog 元素是有效的，用户可以与它进行交互。</p></blockquote><ol><li><p><strong>footer</strong><br>footer 标签定义文档或节的页脚。</p></li><li><p><strong>header</strong><br>header 标签用于定义文档的页眉（介绍信息）。</p></li><li><p><strong>main</strong><br>main 标签用于定义文档或应用的主体部分。</p></li><li><p><strong>nav</strong><br>nav 标签用于定义页面主导航功能。</p></li><li><p><strong>section</strong><br>section 标签用于定义定义文档中的节。</p></li><li><p><strong>summary</strong></p><p>summary 标签定义</p></li></ol><blockquote><p>summary 和 details 元素配合使用可以为 details 定义标题。标题是可见的，用户点击标题时，会显示出 details。</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">details</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">summary</span>&gt;</span>标题<span class="hljs-tag">&lt;/<span class="hljs-name">summary</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>展开框1<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>展开框2<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">details</span>&gt;</span><br></code></pre></td></tr></table></figure><p><strong>常见页面布局</strong></p><h2 id="多媒体"><a href="#多媒体" class="headerlink" title="多媒体"></a>多媒体</h2><h3 id="声音-amp-音乐"><a href="#声音-amp-音乐" class="headerlink" title="声音&amp;音乐"></a>声音&amp;音乐</h3><p>audio 标签定义声音，比如音乐或其他音频流。支持的3种文件格式：MP3、Wav、Ogg。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">audio</span> <span class="hljs-attr">controls</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">source</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;音乐.mp3&quot;</span> &gt;</span><br>    您的浏览器不支持 audio 元素。<br><span class="hljs-tag">&lt;/<span class="hljs-name">audio</span>&gt;</span><br></code></pre></td></tr></table></figure><blockquote><p>autoplay:如果指定该属性，则音频在就绪后马上播放。</p><p>controls:如果指定该属性，则向用户显示播放控件（比如播放&#x2F;暂停按钮）。</p><p>loop:如果指定该属性，将循环播放音频。</p></blockquote><blockquote><p>muted:如果指定该属性，则音频输出为静音。</p><p>preload:auto&#x2F;metadata&#x2F;none;<br>指定音频在页面加载时，是否进行预加载。注意：如果同时指定了<br>autoplay 属性，则忽略该属性。<br>其中：<br>auto：要求浏览器尽快加载整个音频，默认行为<br>metadata：只加载音频的元数据<br>none：在用户点击开始播放之前不会加载音频</p></blockquote><h3 id="字幕"><a href="#字幕" class="headerlink" title="字幕"></a>字幕</h3><p>track 标签用于为 HTML5 的媒体文件添加字幕。</p><blockquote><p>注：track 元素可以直接添加字幕，而无需额外编写脚本或其他程序实现。</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">track</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;地址.vtt&quot;</span> <span class="hljs-attr">srclang</span>=<span class="hljs-string">&quot;en&quot;</span> <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;English&quot;</span> <span class="hljs-attr">kind</span>=<span class="hljs-string">&quot;subtitles&quot;</span> <span class="hljs-attr">default</span>&gt;</span><br></code></pre></td></tr></table></figure><blockquote><p>default：指定该字幕为默认字幕（如果用户没有选择其他字幕，则自动使用该字幕）。</p><p>label：text；指定字幕的标题。</p><p>srclang：language_code；指定字幕文本所使用的语言（如果 kind 属性的值是 “subtitles”，则该属性是必需的）。</p><p>kind：captions &#x2F; chapters &#x2F; descriptions &#x2F; metadata &#x2F; subtitles；<br>指定该字幕的文本类型。<br>captions：对话或音效的字幕<br>chapters：章节标题<br>descriptions：视频内容的文本描述<br>metadata：元数据<br>subtitles：字幕</p></blockquote><h3 id="视频"><a href="#视频" class="headerlink" title="视频"></a>视频</h3><p>video 标签定义视频，比如电影片段或其他视频流。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">video</span> <span class="hljs-attr">sre</span>=<span class="hljs-string">&quot;文件地址&quot;</span> <span class="hljs-attr">controls</span>=<span class="hljs-string">&quot;controls&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">video</span>&gt;</span><br><br><span class="hljs-comment">&lt;!-- 有些浏览器不支持，所以可以加source解决 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">video</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;640&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;360&quot;</span> <span class="hljs-attr">controls</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">source</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;地址.mp4&quot;</span>  <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;video/mp4&quot;</span>&gt;</span><br>        您的浏览器不支持 HTML5 video 标签。<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">video</span>&gt;</span><br></code></pre></td></tr></table></figure><blockquote><p>autoplay:如果指定该属性，则视频在就绪后将自动播放。</p><p>controls:如果指定该属性，则向用户显示控件，比如播放&#x2F;暂停按钮。</p><p>loop:如果指定该属性，将循环播放视频。</p><p>muted:如果指定该属性，则将视频的音频输出为静音。</p><p>poster:指定视频正在下载时显示的图像。后面加地址</p><p>preload:auto&#x2F;metadata&#x2F;none;<br>指定视频在页面加载时，是否进行预加载。注意：如果同时指定了<br>autoplay 属性，则忽略该属性。<br>auto：要求浏览器尽快加载整个视频，默认行为<br>metadata：只加载视频的元数据（宽度、高度、第一帧影像和视频总长度等）<br>none：在用户点击开始播放之前不会加载视频</p></blockquote><h3 id="source"><a href="#source" class="headerlink" title="source"></a>source</h3><p>source 标签为 picture , audio 或者 video 元素指定多个媒体资源。source 元素是一个空元素。它通常用于以不同浏览器支持的多种格式提供相同的媒体内容。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">audio</span> <span class="hljs-attr">controls</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">source</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;地址.mp3&quot;</span> &gt;</span><br>    您的浏览器不支持 audio 元素。<br><span class="hljs-tag">&lt;/<span class="hljs-name">audio</span>&gt;</span><br></code></pre></td></tr></table></figure><blockquote><p>srcset:仅当source元素是picture元素的直接子元素时，srcset属性才有效。</p><p>media:规定媒体资源的类型。</p><p>sizes:表示源大小的列表，用于描述源代表的图像的最终渲染宽度。</p><p>type:规定媒体资源的 MIME 类型。</p></blockquote><h2 id="状态标签"><a href="#状态标签" class="headerlink" title="状态标签"></a>状态标签</h2><h3 id="meter"><a href="#meter" class="headerlink" title="meter"></a>meter</h3><p>meter 标签定义一个范围内的测量值&#x2F;分数值。仅用于已知最大和最小值的度量，比如：磁盘使用情况，查询结果的相关性等。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">meter</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;3&quot;</span> <span class="hljs-attr">min</span>=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-attr">max</span>=<span class="hljs-string">&quot;10&quot;</span>&gt;</span>显示<span class="hljs-tag">&lt;/<span class="hljs-name">meter</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">meter</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;0.6&quot;</span>&gt;</span>60%<span class="hljs-tag">&lt;/<span class="hljs-name">meter</span>&gt;</span><br></code></pre></td></tr></table></figure><blockquote><p>form：指定该元素所属的一个或多个表单</p><p>high：指定被界定为高的值的范围</p><p>low：指定被界定为低的值的范围</p><p>max：指定范围的最大值</p><p>min：指定范围的最小值</p><p>optimum：指定最优值</p><p>value：必需，指定当前值</p></blockquote><h3 id="progress"><a href="#progress" class="headerlink" title="progress"></a>progress</h3><p>progress 标签定义运行中的任务进度（进程）。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html">进度：<span class="hljs-tag">&lt;<span class="hljs-name">progress</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;22&quot;</span> <span class="hljs-attr">max</span>=<span class="hljs-string">&quot;100&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">progress</span>&gt;</span><br></code></pre></td></tr></table></figure><blockquote><p>max:规定需要完成的值。<br>value:规定进程的当前值。</p></blockquote><h2 id="列表标签"><a href="#列表标签" class="headerlink" title="列表标签"></a>列表标签</h2><h3 id="datalist"><a href="#datalist" class="headerlink" title="datalist"></a>datalist</h3><p>datalist 标签规定了 input 标签可能的选项列表。</p><blockquote><p>请使用 input 标签的 list 属性来绑定 datalist 标签的ID值，<br>样便可为 input 标签提供”自动完成”的功能。用户能看到一个下拉<br>表，里边的选项是预先定义好的，将作为用户的输入数据。</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span><br>    宣言：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">list</span>=<span class="hljs-string">&quot;myDatalist&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;datalist&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">datalist</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;myDatalist&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">option</span>&gt;</span>我<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">option</span>&gt;</span>爱<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">option</span>&gt;</span>学<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">option</span>&gt;</span>习<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">datalist</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="details"><a href="#details" class="headerlink" title="details"></a>details</h3><p>上面有。。</p><h2 id="注释标签"><a href="#注释标签" class="headerlink" title="注释标签"></a>注释标签</h2><h3 id="ruby"><a href="#ruby" class="headerlink" title="ruby"></a>ruby</h3><p>ruby 标签定义注音符号。</p><blockquote><p>ruby 元素需要与 rt 元素和 rp 元素搭配使用。<br>其中，rt 元素用来标记注音符号，rp 元素则用来标记当浏览器不支持<br>ruby 元素时所显示的内容。</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">ruby</span>&gt;</span><br>    1 <span class="hljs-tag">&lt;<span class="hljs-name">rp</span>&gt;</span>(<span class="hljs-tag">&lt;/<span class="hljs-name">rp</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">rt</span>&gt;</span>huáng<span class="hljs-tag">&lt;/<span class="hljs-name">rt</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">rp</span>&gt;</span>)<span class="hljs-tag">&lt;/<span class="hljs-name">rp</span>&gt;</span><br>    2 <span class="hljs-tag">&lt;<span class="hljs-name">rp</span>&gt;</span>(<span class="hljs-tag">&lt;/<span class="hljs-name">rp</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">rt</span>&gt;</span>chuàng<span class="hljs-tag">&lt;/<span class="hljs-name">rt</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">rp</span>&gt;</span>)<span class="hljs-tag">&lt;/<span class="hljs-name">rp</span>&gt;</span><br>    3 <span class="hljs-tag">&lt;<span class="hljs-name">rp</span>&gt;</span>(<span class="hljs-tag">&lt;/<span class="hljs-name">rp</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">rt</span>&gt;</span>jìng<span class="hljs-tag">&lt;/<span class="hljs-name">rt</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">rp</span>&gt;</span>)<span class="hljs-tag">&lt;/<span class="hljs-name">rp</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">ruby</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="rt"><a href="#rt" class="headerlink" title="rt"></a>rt</h3><p>rt 标签与 ruby 标签搭配中使用，用于定义注音符号。</p><h3 id="rp"><a href="#rp" class="headerlink" title="rp"></a>rp</h3><p>rp 标签与 ruby 标签搭配中使用，用于定义不支持 ruby 元素的浏览器所显示的内容。</p><h2 id="其他标签"><a href="#其他标签" class="headerlink" title="其他标签"></a>其他标签</h2><h3 id="mark"><a href="#mark" class="headerlink" title="mark"></a>mark</h3><p>mark 标签用于定义带有标记的文本。</p><blockquote><p>在需要突出显示某部分文本时使用该标签。</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>我是<span class="hljs-tag">&lt;<span class="hljs-name">mark</span>&gt;</span>内容<span class="hljs-tag">&lt;/<span class="hljs-name">mark</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="output"><a href="#output" class="headerlink" title="output"></a>output</h3><p>output 标签将计算结果输出显示（比如执行脚本的输出）。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">oninput</span>=<span class="hljs-string">&quot;result.value=parseInt(a.value)+parseInt(b.value)&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;range&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;b&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;50&quot;</span> /&gt;</span> +<br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;number&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;a&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;33&quot;</span> /&gt;</span> =<br>    <span class="hljs-tag">&lt;<span class="hljs-name">output</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;result&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">output</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="input"><a href="#input" class="headerlink" title="input"></a>input</h3><p>表单</p><p><img src="/img/html/biaodan.png" alt="image-20221103163319542"></p><p>表单属性</p><p><img src="/img/html/biaodanshuxing.png" alt="image-20221103163408655"></p><h2 id="其他学习"><a href="#其他学习" class="headerlink" title="其他学习"></a>其他学习</h2><h3 id="canvas"><a href="#canvas" class="headerlink" title="canvas"></a>canvas</h3><ul><li>标签定义图形，比如图表和其他图像。该标签基于 JavaScript 的绘图 API</li></ul><p>图形容器，必须使用脚本来绘制图形</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;myCanvas&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;200&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;100&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;border:1px solid #000000;&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="svg"><a href="#svg" class="headerlink" title="svg"></a>svg</h3><p>SVG 图形的容器</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="hljs-attr">version</span>=<span class="hljs-string">&quot;1.1&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;190&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">polygon</span> <span class="hljs-attr">points</span>=<span class="hljs-string">&quot;100,10 40,180 190,60 10,60 160,180&quot;</span></span><br><span class="hljs-tag"><span class="hljs-attr">style</span>=<span class="hljs-string">&quot;fill:lime;stroke:purple;stroke-width:5;fill-rule:evenodd;&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="SVG-与-Canvas两者间的区别"><a href="#SVG-与-Canvas两者间的区别" class="headerlink" title="SVG 与 Canvas两者间的区别"></a>SVG 与 Canvas两者间的区别</h3><ul><li><p>SVG 是一种使用 XML 描述 2D 图形的语言</p></li><li><p>Canvas 通过 JavaScript 来绘制 2D 图形</p></li></ul><p>SVG 基于 XML，这意味着 SVG DOM 中的每个元素都是可用的。您可以为某个元素附加 JavaScript 事件处理器。</p><p>在 SVG 中，每个被绘制的图形均被视为对象。如果 SVG 对象的属性发生变化，那么浏览器能够自动重现图形。</p><p>Canvas 是逐像素进行渲染的。在 canvas 中，一旦图形被绘制完成，它就不会继续得到浏览器的关注。如果其位置发生变化，那么整个场景也需要重新绘制，包括任何或许已被图形覆盖的对象。</p><h1 id="查漏补缺"><a href="#查漏补缺" class="headerlink" title="查漏补缺"></a>查漏补缺</h1>]]></content>
    
    
    <categories>
      
      <category>笔记</category>
      
    </categories>
    
    
    <tags>
      
      <tag>html</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
